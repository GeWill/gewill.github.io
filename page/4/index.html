<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
<meta property="og:type" content="website">
<meta property="og:title" content="Will&#39;s Blog">
<meta property="og:url" content="http://example.com/page/4/index.html">
<meta property="og:site_name" content="Will&#39;s Blog">
<meta property="og:description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Ge Will">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/4/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/4/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Will's Blog</title>
  







<head>
    <!-- 霞鹜文楷字体 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.7.0/style.css"/>

    <!-- datapulse统计 -->
    <script defer type="text/javascript" src="https://datapulse.app/datapulse.min.js" id="datapulse" data-endpoint="https://datapulse.app/api/v1/event" data-workspace="cljxqml5q0y0f8j37d4futnbl"></script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DR0FC9YJLH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'G-DR0FC9YJLH');
    </script>

    <!-- 看板娘 -->
    <script src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script>
</head>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Will's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">197</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">16</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">1</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Ge Will"
      src="/images/avatar.jpeg">
  <p class="site-author-name" itemprop="name">Ge Will</p>
  <div class="site-description" itemprop="description">The people who are crazy enough to think they can change the world, are the ones who DO.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">197</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/gewill" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;gewill" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:531sunlight@gmail.com" title="E-Mail → mailto:531sunlight@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/gewei" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;gewei" rel="noopener me" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/BoJack_D" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;BoJack_D" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/27/UserDefaults-default-vaule-issue-with-AppStorage/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/27/UserDefaults-default-vaule-issue-with-AppStorage/" class="post-title-link" itemprop="url">UserDefaults 和 AppStorage 混用时默认值的问题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-11-27 20:04:04" itemprop="dateCreated datePublished" datetime="2022-11-27T20:04:04+08:00">2022-11-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>UserDefaults 和 AppStorage 混用时，默认值不统一的问题。因为AppStorage持久化时机不确定，UserDefaults先调用时可能获取的值仍是系统默认值。</p>
<h2 id="解决方案有两种："><a href="#解决方案有两种：" class="headerlink" title="解决方案有两种："></a>解决方案有两种：</h2><h3 id="1-UserDefaults-standard-object-forKey-nil-判断。"><a href="#1-UserDefaults-standard-object-forKey-nil-判断。" class="headerlink" title="1. UserDefaults.standard.object(forKey:) == nil 判断。"></a>1. <code>UserDefaults.standard.object(forKey:) == nil</code> 判断。</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="type">UserDefaults</span>.standard.object(forKey: <span class="string">&quot;hasHapticFeedback&quot;</span>) <span class="operator">==</span> <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="type">UserDefaults</span>.standard.set(<span class="literal">true</span>, forKey: <span class="string">&quot;hasHapticFeedback&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-借助SwiftyUserDefaults，但是对于纯SwiftUI项目，没必要。"><a href="#2-借助SwiftyUserDefaults，但是对于纯SwiftUI项目，没必要。" class="headerlink" title="2. 借助SwiftyUserDefaults，但是对于纯SwiftUI项目，没必要。"></a>2. 借助<a target="_blank" rel="noopener" href="https://github.com/sunshinejr/SwiftyUserDefaults">SwiftyUserDefaults</a>，但是对于纯SwiftUI项目，没必要。</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">DefaultsKeys</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> userColorScheme: <span class="type">DefaultsKey</span>&lt;<span class="type">String</span>&gt; &#123; .<span class="keyword">init</span>(<span class="string">&quot;userColorScheme&quot;</span>, defaultValue: <span class="string">&quot;default&quot;</span>) &#125;</span><br><span class="line">    <span class="keyword">var</span> userThemeName: <span class="type">DefaultsKey</span>&lt;<span class="type">String</span>?&gt; &#123; .<span class="keyword">init</span>(<span class="string">&quot;userThemeName&quot;</span>) &#125;</span><br><span class="line">    <span class="keyword">var</span> userLastLoginDate: <span class="type">DefaultsKey</span>&lt;<span class="type">Date</span>?&gt; &#123; .<span class="keyword">init</span>(<span class="string">&quot;userLastLoginDate&quot;</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/20/SwiftUI-TextField-Vertical-Axis-Focus-Issues/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/20/SwiftUI-TextField-Vertical-Axis-Focus-Issues/" class="post-title-link" itemprop="url">SwiftUI TextField 垂直布局时焦点的问题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-11-20 22:54:10" itemprop="dateCreated datePublished" datetime="2022-11-20T22:54:10+08:00">2022-11-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>水平布局时，滚动正常，回车键也能正常退出编辑。底层是<code>UITextField</code>。<br>垂直布局时，底层是<code>UITextView</code>，表现不一致，出现问题。</p>
<ol>
<li>焦点问题需要我们滚动时，锚点设为顶部，<code>proxy.scrollTo($0, anchor: .top)</code>。</li>
<li>回车键，退出编辑失效的问题，需要借助<code>toolbar</code>。</li>
</ol>
<p>完整代码如下：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TestNextTextFieldFocus</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">  <span class="meta">@State</span> <span class="keyword">var</span> inputsValues: [<span class="type">String</span>] <span class="operator">=</span> (<span class="number">0</span><span class="operator">..&lt;</span><span class="number">30</span>).map &#123; i <span class="keyword">in</span></span><br><span class="line">    <span class="string">&quot;test <span class="subst">\(i)</span> TextField axis is <span class="subst">\(i <span class="operator">%</span> <span class="number">2</span> <span class="operator">==</span> <span class="number">0</span> <span class="operator">?</span> <span class="string">&quot;.vertical&quot;</span> : <span class="string">&quot;.horizontal&quot;</span>)</span>&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@FocusState</span> <span class="keyword">var</span> focusedInput: <span class="type">Int</span>?</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">ScrollViewReader</span> &#123; proxy <span class="keyword">in</span></span><br><span class="line">      <span class="type">ScrollView</span> &#123;</span><br><span class="line">        <span class="type">LazyVStack</span> &#123;</span><br><span class="line">          <span class="type">ForEach</span>(<span class="number">0</span><span class="operator">..&lt;</span>inputsValues.count, id: \.<span class="keyword">self</span>) &#123; i <span class="keyword">in</span></span><br><span class="line">            <span class="type">TextField</span>(<span class="string">&quot;Value&quot;</span>, text: <span class="variable">$inputsValues</span>[i], axis: i <span class="operator">%</span> <span class="number">2</span> <span class="operator">==</span> <span class="number">0</span> <span class="operator">?</span> .vertical : .horizontal)</span><br><span class="line">              .focused(<span class="variable">$focusedInput</span>, equals: i)</span><br><span class="line">              .submitLabel(.return)</span><br><span class="line">              .id(i)</span><br><span class="line">              .onSubmit &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;submit <span class="subst">\(i)</span>&quot;</span>)</span><br><span class="line">                <span class="comment">// update state here !!</span></span><br><span class="line">                <span class="keyword">if</span> (i <span class="operator">+</span> <span class="number">1</span>) <span class="operator">&lt;</span> inputsValues.count &#123;</span><br><span class="line">                  focusedInput <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                  focusedInput <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .onChange(of: focusedInput) &#123;</span><br><span class="line">          <span class="built_in">print</span>(<span class="string">&quot;onChange focusedInput:<span class="subst">\(String(describing: focusedInput))</span>&quot;</span>)</span><br><span class="line">          <span class="comment">// react on state change here !!</span></span><br><span class="line">          proxy.scrollTo(<span class="variable">$0</span>, anchor: .top)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      .toolbar &#123;</span><br><span class="line">        <span class="type">ToolbarItemGroup</span>(placement: .keyboard) &#123;</span><br><span class="line">          <span class="type">Spacer</span>()</span><br><span class="line">          <span class="type">Button</span> &#123;</span><br><span class="line">            focusedInput <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">          &#125; label: &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Done&quot;</span>)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TestNextTextFieldFocus_Previews</span>: <span class="title class_">PreviewProvider</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">TestNextTextFieldFocus</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/01/05/introducing-Mountpaper/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/01/05/introducing-Mountpaper/" class="post-title-link" itemprop="url">Mountpaper介绍</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-01-05 09:29:23" itemprop="dateCreated datePublished" datetime="2022-01-05T09:29:23+08:00">2022-01-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="介绍Introducing"><a href="#介绍Introducing" class="headerlink" title="介绍Introducing"></a>介绍Introducing</h1><p><img src="https://gewill.org/assets/Mountpaper-iPhone-screenshot1.jpg" alt="Mountpaper-iPhone-screenshot1"><br><img src="https://gewill.org/assets/Mountpaper-iPad-screenshot1.jpg" alt="Mountpaper-iPad-screenshot1"><br><img src="https://gewill.org/assets/Mountpaper-mac-screenshot1.jpg" alt="Mountpaper-mac-screenshot1"></p>
<p>裱纸是装裱壁纸的意思。提供许多高质量壁纸。</p>
<p>Mountpaper is meaning of mount wallpaper. Offer a lot of high quality wallpapers.</p>
<p>下载地址 Download on：<a target="_blank" rel="noopener" href="https://apps.apple.com/cn/app/mountpaper/id1603270231">App Store</a></p>
<p>有任何疑问或者建议，可以通过 <a href="mailto:531sunlight@gmail.com">Email</a> 联系。</p>
<p>If you have any questions or suggestions, you can contact them through <a href="mailto:531sunlight@gmail.com">Email</a>.</p>
<h1 id="隐私政策Privacy-policy"><a href="#隐私政策Privacy-policy" class="headerlink" title="隐私政策Privacy policy"></a>隐私政策Privacy policy</h1><p>本App不进行任何隐私信息收集或上传。</p>
<p>This App does not collect or upload any private information.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/16/introducing-SwiftyModel/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/16/introducing-SwiftyModel/" class="post-title-link" itemprop="url">SwiftyModel介绍</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-16 18:21:00" itemprop="dateCreated datePublished" datetime="2021-11-16T18:21:00+08:00">2021-11-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://gewill.org/assets/SwiftyModel-mac-preview.jpg" alt="SwiftyModel-mac-preview"></p>
<h1 id="介绍Introducing"><a href="#介绍Introducing" class="headerlink" title="介绍Introducing"></a>介绍Introducing</h1><p>使用 SwiftyJSON 生成在 Swift 语言中支持 SwiftyJSON 的 Model（模型）。</p>
<p>一键复制和分享代码。</p>
<p>Use SwiftyJSON to generate models that support SwiftyJSON in Swift Language.</p>
<p>One-click to copy or share code.</p>
<p>例如输入以下JSON：</p>
<p>For example, enter the following JSON:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Jacky&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;notifications&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;pets&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;cat&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;dog&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出Swift Model：</p>
<p>Output Swift Model:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> SwiftyJSON</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">NewModel</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> id: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> notifications: <span class="type">Bool</span></span><br><span class="line">    <span class="keyword">let</span> pets: [<span class="type">String</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="params">json</span>: <span class="type">JSON</span>) &#123;</span><br><span class="line">        id <span class="operator">=</span> json[<span class="string">&quot;id&quot;</span>].intValue</span><br><span class="line">        name <span class="operator">=</span> json[<span class="string">&quot;name&quot;</span>].stringValue</span><br><span class="line">        notifications <span class="operator">=</span> json[<span class="string">&quot;notifications&quot;</span>].boolValue</span><br><span class="line">        pets <span class="operator">=</span> json[<span class="string">&quot;pets&quot;</span>].arrayValue.map &#123; <span class="variable">$0</span>.stringValue &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下载地址：<a target="_blank" rel="noopener" href="https://apps.apple.com/us/app/swiftymodel/id1594180242">App Store</a></p>
<p><a target="_blank" rel="noopener" href="https://apps.apple.com/cn/app/swiftymodel/id1594180242">App Store下载</a><br><a target="_blank" rel="noopener" href="https://apps.apple.com/app/swiftymodel/id1594180242">Download on the App Store</a></p>
<p>有任何疑问或者建议，可以通过 <a href="mailto:531sunlight@gmail.com">Email</a> 联系。</p>
<p>If you have any questions or suggestions, you can contact them through <a href="mailto:531sunlight@gmail.com">Email</a>.</p>
<h1 id="隐私政策Privacy-policy"><a href="#隐私政策Privacy-policy" class="headerlink" title="隐私政策Privacy policy"></a>隐私政策Privacy policy</h1><p>本App不进行任何隐私信息收集或上传。</p>
<p>This App does not collect or upload any private information.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/04/18/introducing-Subscriptions-Bill/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/18/introducing-Subscriptions-Bill/" class="post-title-link" itemprop="url">阅账介绍</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-04-18 20:35:29" itemprop="dateCreated datePublished" datetime="2021-04-18T20:35:29+08:00">2021-04-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://gewill.org/assets/subscriptions-mac-preview.jpg" alt="subscriptions-mac-preview"></p>
<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><ol>
<li><p>轻松记录全部订阅账单。</p>
</li>
<li><p>统计平均每日、每周、每月和每年花费。</p>
</li>
<li><p>支持iCloud同步全设备。</p>
</li>
</ol>
<p>下载地址：<a target="_blank" rel="noopener" href="https://apps.apple.com/cn/app/%E9%98%85%E5%B8%90/id1561803236">App Store</a></p>
<p>有任何疑问或者建议，可以通过 <a href="mailto:531sunlight@gmail.com">Email</a> 联系。</p>
<h2 id="隐私政策"><a href="#隐私政策" class="headerlink" title="隐私政策"></a>隐私政策</h2><p>本隐私政策描述了我们如何收集，使用和披露与服务有关的个人信息，您通过访问服务即表示同意。“个人信息”是指有关可识别个人的信息，但不包括商业信息。</p>
<h3 id="收集哪些信息"><a href="#收集哪些信息" class="headerlink" title="收集哪些信息"></a>收集哪些信息</h3><p>阅账希望使您与我们的体验令人满意且安全。我们的数据收集政策使您可以选择向我们提供多少个人信息，并控制我们如何使用这些信息。我们的目标是为您提供满意的体验，同时让您控制自己的隐私。阅账收集和使用信息主要是为了使您使用我们的服务更轻松，更有意义。如果您选择向我们注册，则可能会在不同时间要求您提供信息，我们将竭尽所能使阅账满足您的服务并只为您提供所需的内容。</p>
<h3 id="收集的信息与用途"><a href="#收集的信息与用途" class="headerlink" title="收集的信息与用途"></a>收集的信息与用途</h3><p>为识别您的设备 ID 并预防恶意程序、提高服务安全性、保障运营质量及效率，我们使用的第三方平台包括Firebase 会收集您的设备信息（包括IMEI、MEID、IMSI、GUID、MAC地址）、您安装的应用信息或运行中的进程信息。</p>
<p><strong>匿名信息</strong>是指无法与特定个人联系在一起的信息，我们不知道您的姓名，住处或出生日期。匿名信息可能以多种方式收集，包括通过使用 Cookie，网络信标或从您使用的设备中收集。</p>
<h3 id="第三方分析工具"><a href="#第三方分析工具" class="headerlink" title="第三方分析工具"></a>第三方分析工具</h3><p>我们的服务可能包含来自我们服务提供商的第三方跟踪以及数据收集和分析工具，例如 Google Analytics（分析）和 Google Firebase 。此类第三方可以在我们的服务中使用 Cookie，API 和 SDK，以使他们能够代表我们收集和分析与用户和设备相关的数据和信息。第三方可能会访问并收集有关您的数据和信息，例如您的设备标识符(包括IMEI、MEID、IMSI、GUID、MAC地址及其他相关信息)，语言环境（使用特定语言的特定位置），地理位置信息，IP 地址，应用程序使用情况，访问权限和会话时间，传感器数据，设备上存在的或在设备上特定时间使用的应用程序以及您对广告的观看和互动，以提供其服务，包括例如启用，提供和投放广告在下面有更详细的说明。</p>
<p>我们的服务提供商的隐私政策可能包括有关其数据收集和使用惯例以及跟踪技术的其他条款和披露，我们鼓励您检查这些隐私政策以了解有关其数据收集和使用惯例以及 Cookie 的使用的更多信息以及其他类似的跟踪技术。</p>
<p>为识别您的设备 ID 并预防恶意程序、提高服务安全性、保障运营质量及效率，我们使用的第三方平台将获取设备序列号。</p>
<ul>
<li><strong>Google</strong><br>隐私政策：<a target="_blank" rel="noopener" href="https://policies.google.com/privacy">https://policies.google.com/privacy</a></li>
</ul>
<h3 id="第三方广告合作伙伴"><a href="#第三方广告合作伙伴" class="headerlink" title="第三方广告合作伙伴"></a>第三方广告合作伙伴</h3><p>我们与各种广告商，广告网络，广告服务器和分析公司合作。这些广告商，广告网络，广告服务器和分析公司使用各种技术以及第三方公司的技术来收集数据，以便向您和其他用户发送（或投放）相关广告。这些技术可能包括放置Cookie或网络信标，使用唯一或非唯一的非个人标识符，或在我们的服务上使用其他技术，并且这些技术可用于跟踪用户行为，跟踪我们如何服务正在使用中，有可能为您提供更多相关的广告。这些目标广告可能会出现在我们的服务或您访问的其他服务上。本隐私政策不涵盖广告商，广告网络，广告服务器和分析公司对各种技术的使用。这些公司还可能从您从其他公司使用的服务中获取信息，这些服务包括但不限于其他网站，移动网站，可移动下载的应用程序和可下载的桌面应用程序，并将这些信息与他们通过我们的服务通过这些第三方技术获取的信息结合在一起。您应该意识到，我们无法控制这些第三方技术或其中包含的信息。</p>
<h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><p>阅账可以随时修改本隐私政策。请经常检查是否有任何更改。继续使用服务，即表示您接受本隐私政策的所有更新。此版本于 2023 年 02 月 01 日更新。</p>
<h3 id="联系我们"><a href="#联系我们" class="headerlink" title="联系我们"></a>联系我们</h3><p>我们希望此声明能为您提供丰富而清晰的信息。如果您有任何疑问或进一步的信息，请给我们发送电子邮件。</p>
<p>App 与服务反馈: <a href="mailto:531sunlight@gmail.com">531sunlight@gmail.com</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/11/14/Update-Hackintosh-to-Big-Sur-with-Open-Core/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/11/14/Update-Hackintosh-to-Big-Sur-with-Open-Core/" class="post-title-link" itemprop="url">使用 Open Core 黑苹果升级至 Big Sur</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-11-14 14:59:53" itemprop="dateCreated datePublished" datetime="2020-11-14T14:59:53+08:00">2020-11-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="机器配置"><a href="#机器配置" class="headerlink" title="机器配置"></a>机器配置</h2><p>主板：<a target="_blank" rel="noopener" href="https://www.msi.com/Motherboard/MPG-Z390-GAMING-PRO-CARBON-AC">微星 MSI MPG Z390 GAMING PRO CARBON AC</a></p>
<p>CPU：<a target="_blank" rel="noopener" href="https://ark.intel.com/content/www/us/en/ark/products/186605/intel-core-i9-9900k-processor-16m-cache-up-to-5-00-ghz.html">Intel i9 9900K</a></p>
<p>内存：科赋 DDR4 3200  16G*4</p>
<p>显卡：<a target="_blank" rel="noopener" href="https://www.asus.com/us/Graphics-Cards/AREZ-STRIX-RXVEGA64-O8G-GAMING/">华硕 ASUS AREZ-STRIX-RXVEGA64-O8G-GAMING</a></p>
<p>电源：<a target="_blank" rel="noopener" href="https://www.evga.com/products/product.aspx?pn=120-GP-0750-X1">EVGA SuperNOVA 750 G+</a></p>
<p>散热：<a target="_blank" rel="noopener" href="http://www.coolermaster.com/cooling/cpu-liquid-cooler/masterliquid-ml240r-rgb/">MASTERLIQUID ML240R RGB</a></p>
<p>固态：三星 970 EVO 500G</p>
<p>板载声卡：ALC S1220A</p>
<p>板载有线网卡：Intel I219V7</p>
<p>无线网卡和蓝牙：BCM94360CD</p>
<p>显示器：戴尔 P2715Q 4K显示器</p>
<p>机箱：<a target="_blank" rel="noopener" href="http://www.phanteks.com/Enthoo-Evolv-ATX-TemperedGlass.html">追风者 PK-515ETG</a></p>
<h2 id="具体步骤"><a href="#具体步骤" class="headerlink" title="具体步骤"></a>具体步骤</h2><ol>
<li>替换Clover为Open Core v0.6.2，感谢 <a target="_blank" rel="noopener" href="https://github.com/pOH7">pOH7</a>&#x2F;<strong><a target="_blank" rel="noopener" href="https://github.com/pOH7/hackintosh-z390-h-9700k">hackintosh-z390-h-9700kuzh</a></strong> 的EFI。</li>
<li>下载并升级Big Sur，重启几次后，无法进入Big Sur的安装界面。</li>
<li>升级Open Core v0.6.3，感谢 <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=QK9Kmvmnp0A">Ryzentosh Big Sur Updating OpenCore From 0.6.2 to 0.6.3</a><ol>
<li>打开<a target="_blank" rel="noopener" href="https://opencore.slowgeek.com/">OpenCore Sanity Checker</a> ，拖进<code>config.plist</code>，根据建议修改。</li>
<li>下载<a target="_blank" rel="noopener" href="https://github.com/acidanthera/OpenCorePkg">OpenCorePkg</a>、 <a target="_blank" rel="noopener" href="https://github.com/acidanthera/WhateverGreen">WhateverGreen</a>、<a target="_blank" rel="noopener" href="https://github.com/acidanthera/VirtualSMC">VirtualSMC</a>、<a target="_blank" rel="noopener" href="https://github.com/acidanthera/Lilu">Lilu</a> 并替换。其中OpenCore只需要替换<code>EFI/OC/OpenCore.efi</code> 和 <code>EFI/BOOT/BOOTx64.efi</code>。</li>
</ol>
</li>
<li>顺利进入Big Sur的安装界面，升级成功🎉</li>
<li>EFI下载地址： [Big Sur Open Core 0.6.3 EFI 20201114.zip](<a target="_blank" rel="noopener" href="https://github.com/gewill/Hackintosh-Installation-with-MSI-Z390-and-i9-9900K/blob/master/Big">https://github.com/gewill/Hackintosh-Installation-with-MSI-Z390-and-i9-9900K/blob/master/Big</a> Sur Open Core 0.6.3 EFI 20201114.zip)</li>
</ol>
<p><img src="https://gewill.org/assets/Hackintosh-Big-Sur.jpg" alt="Hackintosh-Big-Sur"></p>
<h2 id="已知问题"><a href="#已知问题" class="headerlink" title="已知问题"></a>已知问题</h2><ol>
<li>USB 2.0 不可用，需USB定制。</li>
<li><del>硬件加速不可用</del>，BIOS集成显卡打开即可硬件加速。</li>
</ol>
<p><img src="https://gewill.org/assets/Hardware-Acceleration-On-Big-Sur.png" alt="Hardware-Acceleration-On-Big-Sur"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/07/27/triggers-a-runtime-error-in-swift-standard-library/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/27/triggers-a-runtime-error-in-swift-standard-library/" class="post-title-link" itemprop="url">在Swift标准库中触发运行时错误</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-07-27 22:06:26" itemprop="dateCreated datePublished" datetime="2020-07-27T22:06:26+08:00">2020-07-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-12-15 00:19:12" itemprop="dateModified" datetime="2023-12-15T00:19:12+08:00">2023-12-15</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Array-swift"><a href="#Array-swift" class="headerlink" title="Array.swift"></a>Array.swift</h1><p>Using a negative number or an index equal to or greater than <code>count</code> triggers a runtime error.</p>
<p>使用负数或大于等于<code>count</code>的索引会触发运行时错误。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(emptyDoubles[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<h1 id="ClosedRange-swift"><a href="#ClosedRange-swift" class="headerlink" title="ClosedRange.swift"></a>ClosedRange.swift</h1><p>An equivalent range must be representable as a closed range.  For example, passing an empty range as <code>other</code> triggers a runtime error,  because an empty range cannot be represented by a closed range instance.</p>
<p>等效范围必须可以表示为闭合范围。例如，将空范围作为 <code>other</code> 传递会触发运行时错误，因为空范围不能由封闭范围实例表示。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> emptyRange <span class="operator">=</span> <span class="number">0</span><span class="operator">..&lt;</span><span class="number">0</span></span><br><span class="line"><span class="type">ClosedRange</span>(emptyRange)</span><br></pre></td></tr></table></figure>

<h1 id="Dictionary-swift"><a href="#Dictionary-swift" class="headerlink" title="Dictionary.swift"></a>Dictionary.swift</h1><p>Passing a sequence with duplicate keys to this initializer results in a runtime error. If your sequence might have duplicate keys, use the <code>Dictionary(_:uniquingKeysWith:)</code> initializer instead.</p>
<p>向此构造器传递具有重复键的序列会导致运行时错误。如果序列可能有重复的键，则使用<code>Dictionary(_:uniquingKeysWith:)</code> 初始化。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> digitWords <span class="operator">=</span> [<span class="string">&quot;one&quot;</span>, <span class="string">&quot;two&quot;</span>, <span class="string">&quot;three&quot;</span>, <span class="string">&quot;four&quot;</span>, <span class="string">&quot;five&quot;</span>]</span><br><span class="line"><span class="keyword">let</span> wordToValue <span class="operator">=</span> <span class="type">Dictionary</span>(uniqueKeysWithValues: <span class="built_in">zip</span>(digitWords, <span class="number">1</span> <span class="operator">...</span> <span class="number">5</span>))</span><br><span class="line"><span class="keyword">let</span> wordToValueAndRemoveDuplicateKeys <span class="operator">=</span> <span class="type">Dictionary</span>(<span class="built_in">zip</span>([<span class="string">&quot;one&quot;</span>, <span class="string">&quot;one&quot;</span>, <span class="string">&quot;three&quot;</span>, <span class="string">&quot;four&quot;</span>, <span class="string">&quot;five&quot;</span>], <span class="number">1</span> <span class="operator">...</span> <span class="number">5</span>)) &#123; <span class="built_in">max</span>(<span class="variable">$0</span>, <span class="variable">$1</span>) &#125;</span><br></pre></td></tr></table></figure>

<h1 id="DictionaryCasting-swift"><a href="#DictionaryCasting-swift" class="headerlink" title="DictionaryCasting.swift"></a>DictionaryCasting.swift</h1><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dic: [<span class="type">String</span>: <span class="keyword">Any</span>] <span class="operator">=</span> [<span class="string">&quot;name&quot;</span>: <span class="string">&quot;li&quot;</span>, <span class="string">&quot;age&quot;</span>: <span class="number">18</span>]</span><br><span class="line">dic <span class="keyword">as!</span> [<span class="type">String</span>: <span class="type">String</span>]</span><br></pre></td></tr></table></figure>

<h1 id="Integers-swift"><a href="#Integers-swift" class="headerlink" title="Integers.swift"></a>Integers.swift</h1><p>When the additive inverse of a value is unrepresentable in a conforming type, the operation should either trap or return an exceptional value. For example, using the negation operator (prefix <code>-</code>) with <code>Int.min</code> results in a runtime error.</p>
<p>当一个值的负值在一个符合类型中不可表示时，操作应该捕获或返回一个异常值。例如，将否定运算符(前缀<code>-</code>)与 <code>Int.min</code>一起使用会导致运行时错误。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x <span class="operator">=</span> <span class="type">Int</span>.min</span><br><span class="line"><span class="keyword">let</span> y <span class="operator">=</span> <span class="operator">-</span>x</span><br><span class="line"><span class="comment">// Overflow error</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> z <span class="operator">=</span> <span class="operator">-</span><span class="type">Int8</span>.min</span><br><span class="line"><span class="comment">// Overflow error</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> y <span class="operator">=</span> <span class="type">Int8</span>.min</span><br><span class="line">y.negate()</span><br><span class="line"><span class="comment">// Overflow error</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> z <span class="operator">=</span> <span class="type">UInt32</span>(<span class="operator">-</span><span class="number">500</span>)</span><br><span class="line"><span class="comment">// Error</span></span><br></pre></td></tr></table></figure>

<h1 id="Optional-swift"><a href="#Optional-swift" class="headerlink" title="Optional.swift"></a>Optional.swift</h1><p>In debug builds (<code>-Onone</code>), the <code>unsafelyUnwrapped</code> property has the same behavior as using the postfix <code>!</code> operator and triggers a runtime error if the instance is <code>nil</code>.</p>
<p>在调试版本(<code>-Onone</code>)中，<code>unsafelyUnwrapped</code>属性的行为与使用后缀的行为相同<code>!</code>如果实例为<code> nil</code> ，则触发运行时错误。<strong>谨慎使用</strong>。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> optionalInt: <span class="type">Int</span>? <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">optionalInt.unsafelyUnwrapped</span><br><span class="line">optionalInt<span class="operator">!</span></span><br></pre></td></tr></table></figure>

<h1 id="Policy-swift"><a href="#Policy-swift" class="headerlink" title="Policy.swift"></a>Policy.swift</h1><p>If you have prior knowledge that an <code>AnyObject</code> instance has a particular type, you can use the unconditional downcast operator (<code>as!</code>). Performing an invalid cast triggers a runtime error.</p>
<p>如果您事先知道<code>AnyObject</code>实例具有特定的类型，则可以使用无条件向下转换运算符(<code>as</code>)。 执行无效强制转换会触发运行时错误。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> message <span class="operator">=</span> s <span class="keyword">as!</span> <span class="type">String</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Successful cast to String: <span class="subst">\(message)</span>&quot;</span>)</span><br><span class="line"><span class="comment">// Prints &quot;Successful cast to String: This is a bridged string.&quot;</span></span><br><span class="line"><span class="keyword">let</span> badCase <span class="operator">=</span> v <span class="keyword">as!</span> <span class="type">String</span></span><br><span class="line"><span class="comment">// Runtime error</span></span><br></pre></td></tr></table></figure>

<h1 id="Range-swift"><a href="#Range-swift" class="headerlink" title="Range.swift"></a>Range.swift</h1><p>An equivalent range must be representable as an instance of Range<Bound>. For example, passing a closed range with an upper bound of <code>Int.max</code> triggers a runtime error, because the resulting half-open range would require an upper bound of <code>Int.max + 1</code>, which is not representable as</p>
<p>范围边界值越界会触发运行时错误，如设置最大值为<code>Int.max</code>时。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Range</span>(<span class="number">0</span> <span class="operator">...</span> <span class="type">Int</span>.max)</span><br></pre></td></tr></table></figure>



<p>Always use the slice’s <code>startIndex</code> property instead of assuming that its indices start at a particular value. Attempting to access an element by using an index outside the bounds of the slice’s indices may result in a runtime error, even if that index is valid for the original collection.</p>
<p>始终使用 slice 的<code>startIndex</code>属性，而不是假设它的索引以特定的值开始。试图通过在slice索引的边界之外使用索引来访问元素可能会导致运行时错误，即使该索引对原始集合有效。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> streets <span class="operator">=</span> [<span class="string">&quot;Adams&quot;</span>, <span class="string">&quot;Bryant&quot;</span>, <span class="string">&quot;Channing&quot;</span>, <span class="string">&quot;Douglas&quot;</span>, <span class="string">&quot;Evarts&quot;</span>]</span><br><span class="line"><span class="keyword">let</span> streetsSlice <span class="operator">=</span> streets[<span class="number">2</span><span class="operator">...</span>]</span><br><span class="line"><span class="built_in">print</span>(streetsSlice)</span><br><span class="line"><span class="comment">// [&quot;Channing&quot;, &quot;Douglas&quot;, &quot;Evarts&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(streetsSlice.startIndex)</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="built_in">print</span>(streetsSlice[<span class="number">2</span>])</span><br><span class="line"><span class="comment">// &quot;Channing&quot;</span></span><br><span class="line"><span class="built_in">print</span>(streetsSlice[<span class="number">0</span>])</span><br><span class="line"><span class="comment">// error: Index out of bounds</span></span><br></pre></td></tr></table></figure>

<h1 id="RangeReplaceableCollection-swift"><a href="#RangeReplaceableCollection-swift" class="headerlink" title="RangeReplaceableCollection.swift"></a>RangeReplaceableCollection.swift</h1><p>Attempting to remove more elements than exist in the collection triggers a runtime error.</p>
<p>尝试移除集合中存在的元素数目多于存在的元素会触发运行时错误。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> array <span class="operator">=</span> <span class="type">Array</span>(<span class="number">0</span> <span class="operator">..&lt;</span> <span class="number">5</span>)</span><br><span class="line">array.removeFirst(<span class="number">6</span>)</span><br><span class="line">array.removeLast(<span class="number">6</span>)</span><br></pre></td></tr></table></figure>

<h1 id="SetCasting-swift"><a href="#SetCasting-swift" class="headerlink" title="SetCasting.swift"></a>SetCasting.swift</h1><p> We can’t just delegate to _setDownCastConditional here because we rely on  <code>as!</code> to generate nice runtime errors when the downcast fails.</p>
<p>Set 向下强制转换失败时，会产生运行时错误。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s: <span class="type">Set</span>&lt;<span class="type">AnyHashable</span>&gt; <span class="operator">=</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="string">&quot;3&quot;</span>]</span><br><span class="line">s <span class="keyword">as!</span> <span class="type">Set</span>&lt;<span class="type">Int</span>&gt;</span><br></pre></td></tr></table></figure>

<h1 id="StaticString-swift"><a href="#StaticString-swift" class="headerlink" title="StaticString.swift"></a>StaticString.swift</h1><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// * a pointer to a null-terminated sequence of UTF-8 code units:</span></span><br><span class="line"><span class="keyword">let</span> emoji: <span class="type">StaticString</span> <span class="operator">=</span> <span class="string">&quot;<span class="subst">\u&#123;1F600&#125;</span>&quot;</span></span><br><span class="line">emoji.hasPointerRepresentation <span class="comment">// -&gt; true</span></span><br><span class="line">emoji.isASCII <span class="comment">// -&gt; false</span></span><br><span class="line"><span class="comment">// emoji.unicodeScalar // -&gt; Fatal error!</span></span><br><span class="line">emoji.utf8CodeUnitCount <span class="comment">// -&gt; 4</span></span><br><span class="line">emoji.utf8Start[<span class="number">0</span>] <span class="comment">// -&gt; 0xF0</span></span><br><span class="line">emoji.utf8Start[<span class="number">1</span>] <span class="comment">// -&gt; 0x9F</span></span><br><span class="line">emoji.utf8Start[<span class="number">2</span>] <span class="comment">// -&gt; 0x98</span></span><br><span class="line">emoji.utf8Start[<span class="number">3</span>] <span class="comment">// -&gt; 0x80</span></span><br><span class="line">emoji.utf8Start[<span class="number">4</span>] <span class="comment">// -&gt; 0x00</span></span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// * a single Unicode scalar value, under very limited circumstances:</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MyStaticScalar</span>: <span class="title class_">ExpressibleByUnicodeScalarLiteral</span> &#123;</span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">UnicodeScalarLiteralType</span> <span class="operator">=</span> <span class="type">StaticString</span></span><br><span class="line">    <span class="keyword">let</span> value: <span class="type">StaticString</span></span><br><span class="line">    <span class="keyword">init</span>(<span class="params">unicodeScalarLiteral</span> <span class="params">value</span>: <span class="type">StaticString</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.value <span class="operator">=</span> value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> emoji: <span class="type">StaticString</span> <span class="operator">=</span> <span class="type">MyStaticScalar</span>(<span class="string">&quot;<span class="subst">\u&#123;1F600&#125;</span>&quot;</span>).value</span><br><span class="line">emoji.hasPointerRepresentation <span class="comment">// -&gt; false</span></span><br><span class="line">emoji.isASCII <span class="comment">// -&gt; false</span></span><br><span class="line">emoji.unicodeScalar.value <span class="comment">// -&gt; 0x1F600</span></span><br><span class="line">emoji.utf8CodeUnitCount <span class="comment">// -&gt; Fatal error!</span></span><br><span class="line">emoji.utf8Start <span class="comment">// -&gt; Fatal error!</span></span><br></pre></td></tr></table></figure>

<p><code>hasPointerRepresentation</code> 一个布尔值，表示静态字符串是否存储指向以 null 结尾的 UTF-8代码单元序列的指针。</p>
<ul>
<li>true：这时访问<code>unicodeScalar</code>会触发运行时错误；</li>
<li>false：静态字符串存储单个 Unicode 标量值。这时访问<code>utf8</code>开头的属性会触发运行时错误；</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/11/18/Data-Structures-and-Algorithms-in-Swift-Notes-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/11/18/Data-Structures-and-Algorithms-in-Swift-Notes-2/" class="post-title-link" itemprop="url">Swift数据结构和算法（二）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-11-18 14:44:13" itemprop="dateCreated datePublished" datetime="2019-11-18T14:44:13+08:00">2019-11-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="第三部分：树"><a href="#第三部分：树" class="headerlink" title="第三部分：树"></a>第三部分：树</h2><h3 id="第十章：树"><a href="#第十章：树" class="headerlink" title="第十章：树"></a>第十章：树</h3><p>树在数据结构中相当重要。它用于解决软件开发中的许多反复出现的挑战：</p>
<ul>
<li><p>表示层次关系。</p>
</li>
<li><p>管理排序的数据。</p>
</li>
<li><p>促进快速查找操作。</p>
</li>
</ul>
<p>相关术语</p>
<ul>
<li>节点（Node）</li>
<li>父子（Parent and child）</li>
<li>根（Root）</li>
<li>叶子（Leaf）</li>
</ul>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TreeNode</span>&lt;<span class="title class_">T</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> value: <span class="type">T</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> children: [<span class="type">TreeNode</span>] <span class="operator">=</span> []</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">T</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.value <span class="operator">=</span> value</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">add</span>(<span class="keyword">_</span> <span class="params">child</span>: <span class="type">TreeNode</span>) &#123;</span><br><span class="line">    children.append(child)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="遍历算法"><a href="#遍历算法" class="headerlink" title="遍历算法"></a>遍历算法</h4><p>遍历线性的集合（如：数组和链表）是非常直接的。因为有直接的首尾。</p>
<p>但是遍历树就复杂了。是左边优先，还是深度优先，要看具体解决的问题。</p>
<h5 id="深度优先遍历（Depth-ﬁrst-traversal）"><a href="#深度优先遍历（Depth-ﬁrst-traversal）" class="headerlink" title="深度优先遍历（Depth-ﬁrst traversal）"></a>深度优先遍历（Depth-ﬁrst traversal）</h5><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">TreeNode</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">forEachDepthFirst</span>(<span class="params">visit</span>: (<span class="type">TreeNode</span>) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">    visit(<span class="keyword">self</span>)</span><br><span class="line">    children.forEach &#123;</span><br><span class="line">      <span class="variable">$0</span>.forEachDepthFirst(visit: visit)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="层级优先遍历（Level-order-traversal）"><a href="#层级优先遍历（Level-order-traversal）" class="headerlink" title="层级优先遍历（Level-order traversal）"></a>层级优先遍历（Level-order traversal）</h5><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">TreeNode</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">forEachLevelOrder</span>(<span class="params">visit</span>: (<span class="type">TreeNode</span>) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">    visit(<span class="keyword">self</span>)</span><br><span class="line">    <span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">Queue</span>&lt;<span class="type">TreeNode</span>&gt;()</span><br><span class="line">    children.forEach &#123; queue.enqueue(<span class="variable">$0</span>) &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> node <span class="operator">=</span> queue.dequeue() &#123;</span><br><span class="line">      visit(node)</span><br><span class="line">      node.children.forEach &#123; queue.enqueue(<span class="variable">$0</span>) &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h5><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">TreeNode</span> <span class="title class_">where</span> <span class="title class_">T</span>: <span class="title class_">Equatable</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">search</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">T</span>) -&gt; <span class="type">TreeNode</span>? &#123;</span><br><span class="line">    <span class="keyword">var</span> result: <span class="type">TreeNode</span>?</span><br><span class="line">    forEachDepthFirst &#123; node <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">if</span> node.value <span class="operator">==</span> value &#123;</span><br><span class="line">        result <span class="operator">=</span> node</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ol>
<li>树与链接列表具有一些相似之处，但是，链接列表节点只能链接到另一个节点，而树节点可以链接到无限多个节点。</li>
<li>熟悉树的术语，例如父，子，叶子和根。 这些术语中有许多是其他程序员常用的语言，将用于帮助解释其他树形结构。</li>
<li>遍历（例如深度优先遍历和层级遍历）不是特定于常规树的。 它们也可以在其他树上工作，尽管根据树的结构，它们的实现会略有不同。</li>
</ol>
<h3 id="第十一章：树挑战"><a href="#第十一章：树挑战" class="headerlink" title="第十一章：树挑战"></a>第十一章：树挑战</h3><p>打印所有的值，按照他们层级的顺序。同意层级应该打印在一行</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">15 </span><br><span class="line">1 17 20</span><br><span class="line">1 5 0 2 5 7</span><br></pre></td></tr></table></figure>

<p>实现：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">printEachLevel</span>&lt;<span class="type">T</span>&gt;(<span class="params">for</span> <span class="params">tree</span>: <span class="type">TreeNode</span>&lt;<span class="type">T</span>&gt;) &#123;</span><br><span class="line">    <span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">Queue</span>&lt;<span class="type">TreeNode</span>&lt;<span class="type">T</span>&gt;&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// 加入每层的节点计数，当打印完时，换行</span></span><br><span class="line">    <span class="keyword">var</span> nodesLeftInCurrentLevel <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    queue.enqueue(tree)</span><br><span class="line">    <span class="keyword">while</span> <span class="operator">!</span>queue.isEmpty &#123;</span><br><span class="line">        nodesLeftInCurrentLevel <span class="operator">=</span> queue.count</span><br><span class="line">        <span class="keyword">while</span> nodesLeftInCurrentLevel <span class="operator">&gt;</span> <span class="number">0</span> &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> node <span class="operator">=</span> queue.dequeue() <span class="keyword">else</span> &#123; <span class="keyword">break</span> &#125;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;<span class="subst">\(node.value)</span> &quot;</span>, terminator: <span class="string">&quot;&quot;</span>)</span><br><span class="line">            node.children.forEach &#123; queue.enqueue(<span class="variable">$0</span>) &#125;</span><br><span class="line">            nodesLeftInCurrentLevel <span class="operator">-=</span> <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/08/05/Server-Side-Swift-with-Kitura-Notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/08/05/Server-Side-Swift-with-Kitura-Notes/" class="post-title-link" itemprop="url">Kitura Swift后端开发-笔记</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-08-05 15:49:35" itemprop="dateCreated datePublished" datetime="2019-08-05T15:49:35+08:00">2019-08-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="第一章：引言"><a href="#第一章：引言" class="headerlink" title="第一章：引言"></a>第一章：引言</h2><p><strong>Kitura是什么？</strong></p>
<p>在词源学上，Kitura这个词松散地源于希伯来语Keturah，字面意思是“香”。</p>
<p><strong>为什么选择Swift写后端？</strong></p>
<p>支持为服务器编写Swift的核心论点是在应用程序的前端和后端之间共享代码和知识。如果你是一个团队，这种精简可以说是更加关键和赋权。这包括但不限于模型对象代码。</p>
<p>BFF（Backonnd for Frontend）是一种设计模式，很快就会成为你最好的朋友（永远？）。</p>
<p>这个模式在这个特定用例中起作用的几个原因：</p>
<ol>
<li><p>你可以确定从此API发出请求的唯一设备将是iOS设备。这意味着你可以更少担心平衡请求负载。</p>
</li>
<li><p>你可以更好地控制对iOS设备的响应中的数据。在此之前，你可能已经等待后端开发人员最终帮助你，并根据User-Agent首部有条件地修剪响应数据。现在，你可以让后端开发人员不间断地工作，并通过将响应数据解析为你的BFF设备所需的内容来解决你的问题。</p>
</li>
<li><p>在我们的特定用例中，你可以在发送响应之前保存一个用户可能对数据库进行的查询的响应。这意味着，如果其他人在相同的位置请求餐馆信息（例子是请求包含地理位置的餐馆信息），并且存储的数据足够新以满足你的刷新策略，你甚至不必向主服务器发送查询！你只需发送缓存的数据，并相信它对你的用户来说足够新。</p>
</li>
<li><p>你可以使用你已经知道如何在Swift中编写代码的语言完成1-3！</p>
</li>
</ol>
<h2 id="第二章：Hello-World"><a href="#第二章：Hello-World" class="headerlink" title="第二章：Hello, World!"></a>第二章：Hello, World!</h2><p>如何Kitura项目</p>
<p>先安装Kitura macOS App和Kitura CLI</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew tap ibm-swift/kitura</span><br><span class="line">brew install kitura</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">kitura</span><br><span class="line">Usage: kitura [options] [command]</span><br><span class="line"></span><br><span class="line">Kitura command-line interface</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -V, --version  output the version number</span><br><span class="line">  -h, --help     output usage information</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  build          build the project in a local container</span><br><span class="line">  create         interactively create a Kitura project</span><br><span class="line">  idt            install IBM Cloud Developer Tools</span><br><span class="line">  init           scaffold a bare-bones Kitura project</span><br><span class="line">  kit            print Cocoapods boilerplate for KituraKit</span><br><span class="line">  run            run the project in a local container</span><br><span class="line">  sdk            generate a client SDK from an OpenAPI/Swagger spec</span><br><span class="line">  help [cmd]     display help for [cmd]</span><br></pre></td></tr></table></figure>



<p>创建的Kitura项目提供了一个开箱即用的全功能Kitura应用程序。 它提供了在生产环境中运行的任何应用程序可能需要的一些功能，包括：</p>
<ul>
<li><p>使用HeliumLogger记录信息，警告和错误消息。</p>
</li>
<li><p>使用CloudEnvironment进行动态配置查找和设置。</p>
</li>
<li><p>使用Health查看和报告应用程序健康状况。</p>
</li>
<li><p>使用SwiftMetrics进行App和Kitura框架指标和监控。</p>
</li>
</ul>
<p>项目使用SPM管理依赖</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// swift-tools-version:4.0</span></span><br><span class="line"><span class="keyword">import</span> PackageDescription</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> package <span class="operator">=</span> <span class="type">Package</span>(</span><br><span class="line">    name: <span class="string">&quot;EmojiJournalServer&quot;</span>,</span><br><span class="line">    dependencies: [</span><br><span class="line">      .package(url: <span class="string">&quot;https://github.com/IBM-Swift/Kitura.git&quot;</span>, .upToNextMinor(from: <span class="string">&quot;2.5.0&quot;</span>)),</span><br><span class="line">      .package(url: <span class="string">&quot;https://github.com/IBM-Swift/HeliumLogger.git&quot;</span>, from: <span class="string">&quot;1.7.1&quot;</span>),</span><br><span class="line">      .package(url: <span class="string">&quot;https://github.com/IBM-Swift/CloudEnvironment.git&quot;</span>, from: <span class="string">&quot;9.0.0&quot;</span>),</span><br><span class="line">      .package(url: <span class="string">&quot;https://github.com/RuntimeTools/SwiftMetrics.git&quot;</span>, from: <span class="string">&quot;2.0.0&quot;</span>),</span><br><span class="line">      .package(url: <span class="string">&quot;https://github.com/IBM-Swift/Health.git&quot;</span>, from: <span class="string">&quot;1.0.0&quot;</span>),</span><br><span class="line">    ],</span><br><span class="line">    targets: [</span><br><span class="line">      .target(name: <span class="string">&quot;EmojiJournalServer&quot;</span>, dependencies: [ .target(name: <span class="string">&quot;Application&quot;</span>), <span class="string">&quot;Kitura&quot;</span> , <span class="string">&quot;HeliumLogger&quot;</span>]),</span><br><span class="line">      .target(name: <span class="string">&quot;Application&quot;</span>, dependencies: [ <span class="string">&quot;Kitura&quot;</span>, <span class="string">&quot;CloudEnvironment&quot;</span>,<span class="string">&quot;SwiftMetrics&quot;</span>,<span class="string">&quot;Health&quot;</span>,      ]),</span><br><span class="line"></span><br><span class="line">      .testTarget(name: <span class="string">&quot;ApplicationTests&quot;</span> , dependencies: [.target(name: <span class="string">&quot;Application&quot;</span>), <span class="string">&quot;Kitura&quot;</span>,<span class="string">&quot;HeliumLogger&quot;</span> ])</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Application.swift包含应用程序的生命周期处理，提供emojiJournalServer目标中main.swift使用的核心<code>init()</code>和<code>run()</code>方法来启动应用程序。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> Kitura</span><br><span class="line"><span class="keyword">import</span> LoggerAPI</span><br><span class="line"><span class="keyword">import</span> Configuration</span><br><span class="line"><span class="keyword">import</span> CloudEnvironment</span><br><span class="line"><span class="keyword">import</span> KituraContracts</span><br><span class="line"><span class="keyword">import</span> Health</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">let</span> projectPath <span class="operator">=</span> <span class="type">ConfigurationManager</span>.<span class="type">BasePath</span>.project.path</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">let</span> health <span class="operator">=</span> <span class="type">Health</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> router <span class="operator">=</span> <span class="type">Router</span>()</span><br><span class="line">  <span class="keyword">let</span> cloudEnv <span class="operator">=</span> <span class="type">CloudEnv</span>()</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() <span class="keyword">throws</span> &#123;</span><br><span class="line">    <span class="comment">// Run the metrics initializer</span></span><br><span class="line">    initializeMetrics(router: router)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">postInit</span>() <span class="keyword">throws</span> &#123;</span><br><span class="line">    <span class="comment">// Endpoints</span></span><br><span class="line">    initializeHealthRoutes(app: <span class="keyword">self</span>)</span><br><span class="line">    router.get(<span class="string">&quot;/&quot;</span>, handler: helloWorldHandler)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">helloWorldHandler</span>(<span class="params">request</span>: <span class="type">RouterRequest</span>, <span class="params">response</span>: <span class="type">RouterResponse</span>, <span class="params">next</span>: ()-&gt;()) &#123;</span><br><span class="line">    response.send(<span class="string">&quot;Hello, World!&quot;</span>)</span><br><span class="line">    next()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">run</span>() <span class="keyword">throws</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> postInit()</span><br><span class="line">    <span class="type">Kitura</span>.addHTTPServer(onPort: cloudEnv.port, with: router)</span><br><span class="line">    <span class="type">Kitura</span>.run()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行后</p>
<p>欢迎页：<a target="_blank" rel="noopener" href="http://localhost:8090/">http://localhost:8090</a></p>
<p>健康：<a target="_blank" rel="noopener" href="http://localhost:8090/health">http://localhost:8090/health</a></p>
<p>监控仪表板：<a target="_blank" rel="noopener" href="http://localhost:8090/swiftmetrics-dash">http://localhost:8090/swiftmetrics-dash</a></p>
<p>HTTP吞吐量视图使用每秒请求（RPS）度量标准显示在任何时间点发生的请求量。</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8090/metrics">http://localhost:8090/metrics</a></p>
<p><strong>使用Docker在Linux上运行应用程序</strong></p>
<p>Docker和Kubernetes是Kitura部署的核心，它们提供了重要的性能和扩展优势。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kitura build</span><br><span class="line">kitura run</span><br></pre></td></tr></table></figure>

<h2 id="第三章：RESTful-APIs"><a href="#第三章：RESTful-APIs" class="headerlink" title="第三章：RESTful APIs"></a>第三章：RESTful APIs</h2><p>在开始构建这些RESTful API之前，将了解RESTful API本身，包括它们的架构方法和设计原则。</p>
<h3 id="REpresentational-State-Transfer-REST"><a href="#REpresentational-State-Transfer-REST" class="headerlink" title="REpresentational State Transfer (REST)"></a>REpresentational State Transfer (REST)</h3><p>REpresentational State Transfer（REST）是一种架构风格或设计模式的API。 如果一个API符合Roy Fielding博士在他的2000年论文“架构风格和基于网络的软件架构设计”中提出的一系列约束，那么它就是RESTful。</p>
<h4 id="Fielding提出了以下六个限制："><a href="#Fielding提出了以下六个限制：" class="headerlink" title="Fielding提出了以下六个限制："></a>Fielding提出了以下六个限制：</h4><ol>
<li>客户端 - 服务器</li>
</ol>
<p>RESTful API在客户端和服务器之间提供明确的分离，允许客户端和服务器彼此独立地开发。这种分离使得为同一服务器实现多个客户端成为可能，就像你为EmojiJournal创建iOS和Web应用程序客户端时所做的那样。</p>
<ol start="2">
<li>无状态</li>
</ol>
<p>RESTful API应该是无状态的。每个请求都应该是自包含的，并且不应该依赖于存储在服务器上的先前请求的任何会话上下文。</p>
<ol start="3">
<li>可缓存</li>
</ol>
<p>由于RESTful API是无状态和自包含的，因此可以将请求的结果缓存到RESTful API。这可以由客户端或诸如web代理之类的中介来完成。</p>
<p>设计良好的RESTful API应该鼓励尽可能存储可缓存的数据，对请求的响应被隐式或显式标记为可缓存，可缓存到特定时间（expires-at）或不可缓存。</p>
<ol start="4">
<li>分层系统</li>
</ol>
<p>RESTful API可以是分层的，因此客户端不知道它是直接连接到API本身还是通过代理或负载均衡器间接连接。另外，API本身可以由服务器系统本身内的若干层或源组成和构建。</p>
<ol start="5">
<li>按需代码（可选）</li>
</ol>
<p>RESTful API可以提供可以直接在客户端上运行的功能。实际上，这通常仅限于在浏览器中运行的JavaScript或Java Applet。</p>
<ol start="6">
<li>统一界面</li>
</ol>
<p>RESTful API最重要的概念之一是资源的使用。资源可以是API可以提供有关信息的任何对象，例如你将使用的JournalEntry资源。</p>
<h4 id="提供统一接口的RESTful-API必须满足以下四个约束："><a href="#提供统一接口的RESTful-API必须满足以下四个约束：" class="headerlink" title="提供统一接口的RESTful API必须满足以下四个约束："></a>提供统一接口的RESTful API必须满足以下四个约束：</h4><ul>
<li>请求必须确定他们采取行动的资源。 </li>
<li>请求和响应必须使用资源的表示。 </li>
<li>消息必须是自描述的，自包含的，并且只能使用标准操作。</li>
<li>资源必须通过链接连接到其他资源。</li>
</ul>
<p>另请注意，没有提及HTTP和Web请求。虽然RESTful API最常使用HTTP实现，但这不是必需的。也就是说，我们将仅介绍如何使用标准HTTP操作构建RESTful API，我们接下来将简要介绍HTTP本身。</p>
<h3 id="HyperText-Transfer-Protocol-HTTP"><a href="#HyperText-Transfer-Protocol-HTTP" class="headerlink" title="HyperText Transfer Protocol (HTTP)"></a>HyperText Transfer Protocol (HTTP)</h3><p>超文本传输协议（HTTP）是一种客户端 - 服务器，基于请求 - 响应的协议，是网站和基于Web的流量的基础。 因此，它受到客户端和服务器的普遍支持。</p>
<h3 id="HTTP-based-RESTful-APIs"><a href="#HTTP-based-RESTful-APIs" class="headerlink" title="HTTP-based RESTful APIs"></a>HTTP-based RESTful APIs</h3><h4 id="URL作为资源"><a href="#URL作为资源" class="headerlink" title="URL作为资源"></a>URL作为资源</h4><p>统一接口的第一个要求是请求标识它们所依赖的资源。在HTTP中，这是通过RESTful API使用请求的URL实现的。</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/entries</span><br></pre></td></tr></table></figure>

<h4 id="特定资源的URL编码标识符"><a href="#特定资源的URL编码标识符" class="headerlink" title="特定资源的URL编码标识符"></a>特定资源的URL编码标识符</h4><p>将提供这些URL以使客户端能够与所有日记帐分录和特定日记帐分录进行交互：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/entries </span><br><span class="line">/entries/&lt;identifier&gt;</span><br></pre></td></tr></table></figure>

<h4 id="用于资源组的URL编码查询参数"><a href="#用于资源组的URL编码查询参数" class="headerlink" title="用于资源组的URL编码查询参数"></a>用于资源组的URL编码查询参数</h4><p>你可能还希望提供与资源子集的API。 这再次通过URL完成，这次使用URL查询参数。</p>
<p>URL查询参数以<code>?</code>开头。 他们可以使用<code>&lt;key&gt; = &lt;value&gt;</code>格式的键值对传递有关资源的任何其他信息。 可以使用键值对之间的<code>＆</code>分隔符聚合和传递多个键值对。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/entries </span><br><span class="line">/entries?emoji=&lt;emoji&gt;&amp;date=&lt;date&gt; </span><br><span class="line">/entries/&lt;idenfifier&gt;</span><br></pre></td></tr></table></figure>

<h4 id="分层API的分层URL"><a href="#分层API的分层URL" class="headerlink" title="分层API的分层URL"></a>分层API的分层URL</h4><p>RESTful URL也可以是分层的。 在你的EmojiJournal应用程序中，你只会支持拥有单个EmojiJournal的用户。 但是，假设你希望支持拥有多个期刊的用户，每个期刊都有自己的日记帐分录。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/journals </span><br><span class="line">/journals/&lt;identifier&gt; </span><br><span class="line">/journals/&lt;identifier&gt;/entries </span><br><span class="line">/journals/&lt;identifier&gt;/entries?emoji=&lt;emoji&gt;&amp;date=&lt;date&gt; /journals/&lt;identifier&gt;/entries/&lt;identifier&gt;</span><br></pre></td></tr></table></figure>

<p>例如，对以下URL的客户端请求将与日记2中的条目20进行交互：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/journals/2/entries/20</span><br></pre></td></tr></table></figure>

<h4 id="资源表示"><a href="#资源表示" class="headerlink" title="资源表示"></a>资源表示</h4><p>回想一下，统一接口的第二个概念是请求和响应应该使用资源的表示。 这是通过在HTTP正文数据中编码资源的表示，在基于HTTP的RESTful API中实现的。</p>
<p>HTTP消息，无论是请求还是响应，基本上由两部分组成：一组标题和正文数据。 为了完整性，响应还包含一个状态代码，用于报告请求的状态。</p>
<h4 id="HTTP首部和正文数据"><a href="#HTTP首部和正文数据" class="headerlink" title="HTTP首部和正文数据"></a>HTTP首部和正文数据</h4><p>HTTP首部为请求和响应提供了额外的元数据。 首部在请求或响应开始时传输，并存储为键值对，一些首部允许多个值。</p>
<p>你可以使用HTTP首部存储你希望的任何其他信息。 你应该了解两个正式定义的标准标题，请参阅<a target="_blank" rel="noopener" href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html">https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html</a>（由正式的核心RFC规范定义），以及不太正式但广泛使用的非标准的首部，请参阅<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Common_non-standard_request_fields">https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Common_non-standard_request_fields</a>。</p>
<p>标准头用于传递诸如Cookie，授权，ContentType（描述正文数据的媒体类型）和Content-Length（以字节为单位描述正文数据长度）等信息。</p>
<p>HTTP消息正文包含与请求或响应关联的数据。 在响应对网页的请求的情况下，正文数据包含网页本身的来源。 看一下对Hello，World的请求生成的HTTP响应！ 你在上一章中创建的应用程序。</p>
<h4 id="正文数据中的资源表示"><a href="#正文数据中的资源表示" class="headerlink" title="正文数据中的资源表示"></a>正文数据中的资源表示</h4><p>如前所述，RESTful API对返回的HTTP正文数据中的资源表示进行编码。 身体通常由三部分组成：</p>
<ol>
<li>Content-Type首部</li>
</ol>
<p>Content-Type首部表示用于表示正文数据中的资源的编码。最常用的方法是使用JavaScript Object Notation（JSON）对表示进行编码，并将Content-Type首部设置为<code>application/json</code>。有时与RESTful API一起使用的身体数据编码的其他示例包括Protobuf，Thrift和Avro。</p>
<ol start="2">
<li>接受首部（仅限请求）</li>
</ol>
<p>接受首部指示客户端将接受响应的编码。这通常是<code>application/json</code>，但它也可以包含编码列表。例如，如果客户端在JSON和Protobuf中都接受了响应，则此值可能设置为：<code>application/json;application/protobuf</code>。</p>
<ol start="3">
<li>编码的正文数据</li>
</ol>
<p>最后，使用Content-Type首部中设置的编码将资源本身编码为正文数据。在最常见的<code>application/json</code>场景中，这是资源的JSON表示。 JSON的细节取决于特定资源的模型。例如，在本书后面稍后，JournalEntry的资源将包含id，emoji和date，类似于：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">	<span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="string">&quot;1&quot;</span><span class="punctuation">,</span> </span><br><span class="line">	<span class="attr">&quot;emoji&quot;</span><span class="punctuation">:</span><span class="string">&quot;😊 &quot;</span><span class="punctuation">,</span> </span><br><span class="line">	<span class="attr">&quot;date&quot;</span><span class="punctuation">:</span><span class="string">&quot;2018-09-18T00:07:01Z&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="自我描述性的信息"><a href="#自我描述性的信息" class="headerlink" title="自我描述性的信息"></a>自我描述性的信息</h4><p>你已经了解了资源的识别和表示，但你如何对这些资源进行操作？</p>
<p>统一接口的第三个原则解决了这个问题。 它规定请求和响应都应该是自描述的，并且它们仅使用客户端和服务器都理解的标准操作。 在基于HTML的RESTful API中，这是通过使用特定的HTTP方法实现的。</p>
<p>RFC 2616概述了八种HTTP方法：OPTIONS，GET，HEAD，POST，PUT，DELETE，TRACE和CONNECT。</p>
<h4 id="通过链接连接资源"><a href="#通过链接连接资源" class="headerlink" title="通过链接连接资源"></a>通过链接连接资源</h4><p>统一接口的第四个也是最后一个概念是资源应该通过链接连接到其他资源。</p>
<p>如你所见，基于HTTP的RESTful API使用URL和基于URL的标识符来提供对资源的访问并指定单个资源。 因此，资源之间的链接只是进一步的RESTful URL和链接到连接资源的基于URL的标识符。</p>
<p>有两种常见的场景需要URL或标识资源：</p>
<ul>
<li>请求的资源引用另一个（子或相关）资源。</li>
<li>你需要知道资源的标识符。</li>
</ul>
<h3 id="构建RESTful-API"><a href="#构建RESTful-API" class="headerlink" title="构建RESTful API"></a>构建RESTful API</h3><p><img src="/../assets/image-20190806103823282.png" alt="image-20190806103823282"></p>
<p>到目前为止，你已经学会了所有基础知识。 当你了解有关设计和实现RESTful API的更多信息时，你会发现除了我们在此处介绍的范围之外还有其他最佳实践。 这包括设置正确的Content-Type和Accepts标头，为成功创建设置Location标头，并为请求中的任何故障设置正确的HTTP状态代码。</p>
<p>此外，需要对请求和响应主体进行编码和解码，最常见的是来自JSON。 这曾经是一项艰巨的任务。 由于强大的Codable协议，Swift使JSON优雅且无痛。</p>
<h2 id="第四章：Codable简介"><a href="#第四章：Codable简介" class="headerlink" title="第四章：Codable简介"></a>第四章：Codable简介</h2><p>Codable协议是Swift编程语言最强大的功能之一。 在一个句子中，当你扩展对象以符合Codable时，你可以使该对象自动序列化为任何外部可读格式，例如JSON，XML或协议缓冲区。</p>
<h3 id="The-bare-necessities"><a href="#The-bare-necessities" class="headerlink" title="The bare necessities"></a>The bare necessities</h3><p>直接看一个例子</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1 Cadabe 是一个组合的协议：Decodable &amp; Encodable</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">Song</span>: <span class="title class_">Codable</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> title: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> length: <span class="type">Int</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">enum</span> <span class="title class_">CodingKeys</span>: <span class="title class_">String</span>, <span class="title class_">CodingKey</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> title <span class="operator">=</span> <span class="string">&quot;songTitle&quot;</span></span><br><span class="line">    <span class="keyword">case</span> length <span class="operator">=</span> <span class="string">&quot;songLength&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">Animal</span>: <span class="title class_">Codable</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> age: <span class="type">Int</span>?</span><br><span class="line">  <span class="keyword">var</span> isFriendly: <span class="type">Bool</span></span><br><span class="line">  <span class="keyword">var</span> birthday: <span class="type">Date</span></span><br><span class="line">  <span class="keyword">var</span> songs: [<span class="type">Song</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2 嵌套</span></span><br><span class="line"><span class="keyword">let</span> baloo <span class="operator">=</span> <span class="type">Animal</span>(name: <span class="string">&quot;Baloo&quot;</span>,</span><br><span class="line">                   age: <span class="number">5</span>,</span><br><span class="line">                   isFriendly: <span class="literal">true</span>,</span><br><span class="line">                   birthday: <span class="type">Date</span>(),</span><br><span class="line">                   songs: [<span class="type">Song</span>(title: <span class="string">&quot;The Bare Necessities&quot;</span>, length: <span class="number">180</span>)])</span><br><span class="line"><span class="keyword">let</span> bagheera <span class="operator">=</span> <span class="type">Animal</span>(name: <span class="string">&quot;Bagheera&quot;</span>,</span><br><span class="line">                      age: <span class="literal">nil</span>,</span><br><span class="line">                      isFriendly: <span class="literal">true</span>,</span><br><span class="line">                      birthday: <span class="type">Date</span>(),</span><br><span class="line">                      songs: [<span class="type">Song</span>(title: <span class="string">&quot;Jungle&#x27;s No Place For A Boy&quot;</span>, length: <span class="number">95</span>)])</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3 处理日期格式，驼峰式与蛇式转换</span></span><br><span class="line"><span class="keyword">let</span> encoder <span class="operator">=</span> <span class="type">JSONEncoder</span>()</span><br><span class="line">encoder.keyEncodingStrategy <span class="operator">=</span> .convertToSnakeCase</span><br><span class="line">encoder.dateEncodingStrategy <span class="operator">=</span> .iso8601</span><br><span class="line"><span class="keyword">let</span> decoder <span class="operator">=</span> <span class="type">JSONDecoder</span>()</span><br><span class="line">decoder.keyDecodingStrategy <span class="operator">=</span> .convertFromSnakeCase</span><br><span class="line">decoder.dateDecodingStrategy <span class="operator">=</span> .iso8601</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="comment">// 4</span></span><br><span class="line">  <span class="keyword">let</span> encodedBaloo <span class="operator">=</span> <span class="keyword">try</span> encoder.encode(baloo)</span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">let</span> balooString <span class="operator">=</span> <span class="type">String</span>(data: encodedBaloo, encoding: .utf8) &#123;</span><br><span class="line">    <span class="built_in">print</span>(balooString)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> encodedBagheera <span class="operator">=</span> <span class="keyword">try</span> encoder.encode(bagheera)</span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">let</span> bagheeraString <span class="operator">=</span> <span class="type">String</span>(data: encodedBagheera, encoding: .utf8) &#123;</span><br><span class="line">    <span class="built_in">print</span>(bagheeraString)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 5</span></span><br><span class="line">  <span class="keyword">let</span> decodedBaloo <span class="operator">=</span> <span class="keyword">try</span> decoder.decode(<span class="type">Animal</span>.<span class="keyword">self</span>, from: encodedBaloo)</span><br><span class="line">  <span class="built_in">print</span>(decodedBaloo)</span><br><span class="line">  <span class="keyword">let</span> decodedBagheera <span class="operator">=</span> <span class="keyword">try</span> decoder.decode(<span class="type">Animal</span>.<span class="keyword">self</span>, from: encodedBagheera)</span><br><span class="line">  <span class="built_in">print</span>(decodedBagheera)</span><br><span class="line">&#125; <span class="keyword">catch</span> <span class="keyword">let</span> error &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Error occurred: <span class="subst">\(error.localizedDescription)</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="第五章：Codable-Routing"><a href="#第五章：Codable-Routing" class="headerlink" title="第五章：Codable Routing"></a>第五章：Codable Routing</h2><p>Codable Routing支持以完全类型安全的方式在你的应用程序的结构和类以及HTTP请求和响应中使用的正文数据之间自动转换。 它大大减少了构建路由处理程序时需要编写的代码，并使Kitura能够代表你执行数据验证和错误处理。</p>
<p>看Model和Route的实现：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">JournalEntry</span>: <span class="title class_">Codable</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> id: <span class="type">String</span>?</span><br><span class="line">  <span class="keyword">var</span> emoji: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> date: <span class="type">Date</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> LoggerAPI</span><br><span class="line"><span class="keyword">import</span> Kitura</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> entries: [<span class="type">JournalEntry</span>] <span class="operator">=</span> []</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">initializeEntryRoutes</span>(<span class="params">app</span>: <span class="type">App</span>) &#123;</span><br><span class="line">  app.router.get(<span class="string">&quot;/entries&quot;</span>, handler: getAllEntries)</span><br><span class="line">  app.router.post(<span class="string">&quot;/entries&quot;</span>, handler: addEntry)</span><br><span class="line">  app.router.delete(<span class="string">&quot;/entries&quot;</span>, handler: deleteEntry)</span><br><span class="line">  <span class="type">Log</span>.info(<span class="string">&quot;Journal entry routes created&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">addEntry</span>(<span class="params">entry</span>: <span class="type">JournalEntry</span>, <span class="params">completion</span>: <span class="keyword">@escaping</span> (<span class="type">JournalEntry</span>?, <span class="type">RequestError</span>?) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> storedEntry <span class="operator">=</span> entry</span><br><span class="line">  storedEntry.id <span class="operator">=</span> entries.count.value</span><br><span class="line">  entries.append(storedEntry)</span><br><span class="line">  completion(storedEntry, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">getAllEntries</span>(<span class="params">completion</span>: <span class="keyword">@escaping</span> ([<span class="type">JournalEntry</span>]<span class="operator">?</span>, <span class="type">RequestError</span>?) -&gt; <span class="type">Void</span>) -&gt; <span class="type">Void</span> &#123;</span><br><span class="line">  completion(entries, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">deleteEntry</span>(<span class="params">id</span>: <span class="type">String</span>, <span class="params">completion</span>: <span class="keyword">@escaping</span> (<span class="type">RequestError</span>?) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">  <span class="keyword">guard</span> <span class="keyword">let</span> index <span class="operator">=</span> entries.index(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> id &#125;) <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> completion(.notFound)</span><br><span class="line">  &#125;</span><br><span class="line">  entries.remove(at: index)</span><br><span class="line">  completion(<span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Codable Routing的一个独特功能是它只需要你在处理函数中定义你希望从请求中接收的值，以及你将通过完成处理程序添加到响应中的值。</p>
<blockquote>
<p>目前，Kitura仅支持从<code>application/json</code>解码。 这意味着，实际上，Content-Type当前必须始终设置为<code>application/json</code>。 但是，Kitura团队计划在即将发布的版本中支持其他编码类型。</p>
</blockquote>
<h2 id="第六章：OpenAPI规范"><a href="#第六章：OpenAPI规范" class="headerlink" title="第六章：OpenAPI规范"></a>第六章：OpenAPI规范</h2><h3 id="Swagger的目标"><a href="#Swagger的目标" class="headerlink" title="Swagger的目标"></a>Swagger的目标</h3><p>在Tony Tam开创性的开源项目的基础上，其他公司开始做出贡献。 最终，Linux基金会承担了该项目的赞助，并将其名称更改为OpenAPI Initiative。 这种广泛的支持使OpenAPI规范在开源软件开发中占据了非常突出的位置。</p>
<p>当Tony开始研究Swagger API项目时，他确定了三个关键目标：</p>
<ul>
<li>API开发</li>
<li>API文档</li>
<li>API交互</li>
</ul>
<h3 id="生成你的规格"><a href="#生成你的规格" class="headerlink" title="生成你的规格"></a>生成你的规格</h3><p>通过添加<code>Kitura-OpenAPI</code>依赖</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.package(url: <span class="string">&quot;https://github.com/IBM-Swift/Kitura-OpenAPI.git&quot;</span>, from: <span class="string">&quot;1.1.1&quot;</span>),</span><br></pre></td></tr></table></figure>

<p> 运行后</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8080/openapi">http://localhost:8080/openapi</a></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;schemes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;http&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;swagger&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;info&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;title&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Kitura Project&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Generated by Kitura&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;paths&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;\/entries&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;get&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;responses&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;200&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;schema&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;type&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;array&quot;</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;items&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;$ref&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;#\/definitions\/JournalEntry&quot;</span></span><br><span class="line">              <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;successful response&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;consumes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;produces&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;post&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;consumes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;produces&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;responses&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;200&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;schema&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;$ref&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;#\/definitions\/JournalEntry&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;successful response&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;parameters&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;in&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;body&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;input&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;required&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;schema&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;$ref&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;#\/definitions\/JournalEntry&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;\/health&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;get&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;responses&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;200&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;schema&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;$ref&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;#\/definitions\/Status&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;successful response&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;consumes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;produces&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;\/entries\/&#123;id&#125;&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;delete&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;consumes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;produces&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;responses&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;200&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;successful response&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;parameters&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;in&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;path&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;id&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;required&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;basePath&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;\/&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;definitions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;JournalEntry&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;object&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;required&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;date&quot;</span><span class="punctuation">,</span><span class="string">&quot;emoji&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;emoji&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;number&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Status&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;object&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;required&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;status&quot;</span><span class="punctuation">,</span><span class="string">&quot;details&quot;</span><span class="punctuation">,</span><span class="string">&quot;timestamp&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;details&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;items&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;array&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;timestamp&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>此代码段的顶部表示你正在查看路径<code>/entries</code>的GET路由。 三个子节点描述了这条路线：</p>
<ul>
<li><p>“responses”提供用户可以接收的一系列响应。</p>
</li>
<li><p>“consumes”指定必须给出此方法的数据类型。</p>
</li>
<li><p>“produces”描述响应将包含的数据类型。</p>
</li>
</ul>
<h3 id="使用Kitura-OpenAPI-UI"><a href="#使用Kitura-OpenAPI-UI" class="headerlink" title="使用Kitura OpenAPI UI"></a>使用Kitura OpenAPI UI</h3><p>同步生成的还有UI调试界面</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8080/openapi/ui">http://localhost:8080/openapi/ui</a></p>
<p><img src="https://gewill.org/assets/image-20190807140446505.png" alt="image-20190807140446505"></p>
<p>这对于你需要进行快速而肮脏的测试的情况非常有用 - 或者如果你无法让顽固的队友相信这个模块真的有用！</p>
<h3 id="为你的iOS应用生成SDK"><a href="#为你的iOS应用生成SDK" class="headerlink" title="为你的iOS应用生成SDK"></a>为你的iOS应用生成SDK</h3><p>终端运行，即可生成SDK，一个功能齐全的Swift SDK，可以处理与此特定服务器的所有网络通信。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker pull swaggerapi/swagger-codegen-cli</span><br><span class="line">docker run --<span class="built_in">rm</span> -v <span class="variable">$&#123;PWD&#125;</span>:/local swaggerapi/swagger-codegen-cli langs</span><br><span class="line"><span class="built_in">mkdir</span> GeneratedSDK </span><br><span class="line"><span class="built_in">touch</span> specification.json </span><br><span class="line">//  复制http://localhost:8080/openapi的内容到specification.json</span><br><span class="line">docker run --<span class="built_in">rm</span> -v <span class="variable">$&#123;PWD&#125;</span>:/local swaggerapi/swagger-codegen-cli generate -i /local/specification.json -l swift -o /local/GeneratedSDK</span><br></pre></td></tr></table></figure>

<p>在实践中，这不仅可以节省时间并让你快速启动和运行，还可以节省错误，并且对于那些没有（喘气）在Swift工作的人来说尤其有用！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/08/01/Data-Structures-and-Algorithms-in-Swift-Notes-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/08/01/Data-Structures-and-Algorithms-in-Swift-Notes-1/" class="post-title-link" itemprop="url">Swift数据结构和算法（一）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-08-01 14:59:59" itemprop="dateCreated datePublished" datetime="2019-08-01T14:59:59+08:00">2019-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="第一部分：引言"><a href="#第一部分：引言" class="headerlink" title="第一部分：引言"></a>第一部分：引言</h2><h3 id="第一章：前言"><a href="#第一章：前言" class="headerlink" title="第一章：前言"></a>第一章：前言</h3><p>数据结构是一门经过充分研究的学科，其概念与语言无关; 来自C的数据结构在功能上和概念上与任何其他语言中的相同数据结构相同，例如Swift。 与此同时，Swift的高级表现力使其成为学习这些核心概念的理想选择，而不会牺牲太多的性能。</p>
<p>Swift标准库有一小组通用集合类型; 他们甚至没有涵盖每一个案例。正如您将看到的，这些 原始的类型可以用作构建更复杂和特殊用途构造的一个很好的起点。 了解比标准数组和字典更多的数据结构，您可以使用更多的工具来构建自己的应用程序。</p>
<h3 id="第二章：Swift标准库"><a href="#第二章：Swift标准库" class="headerlink" title="第二章：Swift标准库"></a>第二章：Swift标准库</h3><p>在开始构建自己的自定义数据结构之前，了解Swift标准库已经提供的主要数据结构非常重要。</p>
<p>字典缺乏明确的排序劣势，却又带来了一些其他的优点。 与数组不同，字典不需要担心元素的转移。 插入字典总是O(1)。 查找操作也在O(1)时间内完成，这比在需要O(n)扫描的数组中找到特定元素要快得多。</p>
<h3 id="第三章：复杂度"><a href="#第三章：复杂度" class="headerlink" title="第三章：复杂度"></a>第三章：复杂度</h3><p>常见的时间复杂度和空间复杂度。</p>
<p>对于计算机，算法的资源是内存。空间复杂度就意味着内存占用率。</p>
<p><strong>总结</strong></p>
<ul>
<li><p>时间复杂度衡量输入大小增加时运行算法所需的时间。</p>
</li>
<li><p>空间复杂度衡量算法运行所需的资源。</p>
</li>
<li><p>Big O表示法用于表示时间和空间复杂性的一般形式。</p>
</li>
<li><p>时间和空间复杂性是可扩展性的高级度量; 它们不测量算法本身的实际速度。</p>
</li>
<li><p>对于小型数据集，时间复杂度通常无关紧要。 拟线性算法可能比线性算法慢。</p>
</li>
</ul>
<h2 id="第二部分：基本数据类型"><a href="#第二部分：基本数据类型" class="headerlink" title="第二部分：基本数据类型"></a>第二部分：基本数据类型</h2><h3 id="第四章：链表"><a href="#第四章：链表" class="headerlink" title="第四章：链表"></a>第四章：链表</h3><p>链表是以线性单向序列排列的值的集合。链表比连续存储选项（如Swift数组）具有几个理论上的优势：</p>
<ul>
<li>从列表前面插入和删除恒定时间。</li>
<li>可靠的性能特征。</li>
</ul>
<p><img src="https://gewill.org/assets/image-20190801154442688.png" alt="image-20190801154442688"></p>
<p>如图所示，链表是一系列节点。 节点有两个职责：</p>
<p>1.保存一个值。</p>
<p>2.保存对下一个节点的引用。 空表示列表的结尾。<img src="https://gewill.org/assets/image-20190801154554314.png" alt="image-20190801154554314"></p>
<p>节点</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;<span class="title class_">Value</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> value: <span class="type">Value</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> next: <span class="type">Node</span>?</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">value</span>: <span class="type">Value</span>, <span class="params">next</span>: <span class="type">Node</span>? <span class="operator">=</span> <span class="literal">nil</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.value <span class="operator">=</span> value</span><br><span class="line">    <span class="keyword">self</span>.next <span class="operator">=</span> next</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>链表</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">LinkedList</span>&lt;<span class="title class_">Value</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> head: <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;?</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> tail: <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;?</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> head <span class="operator">==</span> <span class="literal">nil</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// MARK: - 增加和删除节点的方法</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 时间复杂度：O(1)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">push</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">Value</span>) &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    head <span class="operator">=</span> <span class="type">Node</span>(value: value, next: head)</span><br><span class="line">    <span class="keyword">if</span> tail <span class="operator">==</span> <span class="literal">nil</span> &#123;</span><br><span class="line">      tail <span class="operator">=</span> head</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 时间复杂度：O(1)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">append</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">Value</span>) &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    <span class="keyword">guard</span> <span class="operator">!</span>isEmpty <span class="keyword">else</span> &#123;</span><br><span class="line">      push(value)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    tail<span class="operator">!</span>.next <span class="operator">=</span> <span class="type">Node</span>(value: value)</span><br><span class="line">    tail <span class="operator">=</span> tail<span class="operator">!</span>.next</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 时间复杂度：O(i) , i 就是给定的index</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">node</span>(<span class="params">at</span> <span class="params">index</span>: <span class="type">Int</span>) -&gt; <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;? &#123;</span><br><span class="line">    <span class="keyword">var</span> currentNode <span class="operator">=</span> head</span><br><span class="line">    <span class="keyword">var</span> currentIndex <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> currentNode <span class="operator">!=</span> <span class="literal">nil</span> <span class="operator">&amp;&amp;</span> currentIndex <span class="operator">&lt;</span> index &#123;</span><br><span class="line">      currentNode <span class="operator">=</span> currentNode<span class="operator">!</span>.next</span><br><span class="line">      currentIndex <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> currentNode</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 时间复杂度：O(1)</span></span><br><span class="line">  <span class="keyword">@discardableResult</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">insert</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">Value</span>, <span class="params">after</span> <span class="params">node</span>: <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;) -&gt; <span class="type">Node</span>&lt;<span class="type">Value</span>&gt; &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    <span class="keyword">guard</span> tail <span class="operator">!==</span> node <span class="keyword">else</span> &#123;</span><br><span class="line">      append(value)</span><br><span class="line">      <span class="keyword">return</span> tail<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line">    node.next <span class="operator">=</span> <span class="type">Node</span>(value: value, next: node.next)</span><br><span class="line">    <span class="keyword">return</span> node.next<span class="operator">!</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 时间复杂度：O(1)  </span></span><br><span class="line">  <span class="keyword">@discardableResult</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">pop</span>() -&gt; <span class="type">Value</span>? &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    <span class="keyword">defer</span> &#123;</span><br><span class="line">      head <span class="operator">=</span> head<span class="operator">?</span>.next</span><br><span class="line">      <span class="keyword">if</span> isEmpty &#123;</span><br><span class="line">        tail <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head<span class="operator">?</span>.value</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 时间复杂度：O(n)</span></span><br><span class="line">  <span class="keyword">@discardableResult</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">removeLast</span>() -&gt; <span class="type">Value</span>? &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> head <span class="operator">=</span> head <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">guard</span> head.next <span class="operator">!=</span> <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> pop()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> prev <span class="operator">=</span> head</span><br><span class="line">    <span class="keyword">var</span> current <span class="operator">=</span> head</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> next <span class="operator">=</span> current.next &#123;</span><br><span class="line">      prev <span class="operator">=</span> current</span><br><span class="line">      current <span class="operator">=</span> next</span><br><span class="line">    &#125;</span><br><span class="line">    prev.next <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">    tail <span class="operator">=</span> prev</span><br><span class="line">    <span class="keyword">return</span> current.value</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 时间复杂度：O(1)  </span></span><br><span class="line">  <span class="keyword">@discardableResult</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">remove</span>(<span class="params">after</span> <span class="params">node</span>: <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;) -&gt; <span class="type">Value</span>? &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    <span class="keyword">defer</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> node.next <span class="operator">===</span> tail &#123;</span><br><span class="line">        tail <span class="operator">=</span> node</span><br><span class="line">      &#125;</span><br><span class="line">      node.next <span class="operator">=</span> node.next<span class="operator">?</span>.next</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> node.next<span class="operator">?</span>.value</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// MARK: - 实现值类型和写入时复制</span></span><br><span class="line">  <span class="comment">//使用COW实现价值语义的策略非常简单。在改变链接列表的内容之前，您希望执行底层存储的副本并将所有引用（头部和尾部）更新为新副本。</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">copyNodes</span>() &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="operator">!</span><span class="built_in">isKnownUniquelyReferenced</span>(<span class="operator">&amp;</span>head) <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">var</span> oldNode <span class="operator">=</span> head <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    head <span class="operator">=</span> <span class="type">Node</span>(value: oldNode.value)</span><br><span class="line">    <span class="keyword">var</span> newNode <span class="operator">=</span> head</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> nextOldNode <span class="operator">=</span> oldNode.next &#123;</span><br><span class="line">      newNode<span class="operator">!</span>.next <span class="operator">=</span> <span class="type">Node</span>(value: nextOldNode.value)</span><br><span class="line">      newNode <span class="operator">=</span> newNode<span class="operator">!</span>.next</span><br><span class="line">      oldNode <span class="operator">=</span> nextOldNode</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    tail <span class="operator">=</span> newNode</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - 实现Swift的Collection协议</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Swift Collection还允许通过下标进行访问，这是一个很好的术语，用于表示索引可以映射到集合中的值。</span></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">LinkedList</span>: <span class="title class_">Collection</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">Index</span>: <span class="title class_">Comparable</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> node: <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;?</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">==</span>(<span class="params">lhs</span>: <span class="type">Index</span>, <span class="params">rhs</span>: <span class="type">Index</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">      <span class="keyword">switch</span> (lhs.node, rhs.node) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="keyword">let</span> (left<span class="operator">?</span>, right<span class="operator">?</span>):</span><br><span class="line">        <span class="keyword">return</span> left.next <span class="operator">===</span> right.next</span><br><span class="line">      <span class="keyword">case</span> (<span class="literal">nil</span>, <span class="literal">nil</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">&lt;</span>(<span class="params">lhs</span>: <span class="type">Index</span>, <span class="params">rhs</span>: <span class="type">Index</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">      <span class="keyword">guard</span> lhs <span class="operator">!=</span> rhs <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">let</span> nodes <span class="operator">=</span> <span class="built_in">sequence</span>(first: lhs.node) &#123; <span class="variable">$0</span><span class="operator">?</span>.next &#125;</span><br><span class="line">      <span class="keyword">return</span> nodes.contains &#123; <span class="variable">$0</span> <span class="operator">===</span> rhs.node &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> startIndex: <span class="type">Index</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Index</span>(node: head)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> endIndex: <span class="type">Index</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Index</span>(node: tail<span class="operator">?</span>.next)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">index</span>(<span class="params">after</span> <span class="params">i</span>: <span class="type">Index</span>) -&gt; <span class="type">Index</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Index</span>(node: i.node<span class="operator">?</span>.next)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">subscript</span>(<span class="params">position</span>: <span class="type">Index</span>) -&gt; <span class="type">Value</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> position.node<span class="operator">!</span>.value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>关键点</strong></p>
<ul>
<li>链接列表是线性和单向的。 只要将引用从一个节点移动到另一个节点，就无法返回。</li>
<li>链接列表的头部第一次插入具有O(1)时间复杂度。 对于头部第一次插入，数组有O(n)时间复杂度。</li>
<li>符合Swift收集协议（如序列和集合），可为相当少的要求提供一系列有用的方法。</li>
<li>写时复制行为使您可以实现值语义。</li>
</ul>
<h3 id="第五章：链表挑战"><a href="#第五章：链表挑战" class="headerlink" title="第五章：链表挑战"></a>第五章：链表挑战</h3><h4 id="逆序打印所有节点元素"><a href="#逆序打印所有节点元素" class="headerlink" title="逆序打印所有节点元素"></a>逆序打印所有节点元素</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">printInReverse</span>&lt;<span class="type">T</span>&gt;(<span class="keyword">_</span> <span class="params">list</span>: <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;) &#123;</span><br><span class="line">  <span class="comment">//巧妙的递归：先迭代后打印，这样打印的就是逆序了</span></span><br><span class="line">  printInReverse(list.head)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">printInReverse</span>&lt;<span class="type">T</span>&gt;(<span class="keyword">_</span> <span class="params">node</span>: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?) &#123;</span><br><span class="line">  <span class="keyword">guard</span> <span class="keyword">let</span> node <span class="operator">=</span> node <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">  printInReverse(node.next)</span><br><span class="line">  <span class="built_in">print</span>(node.value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="取中间节点"><a href="#取中间节点" class="headerlink" title="取中间节点"></a>取中间节点</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">getMiddle</span>&lt;<span class="type">T</span>&gt;(<span class="keyword">_</span> <span class="params">list</span>: <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;) -&gt; <span class="type">Node</span>&lt;<span class="type">T</span>&gt;? &#123;</span><br><span class="line">  	<span class="comment">//两个步长差一倍，这样快的遍历到终点，慢的刚好到中间</span></span><br><span class="line">    <span class="keyword">var</span> fast <span class="operator">=</span> list.head</span><br><span class="line">    <span class="keyword">var</span> slow <span class="operator">=</span> list.head</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> nextFast <span class="operator">=</span> fast<span class="operator">?</span>.next &#123;</span><br><span class="line">        fast <span class="operator">=</span> nextFast.next</span><br><span class="line">        slow <span class="operator">=</span> slow<span class="operator">?</span>.next</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> slow</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="反转链表"><a href="#反转链表" class="headerlink" title="反转链表"></a>反转链表</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">LinkedList</span> &#123;</span><br><span class="line">    <span class="comment">// 不断的分割链表，从头部开始，下一步时把之前分割的节点拼接在新的节点之后。</span></span><br><span class="line">    <span class="comment">// 如此遍历到底，就实现了逆序。</span></span><br><span class="line">    <span class="comment">// 核心思路：把每个节点的前节点变成后节点，同时通过遍历时分割成2~3个分段。</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">reverse</span>() &#123;</span><br><span class="line">        tail <span class="operator">=</span> head</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> current <span class="operator">=</span> head<span class="operator">?</span>.next</span><br><span class="line">        <span class="comment">//  临时存储逆序的链表</span></span><br><span class="line">        <span class="keyword">var</span> prev <span class="operator">=</span> head</span><br><span class="line">        prev<span class="operator">?</span>.next <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> current <span class="operator">!=</span> <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> next <span class="operator">=</span> current<span class="operator">?</span>.next</span><br><span class="line">            current<span class="operator">?</span>.next <span class="operator">=</span> prev</span><br><span class="line">            prev <span class="operator">=</span> current</span><br><span class="line">            current <span class="operator">=</span> next</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        head <span class="operator">=</span> prev</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="合并两个已经排序好的链表"><a href="#合并两个已经排序好的链表" class="headerlink" title="合并两个已经排序好的链表"></a>合并两个已经排序好的链表</h4><p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// list1 1 -&gt; 4 -&gt; 10 -&gt; 11</span><br><span class="line"></span><br><span class="line">// list2 -1 -&gt; 2 -&gt; 3 -&gt; 6</span><br><span class="line"></span><br><span class="line">// merged list -1 -&gt; 1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 6 -&gt; 10 -&gt; 11</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">mergeSorted</span>&lt;<span class="type">T</span>: <span class="type">Comparable</span>&gt;(<span class="keyword">_</span> <span class="params">left</span>: <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;,</span><br><span class="line">                                <span class="keyword">_</span> <span class="params">right</span>: <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;) -&gt; <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="operator">!</span>left.isEmpty <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> right</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">guard</span> <span class="operator">!</span>right.isEmpty <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> left</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义新的链表的首尾</span></span><br><span class="line">    <span class="keyword">var</span> newHead: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">    <span class="keyword">var</span> tail: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 原有链表的游标，后面以此遍历</span></span><br><span class="line">    <span class="keyword">var</span> currentLeft <span class="operator">=</span> left.head</span><br><span class="line">    <span class="keyword">var</span> currentRight <span class="operator">=</span> right.head</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始设置</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> leftNode <span class="operator">=</span> currentLeft, <span class="keyword">let</span> rightNode <span class="operator">=</span> currentRight &#123;</span><br><span class="line">        <span class="keyword">if</span> leftNode.value <span class="operator">&lt;</span> rightNode.value &#123;</span><br><span class="line">            newHead <span class="operator">=</span> leftNode</span><br><span class="line">            currentLeft <span class="operator">=</span> leftNode.next</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            newHead <span class="operator">=</span> rightNode</span><br><span class="line">            currentRight <span class="operator">=</span> rightNode.next</span><br><span class="line">        &#125;</span><br><span class="line">        tail <span class="operator">=</span> newHead</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 遍历</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> leftNode <span class="operator">=</span> currentLeft, <span class="keyword">let</span> rightNode <span class="operator">=</span> currentRight &#123;</span><br><span class="line">        <span class="keyword">if</span> leftNode.value <span class="operator">&lt;</span> rightNode.value &#123;</span><br><span class="line">            tail<span class="operator">?</span>.next <span class="operator">=</span> leftNode</span><br><span class="line">            currentLeft <span class="operator">=</span> leftNode.next</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tail<span class="operator">?</span>.next <span class="operator">=</span> rightNode</span><br><span class="line">            currentRight <span class="operator">=</span> rightNode.next</span><br><span class="line">        &#125;</span><br><span class="line">        tail <span class="operator">=</span> tail<span class="operator">?</span>.next</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> leftNode <span class="operator">=</span> currentLeft &#123;</span><br><span class="line">        tail<span class="operator">?</span>.next <span class="operator">=</span> leftNode</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> rightNode <span class="operator">=</span> currentRight &#123;</span><br><span class="line">        tail<span class="operator">?</span>.next <span class="operator">=</span> rightNode</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理新的链表的首尾</span></span><br><span class="line">    <span class="keyword">var</span> list <span class="operator">=</span> <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;()</span><br><span class="line"></span><br><span class="line">    list.head <span class="operator">=</span> newHead</span><br><span class="line">    <span class="comment">// 找到真的尾部节点</span></span><br><span class="line">    list.tail <span class="operator">=</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">let</span> next <span class="operator">=</span> tail<span class="operator">?</span>.next &#123;</span><br><span class="line">            tail <span class="operator">=</span> next</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> tail</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> list</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="创建一个从链表中删除所有特定元素的函数"><a href="#创建一个从链表中删除所有特定元素的函数" class="headerlink" title="创建一个从链表中删除所有特定元素的函数"></a>创建一个从链表中删除所有特定元素的函数</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">LinkedList</span> <span class="title class_">where</span> <span class="title class_">Value</span>: <span class="title class_">Equatable</span> &#123;</span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">removeAll</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">Value</span>) &#123;</span><br><span class="line">        <span class="comment">// 头部的值相等时单独处理</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">let</span> head <span class="operator">=</span> <span class="keyword">self</span>.head, head.value <span class="operator">==</span> value &#123;</span><br><span class="line">            <span class="keyword">self</span>.head <span class="operator">=</span> head.next</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> current <span class="operator">=</span> head<span class="operator">?</span>.next</span><br><span class="line">        <span class="keyword">var</span> prev <span class="operator">=</span> head</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 遍历</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">let</span> currentNode <span class="operator">=</span> current &#123;</span><br><span class="line">            <span class="keyword">guard</span> currentNode.value <span class="operator">!=</span> value <span class="keyword">else</span> &#123;</span><br><span class="line">                prev<span class="operator">?</span>.next <span class="operator">=</span> currentNode.next</span><br><span class="line">                current <span class="operator">=</span> prev<span class="operator">?</span>.next</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            prev <span class="operator">=</span> current</span><br><span class="line">            current <span class="operator">=</span> current<span class="operator">?</span>.next</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        tail <span class="operator">=</span> prev</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在时间复杂度上优化，所以一般都是2~3个临时变量（牺牲一点空间复杂度）。相当于让更多人协同做一件事情，肯定更快。但是如果是资源有限的时候，比如说雇人做事，总的成本不一定会减少。但是通常情况下，电脑的内存容量是既定的，而且够用的情况下，就要优化时间复杂度，不用吝惜内存。</p>
</blockquote>
<h3 id="第六章：栈"><a href="#第六章：栈" class="headerlink" title="第六章：栈"></a>第六章：栈</h3><p>栈无处不在。 以下是您要栈的一些常见示例：</p>
<ul>
<li>薄煎饼</li>
<li>书籍</li>
<li>纸张</li>
</ul>
<p>在概念上，栈数据结构与物理栈相同。 将项目添加到栈时，将其放在栈顶部。 从栈中删除项目时，始终会删除最顶层的项目。</p>
<h4 id="栈的操作"><a href="#栈的操作" class="headerlink" title="栈的操作"></a>栈的操作</h4><p>栈的操作只有两个：</p>
<ol>
<li>push：将元素添加到栈顶部。</li>
<li>pop：删除栈的顶部元素。</li>
</ol>
<p>这意味着您只能在数据结构的一侧添加或删除元素。在计算机科学中，栈被称为LIFO（后进先出）数据结构。最后推入的元素是第一个被弹出的元素。</p>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//泛型Element为存储的元素</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">Stack</span>&lt;<span class="title class_">Element</span>&gt; &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//内部为数组存储所有元素</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> storage: [<span class="type">Element</span>] <span class="operator">=</span> []</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123; &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">elements</span>: [<span class="type">Element</span>]) &#123;</span><br><span class="line">    storage <span class="operator">=</span> elements</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">push</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">Element</span>) &#123;</span><br><span class="line">    storage.append(element)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@discardableResult</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">pop</span>() -&gt; <span class="type">Element</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> storage.popLast()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">peek</span>() -&gt; <span class="type">Element</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> storage.last</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> peek() <span class="operator">==</span> <span class="literal">nil</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Stack</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> topDivider <span class="operator">=</span> <span class="string">&quot;----top----<span class="subst">\n</span>&quot;</span></span><br><span class="line">    <span class="keyword">let</span> bottomDivider <span class="operator">=</span> <span class="string">&quot;<span class="subst">\n</span>-----------&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> stackElements <span class="operator">=</span> storage</span><br><span class="line">      .map &#123; <span class="string">&quot;<span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span> &#125;</span><br><span class="line">      .reversed()</span><br><span class="line">      .joined(separator: <span class="string">&quot;<span class="subst">\n</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> topDivider <span class="operator">+</span> stackElements <span class="operator">+</span> bottomDivider</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Stack</span>: <span class="title class_">ExpressibleByArrayLiteral</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">arrayLiteral</span> <span class="params">elements</span>: <span class="type">Element</span>...) &#123;</span><br><span class="line">    storage <span class="operator">=</span> elements</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>你可能想知道是否可以为栈采用Swift集合协议。栈的目的是限制访问数据的方式的数量，并采用诸如Collection之类的协议将通过迭代器和下标公开所有元素来违背此目标。在这种情况下，少即是多！</p>
<h3 id="第七章：栈挑战"><a href="#第七章：栈挑战" class="headerlink" title="第七章：栈挑战"></a>第七章：栈挑战</h3><h4 id="逆序打印链表，但是不能用递归"><a href="#逆序打印链表，但是不能用递归" class="headerlink" title="逆序打印链表，但是不能用递归"></a>逆序打印链表，但是不能用递归</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> list: <span class="type">LinkedList</span>&lt;<span class="type">Int</span>&gt; <span class="operator">=</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> list <span class="operator">=</span> <span class="type">LinkedList</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line">  list.push(<span class="number">3</span>)</span><br><span class="line">  list.push(<span class="number">2</span>)</span><br><span class="line">  list.push(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">return</span> list</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">printInReverse</span>&lt;<span class="type">T</span>&gt;(<span class="keyword">_</span> <span class="params">list</span>: <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;) &#123;</span><br><span class="line">  <span class="keyword">var</span> current <span class="operator">=</span> list.head</span><br><span class="line">  <span class="keyword">var</span> stack <span class="operator">=</span> <span class="type">Stack</span>&lt;<span class="type">T</span>&gt;()</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">while</span> <span class="keyword">let</span> node <span class="operator">=</span> current &#123;</span><br><span class="line">    stack.push(node.value)</span><br><span class="line">    current <span class="operator">=</span> node.next</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">while</span> <span class="keyword">let</span> value <span class="operator">=</span> stack.pop() &#123;</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">printInReverse(list)</span><br></pre></td></tr></table></figure>

<h4 id="检查括号的匹配"><a href="#检查括号的匹配" class="headerlink" title="检查括号的匹配"></a>检查括号的匹配</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> testString1 <span class="operator">=</span> <span class="string">&quot;h((e))llo(world)()&quot;</span></span><br><span class="line"><span class="keyword">var</span> testString2 <span class="operator">=</span> <span class="string">&quot;(hello world&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">checkParentheses</span>(<span class="keyword">_</span> <span class="params">string</span>: <span class="type">String</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> stack <span class="operator">=</span> <span class="type">Stack</span>&lt;<span class="type">Character</span>&gt;()</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> character <span class="keyword">in</span> string &#123;</span><br><span class="line">    <span class="keyword">if</span> character <span class="operator">==</span> <span class="string">&quot;(&quot;</span> &#123;</span><br><span class="line">      stack.push(character)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> character <span class="operator">==</span> <span class="string">&quot;)&quot;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> stack.isEmpty &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        stack.pop()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> stack.isEmpty</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">checkParentheses(testString1)</span><br><span class="line">checkParentheses(testString2)</span><br></pre></td></tr></table></figure>

<h3 id="第八章：队列"><a href="#第八章：队列" class="headerlink" title="第八章：队列"></a>第八章：队列</h3><p>我们都熟悉排队，无论是买票还是排队打印。</p>
<p>队列使用FIFO或先进先出顺序，这意味着添加的第一个元素将始终是第一个被删除的元素。当您需要维护元素的顺序以便稍后处理时，队列很方便。</p>
<h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><p>让我们先确定队列的协议：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">protocol</span> <span class="title class_">Queue</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">associatedtype</span> <span class="type">Element</span></span><br><span class="line">  <span class="comment">///在队列后面插入一个元素。如果操作成功，则返回true。</span></span><br><span class="line">  <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">enqueue</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">Element</span>) -&gt; <span class="type">Bool</span></span><br><span class="line">  <span class="comment">///删除队列前面的元素并将其返回。</span></span><br><span class="line">  <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">dequeue</span>() -&gt; <span class="type">Element</span>?</span><br><span class="line">  <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">  <span class="keyword">var</span> peek: <span class="type">Element</span>? &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在以下部分中，将以四种不同的方式创建队列：</p>
<ol>
<li>数组</li>
<li>双向列表</li>
<li>环形缓冲区</li>
<li>双栈</li>
</ol>
<h4 id="用数组来实现"><a href="#用数组来实现" class="headerlink" title="用数组来实现"></a>用数组来实现</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">QueueArray</span>&lt;<span class="title class_">T</span>&gt;: <span class="title class_">Queue</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> array: [<span class="type">T</span>] <span class="operator">=</span> []</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> array.isEmpty</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> peek: <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> array.first</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">enqueue</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    array.append(element)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">dequeue</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> isEmpty <span class="operator">?</span> <span class="literal">nil</span> : array.removeFirst()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueArray</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: array)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">QueueArray</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line">queue.enqueue(<span class="string">&quot;Ray&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Brian&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Eric&quot;</span>)</span><br><span class="line">queue</span><br><span class="line">queue.dequeue()</span><br><span class="line">queue</span><br><span class="line">queue.peek</span><br></pre></td></tr></table></figure>

<h5 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h5><h5 id=""><a href="#" class="headerlink" title=""></a><img src="https://gewill.org/assets/image-20190912160423263.png" alt="image-20190912160423263"></h5><p>很明显只有<code>enqueue</code>是O(1)，其他都是O(n)。</p>
<h4 id="用双向链表来实现"><a href="#用双向链表来实现" class="headerlink" title="用双向链表来实现"></a>用双向链表来实现</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QueueLinkedList</span>&lt;<span class="title class_">T</span>&gt;: <span class="title class_">Queue</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> list <span class="operator">=</span> <span class="type">DoublyLinkedList</span>&lt;<span class="type">T</span>&gt;()</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">enqueue</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    list.append(element)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">dequeue</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="operator">!</span>list.isEmpty, <span class="keyword">let</span> element <span class="operator">=</span> list.first <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list.remove(element)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> peek: <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> list.first<span class="operator">?</span>.value</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> list.isEmpty</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueLinkedList</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: list)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">QueueLinkedList</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line">queue.enqueue(<span class="string">&quot;Ray&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Brian&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Eric&quot;</span>)</span><br><span class="line">queue</span><br><span class="line">queue.dequeue()</span><br><span class="line">queue</span><br><span class="line">queue.peek</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - DoublyLinkedList</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;<span class="title class_">T</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> value: <span class="type">T</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> next: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> previous: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">value</span>: <span class="type">T</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.value <span class="operator">=</span> value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Node</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DoublyLinkedList</span>&lt;<span class="title class_">T</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> head: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> tail: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123; &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> head <span class="operator">==</span> <span class="literal">nil</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> first: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;? &#123;</span><br><span class="line">    <span class="keyword">return</span> head</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">append</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">T</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> newNode <span class="operator">=</span> <span class="type">Node</span>(value: value)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> tailNode <span class="operator">=</span> tail <span class="keyword">else</span> &#123;</span><br><span class="line">      head <span class="operator">=</span> newNode</span><br><span class="line">      tail <span class="operator">=</span> newNode</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    newNode.previous <span class="operator">=</span> tailNode</span><br><span class="line">    tailNode.next <span class="operator">=</span> newNode</span><br><span class="line">    tail <span class="operator">=</span> newNode</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">remove</span>(<span class="keyword">_</span> <span class="params">node</span>: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;) -&gt; <span class="type">T</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> prev <span class="operator">=</span> node.previous</span><br><span class="line">    <span class="keyword">let</span> next <span class="operator">=</span> node.next</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> prev <span class="operator">=</span> prev &#123;</span><br><span class="line">      prev.next <span class="operator">=</span> next</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      head <span class="operator">=</span> next</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    next<span class="operator">?</span>.previous <span class="operator">=</span> prev</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> next <span class="operator">==</span> <span class="literal">nil</span> &#123;</span><br><span class="line">      tail <span class="operator">=</span> prev</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    node.previous <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">    node.next <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> node.value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">DoublyLinkedList</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> string <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">var</span> current <span class="operator">=</span> head</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> node <span class="operator">=</span> current &#123;</span><br><span class="line">      string.append(<span class="string">&quot;<span class="subst">\(node.value)</span> -&gt; &quot;</span>)</span><br><span class="line">      current <span class="operator">=</span> node.next</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> string <span class="operator">+</span> <span class="string">&quot;end&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedListIterator</span>&lt;<span class="title class_">T</span>&gt;: <span class="title class_">IteratorProtocol</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> current: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">init</span>(<span class="params">node</span>: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?) &#123;</span><br><span class="line">    current <span class="operator">=</span> node</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">next</span>() -&gt; <span class="type">Node</span>&lt;<span class="type">T</span>&gt;? &#123;</span><br><span class="line">    <span class="keyword">defer</span> &#123; current <span class="operator">=</span> current<span class="operator">?</span>.next &#125;</span><br><span class="line">    <span class="keyword">return</span> current</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">DoublyLinkedList</span>: <span class="title class_">Sequence</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">makeIterator</span>() -&gt; <span class="type">LinkedListIterator</span>&lt;<span class="type">T</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">LinkedListIterator</span>(node: head)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="优缺点-1"><a href="#优缺点-1" class="headerlink" title="优缺点"></a>优缺点<img src="https://gewill.org/assets/image-20190912161101034.png" alt="image-20190912161101034"></h5><p>出来空间复杂度是O(n)，其他的都是O(1)。</p>
<p>双向列表的主要弱点在表中并不明显。尽管有O(1)的性能，但它的开销很高。每个元素都必须有额外的存储空间用于前向和后向引用。而且，每次创建新元素时，都需要相对昂贵的动态分配。相比之下，数组进行批量分配，速度更快。</p>
<h4 id="用环形缓冲区来实现"><a href="#用环形缓冲区来实现" class="headerlink" title="用环形缓冲区来实现"></a>用环形缓冲区来实现</h4><p>环形缓冲区，也称为循环缓冲区，是固定大小的阵列。当最终没有更多项目需要删除时，这种数据结构战略性地包含在开头。</p>
<p>详见：[<a target="_blank" rel="noopener" href="https://github.com/raywenderlich/swift-algorithm-club/tree/master/Ring%20Buffer]">https://github.com/raywenderlich/swift-algorithm-club/tree/master/Ring%20Buffer]</a>(<a target="_blank" rel="noopener" href="https://github.com/raywenderlich/swift-algorithm-club/tree/master/Ring">https://github.com/raywenderlich/swift-algorithm-club/tree/master/Ring</a> Buffer)</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">QueueRingBuffer</span>&lt;<span class="title class_">T</span>&gt;: <span class="title class_">Queue</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> ringBuffer: <span class="type">RingBuffer</span>&lt;<span class="type">T</span>&gt;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">count</span>: <span class="type">Int</span>) &#123;</span><br><span class="line">    ringBuffer <span class="operator">=</span> <span class="type">RingBuffer</span>&lt;<span class="type">T</span>&gt;(count: count)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> ringBuffer.isEmpty</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> peek: <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> ringBuffer.first</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">enqueue</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> ringBuffer.write(element)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">dequeue</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> isEmpty <span class="operator">?</span> <span class="literal">nil</span> : ringBuffer.read()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueRingBuffer</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: ringBuffer)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">QueueRingBuffer</span>&lt;<span class="type">String</span>&gt;(count: <span class="number">10</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Ray&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Brian&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Eric&quot;</span>)</span><br><span class="line">queue</span><br><span class="line">queue.dequeue()</span><br><span class="line">queue</span><br><span class="line">queue.peek</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - RingBuffer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">RingBuffer</span>&lt;<span class="title class_">T</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> array: [<span class="type">T</span>?]</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> readIndex <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> writeIndex <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">count</span>: <span class="type">Int</span>) &#123;</span><br><span class="line">    array <span class="operator">=</span> <span class="type">Array</span>&lt;<span class="type">T</span>?&gt;(repeating: <span class="literal">nil</span>, count: count)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> first: <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> array[readIndex]</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">write</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="operator">!</span>isFull &#123;</span><br><span class="line">      array[writeIndex <span class="operator">%</span> array.count] <span class="operator">=</span> element</span><br><span class="line">      writeIndex <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">read</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="operator">!</span>isEmpty &#123;</span><br><span class="line">      <span class="keyword">let</span> element <span class="operator">=</span> array[readIndex <span class="operator">%</span> array.count]</span><br><span class="line">      readIndex <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">      <span class="keyword">return</span> element</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> availableSpaceForReading: <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> writeIndex <span class="operator">-</span> readIndex</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> availableSpaceForReading <span class="operator">==</span> <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> availableSpaceForWriting: <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> array.count <span class="operator">-</span> availableSpaceForReading</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isFull: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> availableSpaceForWriting <span class="operator">==</span> <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">RingBuffer</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> values <span class="operator">=</span> (<span class="number">0</span><span class="operator">..&lt;</span>availableSpaceForReading).map &#123;</span><br><span class="line">      <span class="type">String</span>(describing: array[(<span class="variable">$0</span> <span class="operator">+</span> readIndex) <span class="operator">%</span> array.count]<span class="operator">!</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;[&quot;</span> <span class="operator">+</span> values.joined(separator: <span class="string">&quot;, &quot;</span>) <span class="operator">+</span> <span class="string">&quot;]&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="优缺点-2"><a href="#优缺点-2" class="headerlink" title="优缺点"></a>优缺点</h5><p><img src="https://gewill.org/assets/image-20190912162139308.png" alt="image-20190912162139308"></p>
<p>基于环缓冲区的队列具有与链表实现相同的入队和出队时间复杂度。唯一的区别是空间复杂性。环形缓冲区具有固定大小，这意味着入队可能会失败。</p>
<h4 id="用双栈来实现"><a href="#用双栈来实现" class="headerlink" title="用双栈来实现"></a>用双栈来实现</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">QueueStack</span>&lt;<span class="title class_">T</span>&gt; : <span class="title class_">Queue</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> leftStack: [<span class="type">T</span>] <span class="operator">=</span> []</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> rightStack: [<span class="type">T</span>] <span class="operator">=</span> []</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> leftStack.isEmpty <span class="operator">&amp;&amp;</span> rightStack.isEmpty</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> peek: <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="operator">!</span>leftStack.isEmpty <span class="operator">?</span> leftStack.last : rightStack.first</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">enqueue</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    rightStack.append(element)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">dequeue</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">if</span> leftStack.isEmpty &#123;</span><br><span class="line">      leftStack <span class="operator">=</span> rightStack.reversed()</span><br><span class="line">      rightStack.removeAll()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> leftStack.popLast()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueStack</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> printList <span class="operator">=</span> leftStack.reversed() <span class="operator">+</span> rightStack</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: printList)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">QueueStack</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line">queue.enqueue(<span class="string">&quot;Ray&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Brian&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Eric&quot;</span>)</span><br><span class="line">queue</span><br><span class="line">queue.dequeue()</span><br><span class="line">queue</span><br><span class="line">queue.peek</span><br></pre></td></tr></table></figure>

<p>出队：<img src="https://gewill.org/assets/image-20190912162831309.png" alt="image-20190912162831309"></p>
<p>入队：</p>
<p>![image-20190912162918069](&#x2F;Users&#x2F;will&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20190912162918069.png)</p>
<h5 id="优缺点-3"><a href="#优缺点-3" class="headerlink" title="优缺点"></a>优缺点</h5><h5 id="image-20190912163001741-x2F-Users-x2F-will-x2F-Library-x2F-Application-Support-x2F-typora-user-images-x2F-image-20190912163001741-png"><a href="#image-20190912163001741-x2F-Users-x2F-will-x2F-Library-x2F-Application-Support-x2F-typora-user-images-x2F-image-20190912163001741-png" class="headerlink" title="![image-20190912163001741](&#x2F;Users&#x2F;will&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20190912163001741.png)"></a>![image-20190912163001741](&#x2F;Users&#x2F;will&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20190912163001741.png)</h5><p>与基于数组的实现相比，通过利用两个堆栈，您可以将<code>dequeue(_ :)</code>转换为分摊的O(1)操作。</p>
<p>此外，您的双栈实现是完全动态的，并且没有基于环形缓冲区的队列实现所具有的固定大小限制。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ul>
<li><p>队列采用FIFO策略，首先必须先删除添加的元素。</p>
</li>
<li><p>Enqueue将元素插入队列的后面。</p>
</li>
<li><p>Dequeue删除队列前面的元素。</p>
</li>
<li><p>数组中的元素在连续的内存块中布局，而链表中的元素更加分散，可能存在缓存未命中。</p>
</li>
<li><p>基于环路缓冲区队列的实现适用于具有固定大小的队列。</p>
</li>
<li><p>与其他数据结构相比，利用两个栈可以将出列<code>dequeue(_ :)</code>时间复杂度提高到摊销的O(1)操作。</p>
</li>
<li><p>双栈实现在空间复杂度方面击败了链表。</p>
</li>
</ul>
<h3 id="第九章：队列挑战"><a href="#第九章：队列挑战" class="headerlink" title="第九章：队列挑战"></a>第九章：队列挑战</h3><h4 id="解释栈和队列之间的区别"><a href="#解释栈和队列之间的区别" class="headerlink" title="解释栈和队列之间的区别"></a>解释栈和队列之间的区别</h4><p>为每个数据结构提供两个实际示例。</p>
<h4 id="画逐步图表"><a href="#画逐步图表" class="headerlink" title="画逐步图表"></a>画逐步图表</h4><p>演示四种实现时，每一步对队列的有影响。</p>
<p>如队列为：”SWIFT”</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">enqueue(<span class="string">&quot;R&quot;</span>) </span><br><span class="line">enqueue(<span class="string">&quot;O&quot;</span>) </span><br><span class="line">dequeue() </span><br><span class="line">enqueue(<span class="string">&quot;C&quot;</span>) </span><br><span class="line">dequeue() </span><br><span class="line">dequeue() </span><br><span class="line">enqueue(<span class="string">&quot;K&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="给队列添加next协议"><a href="#给队列添加next协议" class="headerlink" title="给队列添加next协议"></a>给队列添加<code>next</code>协议</h4><p>用来大富翁游戏，指派下一个玩家</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">protocol</span> <span class="title class_">BoardGameManager</span> &#123;</span><br><span class="line">  <span class="keyword">associatedtype</span> <span class="type">Player</span></span><br><span class="line">  <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">nextPlayer</span>() -&gt; <span class="type">Player</span>?</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueArray</span>: <span class="title class_">BoardGameManager</span> &#123;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">typealias</span> <span class="type">Player</span> <span class="operator">=</span> <span class="type">T</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">nextPlayer</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> person <span class="operator">=</span> dequeue() <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    enqueue(person)</span><br><span class="line">    <span class="keyword">return</span> person</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="逆序排列队列"><a href="#逆序排列队列" class="headerlink" title="逆序排列队列"></a>逆序排列队列</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueArray</span> &#123;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">reversed</span>() -&gt; <span class="type">QueueArray</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> queue <span class="operator">=</span> <span class="keyword">self</span></span><br><span class="line">    <span class="keyword">var</span> stack <span class="operator">=</span> <span class="type">Stack</span>&lt;<span class="type">T</span>&gt;()</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> element <span class="operator">=</span> queue.dequeue() &#123;</span><br><span class="line">      stack.push(element)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> element <span class="operator">=</span> stack.pop() &#123;</span><br><span class="line">      queue.enqueue(element)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> queue</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Ge Will</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  





</body>
</html>
