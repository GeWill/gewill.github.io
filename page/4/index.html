<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
<meta property="og:type" content="website">
<meta property="og:title" content="Will&#39;s Blog">
<meta property="og:url" content="http://example.com/page/4/index.html">
<meta property="og:site_name" content="Will&#39;s Blog">
<meta property="og:description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Ge Will">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/4/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/4/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Will's Blog</title>
  







<head>
    <!-- éœé¹œæ–‡æ¥·å­—ä½“ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.7.0/style.css"/>

    <!-- datapulseç»Ÿè®¡ -->
    <script defer type="text/javascript" src="https://datapulse.app/datapulse.min.js" id="datapulse" data-endpoint="https://datapulse.app/api/v1/event" data-workspace="cljxqml5q0y0f8j37d4futnbl"></script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DR0FC9YJLH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'G-DR0FC9YJLH');
    </script>

    <!-- çœ‹æ¿å¨˜ -->
    <script src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script>
</head>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Will's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">189</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">11</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">1</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Ge Will"
      src="/images/avatar.jpeg">
  <p class="site-author-name" itemprop="name">Ge Will</p>
  <div class="site-description" itemprop="description">The people who are crazy enough to think they can change the world, are the ones who DO.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">189</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/gewill" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;gewill" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:531sunlight@gmail.com" title="E-Mail â†’ mailto:531sunlight@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/gewei" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;gewei" rel="noopener me" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/BoJack_D" title="Twitter â†’ https:&#x2F;&#x2F;twitter.com&#x2F;BoJack_D" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/08/05/Server-Side-Swift-with-Kitura-Notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/08/05/Server-Side-Swift-with-Kitura-Notes/" class="post-title-link" itemprop="url">Kitura Swiftåç«¯å¼€å‘-ç¬”è®°</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-08-05 15:49:35" itemprop="dateCreated datePublished" datetime="2019-08-05T15:49:35+08:00">2019-08-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="ç¬¬ä¸€ç« ï¼šå¼•è¨€"><a href="#ç¬¬ä¸€ç« ï¼šå¼•è¨€" class="headerlink" title="ç¬¬ä¸€ç« ï¼šå¼•è¨€"></a>ç¬¬ä¸€ç« ï¼šå¼•è¨€</h2><p><strong>Kituraæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>åœ¨è¯æºå­¦ä¸Šï¼ŒKituraè¿™ä¸ªè¯æ¾æ•£åœ°æºäºå¸Œä¼¯æ¥è¯­Keturahï¼Œå­—é¢æ„æ€æ˜¯â€œé¦™â€ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé€‰æ‹©Swiftå†™åç«¯ï¼Ÿ</strong></p>
<p>æ”¯æŒä¸ºæœåŠ¡å™¨ç¼–å†™Swiftçš„æ ¸å¿ƒè®ºç‚¹æ˜¯åœ¨åº”ç”¨ç¨‹åºçš„å‰ç«¯å’Œåç«¯ä¹‹é—´å…±äº«ä»£ç å’ŒçŸ¥è¯†ã€‚å¦‚æœä½ æ˜¯ä¸€ä¸ªå›¢é˜Ÿï¼Œè¿™ç§ç²¾ç®€å¯ä»¥è¯´æ˜¯æ›´åŠ å…³é”®å’Œèµ‹æƒã€‚è¿™åŒ…æ‹¬ä½†ä¸é™äºæ¨¡å‹å¯¹è±¡ä»£ç ã€‚</p>
<p>BFFï¼ˆBackonnd for Frontendï¼‰æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå¾ˆå¿«å°±ä¼šæˆä¸ºä½ æœ€å¥½çš„æœ‹å‹ï¼ˆæ°¸è¿œï¼Ÿï¼‰ã€‚</p>
<p>è¿™ä¸ªæ¨¡å¼åœ¨è¿™ä¸ªç‰¹å®šç”¨ä¾‹ä¸­èµ·ä½œç”¨çš„å‡ ä¸ªåŸå› ï¼š</p>
<ol>
<li><p>ä½ å¯ä»¥ç¡®å®šä»æ­¤APIå‘å‡ºè¯·æ±‚çš„å”¯ä¸€è®¾å¤‡å°†æ˜¯iOSè®¾å¤‡ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥æ›´å°‘æ‹…å¿ƒå¹³è¡¡è¯·æ±‚è´Ÿè½½ã€‚</p>
</li>
<li><p>ä½ å¯ä»¥æ›´å¥½åœ°æ§åˆ¶å¯¹iOSè®¾å¤‡çš„å“åº”ä¸­çš„æ•°æ®ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œä½ å¯èƒ½å·²ç»ç­‰å¾…åç«¯å¼€å‘äººå‘˜æœ€ç»ˆå¸®åŠ©ä½ ï¼Œå¹¶æ ¹æ®User-Agenté¦–éƒ¨æœ‰æ¡ä»¶åœ°ä¿®å‰ªå“åº”æ•°æ®ã€‚ç°åœ¨ï¼Œä½ å¯ä»¥è®©åç«¯å¼€å‘äººå‘˜ä¸é—´æ–­åœ°å·¥ä½œï¼Œå¹¶é€šè¿‡å°†å“åº”æ•°æ®è§£æä¸ºä½ çš„BFFè®¾å¤‡æ‰€éœ€çš„å†…å®¹æ¥è§£å†³ä½ çš„é—®é¢˜ã€‚</p>
</li>
<li><p>åœ¨æˆ‘ä»¬çš„ç‰¹å®šç”¨ä¾‹ä¸­ï¼Œä½ å¯ä»¥åœ¨å‘é€å“åº”ä¹‹å‰ä¿å­˜ä¸€ä¸ªç”¨æˆ·å¯èƒ½å¯¹æ•°æ®åº“è¿›è¡Œçš„æŸ¥è¯¢çš„å“åº”ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœå…¶ä»–äººåœ¨ç›¸åŒçš„ä½ç½®è¯·æ±‚é¤é¦†ä¿¡æ¯ï¼ˆä¾‹å­æ˜¯è¯·æ±‚åŒ…å«åœ°ç†ä½ç½®çš„é¤é¦†ä¿¡æ¯ï¼‰ï¼Œå¹¶ä¸”å­˜å‚¨çš„æ•°æ®è¶³å¤Ÿæ–°ä»¥æ»¡è¶³ä½ çš„åˆ·æ–°ç­–ç•¥ï¼Œä½ ç”šè‡³ä¸å¿…å‘ä¸»æœåŠ¡å™¨å‘é€æŸ¥è¯¢ï¼ä½ åªéœ€å‘é€ç¼“å­˜çš„æ•°æ®ï¼Œå¹¶ç›¸ä¿¡å®ƒå¯¹ä½ çš„ç”¨æˆ·æ¥è¯´è¶³å¤Ÿæ–°ã€‚</p>
</li>
<li><p>ä½ å¯ä»¥ä½¿ç”¨ä½ å·²ç»çŸ¥é“å¦‚ä½•åœ¨Swiftä¸­ç¼–å†™ä»£ç çš„è¯­è¨€å®Œæˆ1-3ï¼</p>
</li>
</ol>
<h2 id="ç¬¬äºŒç« ï¼šHello-World"><a href="#ç¬¬äºŒç« ï¼šHello-World" class="headerlink" title="ç¬¬äºŒç« ï¼šHello, World!"></a>ç¬¬äºŒç« ï¼šHello, World!</h2><p>å¦‚ä½•Kituraé¡¹ç›®</p>
<p>å…ˆå®‰è£…Kitura macOS Appå’ŒKitura CLI</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew tap ibm-swift/kitura</span><br><span class="line">brew install kitura</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">kitura</span><br><span class="line">Usage: kitura [options] [command]</span><br><span class="line"></span><br><span class="line">Kitura command-line interface</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -V, --version  output the version number</span><br><span class="line">  -h, --help     output usage information</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  build          build the project in a local container</span><br><span class="line">  create         interactively create a Kitura project</span><br><span class="line">  idt            install IBM Cloud Developer Tools</span><br><span class="line">  init           scaffold a bare-bones Kitura project</span><br><span class="line">  kit            print Cocoapods boilerplate for KituraKit</span><br><span class="line">  run            run the project in a local container</span><br><span class="line">  sdk            generate a client SDK from an OpenAPI/Swagger spec</span><br><span class="line">  help [cmd]     display help for [cmd]</span><br></pre></td></tr></table></figure>



<p>åˆ›å»ºçš„Kituraé¡¹ç›®æä¾›äº†ä¸€ä¸ªå¼€ç®±å³ç”¨çš„å…¨åŠŸèƒ½Kituraåº”ç”¨ç¨‹åºã€‚ å®ƒæä¾›äº†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œçš„ä»»ä½•åº”ç”¨ç¨‹åºå¯èƒ½éœ€è¦çš„ä¸€äº›åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><p>ä½¿ç”¨HeliumLoggerè®°å½•ä¿¡æ¯ï¼Œè­¦å‘Šå’Œé”™è¯¯æ¶ˆæ¯ã€‚</p>
</li>
<li><p>ä½¿ç”¨CloudEnvironmentè¿›è¡ŒåŠ¨æ€é…ç½®æŸ¥æ‰¾å’Œè®¾ç½®ã€‚</p>
</li>
<li><p>ä½¿ç”¨HealthæŸ¥çœ‹å’ŒæŠ¥å‘Šåº”ç”¨ç¨‹åºå¥åº·çŠ¶å†µã€‚</p>
</li>
<li><p>ä½¿ç”¨SwiftMetricsè¿›è¡ŒAppå’ŒKituraæ¡†æ¶æŒ‡æ ‡å’Œç›‘æ§ã€‚</p>
</li>
</ul>
<p>é¡¹ç›®ä½¿ç”¨SPMç®¡ç†ä¾èµ–</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// swift-tools-version:4.0</span></span><br><span class="line"><span class="keyword">import</span> PackageDescription</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> package <span class="operator">=</span> <span class="type">Package</span>(</span><br><span class="line">    name: <span class="string">&quot;EmojiJournalServer&quot;</span>,</span><br><span class="line">    dependencies: [</span><br><span class="line">      .package(url: <span class="string">&quot;https://github.com/IBM-Swift/Kitura.git&quot;</span>, .upToNextMinor(from: <span class="string">&quot;2.5.0&quot;</span>)),</span><br><span class="line">      .package(url: <span class="string">&quot;https://github.com/IBM-Swift/HeliumLogger.git&quot;</span>, from: <span class="string">&quot;1.7.1&quot;</span>),</span><br><span class="line">      .package(url: <span class="string">&quot;https://github.com/IBM-Swift/CloudEnvironment.git&quot;</span>, from: <span class="string">&quot;9.0.0&quot;</span>),</span><br><span class="line">      .package(url: <span class="string">&quot;https://github.com/RuntimeTools/SwiftMetrics.git&quot;</span>, from: <span class="string">&quot;2.0.0&quot;</span>),</span><br><span class="line">      .package(url: <span class="string">&quot;https://github.com/IBM-Swift/Health.git&quot;</span>, from: <span class="string">&quot;1.0.0&quot;</span>),</span><br><span class="line">    ],</span><br><span class="line">    targets: [</span><br><span class="line">      .target(name: <span class="string">&quot;EmojiJournalServer&quot;</span>, dependencies: [ .target(name: <span class="string">&quot;Application&quot;</span>), <span class="string">&quot;Kitura&quot;</span> , <span class="string">&quot;HeliumLogger&quot;</span>]),</span><br><span class="line">      .target(name: <span class="string">&quot;Application&quot;</span>, dependencies: [ <span class="string">&quot;Kitura&quot;</span>, <span class="string">&quot;CloudEnvironment&quot;</span>,<span class="string">&quot;SwiftMetrics&quot;</span>,<span class="string">&quot;Health&quot;</span>,      ]),</span><br><span class="line"></span><br><span class="line">      .testTarget(name: <span class="string">&quot;ApplicationTests&quot;</span> , dependencies: [.target(name: <span class="string">&quot;Application&quot;</span>), <span class="string">&quot;Kitura&quot;</span>,<span class="string">&quot;HeliumLogger&quot;</span> ])</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Application.swiftåŒ…å«åº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸå¤„ç†ï¼Œæä¾›emojiJournalServerç›®æ ‡ä¸­main.swiftä½¿ç”¨çš„æ ¸å¿ƒ<code>init()</code>å’Œ<code>run()</code>æ–¹æ³•æ¥å¯åŠ¨åº”ç”¨ç¨‹åºã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> Kitura</span><br><span class="line"><span class="keyword">import</span> LoggerAPI</span><br><span class="line"><span class="keyword">import</span> Configuration</span><br><span class="line"><span class="keyword">import</span> CloudEnvironment</span><br><span class="line"><span class="keyword">import</span> KituraContracts</span><br><span class="line"><span class="keyword">import</span> Health</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">let</span> projectPath <span class="operator">=</span> <span class="type">ConfigurationManager</span>.<span class="type">BasePath</span>.project.path</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">let</span> health <span class="operator">=</span> <span class="type">Health</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> router <span class="operator">=</span> <span class="type">Router</span>()</span><br><span class="line">  <span class="keyword">let</span> cloudEnv <span class="operator">=</span> <span class="type">CloudEnv</span>()</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() <span class="keyword">throws</span> &#123;</span><br><span class="line">    <span class="comment">// Run the metrics initializer</span></span><br><span class="line">    initializeMetrics(router: router)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">postInit</span>() <span class="keyword">throws</span> &#123;</span><br><span class="line">    <span class="comment">// Endpoints</span></span><br><span class="line">    initializeHealthRoutes(app: <span class="keyword">self</span>)</span><br><span class="line">    router.get(<span class="string">&quot;/&quot;</span>, handler: helloWorldHandler)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">helloWorldHandler</span>(<span class="params">request</span>: <span class="type">RouterRequest</span>, <span class="params">response</span>: <span class="type">RouterResponse</span>, <span class="params">next</span>: ()-&gt;()) &#123;</span><br><span class="line">    response.send(<span class="string">&quot;Hello, World!&quot;</span>)</span><br><span class="line">    next()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">run</span>() <span class="keyword">throws</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> postInit()</span><br><span class="line">    <span class="type">Kitura</span>.addHTTPServer(onPort: cloudEnv.port, with: router)</span><br><span class="line">    <span class="type">Kitura</span>.run()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œå</p>
<p>æ¬¢è¿é¡µï¼š<a target="_blank" rel="noopener" href="http://localhost:8090/">http://localhost:8090</a></p>
<p>å¥åº·ï¼š<a target="_blank" rel="noopener" href="http://localhost:8090/health">http://localhost:8090/health</a></p>
<p>ç›‘æ§ä»ªè¡¨æ¿ï¼š<a target="_blank" rel="noopener" href="http://localhost:8090/swiftmetrics-dash">http://localhost:8090/swiftmetrics-dash</a></p>
<p>HTTPååé‡è§†å›¾ä½¿ç”¨æ¯ç§’è¯·æ±‚ï¼ˆRPSï¼‰åº¦é‡æ ‡å‡†æ˜¾ç¤ºåœ¨ä»»ä½•æ—¶é—´ç‚¹å‘ç”Ÿçš„è¯·æ±‚é‡ã€‚</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8090/metrics">http://localhost:8090/metrics</a></p>
<p><strong>ä½¿ç”¨Dockeråœ¨Linuxä¸Šè¿è¡Œåº”ç”¨ç¨‹åº</strong></p>
<p>Dockerå’ŒKubernetesæ˜¯Kituraéƒ¨ç½²çš„æ ¸å¿ƒï¼Œå®ƒä»¬æä¾›äº†é‡è¦çš„æ€§èƒ½å’Œæ‰©å±•ä¼˜åŠ¿ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kitura build</span><br><span class="line">kitura run</span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬ä¸‰ç« ï¼šRESTful-APIs"><a href="#ç¬¬ä¸‰ç« ï¼šRESTful-APIs" class="headerlink" title="ç¬¬ä¸‰ç« ï¼šRESTful APIs"></a>ç¬¬ä¸‰ç« ï¼šRESTful APIs</h2><p>åœ¨å¼€å§‹æ„å»ºè¿™äº›RESTful APIä¹‹å‰ï¼Œå°†äº†è§£RESTful APIæœ¬èº«ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„æ¶æ„æ–¹æ³•å’Œè®¾è®¡åŸåˆ™ã€‚</p>
<h3 id="REpresentational-State-Transfer-REST"><a href="#REpresentational-State-Transfer-REST" class="headerlink" title="REpresentational State Transfer (REST)"></a>REpresentational State Transfer (REST)</h3><p>REpresentational State Transferï¼ˆRESTï¼‰æ˜¯ä¸€ç§æ¶æ„é£æ ¼æˆ–è®¾è®¡æ¨¡å¼çš„APIã€‚ å¦‚æœä¸€ä¸ªAPIç¬¦åˆRoy Fieldingåšå£«åœ¨ä»–çš„2000å¹´è®ºæ–‡â€œæ¶æ„é£æ ¼å’ŒåŸºäºç½‘ç»œçš„è½¯ä»¶æ¶æ„è®¾è®¡â€ä¸­æå‡ºçš„ä¸€ç³»åˆ—çº¦æŸï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯RESTfulã€‚</p>
<h4 id="Fieldingæå‡ºäº†ä»¥ä¸‹å…­ä¸ªé™åˆ¶ï¼š"><a href="#Fieldingæå‡ºäº†ä»¥ä¸‹å…­ä¸ªé™åˆ¶ï¼š" class="headerlink" title="Fieldingæå‡ºäº†ä»¥ä¸‹å…­ä¸ªé™åˆ¶ï¼š"></a>Fieldingæå‡ºäº†ä»¥ä¸‹å…­ä¸ªé™åˆ¶ï¼š</h4><ol>
<li>å®¢æˆ·ç«¯ - æœåŠ¡å™¨</li>
</ol>
<p>RESTful APIåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´æä¾›æ˜ç¡®çš„åˆ†ç¦»ï¼Œå…è®¸å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å½¼æ­¤ç‹¬ç«‹åœ°å¼€å‘ã€‚è¿™ç§åˆ†ç¦»ä½¿å¾—ä¸ºåŒä¸€æœåŠ¡å™¨å®ç°å¤šä¸ªå®¢æˆ·ç«¯æˆä¸ºå¯èƒ½ï¼Œå°±åƒä½ ä¸ºEmojiJournalåˆ›å»ºiOSå’ŒWebåº”ç”¨ç¨‹åºå®¢æˆ·ç«¯æ—¶æ‰€åšçš„é‚£æ ·ã€‚</p>
<ol start="2">
<li>æ— çŠ¶æ€</li>
</ol>
<p>RESTful APIåº”è¯¥æ˜¯æ— çŠ¶æ€çš„ã€‚æ¯ä¸ªè¯·æ±‚éƒ½åº”è¯¥æ˜¯è‡ªåŒ…å«çš„ï¼Œå¹¶ä¸”ä¸åº”è¯¥ä¾èµ–äºå­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šçš„å…ˆå‰è¯·æ±‚çš„ä»»ä½•ä¼šè¯ä¸Šä¸‹æ–‡ã€‚</p>
<ol start="3">
<li>å¯ç¼“å­˜</li>
</ol>
<p>ç”±äºRESTful APIæ˜¯æ— çŠ¶æ€å’Œè‡ªåŒ…å«çš„ï¼Œå› æ­¤å¯ä»¥å°†è¯·æ±‚çš„ç»“æœç¼“å­˜åˆ°RESTful APIã€‚è¿™å¯ä»¥ç”±å®¢æˆ·ç«¯æˆ–è¯¸å¦‚webä»£ç†ä¹‹ç±»çš„ä¸­ä»‹æ¥å®Œæˆã€‚</p>
<p>è®¾è®¡è‰¯å¥½çš„RESTful APIåº”è¯¥é¼“åŠ±å°½å¯èƒ½å­˜å‚¨å¯ç¼“å­˜çš„æ•°æ®ï¼Œå¯¹è¯·æ±‚çš„å“åº”è¢«éšå¼æˆ–æ˜¾å¼æ ‡è®°ä¸ºå¯ç¼“å­˜ï¼Œå¯ç¼“å­˜åˆ°ç‰¹å®šæ—¶é—´ï¼ˆexpires-atï¼‰æˆ–ä¸å¯ç¼“å­˜ã€‚</p>
<ol start="4">
<li>åˆ†å±‚ç³»ç»Ÿ</li>
</ol>
<p>RESTful APIå¯ä»¥æ˜¯åˆ†å±‚çš„ï¼Œå› æ­¤å®¢æˆ·ç«¯ä¸çŸ¥é“å®ƒæ˜¯ç›´æ¥è¿æ¥åˆ°APIæœ¬èº«è¿˜æ˜¯é€šè¿‡ä»£ç†æˆ–è´Ÿè½½å‡è¡¡å™¨é—´æ¥è¿æ¥ã€‚å¦å¤–ï¼ŒAPIæœ¬èº«å¯ä»¥ç”±æœåŠ¡å™¨ç³»ç»Ÿæœ¬èº«å†…çš„è‹¥å¹²å±‚æˆ–æºç»„æˆå’Œæ„å»ºã€‚</p>
<ol start="5">
<li>æŒ‰éœ€ä»£ç ï¼ˆå¯é€‰ï¼‰</li>
</ol>
<p>RESTful APIå¯ä»¥æä¾›å¯ä»¥ç›´æ¥åœ¨å®¢æˆ·ç«¯ä¸Šè¿è¡Œçš„åŠŸèƒ½ã€‚å®é™…ä¸Šï¼Œè¿™é€šå¸¸ä»…é™äºåœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„JavaScriptæˆ–Java Appletã€‚</p>
<ol start="6">
<li>ç»Ÿä¸€ç•Œé¢</li>
</ol>
<p>RESTful APIæœ€é‡è¦çš„æ¦‚å¿µä¹‹ä¸€æ˜¯èµ„æºçš„ä½¿ç”¨ã€‚èµ„æºå¯ä»¥æ˜¯APIå¯ä»¥æä¾›æœ‰å…³ä¿¡æ¯çš„ä»»ä½•å¯¹è±¡ï¼Œä¾‹å¦‚ä½ å°†ä½¿ç”¨çš„JournalEntryèµ„æºã€‚</p>
<h4 id="æä¾›ç»Ÿä¸€æ¥å£çš„RESTful-APIå¿…é¡»æ»¡è¶³ä»¥ä¸‹å››ä¸ªçº¦æŸï¼š"><a href="#æä¾›ç»Ÿä¸€æ¥å£çš„RESTful-APIå¿…é¡»æ»¡è¶³ä»¥ä¸‹å››ä¸ªçº¦æŸï¼š" class="headerlink" title="æä¾›ç»Ÿä¸€æ¥å£çš„RESTful APIå¿…é¡»æ»¡è¶³ä»¥ä¸‹å››ä¸ªçº¦æŸï¼š"></a>æä¾›ç»Ÿä¸€æ¥å£çš„RESTful APIå¿…é¡»æ»¡è¶³ä»¥ä¸‹å››ä¸ªçº¦æŸï¼š</h4><ul>
<li>è¯·æ±‚å¿…é¡»ç¡®å®šä»–ä»¬é‡‡å–è¡ŒåŠ¨çš„èµ„æºã€‚ </li>
<li>è¯·æ±‚å’Œå“åº”å¿…é¡»ä½¿ç”¨èµ„æºçš„è¡¨ç¤ºã€‚ </li>
<li>æ¶ˆæ¯å¿…é¡»æ˜¯è‡ªæè¿°çš„ï¼Œè‡ªåŒ…å«çš„ï¼Œå¹¶ä¸”åªèƒ½ä½¿ç”¨æ ‡å‡†æ“ä½œã€‚</li>
<li>èµ„æºå¿…é¡»é€šè¿‡é“¾æ¥è¿æ¥åˆ°å…¶ä»–èµ„æºã€‚</li>
</ul>
<p>å¦è¯·æ³¨æ„ï¼Œæ²¡æœ‰æåŠHTTPå’ŒWebè¯·æ±‚ã€‚è™½ç„¶RESTful APIæœ€å¸¸ä½¿ç”¨HTTPå®ç°ï¼Œä½†è¿™ä¸æ˜¯å¿…éœ€çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å°†ä»…ä»‹ç»å¦‚ä½•ä½¿ç”¨æ ‡å‡†HTTPæ“ä½œæ„å»ºRESTful APIï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°†ç®€è¦ä»‹ç»HTTPæœ¬èº«ã€‚</p>
<h3 id="HyperText-Transfer-Protocol-HTTP"><a href="#HyperText-Transfer-Protocol-HTTP" class="headerlink" title="HyperText Transfer Protocol (HTTP)"></a>HyperText Transfer Protocol (HTTP)</h3><p>è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆHTTPï¼‰æ˜¯ä¸€ç§å®¢æˆ·ç«¯ - æœåŠ¡å™¨ï¼ŒåŸºäºè¯·æ±‚ - å“åº”çš„åè®®ï¼Œæ˜¯ç½‘ç«™å’ŒåŸºäºWebçš„æµé‡çš„åŸºç¡€ã€‚ å› æ­¤ï¼Œå®ƒå—åˆ°å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„æ™®éæ”¯æŒã€‚</p>
<h3 id="HTTP-based-RESTful-APIs"><a href="#HTTP-based-RESTful-APIs" class="headerlink" title="HTTP-based RESTful APIs"></a>HTTP-based RESTful APIs</h3><h4 id="URLä½œä¸ºèµ„æº"><a href="#URLä½œä¸ºèµ„æº" class="headerlink" title="URLä½œä¸ºèµ„æº"></a>URLä½œä¸ºèµ„æº</h4><p>ç»Ÿä¸€æ¥å£çš„ç¬¬ä¸€ä¸ªè¦æ±‚æ˜¯è¯·æ±‚æ ‡è¯†å®ƒä»¬æ‰€ä¾èµ–çš„èµ„æºã€‚åœ¨HTTPä¸­ï¼Œè¿™æ˜¯é€šè¿‡RESTful APIä½¿ç”¨è¯·æ±‚çš„URLå®ç°çš„ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/entries</span><br></pre></td></tr></table></figure>

<h4 id="ç‰¹å®šèµ„æºçš„URLç¼–ç æ ‡è¯†ç¬¦"><a href="#ç‰¹å®šèµ„æºçš„URLç¼–ç æ ‡è¯†ç¬¦" class="headerlink" title="ç‰¹å®šèµ„æºçš„URLç¼–ç æ ‡è¯†ç¬¦"></a>ç‰¹å®šèµ„æºçš„URLç¼–ç æ ‡è¯†ç¬¦</h4><p>å°†æä¾›è¿™äº›URLä»¥ä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿä¸æ‰€æœ‰æ—¥è®°å¸åˆ†å½•å’Œç‰¹å®šæ—¥è®°å¸åˆ†å½•è¿›è¡Œäº¤äº’ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/entries </span><br><span class="line">/entries/&lt;identifier&gt;</span><br></pre></td></tr></table></figure>

<h4 id="ç”¨äºèµ„æºç»„çš„URLç¼–ç æŸ¥è¯¢å‚æ•°"><a href="#ç”¨äºèµ„æºç»„çš„URLç¼–ç æŸ¥è¯¢å‚æ•°" class="headerlink" title="ç”¨äºèµ„æºç»„çš„URLç¼–ç æŸ¥è¯¢å‚æ•°"></a>ç”¨äºèµ„æºç»„çš„URLç¼–ç æŸ¥è¯¢å‚æ•°</h4><p>ä½ å¯èƒ½è¿˜å¸Œæœ›æä¾›ä¸èµ„æºå­é›†çš„APIã€‚ è¿™å†æ¬¡é€šè¿‡URLå®Œæˆï¼Œè¿™æ¬¡ä½¿ç”¨URLæŸ¥è¯¢å‚æ•°ã€‚</p>
<p>URLæŸ¥è¯¢å‚æ•°ä»¥<code>?</code>å¼€å¤´ã€‚ ä»–ä»¬å¯ä»¥ä½¿ç”¨<code>&lt;key&gt; = &lt;value&gt;</code>æ ¼å¼çš„é”®å€¼å¯¹ä¼ é€’æœ‰å…³èµ„æºçš„ä»»ä½•å…¶ä»–ä¿¡æ¯ã€‚ å¯ä»¥ä½¿ç”¨é”®å€¼å¯¹ä¹‹é—´çš„<code>ï¼†</code>åˆ†éš”ç¬¦èšåˆå’Œä¼ é€’å¤šä¸ªé”®å€¼å¯¹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/entries </span><br><span class="line">/entries?emoji=&lt;emoji&gt;&amp;date=&lt;date&gt; </span><br><span class="line">/entries/&lt;idenfifier&gt;</span><br></pre></td></tr></table></figure>

<h4 id="åˆ†å±‚APIçš„åˆ†å±‚URL"><a href="#åˆ†å±‚APIçš„åˆ†å±‚URL" class="headerlink" title="åˆ†å±‚APIçš„åˆ†å±‚URL"></a>åˆ†å±‚APIçš„åˆ†å±‚URL</h4><p>RESTful URLä¹Ÿå¯ä»¥æ˜¯åˆ†å±‚çš„ã€‚ åœ¨ä½ çš„EmojiJournalåº”ç”¨ç¨‹åºä¸­ï¼Œä½ åªä¼šæ”¯æŒæ‹¥æœ‰å•ä¸ªEmojiJournalçš„ç”¨æˆ·ã€‚ ä½†æ˜¯ï¼Œå‡è®¾ä½ å¸Œæœ›æ”¯æŒæ‹¥æœ‰å¤šä¸ªæœŸåˆŠçš„ç”¨æˆ·ï¼Œæ¯ä¸ªæœŸåˆŠéƒ½æœ‰è‡ªå·±çš„æ—¥è®°å¸åˆ†å½•ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/journals </span><br><span class="line">/journals/&lt;identifier&gt; </span><br><span class="line">/journals/&lt;identifier&gt;/entries </span><br><span class="line">/journals/&lt;identifier&gt;/entries?emoji=&lt;emoji&gt;&amp;date=&lt;date&gt; /journals/&lt;identifier&gt;/entries/&lt;identifier&gt;</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚ï¼Œå¯¹ä»¥ä¸‹URLçš„å®¢æˆ·ç«¯è¯·æ±‚å°†ä¸æ—¥è®°2ä¸­çš„æ¡ç›®20è¿›è¡Œäº¤äº’ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/journals/2/entries/20</span><br></pre></td></tr></table></figure>

<h4 id="èµ„æºè¡¨ç¤º"><a href="#èµ„æºè¡¨ç¤º" class="headerlink" title="èµ„æºè¡¨ç¤º"></a>èµ„æºè¡¨ç¤º</h4><p>å›æƒ³ä¸€ä¸‹ï¼Œç»Ÿä¸€æ¥å£çš„ç¬¬äºŒä¸ªæ¦‚å¿µæ˜¯è¯·æ±‚å’Œå“åº”åº”è¯¥ä½¿ç”¨èµ„æºçš„è¡¨ç¤ºã€‚ è¿™æ˜¯é€šè¿‡åœ¨HTTPæ­£æ–‡æ•°æ®ä¸­ç¼–ç èµ„æºçš„è¡¨ç¤ºï¼Œåœ¨åŸºäºHTTPçš„RESTful APIä¸­å®ç°çš„ã€‚</p>
<p>HTTPæ¶ˆæ¯ï¼Œæ— è®ºæ˜¯è¯·æ±‚è¿˜æ˜¯å“åº”ï¼ŒåŸºæœ¬ä¸Šç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šä¸€ç»„æ ‡é¢˜å’Œæ­£æ–‡æ•°æ®ã€‚ ä¸ºäº†å®Œæ•´æ€§ï¼Œå“åº”è¿˜åŒ…å«ä¸€ä¸ªçŠ¶æ€ä»£ç ï¼Œç”¨äºæŠ¥å‘Šè¯·æ±‚çš„çŠ¶æ€ã€‚</p>
<h4 id="HTTPé¦–éƒ¨å’Œæ­£æ–‡æ•°æ®"><a href="#HTTPé¦–éƒ¨å’Œæ­£æ–‡æ•°æ®" class="headerlink" title="HTTPé¦–éƒ¨å’Œæ­£æ–‡æ•°æ®"></a>HTTPé¦–éƒ¨å’Œæ­£æ–‡æ•°æ®</h4><p>HTTPé¦–éƒ¨ä¸ºè¯·æ±‚å’Œå“åº”æä¾›äº†é¢å¤–çš„å…ƒæ•°æ®ã€‚ é¦–éƒ¨åœ¨è¯·æ±‚æˆ–å“åº”å¼€å§‹æ—¶ä¼ è¾“ï¼Œå¹¶å­˜å‚¨ä¸ºé”®å€¼å¯¹ï¼Œä¸€äº›é¦–éƒ¨å…è®¸å¤šä¸ªå€¼ã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨HTTPé¦–éƒ¨å­˜å‚¨ä½ å¸Œæœ›çš„ä»»ä½•å…¶ä»–ä¿¡æ¯ã€‚ ä½ åº”è¯¥äº†è§£ä¸¤ä¸ªæ­£å¼å®šä¹‰çš„æ ‡å‡†æ ‡é¢˜ï¼Œè¯·å‚é˜…<a target="_blank" rel="noopener" href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html">https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html</a>ï¼ˆç”±æ­£å¼çš„æ ¸å¿ƒRFCè§„èŒƒå®šä¹‰ï¼‰ï¼Œä»¥åŠä¸å¤ªæ­£å¼ä½†å¹¿æ³›ä½¿ç”¨çš„éæ ‡å‡†çš„é¦–éƒ¨ï¼Œè¯·å‚é˜…<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Common_non-standard_request_fields">https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Common_non-standard_request_fields</a>ã€‚</p>
<p>æ ‡å‡†å¤´ç”¨äºä¼ é€’è¯¸å¦‚Cookieï¼Œæˆæƒï¼ŒContentTypeï¼ˆæè¿°æ­£æ–‡æ•°æ®çš„åª’ä½“ç±»å‹ï¼‰å’ŒContent-Lengthï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½æè¿°æ­£æ–‡æ•°æ®é•¿åº¦ï¼‰ç­‰ä¿¡æ¯ã€‚</p>
<p>HTTPæ¶ˆæ¯æ­£æ–‡åŒ…å«ä¸è¯·æ±‚æˆ–å“åº”å…³è”çš„æ•°æ®ã€‚ åœ¨å“åº”å¯¹ç½‘é¡µçš„è¯·æ±‚çš„æƒ…å†µä¸‹ï¼Œæ­£æ–‡æ•°æ®åŒ…å«ç½‘é¡µæœ¬èº«çš„æ¥æºã€‚ çœ‹ä¸€ä¸‹å¯¹Helloï¼ŒWorldçš„è¯·æ±‚ç”Ÿæˆçš„HTTPå“åº”ï¼ ä½ åœ¨ä¸Šä¸€ç« ä¸­åˆ›å»ºçš„åº”ç”¨ç¨‹åºã€‚</p>
<h4 id="æ­£æ–‡æ•°æ®ä¸­çš„èµ„æºè¡¨ç¤º"><a href="#æ­£æ–‡æ•°æ®ä¸­çš„èµ„æºè¡¨ç¤º" class="headerlink" title="æ­£æ–‡æ•°æ®ä¸­çš„èµ„æºè¡¨ç¤º"></a>æ­£æ–‡æ•°æ®ä¸­çš„èµ„æºè¡¨ç¤º</h4><p>å¦‚å‰æ‰€è¿°ï¼ŒRESTful APIå¯¹è¿”å›çš„HTTPæ­£æ–‡æ•°æ®ä¸­çš„èµ„æºè¡¨ç¤ºè¿›è¡Œç¼–ç ã€‚ èº«ä½“é€šå¸¸ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p>
<ol>
<li>Content-Typeé¦–éƒ¨</li>
</ol>
<p>Content-Typeé¦–éƒ¨è¡¨ç¤ºç”¨äºè¡¨ç¤ºæ­£æ–‡æ•°æ®ä¸­çš„èµ„æºçš„ç¼–ç ã€‚æœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨JavaScript Object Notationï¼ˆJSONï¼‰å¯¹è¡¨ç¤ºè¿›è¡Œç¼–ç ï¼Œå¹¶å°†Content-Typeé¦–éƒ¨è®¾ç½®ä¸º<code>application/json</code>ã€‚æœ‰æ—¶ä¸RESTful APIä¸€èµ·ä½¿ç”¨çš„èº«ä½“æ•°æ®ç¼–ç çš„å…¶ä»–ç¤ºä¾‹åŒ…æ‹¬Protobufï¼ŒThriftå’ŒAvroã€‚</p>
<ol start="2">
<li>æ¥å—é¦–éƒ¨ï¼ˆä»…é™è¯·æ±‚ï¼‰</li>
</ol>
<p>æ¥å—é¦–éƒ¨æŒ‡ç¤ºå®¢æˆ·ç«¯å°†æ¥å—å“åº”çš„ç¼–ç ã€‚è¿™é€šå¸¸æ˜¯<code>application/json</code>ï¼Œä½†å®ƒä¹Ÿå¯ä»¥åŒ…å«ç¼–ç åˆ—è¡¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå®¢æˆ·ç«¯åœ¨JSONå’ŒProtobufä¸­éƒ½æ¥å—äº†å“åº”ï¼Œåˆ™æ­¤å€¼å¯èƒ½è®¾ç½®ä¸ºï¼š<code>application/json;application/protobuf</code>ã€‚</p>
<ol start="3">
<li>ç¼–ç çš„æ­£æ–‡æ•°æ®</li>
</ol>
<p>æœ€åï¼Œä½¿ç”¨Content-Typeé¦–éƒ¨ä¸­è®¾ç½®çš„ç¼–ç å°†èµ„æºæœ¬èº«ç¼–ç ä¸ºæ­£æ–‡æ•°æ®ã€‚åœ¨æœ€å¸¸è§çš„<code>application/json</code>åœºæ™¯ä¸­ï¼Œè¿™æ˜¯èµ„æºçš„JSONè¡¨ç¤ºã€‚ JSONçš„ç»†èŠ‚å–å†³äºç‰¹å®šèµ„æºçš„æ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œåœ¨æœ¬ä¹¦åé¢ç¨åï¼ŒJournalEntryçš„èµ„æºå°†åŒ…å«idï¼Œemojiå’Œdateï¼Œç±»ä¼¼äºï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">	<span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="string">&quot;1&quot;</span><span class="punctuation">,</span> </span><br><span class="line">	<span class="attr">&quot;emoji&quot;</span><span class="punctuation">:</span><span class="string">&quot;ğŸ˜Š &quot;</span><span class="punctuation">,</span> </span><br><span class="line">	<span class="attr">&quot;date&quot;</span><span class="punctuation">:</span><span class="string">&quot;2018-09-18T00:07:01Z&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="è‡ªæˆ‘æè¿°æ€§çš„ä¿¡æ¯"><a href="#è‡ªæˆ‘æè¿°æ€§çš„ä¿¡æ¯" class="headerlink" title="è‡ªæˆ‘æè¿°æ€§çš„ä¿¡æ¯"></a>è‡ªæˆ‘æè¿°æ€§çš„ä¿¡æ¯</h4><p>ä½ å·²ç»äº†è§£äº†èµ„æºçš„è¯†åˆ«å’Œè¡¨ç¤ºï¼Œä½†ä½ å¦‚ä½•å¯¹è¿™äº›èµ„æºè¿›è¡Œæ“ä½œï¼Ÿ</p>
<p>ç»Ÿä¸€æ¥å£çš„ç¬¬ä¸‰ä¸ªåŸåˆ™è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚ å®ƒè§„å®šè¯·æ±‚å’Œå“åº”éƒ½åº”è¯¥æ˜¯è‡ªæè¿°çš„ï¼Œå¹¶ä¸”å®ƒä»¬ä»…ä½¿ç”¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ½ç†è§£çš„æ ‡å‡†æ“ä½œã€‚ åœ¨åŸºäºHTMLçš„RESTful APIä¸­ï¼Œè¿™æ˜¯é€šè¿‡ä½¿ç”¨ç‰¹å®šçš„HTTPæ–¹æ³•å®ç°çš„ã€‚</p>
<p>RFC 2616æ¦‚è¿°äº†å…«ç§HTTPæ–¹æ³•ï¼šOPTIONSï¼ŒGETï¼ŒHEADï¼ŒPOSTï¼ŒPUTï¼ŒDELETEï¼ŒTRACEå’ŒCONNECTã€‚</p>
<h4 id="é€šè¿‡é“¾æ¥è¿æ¥èµ„æº"><a href="#é€šè¿‡é“¾æ¥è¿æ¥èµ„æº" class="headerlink" title="é€šè¿‡é“¾æ¥è¿æ¥èµ„æº"></a>é€šè¿‡é“¾æ¥è¿æ¥èµ„æº</h4><p>ç»Ÿä¸€æ¥å£çš„ç¬¬å››ä¸ªä¹Ÿæ˜¯æœ€åä¸€ä¸ªæ¦‚å¿µæ˜¯èµ„æºåº”è¯¥é€šè¿‡é“¾æ¥è¿æ¥åˆ°å…¶ä»–èµ„æºã€‚</p>
<p>å¦‚ä½ æ‰€è§ï¼ŒåŸºäºHTTPçš„RESTful APIä½¿ç”¨URLå’ŒåŸºäºURLçš„æ ‡è¯†ç¬¦æ¥æä¾›å¯¹èµ„æºçš„è®¿é—®å¹¶æŒ‡å®šå•ä¸ªèµ„æºã€‚ å› æ­¤ï¼Œèµ„æºä¹‹é—´çš„é“¾æ¥åªæ˜¯è¿›ä¸€æ­¥çš„RESTful URLå’Œé“¾æ¥åˆ°è¿æ¥èµ„æºçš„åŸºäºURLçš„æ ‡è¯†ç¬¦ã€‚</p>
<p>æœ‰ä¸¤ç§å¸¸è§çš„åœºæ™¯éœ€è¦URLæˆ–æ ‡è¯†èµ„æºï¼š</p>
<ul>
<li>è¯·æ±‚çš„èµ„æºå¼•ç”¨å¦ä¸€ä¸ªï¼ˆå­æˆ–ç›¸å…³ï¼‰èµ„æºã€‚</li>
<li>ä½ éœ€è¦çŸ¥é“èµ„æºçš„æ ‡è¯†ç¬¦ã€‚</li>
</ul>
<h3 id="æ„å»ºRESTful-API"><a href="#æ„å»ºRESTful-API" class="headerlink" title="æ„å»ºRESTful API"></a>æ„å»ºRESTful API</h3><p><img src="/../assets/image-20190806103823282.png" alt="image-20190806103823282"></p>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»å­¦ä¼šäº†æ‰€æœ‰åŸºç¡€çŸ¥è¯†ã€‚ å½“ä½ äº†è§£æœ‰å…³è®¾è®¡å’Œå®ç°RESTful APIçš„æ›´å¤šä¿¡æ¯æ—¶ï¼Œä½ ä¼šå‘ç°é™¤äº†æˆ‘ä»¬åœ¨æ­¤å¤„ä»‹ç»çš„èŒƒå›´ä¹‹å¤–è¿˜æœ‰å…¶ä»–æœ€ä½³å®è·µã€‚ è¿™åŒ…æ‹¬è®¾ç½®æ­£ç¡®çš„Content-Typeå’ŒAcceptsæ ‡å¤´ï¼Œä¸ºæˆåŠŸåˆ›å»ºè®¾ç½®Locationæ ‡å¤´ï¼Œå¹¶ä¸ºè¯·æ±‚ä¸­çš„ä»»ä½•æ•…éšœè®¾ç½®æ­£ç¡®çš„HTTPçŠ¶æ€ä»£ç ã€‚</p>
<p>æ­¤å¤–ï¼Œéœ€è¦å¯¹è¯·æ±‚å’Œå“åº”ä¸»ä½“è¿›è¡Œç¼–ç å’Œè§£ç ï¼Œæœ€å¸¸è§çš„æ˜¯æ¥è‡ªJSONã€‚ è¿™æ›¾ç»æ˜¯ä¸€é¡¹è‰°å·¨çš„ä»»åŠ¡ã€‚ ç”±äºå¼ºå¤§çš„Codableåè®®ï¼ŒSwiftä½¿JSONä¼˜é›…ä¸”æ— ç—›ã€‚</p>
<h2 id="ç¬¬å››ç« ï¼šCodableç®€ä»‹"><a href="#ç¬¬å››ç« ï¼šCodableç®€ä»‹" class="headerlink" title="ç¬¬å››ç« ï¼šCodableç®€ä»‹"></a>ç¬¬å››ç« ï¼šCodableç®€ä»‹</h2><p>Codableåè®®æ˜¯Swiftç¼–ç¨‹è¯­è¨€æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ã€‚ åœ¨ä¸€ä¸ªå¥å­ä¸­ï¼Œå½“ä½ æ‰©å±•å¯¹è±¡ä»¥ç¬¦åˆCodableæ—¶ï¼Œä½ å¯ä»¥ä½¿è¯¥å¯¹è±¡è‡ªåŠ¨åºåˆ—åŒ–ä¸ºä»»ä½•å¤–éƒ¨å¯è¯»æ ¼å¼ï¼Œä¾‹å¦‚JSONï¼ŒXMLæˆ–åè®®ç¼“å†²åŒºã€‚</p>
<h3 id="The-bare-necessities"><a href="#The-bare-necessities" class="headerlink" title="The bare necessities"></a>The bare necessities</h3><p>ç›´æ¥çœ‹ä¸€ä¸ªä¾‹å­</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1 Cadabe æ˜¯ä¸€ä¸ªç»„åˆçš„åè®®ï¼šDecodable &amp; Encodable</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">Song</span>: <span class="title class_">Codable</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> title: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> length: <span class="type">Int</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">enum</span> <span class="title class_">CodingKeys</span>: <span class="title class_">String</span>, <span class="title class_">CodingKey</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> title <span class="operator">=</span> <span class="string">&quot;songTitle&quot;</span></span><br><span class="line">    <span class="keyword">case</span> length <span class="operator">=</span> <span class="string">&quot;songLength&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">Animal</span>: <span class="title class_">Codable</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> age: <span class="type">Int</span>?</span><br><span class="line">  <span class="keyword">var</span> isFriendly: <span class="type">Bool</span></span><br><span class="line">  <span class="keyword">var</span> birthday: <span class="type">Date</span></span><br><span class="line">  <span class="keyword">var</span> songs: [<span class="type">Song</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2 åµŒå¥—</span></span><br><span class="line"><span class="keyword">let</span> baloo <span class="operator">=</span> <span class="type">Animal</span>(name: <span class="string">&quot;Baloo&quot;</span>,</span><br><span class="line">                   age: <span class="number">5</span>,</span><br><span class="line">                   isFriendly: <span class="literal">true</span>,</span><br><span class="line">                   birthday: <span class="type">Date</span>(),</span><br><span class="line">                   songs: [<span class="type">Song</span>(title: <span class="string">&quot;The Bare Necessities&quot;</span>, length: <span class="number">180</span>)])</span><br><span class="line"><span class="keyword">let</span> bagheera <span class="operator">=</span> <span class="type">Animal</span>(name: <span class="string">&quot;Bagheera&quot;</span>,</span><br><span class="line">                      age: <span class="literal">nil</span>,</span><br><span class="line">                      isFriendly: <span class="literal">true</span>,</span><br><span class="line">                      birthday: <span class="type">Date</span>(),</span><br><span class="line">                      songs: [<span class="type">Song</span>(title: <span class="string">&quot;Jungle&#x27;s No Place For A Boy&quot;</span>, length: <span class="number">95</span>)])</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3 å¤„ç†æ—¥æœŸæ ¼å¼ï¼Œé©¼å³°å¼ä¸è›‡å¼è½¬æ¢</span></span><br><span class="line"><span class="keyword">let</span> encoder <span class="operator">=</span> <span class="type">JSONEncoder</span>()</span><br><span class="line">encoder.keyEncodingStrategy <span class="operator">=</span> .convertToSnakeCase</span><br><span class="line">encoder.dateEncodingStrategy <span class="operator">=</span> .iso8601</span><br><span class="line"><span class="keyword">let</span> decoder <span class="operator">=</span> <span class="type">JSONDecoder</span>()</span><br><span class="line">decoder.keyDecodingStrategy <span class="operator">=</span> .convertFromSnakeCase</span><br><span class="line">decoder.dateDecodingStrategy <span class="operator">=</span> .iso8601</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="comment">// 4</span></span><br><span class="line">  <span class="keyword">let</span> encodedBaloo <span class="operator">=</span> <span class="keyword">try</span> encoder.encode(baloo)</span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">let</span> balooString <span class="operator">=</span> <span class="type">String</span>(data: encodedBaloo, encoding: .utf8) &#123;</span><br><span class="line">    <span class="built_in">print</span>(balooString)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> encodedBagheera <span class="operator">=</span> <span class="keyword">try</span> encoder.encode(bagheera)</span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">let</span> bagheeraString <span class="operator">=</span> <span class="type">String</span>(data: encodedBagheera, encoding: .utf8) &#123;</span><br><span class="line">    <span class="built_in">print</span>(bagheeraString)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 5</span></span><br><span class="line">  <span class="keyword">let</span> decodedBaloo <span class="operator">=</span> <span class="keyword">try</span> decoder.decode(<span class="type">Animal</span>.<span class="keyword">self</span>, from: encodedBaloo)</span><br><span class="line">  <span class="built_in">print</span>(decodedBaloo)</span><br><span class="line">  <span class="keyword">let</span> decodedBagheera <span class="operator">=</span> <span class="keyword">try</span> decoder.decode(<span class="type">Animal</span>.<span class="keyword">self</span>, from: encodedBagheera)</span><br><span class="line">  <span class="built_in">print</span>(decodedBagheera)</span><br><span class="line">&#125; <span class="keyword">catch</span> <span class="keyword">let</span> error &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Error occurred: <span class="subst">\(error.localizedDescription)</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬äº”ç« ï¼šCodable-Routing"><a href="#ç¬¬äº”ç« ï¼šCodable-Routing" class="headerlink" title="ç¬¬äº”ç« ï¼šCodable Routing"></a>ç¬¬äº”ç« ï¼šCodable Routing</h2><p>Codable Routingæ”¯æŒä»¥å®Œå…¨ç±»å‹å®‰å…¨çš„æ–¹å¼åœ¨ä½ çš„åº”ç”¨ç¨‹åºçš„ç»“æ„å’Œç±»ä»¥åŠHTTPè¯·æ±‚å’Œå“åº”ä¸­ä½¿ç”¨çš„æ­£æ–‡æ•°æ®ä¹‹é—´è‡ªåŠ¨è½¬æ¢ã€‚ å®ƒå¤§å¤§å‡å°‘äº†æ„å»ºè·¯ç”±å¤„ç†ç¨‹åºæ—¶éœ€è¦ç¼–å†™çš„ä»£ç ï¼Œå¹¶ä½¿Kituraèƒ½å¤Ÿä»£è¡¨ä½ æ‰§è¡Œæ•°æ®éªŒè¯å’Œé”™è¯¯å¤„ç†ã€‚</p>
<p>çœ‹Modelå’ŒRouteçš„å®ç°ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">JournalEntry</span>: <span class="title class_">Codable</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> id: <span class="type">String</span>?</span><br><span class="line">  <span class="keyword">var</span> emoji: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> date: <span class="type">Date</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> LoggerAPI</span><br><span class="line"><span class="keyword">import</span> Kitura</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> entries: [<span class="type">JournalEntry</span>] <span class="operator">=</span> []</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">initializeEntryRoutes</span>(<span class="params">app</span>: <span class="type">App</span>) &#123;</span><br><span class="line">  app.router.get(<span class="string">&quot;/entries&quot;</span>, handler: getAllEntries)</span><br><span class="line">  app.router.post(<span class="string">&quot;/entries&quot;</span>, handler: addEntry)</span><br><span class="line">  app.router.delete(<span class="string">&quot;/entries&quot;</span>, handler: deleteEntry)</span><br><span class="line">  <span class="type">Log</span>.info(<span class="string">&quot;Journal entry routes created&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">addEntry</span>(<span class="params">entry</span>: <span class="type">JournalEntry</span>, <span class="params">completion</span>: <span class="keyword">@escaping</span> (<span class="type">JournalEntry</span>?, <span class="type">RequestError</span>?) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> storedEntry <span class="operator">=</span> entry</span><br><span class="line">  storedEntry.id <span class="operator">=</span> entries.count.value</span><br><span class="line">  entries.append(storedEntry)</span><br><span class="line">  completion(storedEntry, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">getAllEntries</span>(<span class="params">completion</span>: <span class="keyword">@escaping</span> ([<span class="type">JournalEntry</span>]<span class="operator">?</span>, <span class="type">RequestError</span>?) -&gt; <span class="type">Void</span>) -&gt; <span class="type">Void</span> &#123;</span><br><span class="line">  completion(entries, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">deleteEntry</span>(<span class="params">id</span>: <span class="type">String</span>, <span class="params">completion</span>: <span class="keyword">@escaping</span> (<span class="type">RequestError</span>?) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">  <span class="keyword">guard</span> <span class="keyword">let</span> index <span class="operator">=</span> entries.index(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> id &#125;) <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> completion(.notFound)</span><br><span class="line">  &#125;</span><br><span class="line">  entries.remove(at: index)</span><br><span class="line">  completion(<span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Codable Routingçš„ä¸€ä¸ªç‹¬ç‰¹åŠŸèƒ½æ˜¯å®ƒåªéœ€è¦ä½ åœ¨å¤„ç†å‡½æ•°ä¸­å®šä¹‰ä½ å¸Œæœ›ä»è¯·æ±‚ä¸­æ¥æ”¶çš„å€¼ï¼Œä»¥åŠä½ å°†é€šè¿‡å®Œæˆå¤„ç†ç¨‹åºæ·»åŠ åˆ°å“åº”ä¸­çš„å€¼ã€‚</p>
<blockquote>
<p>ç›®å‰ï¼ŒKituraä»…æ”¯æŒä»<code>application/json</code>è§£ç ã€‚ è¿™æ„å‘³ç€ï¼Œå®é™…ä¸Šï¼ŒContent-Typeå½“å‰å¿…é¡»å§‹ç»ˆè®¾ç½®ä¸º<code>application/json</code>ã€‚ ä½†æ˜¯ï¼ŒKituraå›¢é˜Ÿè®¡åˆ’åœ¨å³å°†å‘å¸ƒçš„ç‰ˆæœ¬ä¸­æ”¯æŒå…¶ä»–ç¼–ç ç±»å‹ã€‚</p>
</blockquote>
<h2 id="ç¬¬å…­ç« ï¼šOpenAPIè§„èŒƒ"><a href="#ç¬¬å…­ç« ï¼šOpenAPIè§„èŒƒ" class="headerlink" title="ç¬¬å…­ç« ï¼šOpenAPIè§„èŒƒ"></a>ç¬¬å…­ç« ï¼šOpenAPIè§„èŒƒ</h2><h3 id="Swaggerçš„ç›®æ ‡"><a href="#Swaggerçš„ç›®æ ‡" class="headerlink" title="Swaggerçš„ç›®æ ‡"></a>Swaggerçš„ç›®æ ‡</h3><p>åœ¨Tony Tamå¼€åˆ›æ€§çš„å¼€æºé¡¹ç›®çš„åŸºç¡€ä¸Šï¼Œå…¶ä»–å…¬å¸å¼€å§‹åšå‡ºè´¡çŒ®ã€‚ æœ€ç»ˆï¼ŒLinuxåŸºé‡‘ä¼šæ‰¿æ‹…äº†è¯¥é¡¹ç›®çš„èµåŠ©ï¼Œå¹¶å°†å…¶åç§°æ›´æ”¹ä¸ºOpenAPI Initiativeã€‚ è¿™ç§å¹¿æ³›çš„æ”¯æŒä½¿OpenAPIè§„èŒƒåœ¨å¼€æºè½¯ä»¶å¼€å‘ä¸­å æ®äº†éå¸¸çªå‡ºçš„ä½ç½®ã€‚</p>
<p>å½“Tonyå¼€å§‹ç ”ç©¶Swagger APIé¡¹ç›®æ—¶ï¼Œä»–ç¡®å®šäº†ä¸‰ä¸ªå…³é”®ç›®æ ‡ï¼š</p>
<ul>
<li>APIå¼€å‘</li>
<li>APIæ–‡æ¡£</li>
<li>APIäº¤äº’</li>
</ul>
<h3 id="ç”Ÿæˆä½ çš„è§„æ ¼"><a href="#ç”Ÿæˆä½ çš„è§„æ ¼" class="headerlink" title="ç”Ÿæˆä½ çš„è§„æ ¼"></a>ç”Ÿæˆä½ çš„è§„æ ¼</h3><p>é€šè¿‡æ·»åŠ <code>Kitura-OpenAPI</code>ä¾èµ–</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.package(url: <span class="string">&quot;https://github.com/IBM-Swift/Kitura-OpenAPI.git&quot;</span>, from: <span class="string">&quot;1.1.1&quot;</span>),</span><br></pre></td></tr></table></figure>

<p> è¿è¡Œå</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8080/openapi">http://localhost:8080/openapi</a></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;schemes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;http&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;swagger&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;info&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;title&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Kitura Project&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Generated by Kitura&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;paths&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;\/entries&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;get&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;responses&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;200&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;schema&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;type&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;array&quot;</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;items&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;$ref&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;#\/definitions\/JournalEntry&quot;</span></span><br><span class="line">              <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;successful response&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;consumes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;produces&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;post&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;consumes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;produces&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;responses&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;200&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;schema&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;$ref&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;#\/definitions\/JournalEntry&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;successful response&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;parameters&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;in&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;body&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;input&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;required&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;schema&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;$ref&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;#\/definitions\/JournalEntry&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;\/health&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;get&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;responses&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;200&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;schema&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;$ref&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;#\/definitions\/Status&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;successful response&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;consumes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;produces&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;\/entries\/&#123;id&#125;&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;delete&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;consumes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;produces&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;responses&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;200&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;successful response&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;parameters&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;in&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;path&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;id&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;required&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;basePath&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;\/&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;definitions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;JournalEntry&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;object&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;required&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;date&quot;</span><span class="punctuation">,</span><span class="string">&quot;emoji&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;emoji&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;number&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Status&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;object&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;required&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;status&quot;</span><span class="punctuation">,</span><span class="string">&quot;details&quot;</span><span class="punctuation">,</span><span class="string">&quot;timestamp&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;details&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;items&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;array&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;timestamp&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>æ­¤ä»£ç æ®µçš„é¡¶éƒ¨è¡¨ç¤ºä½ æ­£åœ¨æŸ¥çœ‹è·¯å¾„<code>/entries</code>çš„GETè·¯ç”±ã€‚ ä¸‰ä¸ªå­èŠ‚ç‚¹æè¿°äº†è¿™æ¡è·¯çº¿ï¼š</p>
<ul>
<li><p>â€œresponsesâ€æä¾›ç”¨æˆ·å¯ä»¥æ¥æ”¶çš„ä¸€ç³»åˆ—å“åº”ã€‚</p>
</li>
<li><p>â€œconsumesâ€æŒ‡å®šå¿…é¡»ç»™å‡ºæ­¤æ–¹æ³•çš„æ•°æ®ç±»å‹ã€‚</p>
</li>
<li><p>â€œproducesâ€æè¿°å“åº”å°†åŒ…å«çš„æ•°æ®ç±»å‹ã€‚</p>
</li>
</ul>
<h3 id="ä½¿ç”¨Kitura-OpenAPI-UI"><a href="#ä½¿ç”¨Kitura-OpenAPI-UI" class="headerlink" title="ä½¿ç”¨Kitura OpenAPI UI"></a>ä½¿ç”¨Kitura OpenAPI UI</h3><p>åŒæ­¥ç”Ÿæˆçš„è¿˜æœ‰UIè°ƒè¯•ç•Œé¢</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8080/openapi/ui">http://localhost:8080/openapi/ui</a></p>
<p><img src="https://gewill.org/assets/image-20190807140446505.png" alt="image-20190807140446505"></p>
<p>è¿™å¯¹äºä½ éœ€è¦è¿›è¡Œå¿«é€Ÿè€Œè‚®è„çš„æµ‹è¯•çš„æƒ…å†µéå¸¸æœ‰ç”¨ - æˆ–è€…å¦‚æœä½ æ— æ³•è®©é¡½å›ºçš„é˜Ÿå‹ç›¸ä¿¡è¿™ä¸ªæ¨¡å—çœŸçš„æœ‰ç”¨ï¼</p>
<h3 id="ä¸ºä½ çš„iOSåº”ç”¨ç”ŸæˆSDK"><a href="#ä¸ºä½ çš„iOSåº”ç”¨ç”ŸæˆSDK" class="headerlink" title="ä¸ºä½ çš„iOSåº”ç”¨ç”ŸæˆSDK"></a>ä¸ºä½ çš„iOSåº”ç”¨ç”ŸæˆSDK</h3><p>ç»ˆç«¯è¿è¡Œï¼Œå³å¯ç”ŸæˆSDKï¼Œä¸€ä¸ªåŠŸèƒ½é½å…¨çš„Swift SDKï¼Œå¯ä»¥å¤„ç†ä¸æ­¤ç‰¹å®šæœåŠ¡å™¨çš„æ‰€æœ‰ç½‘ç»œé€šä¿¡ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker pull swaggerapi/swagger-codegen-cli</span><br><span class="line">docker run --<span class="built_in">rm</span> -v <span class="variable">$&#123;PWD&#125;</span>:/local swaggerapi/swagger-codegen-cli langs</span><br><span class="line"><span class="built_in">mkdir</span> GeneratedSDK </span><br><span class="line"><span class="built_in">touch</span> specification.json </span><br><span class="line">//  å¤åˆ¶http://localhost:8080/openapiçš„å†…å®¹åˆ°specification.json</span><br><span class="line">docker run --<span class="built_in">rm</span> -v <span class="variable">$&#123;PWD&#125;</span>:/local swaggerapi/swagger-codegen-cli generate -i /local/specification.json -l swift -o /local/GeneratedSDK</span><br></pre></td></tr></table></figure>

<p>åœ¨å®è·µä¸­ï¼Œè¿™ä¸ä»…å¯ä»¥èŠ‚çœæ—¶é—´å¹¶è®©ä½ å¿«é€Ÿå¯åŠ¨å’Œè¿è¡Œï¼Œè¿˜å¯ä»¥èŠ‚çœé”™è¯¯ï¼Œå¹¶ä¸”å¯¹äºé‚£äº›æ²¡æœ‰ï¼ˆå–˜æ°”ï¼‰åœ¨Swiftå·¥ä½œçš„äººæ¥è¯´å°¤å…¶æœ‰ç”¨ï¼</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/08/01/Data-Structures-and-Algorithms-in-Swift-Notes-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/08/01/Data-Structures-and-Algorithms-in-Swift-Notes-1/" class="post-title-link" itemprop="url">Swiftæ•°æ®ç»“æ„å’Œç®—æ³•ï¼ˆä¸€ï¼‰</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-08-01 14:59:59" itemprop="dateCreated datePublished" datetime="2019-08-01T14:59:59+08:00">2019-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="ç¬¬ä¸€éƒ¨åˆ†ï¼šå¼•è¨€"><a href="#ç¬¬ä¸€éƒ¨åˆ†ï¼šå¼•è¨€" class="headerlink" title="ç¬¬ä¸€éƒ¨åˆ†ï¼šå¼•è¨€"></a>ç¬¬ä¸€éƒ¨åˆ†ï¼šå¼•è¨€</h2><h3 id="ç¬¬ä¸€ç« ï¼šå‰è¨€"><a href="#ç¬¬ä¸€ç« ï¼šå‰è¨€" class="headerlink" title="ç¬¬ä¸€ç« ï¼šå‰è¨€"></a>ç¬¬ä¸€ç« ï¼šå‰è¨€</h3><p>æ•°æ®ç»“æ„æ˜¯ä¸€é—¨ç»è¿‡å……åˆ†ç ”ç©¶çš„å­¦ç§‘ï¼Œå…¶æ¦‚å¿µä¸è¯­è¨€æ— å…³; æ¥è‡ªCçš„æ•°æ®ç»“æ„åœ¨åŠŸèƒ½ä¸Šå’Œæ¦‚å¿µä¸Šä¸ä»»ä½•å…¶ä»–è¯­è¨€ä¸­çš„ç›¸åŒæ•°æ®ç»“æ„ç›¸åŒï¼Œä¾‹å¦‚Swiftã€‚ ä¸æ­¤åŒæ—¶ï¼ŒSwiftçš„é«˜çº§è¡¨ç°åŠ›ä½¿å…¶æˆä¸ºå­¦ä¹ è¿™äº›æ ¸å¿ƒæ¦‚å¿µçš„ç†æƒ³é€‰æ‹©ï¼Œè€Œä¸ä¼šç‰ºç‰²å¤ªå¤šçš„æ€§èƒ½ã€‚</p>
<p>Swiftæ ‡å‡†åº“æœ‰ä¸€å°ç»„é€šç”¨é›†åˆç±»å‹; ä»–ä»¬ç”šè‡³æ²¡æœ‰æ¶µç›–æ¯ä¸€ä¸ªæ¡ˆä¾‹ã€‚æ­£å¦‚æ‚¨å°†çœ‹åˆ°çš„ï¼Œè¿™äº› åŸå§‹çš„ç±»å‹å¯ä»¥ç”¨ä½œæ„å»ºæ›´å¤æ‚å’Œç‰¹æ®Šç”¨é€”æ„é€ çš„ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚ äº†è§£æ¯”æ ‡å‡†æ•°ç»„å’Œå­—å…¸æ›´å¤šçš„æ•°æ®ç»“æ„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ›´å¤šçš„å·¥å…·æ¥æ„å»ºè‡ªå·±çš„åº”ç”¨ç¨‹åºã€‚</p>
<h3 id="ç¬¬äºŒç« ï¼šSwiftæ ‡å‡†åº“"><a href="#ç¬¬äºŒç« ï¼šSwiftæ ‡å‡†åº“" class="headerlink" title="ç¬¬äºŒç« ï¼šSwiftæ ‡å‡†åº“"></a>ç¬¬äºŒç« ï¼šSwiftæ ‡å‡†åº“</h3><p>åœ¨å¼€å§‹æ„å»ºè‡ªå·±çš„è‡ªå®šä¹‰æ•°æ®ç»“æ„ä¹‹å‰ï¼Œäº†è§£Swiftæ ‡å‡†åº“å·²ç»æä¾›çš„ä¸»è¦æ•°æ®ç»“æ„éå¸¸é‡è¦ã€‚</p>
<p>å­—å…¸ç¼ºä¹æ˜ç¡®çš„æ’åºåŠ£åŠ¿ï¼Œå´åˆå¸¦æ¥äº†ä¸€äº›å…¶ä»–çš„ä¼˜ç‚¹ã€‚ ä¸æ•°ç»„ä¸åŒï¼Œå­—å…¸ä¸éœ€è¦æ‹…å¿ƒå…ƒç´ çš„è½¬ç§»ã€‚ æ’å…¥å­—å…¸æ€»æ˜¯O(1)ã€‚ æŸ¥æ‰¾æ“ä½œä¹Ÿåœ¨O(1)æ—¶é—´å†…å®Œæˆï¼Œè¿™æ¯”åœ¨éœ€è¦O(n)æ‰«æçš„æ•°ç»„ä¸­æ‰¾åˆ°ç‰¹å®šå…ƒç´ è¦å¿«å¾—å¤šã€‚</p>
<h3 id="ç¬¬ä¸‰ç« ï¼šå¤æ‚åº¦"><a href="#ç¬¬ä¸‰ç« ï¼šå¤æ‚åº¦" class="headerlink" title="ç¬¬ä¸‰ç« ï¼šå¤æ‚åº¦"></a>ç¬¬ä¸‰ç« ï¼šå¤æ‚åº¦</h3><p>å¸¸è§çš„æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦ã€‚</p>
<p>å¯¹äºè®¡ç®—æœºï¼Œç®—æ³•çš„èµ„æºæ˜¯å†…å­˜ã€‚ç©ºé—´å¤æ‚åº¦å°±æ„å‘³ç€å†…å­˜å ç”¨ç‡ã€‚</p>
<p><strong>æ€»ç»“</strong></p>
<ul>
<li><p>æ—¶é—´å¤æ‚åº¦è¡¡é‡è¾“å…¥å¤§å°å¢åŠ æ—¶è¿è¡Œç®—æ³•æ‰€éœ€çš„æ—¶é—´ã€‚</p>
</li>
<li><p>ç©ºé—´å¤æ‚åº¦è¡¡é‡ç®—æ³•è¿è¡Œæ‰€éœ€çš„èµ„æºã€‚</p>
</li>
<li><p>Big Oè¡¨ç¤ºæ³•ç”¨äºè¡¨ç¤ºæ—¶é—´å’Œç©ºé—´å¤æ‚æ€§çš„ä¸€èˆ¬å½¢å¼ã€‚</p>
</li>
<li><p>æ—¶é—´å’Œç©ºé—´å¤æ‚æ€§æ˜¯å¯æ‰©å±•æ€§çš„é«˜çº§åº¦é‡; å®ƒä»¬ä¸æµ‹é‡ç®—æ³•æœ¬èº«çš„å®é™…é€Ÿåº¦ã€‚</p>
</li>
<li><p>å¯¹äºå°å‹æ•°æ®é›†ï¼Œæ—¶é—´å¤æ‚åº¦é€šå¸¸æ— å…³ç´§è¦ã€‚ æ‹Ÿçº¿æ€§ç®—æ³•å¯èƒ½æ¯”çº¿æ€§ç®—æ³•æ…¢ã€‚</p>
</li>
</ul>
<h2 id="ç¬¬äºŒéƒ¨åˆ†ï¼šåŸºæœ¬æ•°æ®ç±»å‹"><a href="#ç¬¬äºŒéƒ¨åˆ†ï¼šåŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="ç¬¬äºŒéƒ¨åˆ†ï¼šåŸºæœ¬æ•°æ®ç±»å‹"></a>ç¬¬äºŒéƒ¨åˆ†ï¼šåŸºæœ¬æ•°æ®ç±»å‹</h2><h3 id="ç¬¬å››ç« ï¼šé“¾è¡¨"><a href="#ç¬¬å››ç« ï¼šé“¾è¡¨" class="headerlink" title="ç¬¬å››ç« ï¼šé“¾è¡¨"></a>ç¬¬å››ç« ï¼šé“¾è¡¨</h3><p>é“¾è¡¨æ˜¯ä»¥çº¿æ€§å•å‘åºåˆ—æ’åˆ—çš„å€¼çš„é›†åˆã€‚é“¾è¡¨æ¯”è¿ç»­å­˜å‚¨é€‰é¡¹ï¼ˆå¦‚Swiftæ•°ç»„ï¼‰å…·æœ‰å‡ ä¸ªç†è®ºä¸Šçš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li>ä»åˆ—è¡¨å‰é¢æ’å…¥å’Œåˆ é™¤æ’å®šæ—¶é—´ã€‚</li>
<li>å¯é çš„æ€§èƒ½ç‰¹å¾ã€‚</li>
</ul>
<p><img src="https://gewill.org/assets/image-20190801154442688.png" alt="image-20190801154442688"></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œé“¾è¡¨æ˜¯ä¸€ç³»åˆ—èŠ‚ç‚¹ã€‚ èŠ‚ç‚¹æœ‰ä¸¤ä¸ªèŒè´£ï¼š</p>
<p>1.ä¿å­˜ä¸€ä¸ªå€¼ã€‚</p>
<p>2.ä¿å­˜å¯¹ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„å¼•ç”¨ã€‚ ç©ºè¡¨ç¤ºåˆ—è¡¨çš„ç»“å°¾ã€‚<img src="https://gewill.org/assets/image-20190801154554314.png" alt="image-20190801154554314"></p>
<p>èŠ‚ç‚¹</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;<span class="title class_">Value</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> value: <span class="type">Value</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> next: <span class="type">Node</span>?</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">value</span>: <span class="type">Value</span>, <span class="params">next</span>: <span class="type">Node</span>? <span class="operator">=</span> <span class="literal">nil</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.value <span class="operator">=</span> value</span><br><span class="line">    <span class="keyword">self</span>.next <span class="operator">=</span> next</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é“¾è¡¨</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">LinkedList</span>&lt;<span class="title class_">Value</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> head: <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;?</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> tail: <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;?</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> head <span class="operator">==</span> <span class="literal">nil</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// MARK: - å¢åŠ å’Œåˆ é™¤èŠ‚ç‚¹çš„æ–¹æ³•</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// æ—¶é—´å¤æ‚åº¦ï¼šO(1)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">push</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">Value</span>) &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    head <span class="operator">=</span> <span class="type">Node</span>(value: value, next: head)</span><br><span class="line">    <span class="keyword">if</span> tail <span class="operator">==</span> <span class="literal">nil</span> &#123;</span><br><span class="line">      tail <span class="operator">=</span> head</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ—¶é—´å¤æ‚åº¦ï¼šO(1)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">append</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">Value</span>) &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    <span class="keyword">guard</span> <span class="operator">!</span>isEmpty <span class="keyword">else</span> &#123;</span><br><span class="line">      push(value)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    tail<span class="operator">!</span>.next <span class="operator">=</span> <span class="type">Node</span>(value: value)</span><br><span class="line">    tail <span class="operator">=</span> tail<span class="operator">!</span>.next</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ—¶é—´å¤æ‚åº¦ï¼šO(i) , i å°±æ˜¯ç»™å®šçš„index</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">node</span>(<span class="params">at</span> <span class="params">index</span>: <span class="type">Int</span>) -&gt; <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;? &#123;</span><br><span class="line">    <span class="keyword">var</span> currentNode <span class="operator">=</span> head</span><br><span class="line">    <span class="keyword">var</span> currentIndex <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> currentNode <span class="operator">!=</span> <span class="literal">nil</span> <span class="operator">&amp;&amp;</span> currentIndex <span class="operator">&lt;</span> index &#123;</span><br><span class="line">      currentNode <span class="operator">=</span> currentNode<span class="operator">!</span>.next</span><br><span class="line">      currentIndex <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> currentNode</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// æ—¶é—´å¤æ‚åº¦ï¼šO(1)</span></span><br><span class="line">  <span class="keyword">@discardableResult</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">insert</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">Value</span>, <span class="params">after</span> <span class="params">node</span>: <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;) -&gt; <span class="type">Node</span>&lt;<span class="type">Value</span>&gt; &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    <span class="keyword">guard</span> tail <span class="operator">!==</span> node <span class="keyword">else</span> &#123;</span><br><span class="line">      append(value)</span><br><span class="line">      <span class="keyword">return</span> tail<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line">    node.next <span class="operator">=</span> <span class="type">Node</span>(value: value, next: node.next)</span><br><span class="line">    <span class="keyword">return</span> node.next<span class="operator">!</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ—¶é—´å¤æ‚åº¦ï¼šO(1)  </span></span><br><span class="line">  <span class="keyword">@discardableResult</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">pop</span>() -&gt; <span class="type">Value</span>? &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    <span class="keyword">defer</span> &#123;</span><br><span class="line">      head <span class="operator">=</span> head<span class="operator">?</span>.next</span><br><span class="line">      <span class="keyword">if</span> isEmpty &#123;</span><br><span class="line">        tail <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head<span class="operator">?</span>.value</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// æ—¶é—´å¤æ‚åº¦ï¼šO(n)</span></span><br><span class="line">  <span class="keyword">@discardableResult</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">removeLast</span>() -&gt; <span class="type">Value</span>? &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> head <span class="operator">=</span> head <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">guard</span> head.next <span class="operator">!=</span> <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> pop()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> prev <span class="operator">=</span> head</span><br><span class="line">    <span class="keyword">var</span> current <span class="operator">=</span> head</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> next <span class="operator">=</span> current.next &#123;</span><br><span class="line">      prev <span class="operator">=</span> current</span><br><span class="line">      current <span class="operator">=</span> next</span><br><span class="line">    &#125;</span><br><span class="line">    prev.next <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">    tail <span class="operator">=</span> prev</span><br><span class="line">    <span class="keyword">return</span> current.value</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ—¶é—´å¤æ‚åº¦ï¼šO(1)  </span></span><br><span class="line">  <span class="keyword">@discardableResult</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">remove</span>(<span class="params">after</span> <span class="params">node</span>: <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;) -&gt; <span class="type">Value</span>? &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    <span class="keyword">defer</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> node.next <span class="operator">===</span> tail &#123;</span><br><span class="line">        tail <span class="operator">=</span> node</span><br><span class="line">      &#125;</span><br><span class="line">      node.next <span class="operator">=</span> node.next<span class="operator">?</span>.next</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> node.next<span class="operator">?</span>.value</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// MARK: - å®ç°å€¼ç±»å‹å’Œå†™å…¥æ—¶å¤åˆ¶</span></span><br><span class="line">  <span class="comment">//ä½¿ç”¨COWå®ç°ä»·å€¼è¯­ä¹‰çš„ç­–ç•¥éå¸¸ç®€å•ã€‚åœ¨æ”¹å˜é“¾æ¥åˆ—è¡¨çš„å†…å®¹ä¹‹å‰ï¼Œæ‚¨å¸Œæœ›æ‰§è¡Œåº•å±‚å­˜å‚¨çš„å‰¯æœ¬å¹¶å°†æ‰€æœ‰å¼•ç”¨ï¼ˆå¤´éƒ¨å’Œå°¾éƒ¨ï¼‰æ›´æ–°ä¸ºæ–°å‰¯æœ¬ã€‚</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">copyNodes</span>() &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="operator">!</span><span class="built_in">isKnownUniquelyReferenced</span>(<span class="operator">&amp;</span>head) <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">var</span> oldNode <span class="operator">=</span> head <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    head <span class="operator">=</span> <span class="type">Node</span>(value: oldNode.value)</span><br><span class="line">    <span class="keyword">var</span> newNode <span class="operator">=</span> head</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> nextOldNode <span class="operator">=</span> oldNode.next &#123;</span><br><span class="line">      newNode<span class="operator">!</span>.next <span class="operator">=</span> <span class="type">Node</span>(value: nextOldNode.value)</span><br><span class="line">      newNode <span class="operator">=</span> newNode<span class="operator">!</span>.next</span><br><span class="line">      oldNode <span class="operator">=</span> nextOldNode</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    tail <span class="operator">=</span> newNode</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - å®ç°Swiftçš„Collectionåè®®</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Swift Collectionè¿˜å…è®¸é€šè¿‡ä¸‹æ ‡è¿›è¡Œè®¿é—®ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æœ¯è¯­ï¼Œç”¨äºè¡¨ç¤ºç´¢å¼•å¯ä»¥æ˜ å°„åˆ°é›†åˆä¸­çš„å€¼ã€‚</span></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">LinkedList</span>: <span class="title class_">Collection</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">Index</span>: <span class="title class_">Comparable</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> node: <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;?</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">==</span>(<span class="params">lhs</span>: <span class="type">Index</span>, <span class="params">rhs</span>: <span class="type">Index</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">      <span class="keyword">switch</span> (lhs.node, rhs.node) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="keyword">let</span> (left<span class="operator">?</span>, right<span class="operator">?</span>):</span><br><span class="line">        <span class="keyword">return</span> left.next <span class="operator">===</span> right.next</span><br><span class="line">      <span class="keyword">case</span> (<span class="literal">nil</span>, <span class="literal">nil</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">&lt;</span>(<span class="params">lhs</span>: <span class="type">Index</span>, <span class="params">rhs</span>: <span class="type">Index</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">      <span class="keyword">guard</span> lhs <span class="operator">!=</span> rhs <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">let</span> nodes <span class="operator">=</span> <span class="built_in">sequence</span>(first: lhs.node) &#123; <span class="variable">$0</span><span class="operator">?</span>.next &#125;</span><br><span class="line">      <span class="keyword">return</span> nodes.contains &#123; <span class="variable">$0</span> <span class="operator">===</span> rhs.node &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> startIndex: <span class="type">Index</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Index</span>(node: head)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> endIndex: <span class="type">Index</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Index</span>(node: tail<span class="operator">?</span>.next)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">index</span>(<span class="params">after</span> <span class="params">i</span>: <span class="type">Index</span>) -&gt; <span class="type">Index</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Index</span>(node: i.node<span class="operator">?</span>.next)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">subscript</span>(<span class="params">position</span>: <span class="type">Index</span>) -&gt; <span class="type">Value</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> position.node<span class="operator">!</span>.value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>å…³é”®ç‚¹</strong></p>
<ul>
<li>é“¾æ¥åˆ—è¡¨æ˜¯çº¿æ€§å’Œå•å‘çš„ã€‚ åªè¦å°†å¼•ç”¨ä»ä¸€ä¸ªèŠ‚ç‚¹ç§»åŠ¨åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±æ— æ³•è¿”å›ã€‚</li>
<li>é“¾æ¥åˆ—è¡¨çš„å¤´éƒ¨ç¬¬ä¸€æ¬¡æ’å…¥å…·æœ‰O(1)æ—¶é—´å¤æ‚åº¦ã€‚ å¯¹äºå¤´éƒ¨ç¬¬ä¸€æ¬¡æ’å…¥ï¼Œæ•°ç»„æœ‰O(n)æ—¶é—´å¤æ‚åº¦ã€‚</li>
<li>ç¬¦åˆSwiftæ”¶é›†åè®®ï¼ˆå¦‚åºåˆ—å’Œé›†åˆï¼‰ï¼Œå¯ä¸ºç›¸å½“å°‘çš„è¦æ±‚æä¾›ä¸€ç³»åˆ—æœ‰ç”¨çš„æ–¹æ³•ã€‚</li>
<li>å†™æ—¶å¤åˆ¶è¡Œä¸ºä½¿æ‚¨å¯ä»¥å®ç°å€¼è¯­ä¹‰ã€‚</li>
</ul>
<h3 id="ç¬¬äº”ç« ï¼šé“¾è¡¨æŒ‘æˆ˜"><a href="#ç¬¬äº”ç« ï¼šé“¾è¡¨æŒ‘æˆ˜" class="headerlink" title="ç¬¬äº”ç« ï¼šé“¾è¡¨æŒ‘æˆ˜"></a>ç¬¬äº”ç« ï¼šé“¾è¡¨æŒ‘æˆ˜</h3><h4 id="é€†åºæ‰“å°æ‰€æœ‰èŠ‚ç‚¹å…ƒç´ "><a href="#é€†åºæ‰“å°æ‰€æœ‰èŠ‚ç‚¹å…ƒç´ " class="headerlink" title="é€†åºæ‰“å°æ‰€æœ‰èŠ‚ç‚¹å…ƒç´ "></a>é€†åºæ‰“å°æ‰€æœ‰èŠ‚ç‚¹å…ƒç´ </h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">printInReverse</span>&lt;<span class="type">T</span>&gt;(<span class="keyword">_</span> <span class="params">list</span>: <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;) &#123;</span><br><span class="line">  <span class="comment">//å·§å¦™çš„é€’å½’ï¼šå…ˆè¿­ä»£åæ‰“å°ï¼Œè¿™æ ·æ‰“å°çš„å°±æ˜¯é€†åºäº†</span></span><br><span class="line">  printInReverse(list.head)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">printInReverse</span>&lt;<span class="type">T</span>&gt;(<span class="keyword">_</span> <span class="params">node</span>: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?) &#123;</span><br><span class="line">  <span class="keyword">guard</span> <span class="keyword">let</span> node <span class="operator">=</span> node <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">  printInReverse(node.next)</span><br><span class="line">  <span class="built_in">print</span>(node.value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å–ä¸­é—´èŠ‚ç‚¹"><a href="#å–ä¸­é—´èŠ‚ç‚¹" class="headerlink" title="å–ä¸­é—´èŠ‚ç‚¹"></a>å–ä¸­é—´èŠ‚ç‚¹</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">getMiddle</span>&lt;<span class="type">T</span>&gt;(<span class="keyword">_</span> <span class="params">list</span>: <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;) -&gt; <span class="type">Node</span>&lt;<span class="type">T</span>&gt;? &#123;</span><br><span class="line">  	<span class="comment">//ä¸¤ä¸ªæ­¥é•¿å·®ä¸€å€ï¼Œè¿™æ ·å¿«çš„éå†åˆ°ç»ˆç‚¹ï¼Œæ…¢çš„åˆšå¥½åˆ°ä¸­é—´</span></span><br><span class="line">    <span class="keyword">var</span> fast <span class="operator">=</span> list.head</span><br><span class="line">    <span class="keyword">var</span> slow <span class="operator">=</span> list.head</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> nextFast <span class="operator">=</span> fast<span class="operator">?</span>.next &#123;</span><br><span class="line">        fast <span class="operator">=</span> nextFast.next</span><br><span class="line">        slow <span class="operator">=</span> slow<span class="operator">?</span>.next</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> slow</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åè½¬é“¾è¡¨"><a href="#åè½¬é“¾è¡¨" class="headerlink" title="åè½¬é“¾è¡¨"></a>åè½¬é“¾è¡¨</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">LinkedList</span> &#123;</span><br><span class="line">    <span class="comment">// ä¸æ–­çš„åˆ†å‰²é“¾è¡¨ï¼Œä»å¤´éƒ¨å¼€å§‹ï¼Œä¸‹ä¸€æ­¥æ—¶æŠŠä¹‹å‰åˆ†å‰²çš„èŠ‚ç‚¹æ‹¼æ¥åœ¨æ–°çš„èŠ‚ç‚¹ä¹‹åã€‚</span></span><br><span class="line">    <span class="comment">// å¦‚æ­¤éå†åˆ°åº•ï¼Œå°±å®ç°äº†é€†åºã€‚</span></span><br><span class="line">    <span class="comment">// æ ¸å¿ƒæ€è·¯ï¼šæŠŠæ¯ä¸ªèŠ‚ç‚¹çš„å‰èŠ‚ç‚¹å˜æˆåèŠ‚ç‚¹ï¼ŒåŒæ—¶é€šè¿‡éå†æ—¶åˆ†å‰²æˆ2~3ä¸ªåˆ†æ®µã€‚</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">reverse</span>() &#123;</span><br><span class="line">        tail <span class="operator">=</span> head</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> current <span class="operator">=</span> head<span class="operator">?</span>.next</span><br><span class="line">        <span class="comment">//  ä¸´æ—¶å­˜å‚¨é€†åºçš„é“¾è¡¨</span></span><br><span class="line">        <span class="keyword">var</span> prev <span class="operator">=</span> head</span><br><span class="line">        prev<span class="operator">?</span>.next <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> current <span class="operator">!=</span> <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> next <span class="operator">=</span> current<span class="operator">?</span>.next</span><br><span class="line">            current<span class="operator">?</span>.next <span class="operator">=</span> prev</span><br><span class="line">            prev <span class="operator">=</span> current</span><br><span class="line">            current <span class="operator">=</span> next</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        head <span class="operator">=</span> prev</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åˆå¹¶ä¸¤ä¸ªå·²ç»æ’åºå¥½çš„é“¾è¡¨"><a href="#åˆå¹¶ä¸¤ä¸ªå·²ç»æ’åºå¥½çš„é“¾è¡¨" class="headerlink" title="åˆå¹¶ä¸¤ä¸ªå·²ç»æ’åºå¥½çš„é“¾è¡¨"></a>åˆå¹¶ä¸¤ä¸ªå·²ç»æ’åºå¥½çš„é“¾è¡¨</h4><p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// list1 1 -&gt; 4 -&gt; 10 -&gt; 11</span><br><span class="line"></span><br><span class="line">// list2 -1 -&gt; 2 -&gt; 3 -&gt; 6</span><br><span class="line"></span><br><span class="line">// merged list -1 -&gt; 1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 6 -&gt; 10 -&gt; 11</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">mergeSorted</span>&lt;<span class="type">T</span>: <span class="type">Comparable</span>&gt;(<span class="keyword">_</span> <span class="params">left</span>: <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;,</span><br><span class="line">                                <span class="keyword">_</span> <span class="params">right</span>: <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;) -&gt; <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="operator">!</span>left.isEmpty <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> right</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">guard</span> <span class="operator">!</span>right.isEmpty <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> left</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰æ–°çš„é“¾è¡¨çš„é¦–å°¾</span></span><br><span class="line">    <span class="keyword">var</span> newHead: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">    <span class="keyword">var</span> tail: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åŸæœ‰é“¾è¡¨çš„æ¸¸æ ‡ï¼Œåé¢ä»¥æ­¤éå†</span></span><br><span class="line">    <span class="keyword">var</span> currentLeft <span class="operator">=</span> left.head</span><br><span class="line">    <span class="keyword">var</span> currentRight <span class="operator">=</span> right.head</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹è®¾ç½®</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> leftNode <span class="operator">=</span> currentLeft, <span class="keyword">let</span> rightNode <span class="operator">=</span> currentRight &#123;</span><br><span class="line">        <span class="keyword">if</span> leftNode.value <span class="operator">&lt;</span> rightNode.value &#123;</span><br><span class="line">            newHead <span class="operator">=</span> leftNode</span><br><span class="line">            currentLeft <span class="operator">=</span> leftNode.next</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            newHead <span class="operator">=</span> rightNode</span><br><span class="line">            currentRight <span class="operator">=</span> rightNode.next</span><br><span class="line">        &#125;</span><br><span class="line">        tail <span class="operator">=</span> newHead</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éå†</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> leftNode <span class="operator">=</span> currentLeft, <span class="keyword">let</span> rightNode <span class="operator">=</span> currentRight &#123;</span><br><span class="line">        <span class="keyword">if</span> leftNode.value <span class="operator">&lt;</span> rightNode.value &#123;</span><br><span class="line">            tail<span class="operator">?</span>.next <span class="operator">=</span> leftNode</span><br><span class="line">            currentLeft <span class="operator">=</span> leftNode.next</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tail<span class="operator">?</span>.next <span class="operator">=</span> rightNode</span><br><span class="line">            currentRight <span class="operator">=</span> rightNode.next</span><br><span class="line">        &#125;</span><br><span class="line">        tail <span class="operator">=</span> tail<span class="operator">?</span>.next</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> leftNode <span class="operator">=</span> currentLeft &#123;</span><br><span class="line">        tail<span class="operator">?</span>.next <span class="operator">=</span> leftNode</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> rightNode <span class="operator">=</span> currentRight &#123;</span><br><span class="line">        tail<span class="operator">?</span>.next <span class="operator">=</span> rightNode</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤„ç†æ–°çš„é“¾è¡¨çš„é¦–å°¾</span></span><br><span class="line">    <span class="keyword">var</span> list <span class="operator">=</span> <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;()</span><br><span class="line"></span><br><span class="line">    list.head <span class="operator">=</span> newHead</span><br><span class="line">    <span class="comment">// æ‰¾åˆ°çœŸçš„å°¾éƒ¨èŠ‚ç‚¹</span></span><br><span class="line">    list.tail <span class="operator">=</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">let</span> next <span class="operator">=</span> tail<span class="operator">?</span>.next &#123;</span><br><span class="line">            tail <span class="operator">=</span> next</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> tail</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> list</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åˆ›å»ºä¸€ä¸ªä»é“¾è¡¨ä¸­åˆ é™¤æ‰€æœ‰ç‰¹å®šå…ƒç´ çš„å‡½æ•°"><a href="#åˆ›å»ºä¸€ä¸ªä»é“¾è¡¨ä¸­åˆ é™¤æ‰€æœ‰ç‰¹å®šå…ƒç´ çš„å‡½æ•°" class="headerlink" title="åˆ›å»ºä¸€ä¸ªä»é“¾è¡¨ä¸­åˆ é™¤æ‰€æœ‰ç‰¹å®šå…ƒç´ çš„å‡½æ•°"></a>åˆ›å»ºä¸€ä¸ªä»é“¾è¡¨ä¸­åˆ é™¤æ‰€æœ‰ç‰¹å®šå…ƒç´ çš„å‡½æ•°</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">LinkedList</span> <span class="title class_">where</span> <span class="title class_">Value</span>: <span class="title class_">Equatable</span> &#123;</span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">removeAll</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">Value</span>) &#123;</span><br><span class="line">        <span class="comment">// å¤´éƒ¨çš„å€¼ç›¸ç­‰æ—¶å•ç‹¬å¤„ç†</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">let</span> head <span class="operator">=</span> <span class="keyword">self</span>.head, head.value <span class="operator">==</span> value &#123;</span><br><span class="line">            <span class="keyword">self</span>.head <span class="operator">=</span> head.next</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> current <span class="operator">=</span> head<span class="operator">?</span>.next</span><br><span class="line">        <span class="keyword">var</span> prev <span class="operator">=</span> head</span><br><span class="line"></span><br><span class="line">        <span class="comment">// éå†</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">let</span> currentNode <span class="operator">=</span> current &#123;</span><br><span class="line">            <span class="keyword">guard</span> currentNode.value <span class="operator">!=</span> value <span class="keyword">else</span> &#123;</span><br><span class="line">                prev<span class="operator">?</span>.next <span class="operator">=</span> currentNode.next</span><br><span class="line">                current <span class="operator">=</span> prev<span class="operator">?</span>.next</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            prev <span class="operator">=</span> current</span><br><span class="line">            current <span class="operator">=</span> current<span class="operator">?</span>.next</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        tail <span class="operator">=</span> prev</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨æ—¶é—´å¤æ‚åº¦ä¸Šä¼˜åŒ–ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½æ˜¯2~3ä¸ªä¸´æ—¶å˜é‡ï¼ˆç‰ºç‰²ä¸€ç‚¹ç©ºé—´å¤æ‚åº¦ï¼‰ã€‚ç›¸å½“äºè®©æ›´å¤šäººååŒåšä¸€ä»¶äº‹æƒ…ï¼Œè‚¯å®šæ›´å¿«ã€‚ä½†æ˜¯å¦‚æœæ˜¯èµ„æºæœ‰é™çš„æ—¶å€™ï¼Œæ¯”å¦‚è¯´é›‡äººåšäº‹ï¼Œæ€»çš„æˆæœ¬ä¸ä¸€å®šä¼šå‡å°‘ã€‚ä½†æ˜¯é€šå¸¸æƒ…å†µä¸‹ï¼Œç”µè„‘çš„å†…å­˜å®¹é‡æ˜¯æ—¢å®šçš„ï¼Œè€Œä¸”å¤Ÿç”¨çš„æƒ…å†µä¸‹ï¼Œå°±è¦ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ï¼Œä¸ç”¨åæƒœå†…å­˜ã€‚</p>
</blockquote>
<h3 id="ç¬¬å…­ç« ï¼šæ ˆ"><a href="#ç¬¬å…­ç« ï¼šæ ˆ" class="headerlink" title="ç¬¬å…­ç« ï¼šæ ˆ"></a>ç¬¬å…­ç« ï¼šæ ˆ</h3><p>æ ˆæ— å¤„ä¸åœ¨ã€‚ ä»¥ä¸‹æ˜¯æ‚¨è¦æ ˆçš„ä¸€äº›å¸¸è§ç¤ºä¾‹ï¼š</p>
<ul>
<li>è–„ç…é¥¼</li>
<li>ä¹¦ç±</li>
<li>çº¸å¼ </li>
</ul>
<p>åœ¨æ¦‚å¿µä¸Šï¼Œæ ˆæ•°æ®ç»“æ„ä¸ç‰©ç†æ ˆç›¸åŒã€‚ å°†é¡¹ç›®æ·»åŠ åˆ°æ ˆæ—¶ï¼Œå°†å…¶æ”¾åœ¨æ ˆé¡¶éƒ¨ã€‚ ä»æ ˆä¸­åˆ é™¤é¡¹ç›®æ—¶ï¼Œå§‹ç»ˆä¼šåˆ é™¤æœ€é¡¶å±‚çš„é¡¹ç›®ã€‚</p>
<h4 id="æ ˆçš„æ“ä½œ"><a href="#æ ˆçš„æ“ä½œ" class="headerlink" title="æ ˆçš„æ“ä½œ"></a>æ ˆçš„æ“ä½œ</h4><p>æ ˆçš„æ“ä½œåªæœ‰ä¸¤ä¸ªï¼š</p>
<ol>
<li>pushï¼šå°†å…ƒç´ æ·»åŠ åˆ°æ ˆé¡¶éƒ¨ã€‚</li>
<li>popï¼šåˆ é™¤æ ˆçš„é¡¶éƒ¨å…ƒç´ ã€‚</li>
</ol>
<p>è¿™æ„å‘³ç€æ‚¨åªèƒ½åœ¨æ•°æ®ç»“æ„çš„ä¸€ä¾§æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ã€‚åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œæ ˆè¢«ç§°ä¸ºLIFOï¼ˆåè¿›å…ˆå‡ºï¼‰æ•°æ®ç»“æ„ã€‚æœ€åæ¨å…¥çš„å…ƒç´ æ˜¯ç¬¬ä¸€ä¸ªè¢«å¼¹å‡ºçš„å…ƒç´ ã€‚</p>
<h4 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ³›å‹Elementä¸ºå­˜å‚¨çš„å…ƒç´ </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">Stack</span>&lt;<span class="title class_">Element</span>&gt; &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//å†…éƒ¨ä¸ºæ•°ç»„å­˜å‚¨æ‰€æœ‰å…ƒç´ </span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> storage: [<span class="type">Element</span>] <span class="operator">=</span> []</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123; &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">elements</span>: [<span class="type">Element</span>]) &#123;</span><br><span class="line">    storage <span class="operator">=</span> elements</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">push</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">Element</span>) &#123;</span><br><span class="line">    storage.append(element)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@discardableResult</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">pop</span>() -&gt; <span class="type">Element</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> storage.popLast()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">peek</span>() -&gt; <span class="type">Element</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> storage.last</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> peek() <span class="operator">==</span> <span class="literal">nil</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Stack</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> topDivider <span class="operator">=</span> <span class="string">&quot;----top----<span class="subst">\n</span>&quot;</span></span><br><span class="line">    <span class="keyword">let</span> bottomDivider <span class="operator">=</span> <span class="string">&quot;<span class="subst">\n</span>-----------&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> stackElements <span class="operator">=</span> storage</span><br><span class="line">      .map &#123; <span class="string">&quot;<span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span> &#125;</span><br><span class="line">      .reversed()</span><br><span class="line">      .joined(separator: <span class="string">&quot;<span class="subst">\n</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> topDivider <span class="operator">+</span> stackElements <span class="operator">+</span> bottomDivider</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Stack</span>: <span class="title class_">ExpressibleByArrayLiteral</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">arrayLiteral</span> <span class="params">elements</span>: <span class="type">Element</span>...) &#123;</span><br><span class="line">    storage <span class="operator">=</span> elements</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½ å¯èƒ½æƒ³çŸ¥é“æ˜¯å¦å¯ä»¥ä¸ºæ ˆé‡‡ç”¨Swifté›†åˆåè®®ã€‚æ ˆçš„ç›®çš„æ˜¯é™åˆ¶è®¿é—®æ•°æ®çš„æ–¹å¼çš„æ•°é‡ï¼Œå¹¶é‡‡ç”¨è¯¸å¦‚Collectionä¹‹ç±»çš„åè®®å°†é€šè¿‡è¿­ä»£å™¨å’Œä¸‹æ ‡å…¬å¼€æ‰€æœ‰å…ƒç´ æ¥è¿èƒŒæ­¤ç›®æ ‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°‘å³æ˜¯å¤šï¼</p>
<h3 id="ç¬¬ä¸ƒç« ï¼šæ ˆæŒ‘æˆ˜"><a href="#ç¬¬ä¸ƒç« ï¼šæ ˆæŒ‘æˆ˜" class="headerlink" title="ç¬¬ä¸ƒç« ï¼šæ ˆæŒ‘æˆ˜"></a>ç¬¬ä¸ƒç« ï¼šæ ˆæŒ‘æˆ˜</h3><h4 id="é€†åºæ‰“å°é“¾è¡¨ï¼Œä½†æ˜¯ä¸èƒ½ç”¨é€’å½’"><a href="#é€†åºæ‰“å°é“¾è¡¨ï¼Œä½†æ˜¯ä¸èƒ½ç”¨é€’å½’" class="headerlink" title="é€†åºæ‰“å°é“¾è¡¨ï¼Œä½†æ˜¯ä¸èƒ½ç”¨é€’å½’"></a>é€†åºæ‰“å°é“¾è¡¨ï¼Œä½†æ˜¯ä¸èƒ½ç”¨é€’å½’</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> list: <span class="type">LinkedList</span>&lt;<span class="type">Int</span>&gt; <span class="operator">=</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> list <span class="operator">=</span> <span class="type">LinkedList</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line">  list.push(<span class="number">3</span>)</span><br><span class="line">  list.push(<span class="number">2</span>)</span><br><span class="line">  list.push(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">return</span> list</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">printInReverse</span>&lt;<span class="type">T</span>&gt;(<span class="keyword">_</span> <span class="params">list</span>: <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;) &#123;</span><br><span class="line">  <span class="keyword">var</span> current <span class="operator">=</span> list.head</span><br><span class="line">  <span class="keyword">var</span> stack <span class="operator">=</span> <span class="type">Stack</span>&lt;<span class="type">T</span>&gt;()</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">while</span> <span class="keyword">let</span> node <span class="operator">=</span> current &#123;</span><br><span class="line">    stack.push(node.value)</span><br><span class="line">    current <span class="operator">=</span> node.next</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">while</span> <span class="keyword">let</span> value <span class="operator">=</span> stack.pop() &#123;</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">printInReverse(list)</span><br></pre></td></tr></table></figure>

<h4 id="æ£€æŸ¥æ‹¬å·çš„åŒ¹é…"><a href="#æ£€æŸ¥æ‹¬å·çš„åŒ¹é…" class="headerlink" title="æ£€æŸ¥æ‹¬å·çš„åŒ¹é…"></a>æ£€æŸ¥æ‹¬å·çš„åŒ¹é…</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> testString1 <span class="operator">=</span> <span class="string">&quot;h((e))llo(world)()&quot;</span></span><br><span class="line"><span class="keyword">var</span> testString2 <span class="operator">=</span> <span class="string">&quot;(hello world&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">checkParentheses</span>(<span class="keyword">_</span> <span class="params">string</span>: <span class="type">String</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> stack <span class="operator">=</span> <span class="type">Stack</span>&lt;<span class="type">Character</span>&gt;()</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> character <span class="keyword">in</span> string &#123;</span><br><span class="line">    <span class="keyword">if</span> character <span class="operator">==</span> <span class="string">&quot;(&quot;</span> &#123;</span><br><span class="line">      stack.push(character)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> character <span class="operator">==</span> <span class="string">&quot;)&quot;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> stack.isEmpty &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        stack.pop()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> stack.isEmpty</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">checkParentheses(testString1)</span><br><span class="line">checkParentheses(testString2)</span><br></pre></td></tr></table></figure>

<h3 id="ç¬¬å…«ç« ï¼šé˜Ÿåˆ—"><a href="#ç¬¬å…«ç« ï¼šé˜Ÿåˆ—" class="headerlink" title="ç¬¬å…«ç« ï¼šé˜Ÿåˆ—"></a>ç¬¬å…«ç« ï¼šé˜Ÿåˆ—</h3><p>æˆ‘ä»¬éƒ½ç†Ÿæ‚‰æ’é˜Ÿï¼Œæ— è®ºæ˜¯ä¹°ç¥¨è¿˜æ˜¯æ’é˜Ÿæ‰“å°ã€‚</p>
<p>é˜Ÿåˆ—ä½¿ç”¨FIFOæˆ–å…ˆè¿›å…ˆå‡ºé¡ºåºï¼Œè¿™æ„å‘³ç€æ·»åŠ çš„ç¬¬ä¸€ä¸ªå…ƒç´ å°†å§‹ç»ˆæ˜¯ç¬¬ä¸€ä¸ªè¢«åˆ é™¤çš„å…ƒç´ ã€‚å½“æ‚¨éœ€è¦ç»´æŠ¤å…ƒç´ çš„é¡ºåºä»¥ä¾¿ç¨åå¤„ç†æ—¶ï¼Œé˜Ÿåˆ—å¾ˆæ–¹ä¾¿ã€‚</p>
<h4 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h4><p>è®©æˆ‘ä»¬å…ˆç¡®å®šé˜Ÿåˆ—çš„åè®®ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">protocol</span> <span class="title class_">Queue</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">associatedtype</span> <span class="type">Element</span></span><br><span class="line">  <span class="comment">///åœ¨é˜Ÿåˆ—åé¢æ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™è¿”å›trueã€‚</span></span><br><span class="line">  <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">enqueue</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">Element</span>) -&gt; <span class="type">Bool</span></span><br><span class="line">  <span class="comment">///åˆ é™¤é˜Ÿåˆ—å‰é¢çš„å…ƒç´ å¹¶å°†å…¶è¿”å›ã€‚</span></span><br><span class="line">  <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">dequeue</span>() -&gt; <span class="type">Element</span>?</span><br><span class="line">  <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">  <span class="keyword">var</span> peek: <span class="type">Element</span>? &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä»¥ä¸‹éƒ¨åˆ†ä¸­ï¼Œå°†ä»¥å››ç§ä¸åŒçš„æ–¹å¼åˆ›å»ºé˜Ÿåˆ—ï¼š</p>
<ol>
<li>æ•°ç»„</li>
<li>åŒå‘åˆ—è¡¨</li>
<li>ç¯å½¢ç¼“å†²åŒº</li>
<li>åŒæ ˆ</li>
</ol>
<h4 id="ç”¨æ•°ç»„æ¥å®ç°"><a href="#ç”¨æ•°ç»„æ¥å®ç°" class="headerlink" title="ç”¨æ•°ç»„æ¥å®ç°"></a>ç”¨æ•°ç»„æ¥å®ç°</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">QueueArray</span>&lt;<span class="title class_">T</span>&gt;: <span class="title class_">Queue</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> array: [<span class="type">T</span>] <span class="operator">=</span> []</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> array.isEmpty</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> peek: <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> array.first</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">enqueue</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    array.append(element)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">dequeue</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> isEmpty <span class="operator">?</span> <span class="literal">nil</span> : array.removeFirst()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueArray</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: array)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">QueueArray</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line">queue.enqueue(<span class="string">&quot;Ray&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Brian&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Eric&quot;</span>)</span><br><span class="line">queue</span><br><span class="line">queue.dequeue()</span><br><span class="line">queue</span><br><span class="line">queue.peek</span><br></pre></td></tr></table></figure>

<h5 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h5><h5 id=""><a href="#" class="headerlink" title=""></a><img src="https://gewill.org/assets/image-20190912160423263.png" alt="image-20190912160423263"></h5><p>å¾ˆæ˜æ˜¾åªæœ‰<code>enqueue</code>æ˜¯O(1)ï¼Œå…¶ä»–éƒ½æ˜¯O(n)ã€‚</p>
<h4 id="ç”¨åŒå‘é“¾è¡¨æ¥å®ç°"><a href="#ç”¨åŒå‘é“¾è¡¨æ¥å®ç°" class="headerlink" title="ç”¨åŒå‘é“¾è¡¨æ¥å®ç°"></a>ç”¨åŒå‘é“¾è¡¨æ¥å®ç°</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QueueLinkedList</span>&lt;<span class="title class_">T</span>&gt;: <span class="title class_">Queue</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> list <span class="operator">=</span> <span class="type">DoublyLinkedList</span>&lt;<span class="type">T</span>&gt;()</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">enqueue</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    list.append(element)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">dequeue</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="operator">!</span>list.isEmpty, <span class="keyword">let</span> element <span class="operator">=</span> list.first <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list.remove(element)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> peek: <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> list.first<span class="operator">?</span>.value</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> list.isEmpty</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueLinkedList</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: list)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">QueueLinkedList</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line">queue.enqueue(<span class="string">&quot;Ray&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Brian&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Eric&quot;</span>)</span><br><span class="line">queue</span><br><span class="line">queue.dequeue()</span><br><span class="line">queue</span><br><span class="line">queue.peek</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - DoublyLinkedList</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;<span class="title class_">T</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> value: <span class="type">T</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> next: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> previous: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">value</span>: <span class="type">T</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.value <span class="operator">=</span> value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Node</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DoublyLinkedList</span>&lt;<span class="title class_">T</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> head: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> tail: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123; &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> head <span class="operator">==</span> <span class="literal">nil</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> first: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;? &#123;</span><br><span class="line">    <span class="keyword">return</span> head</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">append</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">T</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> newNode <span class="operator">=</span> <span class="type">Node</span>(value: value)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> tailNode <span class="operator">=</span> tail <span class="keyword">else</span> &#123;</span><br><span class="line">      head <span class="operator">=</span> newNode</span><br><span class="line">      tail <span class="operator">=</span> newNode</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    newNode.previous <span class="operator">=</span> tailNode</span><br><span class="line">    tailNode.next <span class="operator">=</span> newNode</span><br><span class="line">    tail <span class="operator">=</span> newNode</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">remove</span>(<span class="keyword">_</span> <span class="params">node</span>: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;) -&gt; <span class="type">T</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> prev <span class="operator">=</span> node.previous</span><br><span class="line">    <span class="keyword">let</span> next <span class="operator">=</span> node.next</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> prev <span class="operator">=</span> prev &#123;</span><br><span class="line">      prev.next <span class="operator">=</span> next</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      head <span class="operator">=</span> next</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    next<span class="operator">?</span>.previous <span class="operator">=</span> prev</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> next <span class="operator">==</span> <span class="literal">nil</span> &#123;</span><br><span class="line">      tail <span class="operator">=</span> prev</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    node.previous <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">    node.next <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> node.value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">DoublyLinkedList</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> string <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">var</span> current <span class="operator">=</span> head</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> node <span class="operator">=</span> current &#123;</span><br><span class="line">      string.append(<span class="string">&quot;<span class="subst">\(node.value)</span> -&gt; &quot;</span>)</span><br><span class="line">      current <span class="operator">=</span> node.next</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> string <span class="operator">+</span> <span class="string">&quot;end&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedListIterator</span>&lt;<span class="title class_">T</span>&gt;: <span class="title class_">IteratorProtocol</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> current: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">init</span>(<span class="params">node</span>: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?) &#123;</span><br><span class="line">    current <span class="operator">=</span> node</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">next</span>() -&gt; <span class="type">Node</span>&lt;<span class="type">T</span>&gt;? &#123;</span><br><span class="line">    <span class="keyword">defer</span> &#123; current <span class="operator">=</span> current<span class="operator">?</span>.next &#125;</span><br><span class="line">    <span class="keyword">return</span> current</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">DoublyLinkedList</span>: <span class="title class_">Sequence</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">makeIterator</span>() -&gt; <span class="type">LinkedListIterator</span>&lt;<span class="type">T</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">LinkedListIterator</span>(node: head)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="ä¼˜ç¼ºç‚¹-1"><a href="#ä¼˜ç¼ºç‚¹-1" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹<img src="https://gewill.org/assets/image-20190912161101034.png" alt="image-20190912161101034"></h5><p>å‡ºæ¥ç©ºé—´å¤æ‚åº¦æ˜¯O(n)ï¼Œå…¶ä»–çš„éƒ½æ˜¯O(1)ã€‚</p>
<p>åŒå‘åˆ—è¡¨çš„ä¸»è¦å¼±ç‚¹åœ¨è¡¨ä¸­å¹¶ä¸æ˜æ˜¾ã€‚å°½ç®¡æœ‰O(1)çš„æ€§èƒ½ï¼Œä½†å®ƒçš„å¼€é”€å¾ˆé«˜ã€‚æ¯ä¸ªå…ƒç´ éƒ½å¿…é¡»æœ‰é¢å¤–çš„å­˜å‚¨ç©ºé—´ç”¨äºå‰å‘å’Œåå‘å¼•ç”¨ã€‚è€Œä¸”ï¼Œæ¯æ¬¡åˆ›å»ºæ–°å…ƒç´ æ—¶ï¼Œéƒ½éœ€è¦ç›¸å¯¹æ˜‚è´µçš„åŠ¨æ€åˆ†é…ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæ•°ç»„è¿›è¡Œæ‰¹é‡åˆ†é…ï¼Œé€Ÿåº¦æ›´å¿«ã€‚</p>
<h4 id="ç”¨ç¯å½¢ç¼“å†²åŒºæ¥å®ç°"><a href="#ç”¨ç¯å½¢ç¼“å†²åŒºæ¥å®ç°" class="headerlink" title="ç”¨ç¯å½¢ç¼“å†²åŒºæ¥å®ç°"></a>ç”¨ç¯å½¢ç¼“å†²åŒºæ¥å®ç°</h4><p>ç¯å½¢ç¼“å†²åŒºï¼Œä¹Ÿç§°ä¸ºå¾ªç¯ç¼“å†²åŒºï¼Œæ˜¯å›ºå®šå¤§å°çš„é˜µåˆ—ã€‚å½“æœ€ç»ˆæ²¡æœ‰æ›´å¤šé¡¹ç›®éœ€è¦åˆ é™¤æ—¶ï¼Œè¿™ç§æ•°æ®ç»“æ„æˆ˜ç•¥æ€§åœ°åŒ…å«åœ¨å¼€å¤´ã€‚</p>
<p>è¯¦è§ï¼š[<a target="_blank" rel="noopener" href="https://github.com/raywenderlich/swift-algorithm-club/tree/master/Ring%20Buffer]">https://github.com/raywenderlich/swift-algorithm-club/tree/master/Ring%20Buffer]</a>(<a target="_blank" rel="noopener" href="https://github.com/raywenderlich/swift-algorithm-club/tree/master/Ring">https://github.com/raywenderlich/swift-algorithm-club/tree/master/Ring</a> Buffer)</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">QueueRingBuffer</span>&lt;<span class="title class_">T</span>&gt;: <span class="title class_">Queue</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> ringBuffer: <span class="type">RingBuffer</span>&lt;<span class="type">T</span>&gt;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">count</span>: <span class="type">Int</span>) &#123;</span><br><span class="line">    ringBuffer <span class="operator">=</span> <span class="type">RingBuffer</span>&lt;<span class="type">T</span>&gt;(count: count)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> ringBuffer.isEmpty</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> peek: <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> ringBuffer.first</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">enqueue</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> ringBuffer.write(element)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">dequeue</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> isEmpty <span class="operator">?</span> <span class="literal">nil</span> : ringBuffer.read()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueRingBuffer</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: ringBuffer)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">QueueRingBuffer</span>&lt;<span class="type">String</span>&gt;(count: <span class="number">10</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Ray&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Brian&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Eric&quot;</span>)</span><br><span class="line">queue</span><br><span class="line">queue.dequeue()</span><br><span class="line">queue</span><br><span class="line">queue.peek</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - RingBuffer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">RingBuffer</span>&lt;<span class="title class_">T</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> array: [<span class="type">T</span>?]</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> readIndex <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> writeIndex <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">count</span>: <span class="type">Int</span>) &#123;</span><br><span class="line">    array <span class="operator">=</span> <span class="type">Array</span>&lt;<span class="type">T</span>?&gt;(repeating: <span class="literal">nil</span>, count: count)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> first: <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> array[readIndex]</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">write</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="operator">!</span>isFull &#123;</span><br><span class="line">      array[writeIndex <span class="operator">%</span> array.count] <span class="operator">=</span> element</span><br><span class="line">      writeIndex <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">read</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="operator">!</span>isEmpty &#123;</span><br><span class="line">      <span class="keyword">let</span> element <span class="operator">=</span> array[readIndex <span class="operator">%</span> array.count]</span><br><span class="line">      readIndex <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">      <span class="keyword">return</span> element</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> availableSpaceForReading: <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> writeIndex <span class="operator">-</span> readIndex</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> availableSpaceForReading <span class="operator">==</span> <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> availableSpaceForWriting: <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> array.count <span class="operator">-</span> availableSpaceForReading</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isFull: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> availableSpaceForWriting <span class="operator">==</span> <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">RingBuffer</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> values <span class="operator">=</span> (<span class="number">0</span><span class="operator">..&lt;</span>availableSpaceForReading).map &#123;</span><br><span class="line">      <span class="type">String</span>(describing: array[(<span class="variable">$0</span> <span class="operator">+</span> readIndex) <span class="operator">%</span> array.count]<span class="operator">!</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;[&quot;</span> <span class="operator">+</span> values.joined(separator: <span class="string">&quot;, &quot;</span>) <span class="operator">+</span> <span class="string">&quot;]&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="ä¼˜ç¼ºç‚¹-2"><a href="#ä¼˜ç¼ºç‚¹-2" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h5><p><img src="https://gewill.org/assets/image-20190912162139308.png" alt="image-20190912162139308"></p>
<p>åŸºäºç¯ç¼“å†²åŒºçš„é˜Ÿåˆ—å…·æœ‰ä¸é“¾è¡¨å®ç°ç›¸åŒçš„å…¥é˜Ÿå’Œå‡ºé˜Ÿæ—¶é—´å¤æ‚åº¦ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯ç©ºé—´å¤æ‚æ€§ã€‚ç¯å½¢ç¼“å†²åŒºå…·æœ‰å›ºå®šå¤§å°ï¼Œè¿™æ„å‘³ç€å…¥é˜Ÿå¯èƒ½ä¼šå¤±è´¥ã€‚</p>
<h4 id="ç”¨åŒæ ˆæ¥å®ç°"><a href="#ç”¨åŒæ ˆæ¥å®ç°" class="headerlink" title="ç”¨åŒæ ˆæ¥å®ç°"></a>ç”¨åŒæ ˆæ¥å®ç°</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">QueueStack</span>&lt;<span class="title class_">T</span>&gt; : <span class="title class_">Queue</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> leftStack: [<span class="type">T</span>] <span class="operator">=</span> []</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> rightStack: [<span class="type">T</span>] <span class="operator">=</span> []</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> leftStack.isEmpty <span class="operator">&amp;&amp;</span> rightStack.isEmpty</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> peek: <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="operator">!</span>leftStack.isEmpty <span class="operator">?</span> leftStack.last : rightStack.first</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">enqueue</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    rightStack.append(element)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">dequeue</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">if</span> leftStack.isEmpty &#123;</span><br><span class="line">      leftStack <span class="operator">=</span> rightStack.reversed()</span><br><span class="line">      rightStack.removeAll()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> leftStack.popLast()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueStack</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> printList <span class="operator">=</span> leftStack.reversed() <span class="operator">+</span> rightStack</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: printList)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">QueueStack</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line">queue.enqueue(<span class="string">&quot;Ray&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Brian&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Eric&quot;</span>)</span><br><span class="line">queue</span><br><span class="line">queue.dequeue()</span><br><span class="line">queue</span><br><span class="line">queue.peek</span><br></pre></td></tr></table></figure>

<p>å‡ºé˜Ÿï¼š<img src="https://gewill.org/assets/image-20190912162831309.png" alt="image-20190912162831309"></p>
<p>å…¥é˜Ÿï¼š</p>
<p>![image-20190912162918069](&#x2F;Users&#x2F;will&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20190912162918069.png)</p>
<h5 id="ä¼˜ç¼ºç‚¹-3"><a href="#ä¼˜ç¼ºç‚¹-3" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h5><h5 id="image-20190912163001741-x2F-Users-x2F-will-x2F-Library-x2F-Application-Support-x2F-typora-user-images-x2F-image-20190912163001741-png"><a href="#image-20190912163001741-x2F-Users-x2F-will-x2F-Library-x2F-Application-Support-x2F-typora-user-images-x2F-image-20190912163001741-png" class="headerlink" title="![image-20190912163001741](&#x2F;Users&#x2F;will&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20190912163001741.png)"></a>![image-20190912163001741](&#x2F;Users&#x2F;will&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20190912163001741.png)</h5><p>ä¸åŸºäºæ•°ç»„çš„å®ç°ç›¸æ¯”ï¼Œé€šè¿‡åˆ©ç”¨ä¸¤ä¸ªå †æ ˆï¼Œæ‚¨å¯ä»¥å°†<code>dequeue(_ :)</code>è½¬æ¢ä¸ºåˆ†æ‘Šçš„O(1)æ“ä½œã€‚</p>
<p>æ­¤å¤–ï¼Œæ‚¨çš„åŒæ ˆå®ç°æ˜¯å®Œå…¨åŠ¨æ€çš„ï¼Œå¹¶ä¸”æ²¡æœ‰åŸºäºç¯å½¢ç¼“å†²åŒºçš„é˜Ÿåˆ—å®ç°æ‰€å…·æœ‰çš„å›ºå®šå¤§å°é™åˆ¶ã€‚</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><ul>
<li><p>é˜Ÿåˆ—é‡‡ç”¨FIFOç­–ç•¥ï¼Œé¦–å…ˆå¿…é¡»å…ˆåˆ é™¤æ·»åŠ çš„å…ƒç´ ã€‚</p>
</li>
<li><p>Enqueueå°†å…ƒç´ æ’å…¥é˜Ÿåˆ—çš„åé¢ã€‚</p>
</li>
<li><p>Dequeueåˆ é™¤é˜Ÿåˆ—å‰é¢çš„å…ƒç´ ã€‚</p>
</li>
<li><p>æ•°ç»„ä¸­çš„å…ƒç´ åœ¨è¿ç»­çš„å†…å­˜å—ä¸­å¸ƒå±€ï¼Œè€Œé“¾è¡¨ä¸­çš„å…ƒç´ æ›´åŠ åˆ†æ•£ï¼Œå¯èƒ½å­˜åœ¨ç¼“å­˜æœªå‘½ä¸­ã€‚</p>
</li>
<li><p>åŸºäºç¯è·¯ç¼“å†²åŒºé˜Ÿåˆ—çš„å®ç°é€‚ç”¨äºå…·æœ‰å›ºå®šå¤§å°çš„é˜Ÿåˆ—ã€‚</p>
</li>
<li><p>ä¸å…¶ä»–æ•°æ®ç»“æ„ç›¸æ¯”ï¼Œåˆ©ç”¨ä¸¤ä¸ªæ ˆå¯ä»¥å°†å‡ºåˆ—<code>dequeue(_ :)</code>æ—¶é—´å¤æ‚åº¦æé«˜åˆ°æ‘Šé”€çš„O(1)æ“ä½œã€‚</p>
</li>
<li><p>åŒæ ˆå®ç°åœ¨ç©ºé—´å¤æ‚åº¦æ–¹é¢å‡»è´¥äº†é“¾è¡¨ã€‚</p>
</li>
</ul>
<h3 id="ç¬¬ä¹ç« ï¼šé˜Ÿåˆ—æŒ‘æˆ˜"><a href="#ç¬¬ä¹ç« ï¼šé˜Ÿåˆ—æŒ‘æˆ˜" class="headerlink" title="ç¬¬ä¹ç« ï¼šé˜Ÿåˆ—æŒ‘æˆ˜"></a>ç¬¬ä¹ç« ï¼šé˜Ÿåˆ—æŒ‘æˆ˜</h3><h4 id="è§£é‡Šæ ˆå’Œé˜Ÿåˆ—ä¹‹é—´çš„åŒºåˆ«"><a href="#è§£é‡Šæ ˆå’Œé˜Ÿåˆ—ä¹‹é—´çš„åŒºåˆ«" class="headerlink" title="è§£é‡Šæ ˆå’Œé˜Ÿåˆ—ä¹‹é—´çš„åŒºåˆ«"></a>è§£é‡Šæ ˆå’Œé˜Ÿåˆ—ä¹‹é—´çš„åŒºåˆ«</h4><p>ä¸ºæ¯ä¸ªæ•°æ®ç»“æ„æä¾›ä¸¤ä¸ªå®é™…ç¤ºä¾‹ã€‚</p>
<h4 id="ç”»é€æ­¥å›¾è¡¨"><a href="#ç”»é€æ­¥å›¾è¡¨" class="headerlink" title="ç”»é€æ­¥å›¾è¡¨"></a>ç”»é€æ­¥å›¾è¡¨</h4><p>æ¼”ç¤ºå››ç§å®ç°æ—¶ï¼Œæ¯ä¸€æ­¥å¯¹é˜Ÿåˆ—çš„æœ‰å½±å“ã€‚</p>
<p>å¦‚é˜Ÿåˆ—ä¸ºï¼šâ€SWIFTâ€</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">enqueue(<span class="string">&quot;R&quot;</span>) </span><br><span class="line">enqueue(<span class="string">&quot;O&quot;</span>) </span><br><span class="line">dequeue() </span><br><span class="line">enqueue(<span class="string">&quot;C&quot;</span>) </span><br><span class="line">dequeue() </span><br><span class="line">dequeue() </span><br><span class="line">enqueue(<span class="string">&quot;K&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="ç»™é˜Ÿåˆ—æ·»åŠ nextåè®®"><a href="#ç»™é˜Ÿåˆ—æ·»åŠ nextåè®®" class="headerlink" title="ç»™é˜Ÿåˆ—æ·»åŠ nextåè®®"></a>ç»™é˜Ÿåˆ—æ·»åŠ <code>next</code>åè®®</h4><p>ç”¨æ¥å¤§å¯Œç¿æ¸¸æˆï¼ŒæŒ‡æ´¾ä¸‹ä¸€ä¸ªç©å®¶</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">protocol</span> <span class="title class_">BoardGameManager</span> &#123;</span><br><span class="line">  <span class="keyword">associatedtype</span> <span class="type">Player</span></span><br><span class="line">  <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">nextPlayer</span>() -&gt; <span class="type">Player</span>?</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueArray</span>: <span class="title class_">BoardGameManager</span> &#123;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">typealias</span> <span class="type">Player</span> <span class="operator">=</span> <span class="type">T</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">nextPlayer</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> person <span class="operator">=</span> dequeue() <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    enqueue(person)</span><br><span class="line">    <span class="keyword">return</span> person</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="é€†åºæ’åˆ—é˜Ÿåˆ—"><a href="#é€†åºæ’åˆ—é˜Ÿåˆ—" class="headerlink" title="é€†åºæ’åˆ—é˜Ÿåˆ—"></a>é€†åºæ’åˆ—é˜Ÿåˆ—</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueArray</span> &#123;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">reversed</span>() -&gt; <span class="type">QueueArray</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> queue <span class="operator">=</span> <span class="keyword">self</span></span><br><span class="line">    <span class="keyword">var</span> stack <span class="operator">=</span> <span class="type">Stack</span>&lt;<span class="type">T</span>&gt;()</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> element <span class="operator">=</span> queue.dequeue() &#123;</span><br><span class="line">      stack.push(element)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> element <span class="operator">=</span> stack.pop() &#123;</span><br><span class="line">      queue.enqueue(element)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> queue</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/06/26/Advanced-Apple-Debugging-and-Reverse-Engineering-Notes-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/06/26/Advanced-Apple-Debugging-and-Reverse-Engineering-Notes-1/" class="post-title-link" itemprop="url">è‹¹æœè°ƒè¯•å’Œé€†å‘å·¥ç¨‹è¿›é˜¶-ç¬”è®°ï¼ˆä¸€ï¼‰</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-06-26 10:32:44" itemprop="dateCreated datePublished" datetime="2019-06-26T10:32:44+08:00">2019-06-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>å†™è¿™æœ¬ä¹¦çš„ç›®çš„</p>
<p>æ¯ä¸ªå¼€å‘äººå‘˜éƒ½åº”è¯¥ç ”ç©¶è°ƒè¯•ä»£ç çš„è‰ºæœ¯ã€‚ ä½†æ˜¯ï¼Œæœ‰äº›äººä¼šä»æœ¬ä¹¦ä¸­è·å¾—æ›´å¤šã€‚ æœ¬ä¹¦æ˜¯ä¸ºï¼š</p>
<ol>
<li><p>å¸Œæœ›æ›´å¥½åœ°ä½¿ç”¨LLDBè¿›è¡Œè°ƒè¯•çš„å¼€å‘äººå‘˜</p>
</li>
<li><p>å¸Œæœ›ä½¿ç”¨LLDBæ„å»ºå¤æ‚è°ƒè¯•å‘½ä»¤çš„å¼€å‘äººå‘˜</p>
</li>
<li><p>å¸Œæœ›æ·±å…¥äº†è§£Swiftå’ŒObjective-Cå†…éƒ¨çš„å¼€å‘äººå‘˜</p>
</li>
<li><p>æœ‰å…´è¶£äº†è§£ï¼šé€šè¿‡é€†å‘å·¥ç¨‹ï¼Œä»–ä»¬å¯ä»¥åšäº›ä»€ä¹ˆçš„å¼€å‘äººå‘˜</p>
</li>
<li><p>å¯¹ç°ä»£ä¸»åŠ¨é€†å‘å·¥ç¨‹ç­–ç•¥æ„Ÿå…´è¶£çš„å¼€å‘äººå‘˜</p>
</li>
<li><p>å¸Œæœ›åœ¨å‘ç°æœ‰å…³å…¶è®¡ç®—æœºæˆ–è½¯ä»¶é—®é¢˜çš„ç­”æ¡ˆæ—¶æœ‰æ‰€å¸®åŠ©çš„å¼€å‘äººå‘˜</p>
</li>
</ol>
<p>è‡ªå®šä¹‰LLDBè„šæœ¬repo:</p>
<p><a target="_blank" rel="noopener" href="https://github.com/DerekSelander/LLDB">https://github.com/DerekSelander/LLDB</a></p>
<p>è¿™äº›è„šæœ¬å°†æœ‰åŠ©äºæ‚¨çš„è°ƒè¯•&#x2F;é€†å‘å·¥ç¨‹ï¼Œå¹¶ä¸ºæ‚¨è‡ªå·±çš„LLDBè„šæœ¬æä¾›æ–°é¢–çš„æƒ³æ³•ã€‚</p>
<h2 id="ç¬¬ä¸€èŠ‚ï¼šå¼€å§‹LLDBå‘½ä»¤"><a href="#ç¬¬ä¸€èŠ‚ï¼šå¼€å§‹LLDBå‘½ä»¤" class="headerlink" title="ç¬¬ä¸€èŠ‚ï¼šå¼€å§‹LLDBå‘½ä»¤"></a>ç¬¬ä¸€èŠ‚ï¼šå¼€å§‹LLDBå‘½ä»¤</h2><p>åˆ°æœ¬èŠ‚ç»“æŸæ—¶ï¼Œæ‚¨å°†èƒ½å¤Ÿä½¿ç”¨è°ƒè¯•å™¨æ¥æ‰§è¡Œè°ƒè¯•æ‰€éœ€çš„å¤§å¤šæ•°åŸºæœ¬ä»»åŠ¡ï¼Œä»¥åŠåˆ›å»ºè‡ªå·±çš„ç®€å•è‡ªå®šä¹‰å‘½ä»¤</p>
<h3 id="ç¬¬1ç« ï¼šå…¥é—¨"><a href="#ç¬¬1ç« ï¼šå…¥é—¨" class="headerlink" title="ç¬¬1ç« ï¼šå…¥é—¨"></a>ç¬¬1ç« ï¼šå…¥é—¨</h3><p>æƒ³çŸ¥é“ä¸ºä»€ä¹ˆå‘½ä»¤æ˜¯poï¼Ÿ poä»£è¡¨æ‰“å°å¯¹è±¡ã€‚ è¿˜æœ‰pï¼Œå®ƒåªæ˜¯æ‰“å°RDIçš„å†…å®¹ã€‚ poé€šå¸¸æ›´æœ‰ç”¨ï¼Œå› ä¸ºå®ƒæä¾›äº†NSObjectçš„æè¿°æˆ–debugDescriptionæ–¹æ³•ï¼ˆå¦‚æœå¯ç”¨ï¼‰ã€‚</p>
<p>å¦‚æœæ‚¨æƒ³å°†è°ƒè¯•æå‡åˆ°ä¸€ä¸ªæ–°çš„æ°´å¹³ï¼Œæ±‡ç¼–ï¼ˆAssemblyï¼‰æ˜¯ä¸€é¡¹é‡è¦çš„æŠ€èƒ½ã€‚</p>
<p>å®ƒå¯ä»¥è®©æ‚¨æ·±å…¥äº†è§£Appleçš„ä»£ç  - å³ä½¿æ‚¨æ²¡æœ‰ä»»ä½•æºä»£ç å¯ä¾›é˜…è¯»ã€‚ å®ƒå°†ä½¿æ‚¨æ›´å¥½åœ°äº†è§£Swiftç¼–è¯‘å™¨å›¢é˜Ÿå¦‚ä½•ä½¿ç”¨Swiftåœ¨Objective-Cä¸­è·³å‡ºï¼Œå¹¶ä¸”å®ƒå°†ä½¿æ‚¨æ›´å¥½åœ°äº†è§£Appleè®¾å¤‡ä¸Šçš„ä¸€åˆ‡æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p>
<p>å¦‚æœå¯ä»¥ï¼Œæˆ‘å°†å§‹ç»ˆé€‰æ‹©åœ¨è°ƒè¯•å™¨ä¸­ä½¿ç”¨Objective-Cï¼Œå› ä¸ºä½¿ç”¨Objective-C LLDBæ¯”ä½¿ç”¨Swiftæ›´ç¨³å®šã€‚</p>
<h3 id="ç¬¬2ç« ï¼šHelpå’ŒApropos"><a href="#ç¬¬2ç« ï¼šHelpå’ŒApropos" class="headerlink" title="ç¬¬2ç« ï¼šHelpå’ŒApropos"></a>ç¬¬2ç« ï¼šHelpå’ŒApropos</h3><p><code>help</code>å°†è½¬å‚¨(dump)æ‰€æœ‰å¯ç”¨çš„å‘½ä»¤ï¼ŒåŒ…æ‹¬ä»ã€œ&#x2F; .lldbinitåŠ è½½çš„è‡ªå®šä¹‰å‘½ä»¤ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) help breakpoint</span><br></pre></td></tr></table></figure>

<p><code>apropos</code>å‘½ä»¤å¯ä»¥ä¸ºæ‚¨æ‰§è¡Œæ­¤æ“ä½œ;è¿™æœ‰ç‚¹åƒä½¿ç”¨æœç´¢å¼•æ“åœ¨ç½‘ç»œä¸Šæ‰¾åˆ°ä¸€äº›ä¸œè¥¿ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) apropos swift</span><br></pre></td></tr></table></figure>

<h3 id="ç¬¬3ç« ï¼šä½¿ç”¨LLDB-Attaching"><a href="#ç¬¬3ç« ï¼šä½¿ç”¨LLDB-Attaching" class="headerlink" title="ç¬¬3ç« ï¼šä½¿ç”¨LLDB Attaching"></a>ç¬¬3ç« ï¼šä½¿ç”¨LLDB Attaching</h3><p>LLDBâ€œAttachingâ€çš„çŸ­è¯­å®é™…ä¸Šæœ‰ç‚¹è¯¯å¯¼ã€‚ åä¸ºdebugserver(ä½äºXcode.app&#x2F;Contents&#x2F;SharedFrameworks&#x2F;LLDB.framework&#x2F;Resources&#x2F;)çš„ç¨‹åºè´Ÿè´£é™„åŠ (attaching)åˆ°ç›®æ ‡è¿›ç¨‹ã€‚</p>
<p>å¦‚æœå®ƒæ˜¯è¿œç¨‹è¿›ç¨‹ï¼Œä¾‹å¦‚åœ¨è¿œç¨‹è®¾å¤‡ä¸Šè¿è¡Œçš„iOSï¼ŒwatchOSæˆ–tvOSåº”ç”¨ç¨‹åºï¼Œåˆ™ä¼šåœ¨è¯¥è¿œç¨‹è®¾å¤‡ä¸Šå¯åŠ¨è¿œç¨‹è°ƒè¯•æœåŠ¡å™¨ã€‚ LLDBçš„å·¥ä½œæ˜¯å¯åŠ¨ï¼Œè¿æ¥å’Œåè°ƒè°ƒè¯•æœåŠ¡å™¨ï¼Œä»¥å¤„ç†è°ƒè¯•åº”ç”¨ç¨‹åºæ—¶çš„æ‰€æœ‰äº¤äº’ã€‚</p>
<h4 id="é™„åŠ åˆ°ç°æœ‰è¿›ç¨‹"><a href="#é™„åŠ åˆ°ç°æœ‰è¿›ç¨‹" class="headerlink" title="é™„åŠ åˆ°ç°æœ‰è¿›ç¨‹"></a>é™„åŠ åˆ°ç°æœ‰è¿›ç¨‹</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lldb -n Xcode</span><br></pre></td></tr></table></figure>

<h4 id="é™„åŠ åˆ°æœªæ¥çš„è¿›ç¨‹"><a href="#é™„åŠ åˆ°æœªæ¥çš„è¿›ç¨‹" class="headerlink" title="é™„åŠ åˆ°æœªæ¥çš„è¿›ç¨‹"></a>é™„åŠ åˆ°æœªæ¥çš„è¿›ç¨‹</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lldb -n Finder -w</span><br></pre></td></tr></table></figure>

<h4 id="launchå¯é€‰çš„å‚æ•°"><a href="#launchå¯é€‰çš„å‚æ•°" class="headerlink" title="launchå¯é€‰çš„å‚æ•°"></a>launchå¯é€‰çš„å‚æ•°</h4><p>è¿™å‘Šè¯‰LLDBä½¿ç”¨<code>/bin/ls</code>ï¼ˆæ–‡ä»¶åˆ—è¡¨å‘½ä»¤ï¼‰ä½œä¸ºç›®æ ‡å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lldb -f /bin/ls</span><br></pre></td></tr></table></figure>



<p>ä½¿ç”¨ process çš„é€‰é¡¹ <code>-w</code> æ›´æ”¹å·¥ä½œç›®å½•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) process launch -w /Applications</span><br></pre></td></tr></table></figure>



<p>ç›´æ¥ä¼ é€’å‚æ•°ç»™<code>ç¨‹åº</code>ï¼Œä¹Ÿå°±æ˜¯<code>/bin/ls</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) process launch -- /Applications</span><br></pre></td></tr></table></figure>

<p>ç­‰ä»·äº</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ls /Applications</span><br></pre></td></tr></table></figure>



<p><code>-X</code>é€‰é¡¹å¯æ‰©å±•æ‚¨æä¾›çš„ä»»ä½•shellå‚æ•°ï¼Œä¾‹å¦‚ä»£å­—å·ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) process launch -X true -- ~/Desktop</span><br></pre></td></tr></table></figure>

<p><code>run</code> æ˜¯ <code>process launch -X true â€”</code>çš„ç¼©å†™ï¼Œæ‰€ä»¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run ~/Desktop</span><br></pre></td></tr></table></figure>



<p>stdinä¹Ÿæœ‰ä¸€ä¸ªé€‰é¡¹<code>-i</code>ï¼Œç”¨æ¥å¤„ç†æ ‡å‡†çš„è¾“å…¥è¾“å‡ºã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) target delete</span><br><span class="line">(lldb) target create /usr/bin/wc</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ echo &quot;hello world&quot; &gt; /tmp/wc_input.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(lldb) process launch -i /tmp/wc_input.txt</span><br><span class="line">Process 24511 launched: &#x27;/usr/bin/wc&#x27; (x86_64)</span><br><span class="line">1 2 12 </span><br><span class="line">Process 24511 exited with status = 0 (0x00000000)</span><br></pre></td></tr></table></figure>

<p>ç­‰åŒäº</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ wc &lt; /tmp/wc_input.txt</span><br><span class="line"> 1  2 12</span><br></pre></td></tr></table></figure>

<h3 id="ç¬¬4ç« ï¼šåœ¨ä»£ç ä¸­åœæ­¢"><a href="#ç¬¬4ç« ï¼šåœ¨ä»£ç ä¸­åœæ­¢" class="headerlink" title="ç¬¬4ç« ï¼šåœ¨ä»£ç ä¸­åœæ­¢"></a>ç¬¬4ç« ï¼šåœ¨ä»£ç ä¸­åœæ­¢</h3><p>æ— è®ºæ‚¨æ˜¯åœ¨æŠ€æœ¯å †æ ˆä¸­ä½¿ç”¨Swiftï¼ŒObjective-Cï¼ŒC ++ï¼ŒCè¿˜æ˜¯å®Œå…¨ä¸åŒçš„è¯­è¨€ï¼Œæ‚¨éƒ½éœ€è¦å­¦ä¹ å¦‚ä½•åˆ›å»ºæ–­ç‚¹ã€‚ å¯ä»¥è½»æ¾åœ°åœ¨Xcodeä¸­å•å‡»ä¾§é¢æ¿ä»¥ä½¿ç”¨GUIåˆ›å»ºæ–­ç‚¹ï¼Œä½†LLDBæ§åˆ¶å°å¯ä»¥è®©æ‚¨æ›´å¥½åœ°æ§åˆ¶æ–­ç‚¹ã€‚</p>
<h4 id="Signalsï¼ˆä¿¡å·ï¼‰"><a href="#Signalsï¼ˆä¿¡å·ï¼‰" class="headerlink" title="Signalsï¼ˆä¿¡å·ï¼‰"></a>Signalsï¼ˆä¿¡å·ï¼‰</h4><p>Unixä¿¡å·æ˜¯è¿›ç¨‹é—´é€šä¿¡çš„åŸºæœ¬å½¢å¼ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå…¶ä¸­ä¸€ä¸ªä¿¡å·SIGSTOPå¯ç”¨äºä¿å­˜çŠ¶æ€å¹¶æš‚åœæ‰§è¡Œè¿›ç¨‹ï¼Œè€Œå…¶å¯¹åº”çš„SIGCONTåˆ™è¢«å‘é€åˆ°ç¨‹åºä»¥æ¢å¤æ‰§è¡Œã€‚è°ƒè¯•å™¨å¯ä»¥ä½¿ç”¨è¿™ä¸¤ä¸ªä¿¡å·æš‚åœå¹¶ç»§ç»­æ‰§è¡Œç¨‹åºã€‚</p>
<h5 id="Xcode-æ–­ç‚¹"><a href="#Xcode-æ–­ç‚¹" class="headerlink" title="Xcode æ–­ç‚¹"></a>Xcode æ–­ç‚¹</h5><p>ç¬¦å·æ–­ç‚¹ï¼ˆSymbolic breakpointsï¼‰æ˜¯Xcodeçš„ä¸€ä¸ªå¾ˆå¥½çš„è°ƒè¯•åŠŸèƒ½ã€‚å®ƒä»¬å…è®¸æ‚¨åœ¨åº”ç”¨ç¨‹åºä¸­çš„æŸä¸ªç¬¦å·ä¸Šè®¾ç½®æ–­ç‚¹ã€‚ä¾‹å¦‚<code>[NSObject init]</code>ï¼Œå®ƒå¼•ç”¨NSObjectå®ä¾‹çš„initæ–¹æ³•ã€‚</p>
<p><img src="/../assets/xcode_breakpoints.png"></p>
<blockquote>
<p>æ‚¨å°†å­¦ä¹ å¦‚ä½•åœ¨ç¬¬10ç« â€œæ±‡ç¼–ï¼Œå¯„å­˜å™¨å’Œè°ƒç”¨çº¦å®šâ€ä¸­æ­£ç¡®ä½¿ç”¨å’Œæ“ä½œå¯„å­˜å™¨ï¼Œä½†æ˜¯ç°?åœ¨ï¼Œåªéœ€çŸ¥é“<code> arg1</code>ä¸â€‹<code> $rdi</code>å¯„å­˜å™¨åŒä¹‰ï¼Œå¹¶ä¸”å¯ä»¥è¢«è®¤ä¸ºæ˜¯æŒæœ‰å®ä¾‹çš„è°ƒç”¨initæ—¶çš„ç±»ã€‚</p>
</blockquote>
<p>è¿˜æœ‰Swifté”™è¯¯æ–­ç‚¹ï¼Œå®ƒé€šè¿‡åœ¨swift_willThrowæ–¹æ³•ä¸Šåˆ›å»ºæ–­ç‚¹æ¥éšæ—¶åœæ­¢SwiftæŠ›å‡ºé”™è¯¯ã€‚å¦‚æœæ‚¨æ­£åœ¨å¤„ç†ä»»ä½•å®¹æ˜“å‡ºé”™çš„APIï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒå¯ä»¥è®©æ‚¨å¿«é€Ÿè¯Šæ–­æƒ…å†µï¼Œè€Œä¸ä¼šå¯¹ä»£ç çš„æ­£ç¡®æ€§åšå‡ºé”™è¯¯çš„å‡è®¾ã€‚</p>
<h4 id="LLDBæ–­ç‚¹è¯­æ³•"><a href="#LLDBæ–­ç‚¹è¯­æ³•" class="headerlink" title="LLDBæ–­ç‚¹è¯­æ³•"></a>LLDBæ–­ç‚¹è¯­æ³•</h4><p><code>image</code>å‘½ä»¤æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©å†…çœå¯¹è®¾ç½®æ–­ç‚¹è‡³å…³é‡è¦çš„ç»†èŠ‚ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -n &quot;-[UIViewController viewDidLoad]&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn test</span><br></pre></td></tr></table></figure>

<h5 id="Objective-C-properties"><a href="#Objective-C-properties" class="headerlink" title="Objective-C properties"></a>Objective-C properties</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">TestClass</span> : <span class="title">NSObject</span> </span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> *name; </span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -n &quot;-[TestClass name]&quot;</span><br></pre></td></tr></table></figure>

<h5 id="Objective-C-properties-and-dot-notation"><a href="#Objective-C-properties-and-dot-notation" class="headerlink" title="Objective-C properties and dot notation"></a>Objective-C properties and dot notation</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">TestClass *a = [[TestClass alloc] init];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Both equivalent for setters </span></span><br><span class="line">[a setName:<span class="string">@&quot;hello, world&quot;</span>]; </span><br><span class="line">a.name = <span class="string">@&quot;hello, world&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Both equivalent for getters </span></span><br><span class="line"><span class="built_in">NSString</span> *b; </span><br><span class="line">b = [a name]; <span class="comment">// b = @&quot;hello, world&quot; </span></span><br><span class="line">b = a.name; <span class="comment">// b = @&quot;hello, world&quot;</span></span><br></pre></td></tr></table></figure>

<p>é‡è¦çš„æ˜¯è¦çŸ¥é“æ‚¨æ˜¯åœ¨å¤„ç†Objective-Cä»£ç å¹¶å°è¯•ä½¿ç”¨ç‚¹è¡¨ç¤ºæ³•åœ¨setterå’Œgetterå±æ€§ä¸Šåˆ›å»ºæ–­ç‚¹ã€‚</p>
<h5 id="Swift-properties"><a href="#Swift-properties" class="headerlink" title="Swift properties"></a>Swift properties</h5><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SwiftTestClass</span>: <span class="title class_">NSObject</span> &#123; </span><br><span class="line">	<span class="keyword">var</span> name: <span class="type">String</span>!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In the LLDB console, type the following:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn Signals.SwiftTestClass.name.setter</span><br></pre></td></tr></table></figure>

<p>Youâ€™ll get output similar to below:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1 match found in /Users/derekselander/Library/Developer/Xcode/ DerivedData/Signals-atqcdyprrotlrvdanihoufkwzyqh/Build/Products/Debugiphonesimulator/Signals.app/Signals:</span><br><span class="line"></span><br><span class="line">Address: Signals[0x000000010000cc70] (Signals.__TEXT.__text + 44816)</span><br><span class="line"></span><br><span class="line">Summary: Signals`Signals.SwiftTestClass.name.setter : Swift.ImplicitlyUnwrappedOptional&lt;Swift.String&gt; at SwiftTestClass.swift: 28</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ä»¥ä¸‹æ­£åˆ™è¡¨è¾¾å¼æŸ¥è¯¢åŒæ—¶æœç´¢nameå±æ€§çš„SwiftTestClass setterå’Œgetterï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn Signals.SwiftTestClass.name</span><br></pre></td></tr></table></figure>

<h4 id="åˆ›å»ºæ–­ç‚¹"><a href="#åˆ›å»ºæ–­ç‚¹" class="headerlink" title="åˆ›å»ºæ–­ç‚¹"></a>åˆ›å»ºæ–­ç‚¹</h4><p>æœ‰å‡ ç§ä¸åŒçš„æ–¹æ³•å¯ä»¥åˆ›å»ºæ–­ç‚¹ã€‚æœ€åŸºæœ¬çš„æ–¹æ³•æ˜¯åªè¾“å…¥å­—æ¯bï¼Œåè·Ÿæ–­ç‚¹åç§°ã€‚è¿™åœ¨Objective-Cå’ŒCä¸­ç›¸å½“å®¹æ˜“ï¼Œå› ä¸ºåç§°ç®€çŸ­ä¸”æ˜“äºé”®å…¥ï¼ˆä¾‹å¦‚ - [NSObject init]æˆ– - [UIView setAlpha:]ï¼‰ã€‚è¾“å…¥C ++å’ŒSwiftéå¸¸æ£˜æ‰‹ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¼šå°†æ‚¨çš„æ–¹æ³•è½¬æ¢ä¸ºå…·æœ‰ç›¸å½“é•¿åç§°çš„ç¬¦å·ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) b -[UIViewController viewDidLoad]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸è®¸å¤šé€Ÿè®°å‘½ä»¤ä¸€æ ·ï¼Œbæ˜¯å¦ä¸€ä¸ªæ›´é•¿çš„LLDBå‘½ä»¤çš„ç¼©å†™ã€‚</p>
</blockquote>
<h5 id="æ­£åˆ™è¡¨è¾¾å¼æ–­ç‚¹å’ŒèŒƒå›´"><a href="#æ­£åˆ™è¡¨è¾¾å¼æ–­ç‚¹å’ŒèŒƒå›´" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼æ–­ç‚¹å’ŒèŒƒå›´"></a>æ­£åˆ™è¡¨è¾¾å¼æ–­ç‚¹å’ŒèŒƒå›´</h5><p>rbå‘½ä»¤å°†æ‰©å±•åˆ°rbreakï¼ˆå‡è®¾æ‚¨æ²¡æœ‰ä»»ä½•ä»¥â€œrbâ€å¼€å¤´çš„å…¶ä»–LLDBå‘½ä»¤ï¼‰ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) rb SwiftTestClass.name.setter</span><br></pre></td></tr></table></figure>



<p>è¿™å°†åœ¨åŒ…å«çŸ­è¯­name.setterçš„ä»»ä½•å†…å®¹ä¸Šç”Ÿæˆæ–­ç‚¹:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) rb name\.setter	</span><br></pre></td></tr></table></figure>



<p>åœ¨UIViewControllerçš„æ¯ä¸ªObjective-Cå®ä¾‹æ–¹æ³•ä¸Šåˆ›å»ºä¸€ä¸ªæ–­ç‚¹:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) rb &#x27;\-\[UIViewController\ &#x27;</span><br></pre></td></tr></table></figure>



<p>åˆ é™¤æ‰€æœ‰æ–­ç‚¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) breakpoint delete</span><br></pre></td></tr></table></figure>



<p>åœ¨æ–­ç‚¹ä¸­çš„UIViewControllerä¹‹åï¼Œè¿™æä¾›äº†å¸¦æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ¯æ•°å­—å­—ç¬¦åè·Ÿç©ºæ ¼çš„å¯é€‰æ‹¬å·ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) rb &#x27;\-\[UIViewController(\(\w+\))?\ &#x27;</span><br></pre></td></tr></table></figure>



<p>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ–­ç‚¹å¯ä»¥ä½¿ç”¨å•ä¸ªè¡¨è¾¾å¼æ•è·å„ç§æ–­ç‚¹ã€‚</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨-fé€‰é¡¹å°†æ–­ç‚¹çš„èŒƒå›´é™åˆ¶ä¸ºç‰¹å®šæ–‡ä»¶ã€‚</p>
<p>å¦‚æœæ‚¨æ­£åœ¨è°ƒè¯•DetailViewController.swiftï¼Œè¿™å°†éå¸¸æœ‰ç”¨ã€‚å®ƒå°†åœ¨æ­¤æ–‡ä»¶ä¸­çš„æ‰€æœ‰å±æ€§getter &#x2F; setterï¼Œå—&#x2F;é—­åŒ…ï¼Œæ‰©å±•&#x2F;ç±»åˆ«å’Œå‡½æ•°&#x2F;æ–¹æ³•ä¸Šè®¾ç½®æ–­ç‚¹ã€‚ -fç§°ä¸ºèŒƒå›´é™åˆ¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) rb . -f DetailViewController.swift</span><br></pre></td></tr></table></figure>



<p>ä½¿ç”¨-så¯ä»¥é™åˆ¶æ­¤å…±äº«åº“ä¸­è®¾ç½®æ–­ç‚¹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) rb . -s UIKit</span><br></pre></td></tr></table></figure>



<p>-oé€‰é¡¹ä¸ºæ­¤æä¾›äº†è§£å†³æ–¹æ¡ˆã€‚å®ƒåˆ›é€ äº†æ‰€è°“çš„â€œä¸€æ¬¡æ€§â€æ–­ç‚¹ã€‚å½“è¿™äº›æ–­ç‚¹å‘½ä¸­æ—¶ï¼Œæ–­ç‚¹å°†è¢«åˆ é™¤ã€‚æ‰€ä»¥å®ƒåªä¼šæ‰“ä¸€æ¬¡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) breakpoint delete </span><br><span class="line">(lldb) rb . -s UIKit -o</span><br></pre></td></tr></table></figure>

<h5 id="å…¶ä»–å¾ˆé…·çš„æ–­ç‚¹é€‰é¡¹"><a href="#å…¶ä»–å¾ˆé…·çš„æ–­ç‚¹é€‰é¡¹" class="headerlink" title="å…¶ä»–å¾ˆé…·çš„æ–­ç‚¹é€‰é¡¹"></a>å…¶ä»–å¾ˆé…·çš„æ–­ç‚¹é€‰é¡¹</h5><p>-Lé€‰é¡¹å…è®¸æ‚¨æŒ‰æºä»£ç çš„è¯­è¨€è¿›è¡Œè¿‡æ»¤ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨åªæƒ³åœ¨Signalsåº”ç”¨ç¨‹åºçš„Commonsæ¨¡å—ä¸­ä½¿ç”¨Swiftä»£ç ï¼Œåˆ™å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) breakpoint set -L swift -r . -s Commons</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™å°†åœ¨Commonsæ¨¡å—ä¸­çš„æ¯ä¸ªSwiftæ–¹æ³•ä¸Šè®¾ç½®æ–­ç‚¹ã€‚</p>
</blockquote>
<p>å¦‚æœä½ æƒ³åœ¨Swiftè¯­å¥<code>if let</code>å¯»æ‰¾ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿ï¼Œå¦‚æœè®©å®ƒå®Œå…¨å¿˜è®°ä½ çš„åº”ç”¨ç¨‹åºåœ¨å“ªé‡Œï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿæ‚¨å¯ä»¥ä½¿ç”¨æºæ­£åˆ™è¡¨è¾¾å¼æ–­ç‚¹æ¥å¸®åŠ©ç¡®å®šæ„Ÿå…´è¶£çš„ä½ç½®ï¼åƒè¿™æ ·ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) breakpoint set -A -p &quot;if let&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™å°†åœ¨åŒ…å«<code>if let</code>çš„æ¯ä¸ªæºä»£ç ä½ç½®åˆ›å»ºä¸€ä¸ªæ–­ç‚¹ã€‚ -Aé€‰é¡¹è¡¨ç¤ºæœç´¢é¡¹ç›®å·²çŸ¥çš„æ‰€æœ‰æºæ–‡ä»¶ã€‚</p>
</blockquote>
<p>å¦‚æœæƒ³è¿›ä¸€é™åˆ¶æ–‡ä»¶èŒƒå›´ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) breakpoint set -p &quot;if let&quot; -f MasterViewController.swift -f DetailViewController.swift</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™å°†è·å–æ‰€æœ‰æºæ–‡ä»¶ï¼ˆ-Aï¼‰ï¼Œä½†åªè¿‡æ»¤é‚£äº›å±äºSignalså¯æ‰§è¡Œæ–‡ä»¶ï¼ˆä½¿ç”¨-s Signalsé€‰é¡¹ï¼‰çš„æ–‡ä»¶ã€‚</p>
</blockquote>
<p>å†æ¥ä¸€ä¸ªå¾ˆé…·çš„æ–­ç‚¹é€‰é¡¹ç¤ºä¾‹ï¼Ÿå¥½çš„ã€‚æ¯å½“viewDidLoadè¢«å‘½ä¸­æ—¶ï¼Œå°†åˆ›å»ºä¸€ä¸ªæ‰“å°UIViewControllerçš„æ–­ç‚¹ï¼Œä½†æ˜¯å°†é€šè¿‡LLDBæ§åˆ¶å°è€Œä¸æ˜¯ç¬¦å·æ–­ç‚¹çª—å£æ¥æ‰§è¡Œæ­¤æ“ä½œã€‚ç„¶åå°†è¿™ä¸ªæ–­ç‚¹å¯¼å‡ºåˆ°æ–‡ä»¶ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡ä½¿ç”¨æ–­ç‚¹è¯»å–å’Œæ–­ç‚¹å†™å…¥å‘½ä»¤å±•ç°ç»™åŒäº‹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(lldb) breakpoint delete //æ¸…ç†æ–­ç‚¹</span><br><span class="line">(lldb) breakpoint set -n &quot;-[UIViewController viewDidLoad]&quot; -C &quot;po $arg1&quot; -G1 // æ‰“å°æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„å®ä¾‹å¯¹è±¡</span><br><span class="line">(lldb) breakpoint write -f /tmp/br.json //æ–­ç‚¹å†™å…¥æ–‡ä»¶</span><br><span class="line">(lldb) platform shell cat /tmp/br.json //shellè¯»å–æ–‡ä»¶</span><br><span class="line">(lldb) breakpoint delete //æ¸…ç†æ–­ç‚¹</span><br><span class="line">(lldb) breakpoint read -f /tmp/br.json //è¿˜èƒ½ä»æ–‡ä»¶ä¸­å¯¼å…¥æ–­ç‚¹</span><br></pre></td></tr></table></figure>

<h5 id="ä¿®æ”¹å’Œç§»é™¤æ–­ç‚¹"><a href="#ä¿®æ”¹å’Œç§»é™¤æ–­ç‚¹" class="headerlink" title="ä¿®æ”¹å’Œç§»é™¤æ–­ç‚¹"></a>ä¿®æ”¹å’Œç§»é™¤æ–­ç‚¹</h5><p>æ–­ç‚¹ä¼šä»1å¼€å§‹åˆ†é…ID</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(lldb) b main</span><br><span class="line">(lldb) breakpoint list 1</span><br><span class="line">(lldb) breakpoint list 1 -b //ç®€æ´ï¼šæ²¡æœ‰ä½ç½®ï¼ˆlocationï¼‰</span><br><span class="line">(lldb) breakpoint list 1 3 //å¤šä¸ª</span><br><span class="line">(lldb) breakpoint list 1-3 //èŒƒå›´</span><br><span class="line">(lldb) breakpoint delete 1 //åˆ é™¤</span><br><span class="line">(lldb) breakpoint delete 1.1 //ä»…åˆ é™¤ç¬¬ä¸€ä¸ªå­æ–­ç‚¹</span><br></pre></td></tr></table></figure>



<h3 id="ç¬¬5ç« ï¼šè¡¨è¾¾å¼"><a href="#ç¬¬5ç« ï¼šè¡¨è¾¾å¼" class="headerlink" title="ç¬¬5ç« ï¼šè¡¨è¾¾å¼"></a>ç¬¬5ç« ï¼šè¡¨è¾¾å¼</h3><h4 id="æ ¼å¼åŒ–-p-å’Œ-po"><a href="#æ ¼å¼åŒ–-p-å’Œ-po" class="headerlink" title="æ ¼å¼åŒ– p å’Œ po"></a>æ ¼å¼åŒ– p å’Œ po</h4><p>poé€šå¸¸ç”¨äºSwiftå’ŒObjective-Cä»£ç ä¸­ä»¥æ‰“å°å‡ºæ„Ÿå…´è¶£çš„é¡¹ç›®ã€‚è¿™å¯ä»¥æ˜¯å¯¹è±¡ä¸­çš„å®ä¾‹å˜é‡ï¼Œå¯¹è±¡çš„æœ¬åœ°å¼•ç”¨æˆ–å¯„å­˜å™¨ï¼Œå¦‚æœ¬ä¹¦å‰é¢æ‰€è¿°ã€‚å®ƒç”šè‡³å¯ä»¥æ˜¯ä¸€ä¸ªä»»æ„çš„å†…å­˜å¼•ç”¨ - åªè¦è¯¥åœ°å€æœ‰ä¸€ä¸ªå¯¹è±¡ï¼</p>
<p>poå®é™…ä¸Šæ˜¯<code>expression -O --</code> çš„ç®€å†™è¡¨è¾¾å¼ã€‚ -Oå‚æ•°ç”¨äºæ‰“å°å¯¹è±¡çš„æè¿°ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(lldb) help po</span><br><span class="line">     Evaluate an expression on the current thread.  Displays any returned</span><br><span class="line">     value with formatting controlled by the type&#x27;s author.  Expects &#x27;raw&#x27;</span><br><span class="line">     input (see &#x27;help raw-input&#x27;.)</span><br><span class="line"></span><br><span class="line">Syntax: po &lt;expr&gt;</span><br><span class="line"></span><br><span class="line">Command Options Usage:</span><br><span class="line">  po &lt;expr&gt;</span><br><span class="line"></span><br><span class="line">&#x27;po&#x27; is an abbreviation for &#x27;expression -O  --&#x27;</span><br></pre></td></tr></table></figure>

<p>poç»å¸¸è¢«å¿½è§†çš„å…„å¼Ÿp,æ˜¯å¦ä¸€ä¸ªçœç•¥-Oé€‰é¡¹çš„ç¼©å†™ï¼Œ<code>expression --</code> ã€‚æ‰“å°å‡ºçš„pçš„æ ¼å¼æ›´ä¾èµ–äºLLDBç±»å‹ç³»ç»Ÿã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(lldb) help p</span><br><span class="line">     Evaluate an expression on the current thread.  Displays any returned</span><br><span class="line">     value with LLDB&#x27;s default formatting.  Expects &#x27;raw&#x27; input (see &#x27;help</span><br><span class="line">     raw-input&#x27;.)</span><br><span class="line"></span><br><span class="line">Syntax: p &lt;expr&gt;</span><br><span class="line"></span><br><span class="line">Command Options Usage:</span><br><span class="line">  p &lt;expr&gt;</span><br><span class="line"></span><br><span class="line">&#x27;p&#x27; is an abbreviation for &#x27;expression --&#x27;</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123; </span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;Yay! debugging &quot;</span> <span class="operator">+</span> <span class="keyword">super</span>.description </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="keyword">var</span> debugDescription: <span class="type">String</span> &#123; </span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;debugDescription: &quot;</span> <span class="operator">+</span> <span class="keyword">super</span>.debugDescription </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidLoad</span>() &#123;</span><br><span class="line">   <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;<span class="subst">\(<span class="keyword">self</span>)</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨viewDidLoadä¸­æ·»åŠ Xcodeæ–­ç‚¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) po self</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">debugDescription: Yay! debugging &lt;Signals.MasterViewController: 0x7fb71fd04080&gt;</span><br></pre></td></tr></table></figure>

<h4 id="Swift-å’Œ-Objective-C-è°ƒè¯•ä¸Šä¸‹ï¼ˆæ–‡contextsï¼‰"><a href="#Swift-å’Œ-Objective-C-è°ƒè¯•ä¸Šä¸‹ï¼ˆæ–‡contextsï¼‰" class="headerlink" title="Swift å’Œ Objective-C è°ƒè¯•ä¸Šä¸‹ï¼ˆæ–‡contextsï¼‰"></a>Swift å’Œ Objective-C è°ƒè¯•ä¸Šä¸‹ï¼ˆæ–‡contextsï¼‰</h4><p>é‡è¦çš„æ˜¯è¦æ³¨æ„è°ƒè¯•ç¨‹åºæ—¶æœ‰ä¸¤ä¸ªè°ƒè¯•ä¸Šä¸‹æ–‡ï¼šéSwiftè°ƒè¯•ä¸Šä¸‹æ–‡å’ŒSwiftä¸Šä¸‹æ–‡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“æ‚¨åœæ­¢ä½¿ç”¨Objective-Cä»£ç æ—¶ï¼ŒLLDBå°†ä½¿ç”¨éSwiftï¼ˆObjective-Cï¼‰è°ƒè¯•ä¸Šä¸‹æ–‡ï¼Œè€Œå¦‚æœæ‚¨åœ¨Swiftä»£ç ä¸­åœæ­¢ï¼Œåˆ™LLDBå°†ä½¿ç”¨Swiftä¸Šä¸‹æ–‡ã€‚å¬èµ·æ¥åˆä¹é€»è¾‘ï¼Œå¯¹å§ï¼Ÿ</p>
<p>ä½†æ˜¯ä½ ä¹Ÿå¯ä»¥æŒ‡å®šä¸Šä¸‹æ–‡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) expression -l objc -O -- [UIApplication sharedApplication]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨è¿™é‡Œï¼Œæ‚¨å‘Šè¯‰LLDBä½¿ç”¨Objective-Cçš„objcè¯­è¨€ã€‚å¦‚æœ‰å¿…è¦ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨objc + +ä½œä¸ºObjective-C ++ã€‚</p>
</blockquote>
<h4 id="ç”¨æˆ·å®šä¹‰å˜é‡"><a href="#ç”¨æˆ·å®šä¹‰å˜é‡" class="headerlink" title="ç”¨æˆ·å®šä¹‰å˜é‡"></a>ç”¨æˆ·å®šä¹‰å˜é‡</h4><p>å¦‚å‰æ‰€è¿°ï¼ŒLLDBå°†åœ¨æ‰“å°å¯¹è±¡æ—¶ä»£è¡¨æ‚¨è‡ªåŠ¨åˆ›å»ºå±€éƒ¨å˜é‡ã€‚æ‚¨ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå·±çš„å˜é‡ã€‚</p>
<p>ä½†æ˜¯è®°å¾—åå­—å‰é¢åŠ <code>$</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(lldb) po id $test = [NSObject new] </span><br><span class="line">(lldb) po $test </span><br><span class="line">&lt;NSObject: 0x60000001d190&gt;</span><br><span class="line">(lldb) expression -l swift -O -- $test //åˆ‡æ¢è‡³Swiftä¸Šä¸‹æ–‡ï¼ŒåŒæ ·å¯ç”¨</span><br><span class="line">&lt;NSObject: 0x60000001d190&gt;</span><br><span class="line">(lldb) expression -l swift -O -- $test.description //ä½†æ˜¯ä¸èƒ½æœŸå¾…ä¸€åˆ‡éƒ½æ­£å¸¸</span><br><span class="line">error: &lt;EXPR&gt;:3:1: error: use of unresolved identifier &#x27;$test&#x27; $test.description ^~~~~</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªæ­£åœ¨ç§¯æå¼€å‘çš„é¢†åŸŸï¼ŒObjective-Cå’ŒSwiftä¹‹é—´é€šè¿‡LLDBçš„æ¡¥æ¢å¯èƒ½ä¼šéšç€æ—¶é—´çš„æ¨ç§»è€Œæœ‰æ‰€æ”¹å–„ã€‚</p>
</blockquote>
<p>åœ¨Xcoodeåˆ›å»ºç¬¦å·æ–­ç‚¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Signals.MasterContainerViewController.viewDidLoad() -&gt; ()</span><br></pre></td></tr></table></figure>

<p>ç„¶å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(lldb) p self</span><br><span class="line">(lldb) po $R0.title //$R0æ˜¯ä¸Šä¸€æ­¥æ‰“å°å‡ºæ¥çš„selfçš„å˜é‡çš„åå­—</span><br><span class="line">(lldb) expression -l swift -- $R0.title = &quot;new title&quot; //è¿˜å¯ä»¥ä¿®æ”¹</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡é”®å…¥continueæˆ–æŒ‰Xcodeä¸­çš„æ’­æ”¾æŒ‰é’®æ¥æ¢å¤åº”ç”¨ç¨‹åºã€‚å°±ä¼šå‘ç°æ ‡é¢˜å·²ç»æ›´æ–°ä¸º â€™new titleâ€˜</p>
<h5 id="ç±»å‹æ ¼å¼åŒ–ï¼ˆType-formattingï¼‰"><a href="#ç±»å‹æ ¼å¼åŒ–ï¼ˆType-formattingï¼‰" class="headerlink" title="ç±»å‹æ ¼å¼åŒ–ï¼ˆType formattingï¼‰"></a>ç±»å‹æ ¼å¼åŒ–ï¼ˆType formattingï¼‰</h5><p>LLDBçš„ä¸€ä¸ªä¸é”™çš„é€‰æ‹©æ˜¯èƒ½å¤Ÿæ ¼å¼åŒ–åŸºæœ¬æ•°æ®ç±»å‹çš„è¾“å‡ºã€‚è¿™ä½¿å¾—LLDBæˆä¸ºäº†è§£ç¼–è¯‘å™¨å¦‚ä½•æ ¼å¼åŒ–åŸºæœ¬Cç±»å‹çš„ç»ä½³å·¥å…·ã€‚å½“ä½ æ­£åœ¨æ¢ç´¢æ±‡ç¼–éƒ¨åˆ†æ—¶ï¼Œè¿™æ˜¯å¿…é¡»çŸ¥é“çš„ï¼Œä½ å°†åœ¨æœ¬ä¹¦åé¢åšã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(lldb) expression -G x -- 10 //æŒ‡å®šåè¿›åˆ¶æ ¼å¼åŒ–è¾“å‡º</span><br><span class="line">(lldb) p/x 10 //åè¿›åˆ¶</span><br><span class="line">(lldb) p/t 10 //äºŒè¿›åˆ¶</span><br><span class="line">(lldb) p/d &#x27;D&#x27; //åè¿›åˆ¶</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-G &lt;gdb-format&gt; ( --gdb-format &lt;gdb-format&gt; )</span><br><span class="line">     Specify a format using a GDB format specifier string.</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºæ ¼å¼çš„å®Œæ•´åˆ—è¡¨å¦‚ä¸‹ï¼ˆå–è‡ª<a target="_blank" rel="noopener" href="https://sourceware.org/gdb/">https://sourceware.org/gdb/</a> onlinedocs &#x2F; gdb &#x2F; Output-Formats.htmlï¼‰ï¼š</p>
<ul>
<li>xï¼šåå…­è¿›åˆ¶</li>
<li>dï¼šåè¿›åˆ¶</li>
<li>uï¼šæ— ç¬¦å·åè¿›åˆ¶</li>
<li>oï¼šå…«è¿›åˆ¶</li>
<li>tï¼šäºŒè¿›åˆ¶</li>
<li>aï¼šåœ°å€</li>
<li>cï¼šå­—ç¬¦å¸¸é‡</li>
<li>fï¼šæµ®ç‚¹å‹</li>
<li>sï¼šå­—ç¬¦ä¸²</li>
</ul>
<p>å¦‚æœè¿™äº›æ ¼å¼ä¸å¤Ÿï¼Œæ‚¨å¯ä»¥ä½¿ç”¨LLDBçš„é¢å¤–æ ¼å¼åŒ–ç¨‹åºï¼Œä½†æ‚¨å°†æ— æ³•ä½¿ç”¨GDBæ ¼å¼åŒ–è¯­æ³•ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) expression -f Y -- 1430672467</span><br><span class="line">(int) $0 = 53 54 46 55             STFU</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-f &lt;format&gt; ( --format &lt;format&gt; )</span><br><span class="line">     Specify a format to be used for display.</span><br></pre></td></tr></table></figure>

<p>LLDBå…·æœ‰ä»¥ä¸‹æ ¼å¼åŒ–ç¨‹åºï¼ˆæ‘˜è‡ª<a target="_blank" rel="noopener" href="http://lldb.llvm.org/varformats.html%EF%BC%89%EF%BC%9A">http://lldb.llvm.org/varformats.htmlï¼‰ï¼š</a></p>
<ul>
<li><p>Bï¼šå¸ƒå°”å€¼</p>
</li>
<li><p>bï¼šäºŒè¿›åˆ¶</p>
</li>
<li><p>yï¼šå­—èŠ‚</p>
</li>
<li><p>Yï¼šASCIIå­—èŠ‚</p>
</li>
<li><p>cï¼šå­—ç¬¦</p>
</li>
<li><p>Cï¼šå¯æ‰“å°å­—ç¬¦</p>
</li>
<li><p>Fï¼šå¤æ‚çš„æµ®ç‚¹å‹ï¼ˆåŒ…å«å®éƒ¨å’Œè™šéƒ¨ï¼‰</p>
</li>
<li><p>sï¼šc-string</p>
</li>
<li><p>iï¼šåè¿›åˆ¶</p>
</li>
<li><p>Eï¼šæšä¸¾</p>
</li>
<li><p>xï¼šåå…­è¿›åˆ¶</p>
</li>
<li><p>fï¼šæµ®ç‚¹å‹</p>
</li>
<li><p>oï¼šå…«è¿›åˆ¶</p>
</li>
<li><p>Oï¼šMacOS OSType</p>
</li>
<li><p>Uï¼šUTF-16</p>
</li>
<li><p>uï¼šæ— ç¬¦å·åè¿›åˆ¶</p>
</li>
<li><p>pï¼šæŒ‡é’ˆ</p>
</li>
</ul>
<h3 id="ç¬¬6ç« ï¼šçº¿ç¨‹ï¼Œå¸§å’Œæ­¥è¿›ï¼ˆThread-Frame-amp-Stepping-Aroundï¼‰"><a href="#ç¬¬6ç« ï¼šçº¿ç¨‹ï¼Œå¸§å’Œæ­¥è¿›ï¼ˆThread-Frame-amp-Stepping-Aroundï¼‰" class="headerlink" title="ç¬¬6ç« ï¼šçº¿ç¨‹ï¼Œå¸§å’Œæ­¥è¿›ï¼ˆThread, Frame &amp; Stepping Aroundï¼‰"></a>ç¬¬6ç« ï¼šçº¿ç¨‹ï¼Œå¸§å’Œæ­¥è¿›ï¼ˆThread, Frame &amp; Stepping Aroundï¼‰</h3><p>æ‚¨å·²ç»å­¦ä¹ äº†å¦‚ä½•åˆ›å»ºæ–­ç‚¹ï¼Œå¦‚ä½•æ‰“å°å’Œä¿®æ”¹å€¼ï¼Œä»¥åŠå¦‚ä½•åœ¨è°ƒè¯•å™¨ä¸­æš‚åœæ—¶æ‰§è¡Œä»£ç ã€‚ä½†åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨å·²ç»å¤„äºé«˜åº¦å¹²ç‡¥çš„çŠ¶æ€ï¼Œå¦‚ä½•åœ¨è°ƒè¯•å™¨ä¸­ç§»åŠ¨å¹¶æ£€æŸ¥æ•°æ®ä¹‹å¤–çš„æ•°æ®ã€‚ç°åœ¨æ˜¯æ—¶å€™äº†ï¼</p>
<p>åœ¨æœ¬ç« ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•åœ¨LLDBå½“å‰æš‚åœæ—¶å°†è°ƒè¯•å™¨ç§»å…¥å’Œç§»å‡ºåŠŸèƒ½ã€‚</p>
<p>è¿™æ˜¯ä¸€é¡¹å…³é”®æŠ€èƒ½ï¼Œå› ä¸ºæ‚¨ç»å¸¸éœ€è¦åœ¨è¾“å…¥æˆ–é€€å‡ºä»£ç ç‰‡æ®µæ—¶éšæ—¶æ£€æŸ¥å€¼ã€‚</p>
<h4 id="ï¼ˆæ ˆçš„ç¬¬ä¸€è¯¾ï¼‰Stack-101"><a href="#ï¼ˆæ ˆçš„ç¬¬ä¸€è¯¾ï¼‰Stack-101" class="headerlink" title="ï¼ˆæ ˆçš„ç¬¬ä¸€è¯¾ï¼‰Stack 101"></a>ï¼ˆæ ˆçš„ç¬¬ä¸€è¯¾ï¼‰Stack 101</h4><p>å½“è®¡ç®—æœºç¨‹åºæ‰§è¡Œæ—¶ï¼Œå®ƒå°†å€¼å­˜å‚¨åœ¨å †å’Œæ ˆä¸­ã€‚ä¸¤è€…éƒ½æœ‰å…¶ä¼˜ç‚¹ã€‚ä½œä¸ºé«˜çº§è°ƒè¯•å™¨ï¼Œæ‚¨éœ€è¦å……åˆ†äº†è§£è¿™äº›å·¥ä½œåŸç†ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç®€è¦ä»‹ç»ä¸€ä¸‹è¿™ä¸ªæ ˆã€‚</p>
<p>æ ˆæ˜¯LIFOï¼ˆåè¿›å…ˆå‡ºï¼‰é˜Ÿåˆ—ï¼Œç”¨äºå­˜å‚¨å¯¹å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»£ç çš„å¼•ç”¨ã€‚è¿™ç§LIFOæ’åºæ„å‘³ç€æœ€è¿‘æ·»åŠ çš„ä»»ä½•å†…å®¹éƒ½ä¼šè¢«åˆ é™¤ã€‚æƒ³æƒ³ä¸€æ ˆç›˜å­ã€‚åœ¨é¡¶éƒ¨æ·»åŠ ä¸€ä¸ªç›˜å­ï¼Œå®ƒå°†æ˜¯ä½ é¦–å…ˆå–ä¸‹çš„ç›˜å­ã€‚</p>
<p>æ ˆæŒ‡é’ˆæŒ‡å‘æ ˆçš„å½“å‰é¡¶éƒ¨ã€‚åœ¨æ¿å—ç±»æ¯”ä¸­ï¼Œæ ˆæŒ‡é’ˆæŒ‡å‘é¡¶æ¿ï¼Œå‘Šè¯‰æ‚¨ä»å“ªé‡Œå–ä¸‹ä¸€å—æ¿ï¼Œæˆ–è€…åœ¨å“ªé‡Œæ”¾ä¸‹ä¸€å—æ¿ã€‚</p>
<p><img src="/../assets/image-20190628093457893.png" alt="image-20190628093457893"></p>
<p>åœ¨æ­¤å›¾ä¸­ï¼Œé«˜åœ°å€æ˜¾ç¤ºåœ¨é¡¶éƒ¨ï¼ˆ0xFFFFFFFFï¼‰ï¼Œä½åœ°å€æ˜¾ç¤ºåœ¨åº•éƒ¨ï¼ˆ0x00000000ï¼‰ï¼Œæ˜¾ç¤ºæ ˆå°†å‘ä¸‹å¢é•¿ã€‚</p>
<p>ä¸€äº›æ’å›¾å–œæ¬¢åœ¨åº•éƒ¨å…·æœ‰é«˜åœ°å€ä»¥ä¸æ¿ç±»æ¯”åŒ¹é…ï¼Œå› ä¸ºæ ˆå°†æ˜¾ç¤ºä¸ºå‘ä¸Šå¢é•¿ã€‚ä½†æ˜¯ï¼Œæˆ‘ç›¸ä¿¡ä»»ä½•å±•ç¤ºæ ˆçš„å›¾è¡¨éƒ½åº”æ˜¾ç¤ºä»é«˜åœ°å€å‘ä¸‹å¢é•¿ï¼Œå› ä¸ºè¿™ä¼šåœ¨ä»¥åè®¨è®ºæ ˆæŒ‡é’ˆçš„åç§»æ—¶å¼•èµ·è¾ƒå°‘çš„éº»çƒ¦ã€‚</p>
<h4 id="æ£€æŸ¥æ ˆçš„å¸§"><a href="#æ£€æŸ¥æ ˆçš„å¸§" class="headerlink" title="æ£€æŸ¥æ ˆçš„å¸§"></a>æ£€æŸ¥æ ˆçš„å¸§</h4><p>è¿™é‡Œæˆ‘å°†ä½¿ç”¨ iPhone X Simulatorã€‚</p>
<p>æ·»åŠ æ–­ç‚¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Signals.MasterViewController.viewWillAppear(Swift.Bool) -&gt; ()</span><br></pre></td></tr></table></figure>

<p><img src="/../assets/image-20190628094640418.jpg" alt="image-20190628094640418"></p>
<p>åœ¨Debug Navigatoré¢æ¿ä¸­ï¼Œå°†æ˜¾ç¤ºæ ˆè·Ÿè¸ªï¼Œæ˜¾ç¤ºæ ˆå¸§åˆ—è¡¨ï¼Œç¬¬ä¸€ä¸ªæ˜¯<code>viewWillAppear(_ :)</code>ã€‚æ¥ä¸‹æ¥æ˜¯Swift &#x2F; Objective-Cæ¡¥æ¥æ–¹æ³•ï¼Œ<code>@objc MasterViewController.viewWillAppear(Bool) -&gt;():</code>ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œæ‰€ä»¥Objective-Cå¯ä»¥è¿›å…¥Swiftä»£ç ã€‚</p>
<p>ä¹‹åï¼Œæœ‰ä¸€äº›æ¥è‡ªUIKitçš„Objective-Cä»£ç æ ˆå¸§ã€‚æ·±å…¥æŒ–æ˜ä¸€ä¸‹ï¼Œä½ ä¼šçœ‹åˆ°ä¸€äº›å±äºCoreAnimationçš„C ++ä»£ç ã€‚æ›´æ·±å…¥çš„æ˜¯ï¼Œä½ ä¼šçœ‹åˆ°ä¸€äº›æ–¹æ³•éƒ½åŒ…å«å±äºCoreFoundationçš„åç§°CFRunLoopã€‚æœ€åï¼Œæœ€é‡è¦çš„æ˜¯ï¼Œmainå‡½æ•°ã€‚</p>
<p>ä¸‹é¢è¿›å…¥LLDB consoleï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) thread backtrace</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ä½¿ç”¨<code>bt</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">(lldb) help bt</span><br><span class="line">     Show the current thread&#x27;s call stack.  Any numeric argument displays at</span><br><span class="line">     most that many frames.  The argument &#x27;all&#x27; displays all threads.  Expects</span><br><span class="line">     &#x27;raw&#x27; input (see &#x27;help raw-input&#x27;.)</span><br><span class="line"></span><br><span class="line">Syntax: bt [&lt;digit&gt; | all]</span><br><span class="line"></span><br><span class="line">&#x27;bt&#x27; is an abbreviation for &#x27;_regexp-bt&#x27;</span><br><span class="line">(lldb) help thread backtrace</span><br><span class="line">     Show thread call stacks.  Defaults to the current thread, thread indexes</span><br><span class="line">     can be specified as arguments.</span><br><span class="line">     Use the thread-index &quot;all&quot; to see all threads.</span><br><span class="line">     Use the thread-index &quot;unique&quot; to see threads grouped by unique call stacks.</span><br><span class="line"></span><br><span class="line">Syntax: thread backtrace &lt;cmd-options&gt;</span><br><span class="line"></span><br><span class="line">Command Options Usage:</span><br><span class="line">  thread backtrace [-c &lt;count&gt;] [-s &lt;frame-index&gt;] [-e &lt;boolean&gt;]</span><br><span class="line"></span><br><span class="line">       -c &lt;count&gt; ( --count &lt;count&gt; )</span><br><span class="line">            How many frames to display (-1 for all)</span><br><span class="line"></span><br><span class="line">       -e &lt;boolean&gt; ( --extended &lt;boolean&gt; )</span><br><span class="line">            Show the extended backtrace, if available</span><br><span class="line"></span><br><span class="line">       -s &lt;frame-index&gt; ( --start &lt;frame-index&gt; )</span><br><span class="line">            Frame in which to start the backtrace</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">(lldb) bt</span><br><span class="line">* thread #1, queue = &#x27;com.apple.main-thread&#x27;, stop reason = breakpoint 1.1</span><br><span class="line">  * frame #0: 0x0000000107044301 Signals`MasterViewController.viewWillAppear(animated=false, self=0x00007f9a26e0a670) at MasterViewController.swift:54:5</span><br><span class="line">    frame #1: 0x0000000107044993 Signals`@objc MasterViewController.viewWillAppear(_:) at &lt;compiler-generated&gt;:0</span><br><span class="line">    frame #2: 0x0000000110fc9437 UIKitCore`-[UIViewController _setViewAppearState:isAnimating:] + 687</span><br><span class="line">    frame #3: 0x0000000110fc9995 UIKitCore`__52-[UIViewController _setViewAppearState:isAnimating:]_block_invoke + 265</span><br><span class="line">    frame #4: 0x000000010957b33a CoreFoundation`-[__NSSingleObjectArrayI enumerateObjectsWithOptions:usingBlock:] + 58</span><br><span class="line">    frame #5: 0x0000000110fc9729 UIKitCore`-[UIViewController _setViewAppearState:isAnimating:] + 1441</span><br><span class="line">    frame #6: 0x0000000110fc9ba2 UIKitCore`-[UIViewController __viewWillAppear:] + 131</span><br><span class="line">    frame #7: 0x0000000110f275c9 UIKitCore`-[UINavigationController _startTransition:fromViewController:toViewController:] + 868</span><br><span class="line">    frame #8: 0x0000000110f283b5 UIKitCore`-[UINavigationController _startDeferredTransitionIfNeeded:] + 896</span><br><span class="line">    frame #9: 0x0000000110f296a7 UIKitCore`-[UINavigationController __viewWillLayoutSubviews] + 150</span><br><span class="line">    frame #10: 0x0000000110f0a38d UIKitCore`-[UILayoutContainerView layoutSubviews] + 217</span><br><span class="line">    frame #11: 0x0000000111a939c1 UIKitCore`-[UIView(CALayerDelegate) layoutSublayersOfLayer:] + 1417</span><br><span class="line">    frame #12: 0x000000010ea1feae QuartzCore`-[CALayer layoutSublayers] + 173</span><br><span class="line">    frame #13: 0x000000010ea24b88 QuartzCore`CA::Layer::layout_if_needed(CA::Transaction*) + 396</span><br><span class="line">    frame #14: 0x000000010ea30ee4 QuartzCore`CA::Layer::layout_and_display_if_needed(CA::Transaction*) + 72</span><br><span class="line">    frame #15: 0x000000010e9a03aa QuartzCore`CA::Context::commit_transaction(CA::Transaction*) + 328</span><br><span class="line">    frame #16: 0x000000010e9d7584 QuartzCore`CA::Transaction::commit() + 608</span><br><span class="line">    frame #17: 0x00000001115deccb UIKitCore`__34-[UIApplication _firstCommitBlock]_block_invoke_2 + 128</span><br><span class="line">    frame #18: 0x0000000109592aec CoreFoundation`__CFRUNLOOP_IS_CALLING_OUT_TO_A_BLOCK__ + 12</span><br><span class="line">    frame #19: 0x00000001095922b0 CoreFoundation`__CFRunLoopDoBlocks + 336</span><br><span class="line">    frame #20: 0x000000010958cb34 CoreFoundation`__CFRunLoopRun + 1252</span><br><span class="line">    frame #21: 0x000000010958c302 CoreFoundation`CFRunLoopRunSpecific + 626</span><br><span class="line">    frame #22: 0x000000010e8e22fe GraphicsServices`GSEventRunModal + 65</span><br><span class="line">    frame #23: 0x00000001115c5ba2 UIKitCore`UIApplicationMain + 140</span><br><span class="line">    frame #24: 0x000000010704b88b Signals`main at AppDelegate.swift:32:7</span><br><span class="line">    frame #25: 0x000000010af06541 libdyld.dylib`start + 1</span><br><span class="line">(lldb) frame info</span><br><span class="line">frame #0: 0x0000000107044301 Signals`MasterViewController.viewWillAppear(animated=false, self=0x00007f9a26e0a670) at MasterViewController.swift:54:5</span><br></pre></td></tr></table></figure>

<p>å¦‚æ‚¨æ‰€è§ï¼Œæ­¤è¾“å‡ºä¸Debug Navigatorä¸­æ‰¾åˆ°çš„å†…å®¹ç›¸åŒ¹é…ã€‚é‚£ä¹ˆï¼Œå¦‚æœæ‚¨åªæ˜¯ä»Debug Navigatorä¸­çœ‹åˆ°æ‰€æœ‰å†…å®¹ï¼Œä¸ºä»€ä¹ˆè¿™ç”šè‡³å¾ˆé‡è¦ï¼Ÿå¥½å§ï¼Œä½¿ç”¨LLDBæ§åˆ¶å°å¯ä»¥å¯¹æ‚¨æƒ³è¦æŸ¥çœ‹çš„ä¿¡æ¯è¿›è¡Œç»†è‡´çš„æ§åˆ¶ã€‚æ­¤å¤–ï¼Œæ‚¨å°†åˆ¶ä½œè‡ªå®šä¹‰LLDBè„šæœ¬ï¼Œå…¶ä¸­è¿™äº›å‘½ä»¤å°†å˜å¾—éå¸¸æœ‰ç”¨ã€‚çŸ¥é“Xcodeä»å“ªé‡Œè·å–ä¿¡æ¯ä¹Ÿå¾ˆå¥½ï¼Œå¯¹å§ï¼Ÿ</p>
<p>ç„¶åï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) frame select 1</span><br><span class="line">frame #1: 0x0000000107044993 Signals`@objc MasterViewController.viewWillAppear(_:) at &lt;compiler-generated&gt;:0</span><br></pre></td></tr></table></figure>

<p>è®°ä¸‹æ±‡ç¼–ä¸­çš„ç»¿çº¿ã€‚åœ¨è¯¥è¡Œä¹‹å‰æ˜¯è´Ÿè´£æ‰§è¡Œ<code>viewWillAppear(_:)</code>çš„<code>callq</code>æŒ‡ä»¤ï¼Œæ‚¨åœ¨ä¹‹å‰è®¾ç½®äº†æ–­ç‚¹ã€‚</p>
<p>ä¸è¦è®©æ±‡ç¼–å¤ªæ¨¡ç³Šä½ çš„çœ¼ç›ã€‚ä½ è¿˜æ²¡æœ‰èµ°å‡ºæ±‡ç¼–æ ‘æ—â€¦â€¦</p>
<h4 id="æ­¥è¿›"><a href="#æ­¥è¿›" class="headerlink" title="æ­¥è¿›"></a>æ­¥è¿›</h4><p>æŒæ¡LLDBæ—¶ï¼Œæ‚¨å¯ä»¥åœ¨ç¨‹åºæš‚åœæ—¶æ‰§è¡Œçš„ä¸‰ä¸ªæœ€é‡è¦çš„å¯¼èˆªæ“ä½œå›´ç»•ç€é€æ­¥æ‰§è¡Œç¨‹åºã€‚é€šè¿‡LLDBï¼Œæ‚¨å¯ä»¥è·³è¿‡ï¼ˆstep overï¼‰ï¼Œå•æ­¥æ‰§è¡Œï¼ˆstep inï¼‰æˆ–é€€å‡ºï¼ˆstep outï¼‰ä»£ç ã€‚</p>
<h5 id="è·³è¿‡"><a href="#è·³è¿‡" class="headerlink" title="è·³è¿‡"></a>è·³è¿‡</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) run //&#x27;run&#x27; is an abbreviation for &#x27;process launch -X true --&#x27;</span><br><span class="line">(lldb) next //&#x27;next&#x27; is an abbreviation for &#x27;thread step-over&#x27;</span><br></pre></td></tr></table></figure>

<h5 id="å•æ­¥æ‰§è¡Œ"><a href="#å•æ­¥æ‰§è¡Œ" class="headerlink" title="å•æ­¥æ‰§è¡Œ"></a>å•æ­¥æ‰§è¡Œ</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) step //&#x27;step&#x27; is an abbreviation for &#x27;thread step-in&#x27;</span><br></pre></td></tr></table></figure>

<h5 id="é€€å‡º"><a href="#é€€å‡º" class="headerlink" title="é€€å‡º"></a>é€€å‡º</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) finish //&#x27;finish&#x27; is an abbreviation for &#x27;thread step-out&#x27;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¯·è®°ä½ï¼Œåªéœ€æŒ‰Enteré”®ï¼ŒLLDBå°†æ‰§è¡Œæ‚¨è¾“å…¥çš„æœ€åä¸€ä¸ªå‘½ä»¤ã€‚</p>
</blockquote>
<h5 id="Xcode-ç•Œé¢ä¸­æ­¥è¿›"><a href="#Xcode-ç•Œé¢ä¸­æ­¥è¿›" class="headerlink" title="Xcode ç•Œé¢ä¸­æ­¥è¿›"></a>Xcode ç•Œé¢ä¸­æ­¥è¿›</h5><p>è™½ç„¶ä½¿ç”¨æ§åˆ¶å°å¯ä»¥è·å¾—æ›´åŠ ç²¾ç»†çš„æ§åˆ¶ï¼Œä½†Xcodeå·²ç»ä¸ºLLDBæ§åˆ¶å°ä¸Šæ–¹çš„æŒ‰é’®æä¾›äº†è¿™äº›é€‰é¡¹ã€‚</p>
<h4 id="æ£€æŸ¥æ ˆä¸­çš„æ•°æ®"><a href="#æ£€æŸ¥æ ˆä¸­çš„æ•°æ®" class="headerlink" title="æ£€æŸ¥æ ˆä¸­çš„æ•°æ®"></a>æ£€æŸ¥æ ˆä¸­çš„æ•°æ®</h4><p><code>frame</code> å‘½ä»¤çš„ä¸€ä¸ªéå¸¸æœ‰è¶£çš„é€‰é¡¹æ˜¯ <code>frame variable</code> å­å‘½ä»¤ã€‚</p>
<p>æ­¤å‘½ä»¤å°†è·å–å¯æ‰§è¡Œæ–‡ä»¶å¤´ä¸­çš„è°ƒè¯•ç¬¦å·ä¿¡æ¯ï¼ˆå¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºè¢«å‰¥ç¦»ï¼Œåˆ™ä¸ºdYSM â€¦ç¨åä¼šè¯¦ç»†ä»‹ç»ï¼‰å¹¶è½¬å‚¨è¯¥ç‰¹å®šæ ˆå¸§çš„ä¿¡æ¯ã€‚ç”±äºè°ƒè¯•ä¿¡æ¯ï¼Œframe variableå‘½ä»¤å¯ä»¥ä½¿ç”¨é€‚å½“çš„é€‰é¡¹è½»æ¾å‘Šè¯‰æ‚¨å‡½æ•°ä¸­æ‰€æœ‰å˜é‡çš„èŒƒå›´ä»¥åŠç¨‹åºä¸­çš„ä»»ä½•å…¨å±€å˜é‡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) frame variable</span><br><span class="line">(lldb) frame variable -F self //ä»¥å¹³é¢æ ¼å¼æ‰“å°ç»“æœ</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-F ( --flat )</span><br><span class="line">      Display results in a flat format that uses expression paths for each variable or member.</span><br></pre></td></tr></table></figure>

<p><img src="/Users/will/git/blog/source/assets/image-20190701112507258.jpg" alt="image-20190701112507258"></p>
<blockquote>
<p>æä¾›æœ‰å…³Appleç§æœ‰APIçš„ivarsçš„æ›´å¤šä¿¡æ¯ï¼Œè€Œä¸æ˜¯Variables Viewã€‚</p>
</blockquote>
<h3 id="ç¬¬7ç« ï¼šé•œåƒ-Image"><a href="#ç¬¬7ç« ï¼šé•œåƒ-Image" class="headerlink" title="ç¬¬7ç« ï¼šé•œåƒ(Image)"></a>ç¬¬7ç« ï¼šé•œåƒ(Image)</h3><p>ç°åœ¨æ˜¯æ—¶å€™æ¢ç´¢é€šè¿‡LLDBçš„æƒåŠ›æ‰¾åˆ°æ„Ÿå…´è¶£ä»£ç çš„æœ€ä½³å·¥å…·ä¹‹ä¸€ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæ‚¨å°†æ·±å…¥äº†è§£<code>image</code>å‘½ä»¤ã€‚</p>
<p><code>image</code>å‘½ä»¤æ˜¯<code>target modules</code>å­å‘½ä»¤çš„åˆ«åã€‚<code>image</code>å‘½ä»¤ä¸“é—¨æŸ¥è¯¢ module ä¿¡æ¯;ä¹Ÿå°±æ˜¯è¯´ï¼Œä»£ç åœ¨è¿›ç¨‹ä¸­åŠ è½½å’Œæ‰§è¡Œã€‚Module å¯ä»¥åŒ…å«è®¸å¤šä¸œè¥¿ï¼ŒåŒ…æ‹¬ä¸»è¦çš„å¯æ‰§è¡Œæ–‡ä»¶(main executables)ï¼Œæ¡†æ¶(framework)æˆ–æ’ä»¶(plugin)ã€‚ä½†æ˜¯ï¼Œè¿™äº›moduleä¸­çš„å¤§å¤šæ•°é€šå¸¸ä»¥åŠ¨æ€åº“(dynamic libraries)çš„å½¢å¼å‡ºç°ã€‚åŠ¨æ€åº“çš„ç¤ºä¾‹åŒ…æ‹¬é€‚ç”¨äºiOSçš„UIKitæˆ–é€‚ç”¨äºmacOSçš„AppKitã€‚</p>
<h4 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image list </span><br><span class="line">(lldb) image list Foundation</span><br><span class="line">[  0] FD4BF3C6-63C9-3A30-BEEA-D39F6F8EEB13 0x0000000107d70000 /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/System/Library/Frameworks/Foundation.framework/Foundation </span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯ä¸€ç§æœ‰ç”¨çš„æ–¹æ³•ï¼Œå¯ä»¥æ‰¾åˆ°æœ‰å…³æ‰€éœ€moduleçš„ä¿¡æ¯ã€‚</p>
<p>è®©æˆ‘ä»¬æ¥æ¢ç´¢è¿™ä¸ªè¾“å‡ºã€‚ é‚£é‡Œæœ‰ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿ï¼š</p>
<ol>
<li><p>é¦–å…ˆæ‰“å°moduleçš„UUIDï¼ˆFD4BF3C6-63C9-3A30-BEEA-D39F6F8EEB13ï¼‰ã€‚UUIDå¯¹äºæœç´¢ç¬¦å·ä¿¡æ¯å’Œå”¯ä¸€æ ‡è¯†Foundation moduleçš„ç‰ˆæœ¬éå¸¸é‡è¦ã€‚</p>
</li>
<li><p>åœ¨UUIDä¹‹åæ˜¯åŠ è½½åœ°å€ï¼ˆ0x0000000107d70000ï¼‰ã€‚ è¿™æ ‡è¯†å°†Foundation  moduleåŠ è½½åˆ°Signalså¯æ‰§è¡Œæ–‡ä»¶çš„è¿›ç¨‹ç©ºé—´ä¸­ã€‚</p>
</li>
<li><p>æœ€åï¼Œæ‚¨æ‹¥æœ‰moduleåœ¨ç£ç›˜ä¸Šæ‰€åœ¨ä½ç½®çš„å®Œæ•´è·¯å¾„ã€‚</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image dump symtab UIKitCore -s address</span><br></pre></td></tr></table></figure>

<p>è¿™å°†è½¬å‚¨UIKitCoreå¯ç”¨çš„æ‰€æœ‰ç¬¦å·è¡¨ä¿¡æ¯ã€‚ç”±äº<code>-s address</code>å‚æ•°ï¼Œæ­¤å‘½ä»¤æŒ‰ç§æœ‰UIKitCoreæ¨¡å—ä¸­å®ç°å‡½æ•°çš„åœ°å€å¯¹è¾“å‡ºè¿›è¡Œæ’åºã€‚</p>
<p>ä½†æ˜¯å¯è¯»æ€§ä¸ä½³ï¼Œéœ€è¦å¦å¤–ä¸€ä¸ªå‘½ä»¤æ¥æœç´¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -n &quot;-[UIViewController viewDidLoad]&quot;</span><br><span class="line">1 match found in /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/System/Library/PrivateFrameworks/UIKitCore.framework/UIKitCore:</span><br><span class="line">        Address: UIKitCore[0x000000000034adf9] (UIKitCore.__TEXT.__text + 3443497)</span><br><span class="line">        Summary: UIKitCore`-[UIViewController viewDidLoad]</span><br></pre></td></tr></table></figure>

<p>è¿™å°†è½¬å‚¨ä¸UIViewControllerçš„viewDidLoadå®ä¾‹æ–¹æ³•ç›¸å…³çš„ä¿¡æ¯ã€‚</p>
<p>å¦‚æœæƒ³ç”¨æ­£åˆ™æ¥æ¨¡ç³Šæœç´¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn UIViewController</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è¿™è¿˜ä¸å¤Ÿï¼Œå› ä¸ºç»“æœåŒ…å«äº†<code>UIViewControllerBuiltinTransitionViewAnimator</code>ï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œæ‰€æ”¹ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn &#x27;\[UIViewController\ &#x27;</span><br><span class="line">(lldb) image lookup -rn \[UIViewController\s //ç­‰ä»·çš„</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å¦‚æœæœç´¢Categoryï¼Œå‘½åè§„åˆ™ï¼š<code>UIViewController(CategoryName)</code>ï¼Œæ”¹è¿›å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn &#x27;\[UIViewController\(\w+\)\ &#x27;</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶è¿™äº›éƒ½æ˜¯å‚è€ƒæ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™ï¼Œç„¶åç”¨åœ¨å®é™…çš„éœ€æ±‚ä¸­ã€‚</p>
<h5 id="å¯»æ‰¾ä»£ç "><a href="#å¯»æ‰¾ä»£ç " class="headerlink" title="å¯»æ‰¾ä»£ç "></a>å¯»æ‰¾ä»£ç </h5><p>æ‚¨å¯ä»¥ä½¿ç”¨ä¸Šé¢çš„<code>image lookup</code>å‘½ä»¤æ‰¾åˆ°UIViewControlleræ–¹æ³•ã€‚æ‚¨è¿˜ä½¿ç”¨å®ƒæ¥å¯»æ‰¾ç¬¬4ç« â€œåœ¨ä»£ç ä¸­åœæ­¢â€ä¸­å¦‚ä½•å‘½åSwiftå±æ€§setterå’Œgetterã€‚</p>
<p>ä½†æ˜¯Blockå¦‚ä½•æœç´¢å‘¢ï¼Ÿå¦‚ä¸‹é¢ä¾‹å­</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dispatch_once(<span class="operator">&amp;</span>onceToken, <span class="operator">^</span>&#123;</span><br><span class="line">  sharedSignalHandler <span class="operator">=</span> [[<span class="type">UnixSignalHandler</span> alloc] initPrivate];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å…ˆåœ¨Xcodeæ·»åŠ æ–­ç‚¹ï¼Œç„¶åï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) frame info</span><br><span class="line">frame #0: 0x00000001048e1250 Commons`__34+[UnixSignalHandler sharedHandler]_block_invoke(.block_descriptor=0x00000001048e8230) at UnixSignalHandler.m:72:28</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°å®Œæ•´çš„å‡½æ•°åï¼š<code> __34+[UnixSignalHandler sharedHandler]_block_invoke</code></p>
<p>è®©æˆ‘ä»¬å…ˆè¯•è¯•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn _block_invoke</span><br></pre></td></tr></table></figure>

<p>ç»“æœå¤ªå¤šï¼Œæ·»åŠ èŒƒå›´é™åˆ¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn _block_invoke Commons</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨åˆ›å»ºæ–­ç‚¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) rb appendSignal.*_block_invoke -s Commons</span><br></pre></td></tr></table></figure>

<p>ä¹‹åæˆ‘å›åˆ°ç»ˆç«¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkill -SIGIO Signals</span><br></pre></td></tr></table></figure>

<p>å°±ä¼šè§¦å‘åˆšåˆšåˆ›å»ºçš„æ–­ç‚¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">2019-07-01 14:16:15.922561+0800 Signals[7583:429444] Appending new signal: SIGIO</span><br><span class="line">(lldb) frame variable</span><br><span class="line">(__block_literal_5 *) .block_descriptor = 0x0000600002f1d580</span><br><span class="line">(int) sig = &lt;read memory from 0x41 failed (0 of 4 bytes read)&gt;</span><br><span class="line"></span><br><span class="line">(siginfo_t *) siginfo = &lt;read memory from 0x39 failed (0 of 8 bytes read)&gt;</span><br><span class="line"></span><br><span class="line">(UnixSignalHandler *const) self = &lt;read memory from 0x31 failed (0 of 8 bytes read)&gt;</span><br><span class="line"></span><br><span class="line">(lldb) next</span><br><span class="line">(lldb) frame variable</span><br><span class="line">(__block_literal_5 *) .block_descriptor = 0x0000600002f1d580</span><br><span class="line">(int) sig = 23</span><br><span class="line">(siginfo_t *) siginfo = 0x00007ffeecdd9e78</span><br><span class="line">(UnixSignalHandler *) self = 0x0000600002f091c0</span><br><span class="line">(UnixSignal *) unixSignal = 0x0000000106ca4454</span><br></pre></td></tr></table></figure>

<p>æ‚¨éœ€è¦è·³è¿‡ä¸€ä¸ªè¯­å¥ï¼Œå› æ­¤å—æ‰§è¡Œäº†ä¸€äº›åˆå§‹é€»è¾‘æ¥è®¾ç½®å‡½æ•°ï¼Œä¹Ÿç§°ä¸ºå‡½æ•°åºè¨€ï¼ˆfunction prologueï¼‰ã€‚å‡½æ•°åºè¨€æ˜¯ä¸æ±‡ç¼–ç›¸å…³çš„ä¸»é¢˜ï¼Œæ‚¨å°†åœ¨ç¬¬IIèŠ‚ä¸­äº†è§£ã€‚</p>
<p>è¿™å®é™…ä¸Šéå¸¸æœ‰è¶£ã€‚é¦–å…ˆï¼Œæ‚¨ä¼šçœ‹åˆ°ä¸€ä¸ªblockçš„å¯¹è±¡ï¼Œæ­£åœ¨è°ƒç”¨çš„ã€‚ç„¶åæœ‰sigå’Œsiginfoå‚æ•°ä¼ é€’ç»™Objective-Cæ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­è°ƒç”¨æ­¤å—ã€‚è¿™äº›å¦‚ä½•ä¼ é€’åˆ°blockä¸­ï¼Ÿ</p>
<p>å¥½å§ï¼Œå½“åˆ›å»ºä¸€ä¸ªblockæ—¶ï¼Œç¼–è¯‘å™¨è¶³å¤Ÿèªæ˜ï¼Œå¯ä»¥ç¡®å®šå®ƒæ­£åœ¨ä½¿ç”¨å“ªäº›å‚æ•°ã€‚ç„¶åå®ƒåˆ›å»ºä¸€ä¸ªå°†è¿™äº›ä½œä¸ºå‚æ•°çš„å‡½æ•°ã€‚è°ƒç”¨å—æ—¶ï¼Œè°ƒç”¨æ­¤å‡½æ•°ï¼Œå¹¶ä¼ å…¥ç›¸å…³å‚æ•°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -t __block_literal_5</span><br><span class="line">Best match found in /Users/will/Library/Developer/Xcode/DerivedData/Signals-bgjklehkjddsnxcexztwhrufpsbn/Build/Products/Debug-iphonesimulator/Signals.app/Frameworks/Commons.framework/Commons:</span><br><span class="line">id = &#123;0x100000be1&#125;, name = &quot;__block_literal_5&quot;, byte-size = 52, decl = UnixSignalHandler.m:127, compiler_type = &quot;struct __block_literal_5 &#123;</span><br><span class="line">    void *__isa;</span><br><span class="line">    int __flags;</span><br><span class="line">    int __reserved;</span><br><span class="line">    void (*__FuncPtr)();</span><br><span class="line">    __block_descriptor_withcopydispose *__descriptor;</span><br><span class="line">    UnixSignalHandler *const self;</span><br><span class="line">    siginfo_t *siginfo;</span><br><span class="line">    int sig;</span><br><span class="line">&#125;&quot;</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯å®šä¹‰blockçš„å¯¹è±¡ï¼</p>
<p>æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œè¿™å‡ ä¹ä¸å¤´æ–‡ä»¶ä¸€æ ·å¥½ï¼Œå¯ä»¥å‘Šè¯‰æ‚¨å¦‚ä½•åœ¨blockä¸­å¯¼èˆªå†…å­˜ã€‚å¦‚æœå°†å†…å­˜ä¸­çš„å¼•ç”¨è½¬æ¢ä¸º<code>__block_literal_5</code>ç±»å‹ï¼Œåˆ™å¯ä»¥è½»æ¾æ‰“å°å‡ºblockå¼•ç”¨çš„æ‰€æœ‰å˜é‡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">(lldb) po ((__block_literal_5 *)0x0000600002f1d580)</span><br><span class="line">&lt;__NSMallocBlock__: 0x600002f1d580&gt;</span><br><span class="line">(lldb) p/x ((__block_literal_5 *)0x0000600002f1d580)-&gt;__FuncPtr</span><br><span class="line">(void (*)()) $1 = 0x0000000103143a80 (Commons`__38-[UnixSignalHandler appendSignal:sig:]_block_invoke_2 at UnixSignalHandler.m:127)</span><br><span class="line">(lldb) image lookup -a 0x0000000103143a80</span><br><span class="line">      Address: Commons[0x0000000000001a80] (Commons.__TEXT.__text + 2240)</span><br><span class="line">      Summary: Commons`__38-[UnixSignalHandler appendSignal:sig:]_block_invoke_2 at UnixSignalHandler.m:127</span><br><span class="line">(lldb) po ((__block_literal_5 *)0x0000600002f1d580)-&gt;sig //æ‰“å°å‡ºä¼ é€’ç»™blockçš„æ‰€æœ‰å‚æ•°</span><br><span class="line">23</span><br><span class="line">(lldb) p *(__block_literal_5 *)0x0000600002f1d580 //å¯ä»¥ä½¿ç”¨på‘½ä»¤è½¬å‚¨å®Œæ•´çš„ç»“æ„å¹¶è§£é™¤å¼•ç”¨æŒ‡é’ˆ</span><br><span class="line">(__block_literal_5) $4 = &#123;</span><br><span class="line">  __isa = 0x0000000106d6e170</span><br><span class="line">  __flags = -1023410174</span><br><span class="line">  __reserved = 0</span><br><span class="line">  __FuncPtr = 0x0000000103143a80 (Commons`__38-[UnixSignalHandler appendSignal:sig:]_block_invoke_2 at UnixSignalHandler.m:127)</span><br><span class="line">  __descriptor = 0x000000010314a2c0</span><br><span class="line">  self = 0x0000600002f091c0</span><br><span class="line">  siginfo = 0x00007ffeecdd9e78</span><br><span class="line">  sig = 23</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ·±å…¥ç ”ç©¶ï¼ˆSnooping-aroundï¼‰"><a href="#æ·±å…¥ç ”ç©¶ï¼ˆSnooping-aroundï¼‰" class="headerlink" title="æ·±å…¥ç ”ç©¶ï¼ˆSnooping aroundï¼‰"></a>æ·±å…¥ç ”ç©¶ï¼ˆSnooping aroundï¼‰</h4><p>å¥½çš„ï¼Œæ‚¨å·²ç»å‘ç°äº†å¦‚ä½•ä»¥é™æ€æ–¹å¼æ£€æŸ¥ç§æœ‰ç±»çš„å®ä¾‹å˜é‡ï¼Œä½†æ˜¯è¯¥å—å†…å­˜åœ°å€å¤ªè¿‡è¯±äººè€Œæ— æ³•ç½®ä¹‹ä¸ç†ã€‚ å°è¯•å°†å…¶æ‰“å°å‡ºæ¥å¹¶ä½¿ç”¨åŠ¨æ€åˆ†æè¿›è¡Œæ¢ç´¢ã€‚</p>
<p>ç›´æ¥æ‰“å°blockçš„å†…å­˜åœ°å€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">(lldb) po 0x0000600002f1d580</span><br><span class="line">&lt;__NSMallocBlock__: 0x600002f1d580&gt;</span><br><span class="line">(lldb) image lookup -rn __NSMallocBlock__ // æ²¡æœ‰ç»“æœ</span><br><span class="line">(lldb) po [__NSMallocBlock__ superclass]</span><br><span class="line">__NSMallocBlock</span><br><span class="line">(lldb) image lookup -rn __NSMallocBlock</span><br><span class="line">5 matches found in /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation:</span><br><span class="line">        Address: CoreFoundation[0x000000000018b600] (CoreFoundation.__TEXT.__text + 1614448)</span><br><span class="line">        Summary: CoreFoundation`-[__NSMallocBlock retain]        Address: CoreFoundation[0x000000000018b620] (CoreFoundation.__TEXT.__text + 1614480)</span><br><span class="line">        Summary: CoreFoundation`-[__NSMallocBlock release]        Address: CoreFoundation[0x000000000018b630] (CoreFoundation.__TEXT.__text + 1614496)</span><br><span class="line">        Summary: CoreFoundation`-[__NSMallocBlock retainCount]        Address: CoreFoundation[0x000000000018b640] (CoreFoundation.__TEXT.__text + 1614512)</span><br><span class="line">        Summary: CoreFoundation`-[__NSMallocBlock _tryRetain]        Address: CoreFoundation[0x000000000018b650] (CoreFoundation.__TEXT.__text + 1614528)</span><br><span class="line">        Summary: CoreFoundation`-[__NSMallocBlock _isDeallocating]</span><br><span class="line">        </span><br><span class="line">(lldb) po [__NSMallocBlock superclass]</span><br><span class="line">NSBlock</span><br><span class="line"></span><br><span class="line">(lldb) image lookup -rn &#x27;NSBlock\ &#x27;</span><br><span class="line">6 matches found in /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation:</span><br><span class="line">        Address: CoreFoundation[0x000000000018b4c0] (CoreFoundation.__TEXT.__text + 1614128)</span><br><span class="line">        Summary: CoreFoundation`+[NSBlock allocWithZone:]        Address: CoreFoundation[0x000000000018b4e0] (CoreFoundation.__TEXT.__text + 1614160)</span><br><span class="line">        Summary: CoreFoundation`+[NSBlock alloc]        Address: CoreFoundation[0x000000000018b500] (CoreFoundation.__TEXT.__text + 1614192)</span><br><span class="line">        Summary: CoreFoundation`-[NSBlock copy]        Address: CoreFoundation[0x000000000018b510] (CoreFoundation.__TEXT.__text + 1614208)</span><br><span class="line">        Summary: CoreFoundation`-[NSBlock copyWithZone:]        Address: CoreFoundation[0x000000000018b520] (CoreFoundation.__TEXT.__text + 1614224)</span><br><span class="line">        Summary: CoreFoundation`-[NSBlock invoke]        Address: CoreFoundation[0x000000000018b530] (CoreFoundation.__TEXT.__text + 1614240)</span><br><span class="line">        Summary: CoreFoundation`-[NSBlock performAfterDelay:]</span><br></pre></td></tr></table></figure>

<p>æ‚¨ç°åœ¨å°†å°è¯•åœ¨blockä¸Šè°ƒç”¨æ­¤æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œå½“ä¿ç•™æ­¤blockçš„å¼•ç”¨é‡Šæ”¾å…¶æ§åˆ¶æ—¶ï¼Œæ‚¨ä¸å¸Œæœ›å—æ¶ˆå¤±ï¼Œä»è€Œé™ä½retainCountï¼Œå¹¶å¯èƒ½é‡Šæ”¾blockã€‚</p>
<p>æœ‰ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥ä¿æŒè¿™ä¸ªblock - åªéœ€ <code>retain</code> å®ƒï¼åœ¨LLDBä¸­é”®å…¥ä»¥ä¸‹å†…å®¹ï¼Œå°†åœ°å€æ›¿æ¢ä¸ºblockçš„åœ°å€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(lldb) po id $block = (id)0x0000600002f1d580</span><br><span class="line">(lldb) po [$block retain]</span><br><span class="line">&lt;__NSMallocBlock__: 0x600002f1d580&gt;</span><br><span class="line"></span><br><span class="line">(lldb) po [$block invoke]</span><br><span class="line">2019-07-01 16:05:33.855039+0800 Signals[7583:452921] Appending new signal: SIGIO</span><br><span class="line"> nil</span><br></pre></td></tr></table></figure>

<p>è¿™è¡¨æ˜ä½ å·²ç»å†æ¬¡è°ƒç”¨äº†blockï¼</p>
<p>è¿™ç§ç”¨äºæ¢ç´¢å…¬å…±å’Œç§æœ‰ç±»ï¼Œç„¶åæ¢ç´¢å®ƒä»¬å®ç°çš„æ–¹æ³•çš„æ–¹æ³•ï¼Œæ˜¯äº†è§£ç¨‹åºè¦†ç›–èŒƒå›´å†…çš„å†…å®¹çš„å¥½æ–¹æ³•ã€‚ç¨åæ‚¨å°†å¯¹æ–¹æ³•ä½¿ç”¨ç›¸åŒçš„å‘ç°è¿‡ç¨‹ï¼Œç„¶ååˆ†æè¿™äº›æ–¹æ³•æ‰§è¡Œçš„ç¨‹åºé›†ï¼Œä¸ºæ‚¨æä¾›åŸå§‹æ–¹æ³•æºä»£ç çš„éå¸¸æ¥è¿‘çš„è¿‘ä¼¼å€¼ã€‚</p>
<h5 id="Private-debugging-methods"><a href="#Private-debugging-methods" class="headerlink" title="Private debugging methods"></a>Private debugging methods</h5><p><code>image lookup</code> å‘½ä»¤å¯ä»¥å¾ˆå¥½åœ°æœç´¢ç§æœ‰æ–¹æ³•ä»¥åŠæ‚¨åœ¨Appleå¼€å‘èŒä¸šç”Ÿæ¶¯ä¸­çœ‹åˆ°çš„å…¬å…±æ–¹æ³•ã€‚</p>
<p>ä½†æ˜¯ï¼Œåœ¨è°ƒè¯•è‡ªå·±çš„ä»£ç æ—¶ï¼Œæœ‰ä¸€äº›éšè—çš„æ–¹æ³•éå¸¸æœ‰ç”¨ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä»¥<code>_</code>å¼€å¤´çš„æ–¹æ³•é€šå¸¸è¡¨ç¤ºè‡ªå·±æ˜¯ä¸€ä¸ªç§æœ‰ï¼ˆä¹Ÿå¯èƒ½æ˜¯é‡è¦çš„ï¼ï¼‰æ–¹æ³•ã€‚</p>
<p>è®©æˆ‘ä»¬å°è¯•åœ¨æ‰€æœ‰ä»¥ä¸‹åˆ’çº¿å­—ç¬¦å¼€å¤´çš„æ¨¡å—ä¸­æœç´¢ä»»ä½•Objective-Cæ–¹æ³•ï¼Œå¹¶åœ¨å…¶ä¸­åŒ…å«å•è¯â€œdescriptionâ€ã€‚</p>
<p>å¦‚æœæ‚¨åœ¨é˜…è¯»æ­¤è¡Œä»£ç æ—¶æœ‰äº›è¿·æƒ‘ä¸è§£ï¼Œå¼ºçƒˆå»ºè®®æ‚¨ä»”ç»†é˜…è¯» <a target="_blank" rel="noopener" href="https://docs.python.org/2/library/re.html">https://docs.python.org/2/library/re.html</a> ä»¥äº†è§£æ­£åˆ™è¡¨è¾¾å¼æŸ¥è¯¢;ä»ç°åœ¨å¼€å§‹ï¼Œå®ƒåªä¼šå˜å¾—æ›´åŠ å¤æ‚ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn (?i)\ _\w+description\] //ä¸åŒºåˆ†å¤§å°å†™</span><br><span class="line">(lldb) image lookup -rn NSObject\(IvarDescription\)</span><br><span class="line">(lldb) po [[UIApplication sharedApplication] _ivarDescription]</span><br><span class="line">(lldb) image lookup -rn &#x27;\[UIStatusBar\ set&#x27; //æŸ¥æ‰¾æ‰€ä»¥setå¼€å¤´æ–¹æ³•</span><br><span class="line">(lldb) po (BOOL)[[UIStatusBar class] isSubclassOfClass:[UIView class]]</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡åœ°å€è°ƒç”¨å¯¹è±¡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(lldb) po [[UIApplication sharedApplication] statusBar]</span><br><span class="line">&lt;UIStatusBar_Modern: 0x7f9965e03f00; frame = (0 0; 375 44); autoresize = W+BM; layer = &lt;CALayer: 0x6000025dd640&gt;&gt;</span><br><span class="line"></span><br><span class="line">(lldb) po [0x7f9965e03f00 setBackgroundColor:[UIColor purpleColor]]</span><br><span class="line">purpleColor</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æœªå®Œå¾…ç»­</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/06/14/SwiftUI-By-Example-Notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/06/14/SwiftUI-By-Example-Notes/" class="post-title-link" itemprop="url">SwiftUI By Example ç¬”è®°</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-06-14 22:40:57" itemprop="dateCreated datePublished" datetime="2019-06-14T22:40:57+08:00">2019-06-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>åŸæ–‡ä¸º <a target="_blank" rel="noopener" href="https://click.pg.mlsend.com/link/c/YT0xMTc1OTUxMzkxNzkzODc4OTYyJmM9djB0OCZlPTE5MjgmYj0yNTYyNzIyMDImZD1xMWs3eDlr.F1niXtzxMJPvGR0n5OkwVQKdeuMBcqaV_PH83g6F9CQ">@twostraws</a> çš„ <a target="_blank" rel="noopener" href="https://click.pg.mlsend.com/link/c/YT0xMTc1OTUxMzkxNzkzODc4OTYyJmM9djB0OCZlPTE5MjgmYj0yNTYyNzIyMDYmZD12NmowZzZl.r3cdqNyvWJ5dIgoCiFs_1q8hUT3njlEH6fEv1rWAXGo">SwiftUI By Example</a>ï¼Œå°±æ˜¯ç®€å•è®°å½•ä¸€äº›ä¸»è¦å†…å®¹ã€‚</p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><strong>A brief explanation of the basics of SwiftUI</strong></p>
<h3 id="What-is-SwiftUI"><a href="#What-is-SwiftUI" class="headerlink" title="What is SwiftUI?"></a>What is SwiftUI?</h3><ol>
<li>å£°æ˜å¼å¯¹æ¯”å‘½ä»¤å¼ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†ä¸åŒçŠ¶æ€çš„UI</li>
<li>è·¨å¹³å°ï¼šæ”¯æŒ iOS, macOS, tvOS, watchOS</li>
</ol>
<h3 id="SwiftUI-vs-Interface-Builder-and-storyboards"><a href="#SwiftUI-vs-Interface-Builder-and-storyboards" class="headerlink" title="SwiftUI vs Interface Builder and storyboards"></a>SwiftUI vs Interface Builder and storyboards</h3><ol>
<li>IBéš¾ä»¥é˜…è¯»å’Œä¿®æ”¹</li>
<li>IBéš¾ä»¥çœ‹å‡ºä¿®æ”¹äº†å†…å®¹</li>
<li>IBå’ŒSwiftäº¤äº’ä¸å¤Ÿå‹å¥½ï¼Œå……æ»¡äº†Objective-Cè®¾è®¡</li>
<li>SwiftUIæ˜¯ä¸ªä»…æ”¯æŒSwift çš„åº“ï¼Œè¿™æ ·æ‰å¯ä»¥å……åˆ†åˆ©ç”¨Swiftçš„ç‰¹æ€§</li>
</ol>
<p>Anyway, weâ€™ll get onto exactly how SwiftUI works soon. For now, the least you need to know is that SwiftUI fixes many problems people had with the old Swift + Interface Builder approach:</p>
<ul>
<li>We no longer have to argue about programmatic or storyboard-based design, because SwiftUI gives us both at the same time.</li>
<li>We no longer have to worry about creating source control problems when committing user interface work, because code is much easier to read and manage than storyboard XML.</li>
<li>We no longer need to worry so much about stringly typed APIs â€“ there are still some, but significantly fewer.</li>
<li>We no longer need to worry about calling functions that donâ€™t exist, because our user interface gets checked by the Swift compiler.</li>
</ul>
<p>So, I hope youâ€™ll agree there are lots of benefits to be had from moving to SwiftUI!</p>
<h3 id="Frequently-asked-questions-about-SwiftUI"><a href="#Frequently-asked-questions-about-SwiftUI" class="headerlink" title="Frequently asked questions about SwiftUI"></a>Frequently asked questions about SwiftUI</h3><h4 id="Does-SwiftUI-replace-UIKit"><a href="#Does-SwiftUI-replace-UIKit" class="headerlink" title="Does SwiftUI replace UIKit?"></a>Does SwiftUI replace UIKit?</h4><p>No. Many parts of SwiftUI directly build on top of existing UIKit components, such as UITableView. Of course, many other parts donâ€™t â€“ they are new controls rendered by SwiftUI and not UIKit.</p>
<p>But the point isnâ€™t to what extent UIKit is involved. Instead, the point is that we donâ€™t <em>care</em>. SwiftUI more or less completely masks UIKitâ€™s behavior, so if you write your app for SwiftUI and Apple replaces UIKit with a singing elephant in two years you donâ€™t have to care â€“ as long as Apple makes the elephant compatible with the same methods and properties that UIKit exposed to SwiftUI, your code doesnâ€™t change.</p>
<h4 id="Is-SwiftUI-fast"><a href="#Is-SwiftUI-fast" class="headerlink" title="Is SwiftUI fast?"></a>Is SwiftUI fast?</h4><p>SwiftUI is <em>screamingly</em> fast â€“ in all my tests so far it seems to outpace UIKit. Having spoken to the team who made it Iâ€™m starting to get an idea why: first, they aggressively flatten their layer hierarchy so the system has to do less drawing, but second many operations bypass Core Animation entirely and go straight to Metal for extra speed.</p>
<p>So, yes: SwiftUI is incredibly fast, and all without us having to do any extra work.</p>
<h3 id="How-to-follow-this-quick-start-guide"><a href="#How-to-follow-this-quick-start-guide" class="headerlink" title="How to follow this quick start guide"></a>How to follow this quick start guide</h3><p>æœ€å¥½é¡ºåºé˜…è¯»è¯¥æ•™ç¨‹</p>
<h3 id="Migrating-from-UIKit-to-SwiftUI"><a href="#Migrating-from-UIKit-to-SwiftUI" class="headerlink" title="Migrating from UIKit to SwiftUI"></a>Migrating from UIKit to SwiftUI</h3><p>å¦‚æœä½ ç”¨è¿‡UIKitï¼Œä¸éš¾å‘ç°SwiftUIå°±æ˜¯æŠŠUIå‰ç¼€å»æ‰æ—¢æ˜¯å¯¹åº”çš„ç»„ä»¶ã€‚</p>
<p>Hereâ€™s a list to get you started, with UIKit class names followed by SwiftUI names:</p>
<ul>
<li><code>UITableView</code>: <code>List</code></li>
<li><code>UICollectionView</code>: No SwiftUI equivalent</li>
<li><code>UILabel</code>: <code>Text</code></li>
<li><code>UITextField</code>: <code>TextField</code></li>
<li><code>UITextField</code> with <code>isSecureTextEntry</code> set to true: <code>SecureField</code></li>
<li><code>UITextView</code>: No SwiftUI equivalent</li>
<li><code>UISwitch</code>: <code>Toggle</code></li>
<li><code>UISlider</code>: <code>Slider</code></li>
<li><code>UIButton</code>: <code>Button</code></li>
<li><code>UINavigationController</code>: <code>NavigationView</code></li>
<li><code>UIAlertController</code> with style <code>.alert</code>: <code>Alert</code></li>
<li><code>UIAlertController</code> with style <code>.actionSheet</code>: <code>ActionSheet</code></li>
<li><code>UIStackView</code> with horizontal axis: <code>HStack</code></li>
<li><code>UIStackView</code> with vertical axis: <code>VStack</code></li>
<li><code>UIImageView</code>: <code>Image</code></li>
<li><code>UISegmentedControl</code>: <code>SegmentedControl</code></li>
<li><code>UIStepper</code>: <code>Stepper</code></li>
<li><code>UIDatePicker</code>: <code>DatePicker</code></li>
<li><code>NSAttributedString</code>: Incompatible with SwiftUI; use <code>Text</code> instead.</li>
</ul>
<h2 id="Text-and-images"><a href="#Text-and-images" class="headerlink" title="Text and images"></a>Text and images</h2><p><strong>Getting started with basic controls</strong></p>
<h3 id="Whatâ€™s-in-the-basic-template"><a href="#Whatâ€™s-in-the-basic-template" class="headerlink" title="Whatâ€™s in the basic template?"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/whats-in-the-basic-template">Whatâ€™s in the basic template?</a></h3><p>SceneDelegate.swift is responsible for managing the way your app is shown.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> window <span class="operator">=</span> <span class="type">UIWindow</span>(frame: <span class="type">UIScreen</span>.main.bounds)</span><br><span class="line">window.rootViewController <span class="operator">=</span> <span class="type">UIHostingController</span>(rootView: <span class="type">ContentView</span>())</span><br><span class="line"><span class="keyword">self</span>.window <span class="operator">=</span> window</span><br><span class="line">window.makeKeyAndVisible()</span><br></pre></td></tr></table></figure>

<p>Open ContentView.swift and letâ€™s look at some actual SwiftUI code.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">#if</span> <span class="type">DEBUG</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Previews</span> : <span class="title class_">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">#endif</span></span><br></pre></td></tr></table></figure>

<p>First, notice how <code>ContentView</code> is a struct.</p>
<p>Second, <code>ContentView</code> conforms to the <code>View</code> protocol.</p>
<p>ç¬¬ä¸‰ï¼Œ<code>body</code>çš„è¿”å›ç±»å‹æ˜¯<code>some view</code>ã€‚ <code>some</code>å…³é”®å­—æ˜¯Swift 5.1ä¸­çš„æ–°å…³é”®å­—ï¼Œæ˜¯åä¸º<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=DvHkeUxiwYY">opaque return types</a>çš„åŠŸèƒ½çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°±æ˜¯å­—é¢æ„æ€ï¼šâ€è¿™å°†è¿”å›æŸç§<code>View</code>ï¼Œä½†SwiftUIä¸éœ€è¦çŸ¥é“ï¼ˆæˆ–å…³å¿ƒï¼‰ä»€ä¹ˆã€‚â€</p>
<p>Finally, below <code>ContentView</code> is a similar-but-different struct called <code>ContentView_Previews</code>.</p>
<h3 id="How-to-create-static-labels-with-a-Text-view"><a href="#How-to-create-static-labels-with-a-Text-view" class="headerlink" title="How to create static labels with a Text view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-static-labels-with-a-text-view">How to create static labels with a Text view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">    .lineLimit(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;This is an extremely long string that will never fit even the widest of Phones&quot;</span>)</span><br><span class="line">    .truncationMode(.middle)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-style-text-views-with-fonts-colors-line-spacing-and-more"><a href="#How-to-style-text-views-with-fonts-colors-line-spacing-and-more" class="headerlink" title="How to style text views with fonts, colors, line spacing, and more"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-style-text-views-with-fonts-colors-line-spacing-and-more">How to style text views with fonts, colors, line spacing, and more</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;This is an extremely long string that will never fit even the widest of Phones&quot;</span>)</span><br><span class="line">        .truncationMode(.middle)</span><br><span class="line">        .font(<span class="type">Font</span>.body)</span><br><span class="line">        .foregroundColor(<span class="type">Color</span>.green)</span><br><span class="line">        .background(<span class="type">Color</span>.gray)</span><br><span class="line">        .lineLimit(<span class="literal">nil</span>)</span><br><span class="line">        .lineSpacing(<span class="number">30</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-format-text-inside-text-views"><a href="#How-to-format-text-inside-text-views" class="headerlink" title="How to format text inside text views"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-format-text-inside-text-views">How to format text inside text views</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> taskDateFormat: <span class="type">DateFormatter</span> <span class="operator">=</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> formatter <span class="operator">=</span> <span class="type">DateFormatter</span>()</span><br><span class="line">        formatter.dateStyle <span class="operator">=</span> .long</span><br><span class="line">        <span class="keyword">return</span> formatter</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> dueDate <span class="operator">=</span> <span class="type">Date</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Task due date: <span class="subst">\(dueDate, formatter: <span class="keyword">Self</span>.taskDateFormat)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="How-to-draw-images-using-Image-views"><a href="#How-to-draw-images-using-Image-views" class="headerlink" title="How to draw images using Image views"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-draw-images-using-image-views">How to draw images using Image views</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Image</span>(systemName: <span class="string">&quot;cloud.heavyrain.fill&quot;</span>)</span><br><span class="line">    .foregroundColor(.red)</span><br><span class="line">		.font(.largeTitle)</span><br></pre></td></tr></table></figure>



<h3 id="How-to-adjust-the-way-an-image-is-fitted-to-its-space"><a href="#How-to-adjust-the-way-an-image-is-fitted-to-its-space" class="headerlink" title="How to adjust the way an image is fitted to its space"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-adjust-the-way-an-image-is-fitted-to-its-space">How to adjust the way an image is fitted to its space</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>)</span><br><span class="line">    .resizable()</span><br><span class="line">    .aspectRatio(contentMode: .fill)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-render-a-gradient"><a href="#How-to-render-a-gradient" class="headerlink" title="How to render a gradient"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-render-a-gradient">How to render a gradient</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">    .padding()</span><br><span class="line">    .foregroundColor(.white)</span><br><span class="line">    .background(<span class="type">LinearGradient</span>(gradient: <span class="type">Gradient</span>(colors: [.white, .black]), startPoint: .top, endPoint: .bottom), cornerRadius: <span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>æ”¯æŒæ›´å¤šé¢œè‰²çš„æ¸å˜</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">    .padding()</span><br><span class="line">    .foregroundColor(.white)</span><br><span class="line">    .background(<span class="type">LinearGradient</span>(gradient: <span class="type">Gradient</span>(colors: [.white, .red, .black]), startPoint: .leading, endPoint: .trailing), cornerRadius: <span class="number">0</span>)</span><br></pre></td></tr></table></figure>



<h3 id="How-to-display-solid-shapes"><a href="#How-to-display-solid-shapes" class="headerlink" title="How to display solid shapes"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-display-solid-shapes">How to display solid shapes</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Rectangle</span>()</span><br><span class="line">    .fill(<span class="type">Color</span>.red)</span><br><span class="line">    .frame(width: <span class="number">200</span>, height: <span class="number">200</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-use-images-and-other-views-as-a-backgrounds"><a href="#How-to-use-images-and-other-views-as-a-backgrounds" class="headerlink" title="How to use images and other views as a backgrounds"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-use-images-and-other-views-as-a-backgrounds">How to use images and other views as a backgrounds</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hacking with Swift&quot;</span>)</span><br><span class="line">    .font(.largeTitle)</span><br><span class="line">    .background(</span><br><span class="line">        <span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>)</span><br><span class="line">            .resizable()</span><br><span class="line">            .frame(width: <span class="number">100</span>, height: <span class="number">100</span>))</span><br></pre></td></tr></table></figure>

<h2 id="View-layout"><a href="#View-layout" class="headerlink" title="View layout"></a>View layout</h2><p><strong>Position views in a grid structure and more</strong></p>
<h3 id="How-to-create-stacks-using-VStack-and-HStack"><a href="#How-to-create-stacks-using-VStack-and-HStack" class="headerlink" title="How to create stacks using VStack and HStack"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-stacks-using-vstack-and-hstack">How to create stacks using VStack and HStack</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">VStack</span> &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;SwiftUI&quot;</span>)</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;rocks&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-customize-stack-layouts-with-alignment-and-spacing"><a href="#How-to-customize-stack-layouts-with-alignment-and-spacing" class="headerlink" title="How to customize stack layouts with alignment and spacing"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-customize-stack-layouts-with-alignment-and-spacing">How to customize stack layouts with alignment and spacing</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">VStack</span>(alignment: .leading, spacing: <span class="number">20</span>) &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;SwiftUI&quot;</span>)</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;rocks&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-control-spacing-around-individual-views-using-padding"><a href="#How-to-control-spacing-around-individual-views-using-padding" class="headerlink" title="How to control spacing around individual views using padding"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-control-spacing-around-individual-views-using-padding">How to control spacing around individual views using padding</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;SwiftUI&quot;</span>)</span><br><span class="line">    .padding(.bottom, <span class="number">100</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-layer-views-on-top-of-each-other-using-ZStack"><a href="#How-to-layer-views-on-top-of-each-other-using-ZStack" class="headerlink" title="How to layer views on top of each other using ZStack"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-layer-views-on-top-of-each-other-using-zstack">How to layer views on top of each other using ZStack</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ZStack</span> &#123;</span><br><span class="line">           <span class="type">Rectangle</span>()</span><br><span class="line">               .fill(<span class="type">Color</span>.red)</span><br><span class="line">           <span class="type">Text</span>(<span class="string">&quot;Hacking with Swift&quot;</span>)</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>



<h3 id="How-to-return-different-view-types"><a href="#How-to-return-different-view-types" class="headerlink" title="How to return different view types"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-return-different-view-types">How to return different view types</a></h3><p>ç¬¬ä¸€ç§æ–¹æ¡ˆ</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">Group</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="type">Bool</span>.random() &#123;</span><br><span class="line">            <span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Better luck next time&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒç§æ–¹æ¡ˆ</p>
<p>If you havenâ€™t heard of this concept, it effectively forces Swift to forget about what specific type is inside the <code>AnyView</code>, allowing them to look like they are the same thing. This has a performance cost, though, so donâ€™t use it often.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: <span class="type">AnyView</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="type">Bool</span>.random() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">AnyView</span>(<span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">AnyView</span>(<span class="type">Text</span>(<span class="string">&quot;Better luck next time&quot;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="How-to-create-views-in-a-loop-using-ForEach"><a href="#How-to-create-views-in-a-loop-using-ForEach" class="headerlink" title="How to create views in a loop using ForEach"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-views-in-a-loop-using-foreach">How to create views in a loop using ForEach</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">    <span class="type">ForEach</span>((<span class="number">1</span><span class="operator">...</span><span class="number">10</span>).reversed()) &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;<span class="subst">\(<span class="variable">$0</span>)</span>â€¦&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;Ready or not, here I come!&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> colors: [<span class="type">Color</span>] <span class="operator">=</span> [.red, .green, .blue]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">ForEach</span>(colors.identified(by: \.<span class="keyword">self</span>)) &#123; color <span class="keyword">in</span></span><br><span class="line">                <span class="type">Text</span>(color.description.capitalized)</span><br><span class="line">                    .padding()</span><br><span class="line">                    .background(color)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-different-layouts-using-size-classes"><a href="#How-to-create-different-layouts-using-size-classes" class="headerlink" title="How to create different layouts using size classes"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-different-layouts-using-size-classes">How to create different layouts using size classes</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@Environment</span>(\.horizontalSizeClass) <span class="keyword">var</span> horizontalSizeClass: <span class="type">UserInterfaceSizeClass</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> horizontalSizeClass <span class="operator">==</span> .compact &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">Text</span>(<span class="string">&quot;Compact&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">Text</span>(<span class="string">&quot;Regular&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-place-content-outside-the-safe-area"><a href="#How-to-place-content-outside-the-safe-area" class="headerlink" title="How to place content outside the safe area"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-place-content-outside-the-safe-area">How to place content outside the safe area</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">    .frame(minWidth: <span class="number">0</span>, maxWidth: .infinity, minHeight: <span class="number">0</span>, maxHeight: .infinity)</span><br><span class="line">    .background(<span class="type">Color</span>.red)</span><br><span class="line">    .edgesIgnoringSafeArea(.all)</span><br></pre></td></tr></table></figure>

<h2 id="Reading-input"><a href="#Reading-input" class="headerlink" title="Reading input"></a>Reading input</h2><p><strong>Respond to interaction and control your program state</strong></p>
<h3 id="Working-with-state"><a href="#Working-with-state" class="headerlink" title="Working with state"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/working-with-state">Working with state</a></h3><p>SwiftUI solves this problem by removing state from our control. When we add properties to our views they are effectively inert â€“ they have values, sure, but changing them doesnâ€™t do anything. But if we added the special <code>@State</code> attribute before them, SwiftUI will automatically watch for changes and update any parts of our views that use that state.</p>
<h3 id="How-to-create-a-toggle-switch"><a href="#How-to-create-a-toggle-switch" class="headerlink" title="How to create a toggle switch"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-toggle-switch">How to create a toggle switch</a></h3><p>ç›¸åï¼Œæˆ‘ä»¬åº”è¯¥å®šä¹‰ä¸€ä¸ª<code>@State</code>å¸ƒå°”å±æ€§ï¼Œç”¨äºå­˜å‚¨åˆ‡æ¢çš„å½“å‰å€¼ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showGreeting <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Toggle</span>(isOn: <span class="variable">$showGreeting</span>) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Show welcome message&quot;</span>)</span><br><span class="line">            &#125;.padding()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showGreeting &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-a-tappable-button"><a href="#How-to-create-a-tappable-button" class="headerlink" title="How to create a tappable button"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-tappable-button">How to create a tappable button</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showDetails <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Button</span>(action: &#123;</span><br><span class="line">                <span class="keyword">self</span>.showDetails.toggle()</span><br><span class="line">            &#125;) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Show details&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetails &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;You should follow me on Twitter: @twostraws&quot;</span>)</span><br><span class="line">                    .font(.largeTitle)</span><br><span class="line">                    .lineLimit(<span class="literal">nil</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-read-text-from-a-TextField"><a href="#How-to-read-text-from-a-TextField" class="headerlink" title="How to read text from a TextField"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-read-text-from-a-textfield">How to read text from a TextField</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> name: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;Tim&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">TextField</span>(<span class="variable">$name</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Hello, <span class="subst">\(name)</span>!&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-add-a-border-to-a-TextField"><a href="#How-to-add-a-border-to-a-TextField" class="headerlink" title="How to add a border to a TextField"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-add-a-border-to-a-textfield">How to add a border to a TextField</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">TextField</span>(<span class="variable">$yourBindingHere</span>)</span><br><span class="line">    .textFieldStyle(.roundedBorder)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-secure-text-fields-using-SecureField"><a href="#How-to-create-secure-text-fields-using-SecureField" class="headerlink" title="How to create secure text fields using SecureField"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-secure-text-fields-using-securefield">How to create secure text fields using SecureField</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> password: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">SecureField</span>(<span class="variable">$password</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;You entered: <span class="subst">\(password)</span>&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-a-Slider-and-read-values-from-it"><a href="#How-to-create-a-Slider-and-read-values-from-it" class="headerlink" title="How to create a Slider and read values from it"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-slider-and-read-values-from-it">How to create a Slider and read values from it</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> celsius: <span class="type">Double</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Slider</span>(value: <span class="variable">$celsius</span>, from: <span class="operator">-</span><span class="number">100</span>, through: <span class="number">100</span>, by: <span class="number">0.1</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;<span class="subst">\(celsius)</span> Celsius is <span class="subst">\(celsius <span class="operator">*</span> <span class="number">9</span> <span class="operator">/</span> <span class="number">5</span> <span class="operator">+</span> <span class="number">32</span>)</span> Fahrenheit&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-a-date-picker-and-read-values-from-it"><a href="#How-to-create-a-date-picker-and-read-values-from-it" class="headerlink" title="How to create a date picker and read values from it"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-date-picker-and-read-values-from-it">How to create a date picker and read values from it</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">   <span class="keyword">var</span> colors <span class="operator">=</span> [<span class="string">&quot;Red&quot;</span>, <span class="string">&quot;Green&quot;</span>, <span class="string">&quot;Blue&quot;</span>, <span class="string">&quot;Tartan&quot;</span>]</span><br><span class="line">   <span class="meta">@State</span> <span class="keyword">var</span> selectedColor <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">      <span class="type">VStack</span> &#123;</span><br><span class="line">         <span class="type">Picker</span>(selection: <span class="variable">$selectedColor</span>, label: <span class="type">Text</span>(<span class="string">&quot;Please choose a color&quot;</span>)) &#123;</span><br><span class="line">            <span class="type">ForEach</span>(<span class="number">0</span> <span class="operator">..&lt;</span> colors.count) &#123;</span><br><span class="line">               <span class="type">Text</span>(<span class="keyword">self</span>.colors[<span class="variable">$0</span>]).tag(<span class="variable">$0</span>)</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="type">Text</span>(<span class="string">&quot;You selected: <span class="subst">\(colors[selectedColor])</span>&quot;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-a-segmented-control-and-read-values-from-it"><a href="#How-to-create-a-segmented-control-and-read-values-from-it" class="headerlink" title="How to create a segmented control and read values from it"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-segmented-control-and-read-values-from-it">How to create a segmented control and read values from it</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> favoriteColor <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">var</span> colors <span class="operator">=</span> [<span class="string">&quot;Red&quot;</span>, <span class="string">&quot;Green&quot;</span>, <span class="string">&quot;Blue&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">SegmentedControl</span>(selection: <span class="variable">$favoriteColor</span>) &#123;</span><br><span class="line">                <span class="type">ForEach</span>(<span class="number">0</span><span class="operator">..&lt;</span>colors.count) &#123; index <span class="keyword">in</span></span><br><span class="line">                    <span class="type">Text</span>(<span class="keyword">self</span>.colors[index]).tag(index)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Value: <span class="subst">\(colors[favoriteColor])</span>&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-read-tap-and-double-tap-gestures"><a href="#How-to-read-tap-and-double-tap-gestures" class="headerlink" title="How to read tap and double-tap gestures"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-read-tap-and-double-tap-gestures">How to read tap and double-tap gestures</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>)</span><br><span class="line">    .tapAction(count: <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Double tapped!&quot;</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-add-a-gesture-recognizer-to-a-view"><a href="#How-to-add-a-gesture-recognizer-to-a-view" class="headerlink" title="How to add a gesture recognizer to a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-add-a-gesture-recognizer-to-a-view">How to add a gesture recognizer to a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> scale: <span class="type">Length</span> <span class="operator">=</span> <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>)</span><br><span class="line">            .scaleEffect(scale)</span><br><span class="line"></span><br><span class="line">            .gesture(</span><br><span class="line">                <span class="type">TapGesture</span>()</span><br><span class="line">                    .onEnded &#123; <span class="keyword">_</span> <span class="keyword">in</span></span><br><span class="line">                        <span class="keyword">self</span>.scale <span class="operator">+=</span> <span class="number">0.1</span></span><br><span class="line">                    &#125;</span><br><span class="line">            )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h2><p><strong>Create scrolling tables of data</strong></p>
<h3 id="Working-with-lists"><a href="#Working-with-lists" class="headerlink" title="Working with lists"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/working-with-lists">Working with lists</a></h3><p>SwiftUIâ€™s <code>List</code> view is similar to <code>UITableView</code> in that it can show static or dynamic table view cells based on your needs.</p>
<h3 id="How-to-create-a-list-of-static-items"><a href="#How-to-create-a-list-of-static-items" class="headerlink" title="How to create a list of static items"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-list-of-static-items">How to create a list of static items</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">RestaurantRow</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Restaurant: <span class="subst">\(name)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">RestaurantRow</span>(name: <span class="string">&quot;Joe&#x27;s Original&quot;</span>)</span><br><span class="line">            <span class="type">RestaurantRow</span>(name: <span class="string">&quot;The Real Joe&#x27;s Original&quot;</span>)</span><br><span class="line">            <span class="type">RestaurantRow</span>(name: <span class="string">&quot;Original Joe&#x27;s&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-a-list-of-dynamic-items"><a href="#How-to-create-a-list-of-dynamic-items" class="headerlink" title="How to create a list of dynamic items"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-list-of-dynamic-items">How to create a list of dynamic items</a></h3><p>In order to handle dynamic items, you must first tell SwiftUI how it can identify which item is which. This is done using the <code>Identifiable</code> protocol, which has only one requirement: some sort of <code>id</code> value that SwiftUI can use to see which item is which.</p>
<p>å’Œ<code>ForEach</code>ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨ç¬¦åˆ<code>Identifiable</code> åè®®çš„Model</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Restaurant</span>: <span class="title class_">Identifiable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> id <span class="operator">=</span> <span class="type">UUID</span>()</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">RestaurantRow</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> restaurant: <span class="type">Restaurant</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Come and eat at <span class="subst">\(restaurant.name)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> first <span class="operator">=</span> <span class="type">Restaurant</span>(name: <span class="string">&quot;Joe&#x27;s Original&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> second <span class="operator">=</span> <span class="type">Restaurant</span>(name: <span class="string">&quot;The Real Joe&#x27;s Original&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> third <span class="operator">=</span> <span class="type">Restaurant</span>(name: <span class="string">&quot;Original Joe&#x27;s&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> restaurants <span class="operator">=</span> [first, second, third]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="type">List</span>(restaurants) &#123; restaurant <span class="keyword">in</span></span><br><span class="line">            <span class="type">RestaurantRow</span>(restaurant: restaurant)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// return List(restaurants, rowContent: RestaurantRow.init)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="How-to-add-sections-to-a-list"><a href="#How-to-add-sections-to-a-list" class="headerlink" title="How to add sections to a list"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-add-sections-to-a-list">How to add sections to a list</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Section</span>(header: <span class="type">Text</span>(<span class="string">&quot;Other tasks&quot;</span>), footer: <span class="type">Text</span>(<span class="string">&quot;End&quot;</span>)) &#123;</span><br><span class="line">    <span class="type">TaskRow</span>()</span><br><span class="line">    <span class="type">TaskRow</span>()</span><br><span class="line">    <span class="type">TaskRow</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-make-a-grouped-list"><a href="#How-to-make-a-grouped-list" class="headerlink" title="How to make a grouped list"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-make-a-grouped-list">How to make a grouped list</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ExampleRow</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Example Row&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">Section</span>(header: <span class="type">Text</span>(<span class="string">&quot;Examples&quot;</span>)) &#123;</span><br><span class="line">                <span class="type">ExampleRow</span>()</span><br><span class="line">                <span class="type">ExampleRow</span>()</span><br><span class="line">                <span class="type">ExampleRow</span>()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.listStyle(.grouped)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Working-with-implicit-stacking"><a href="#Working-with-implicit-stacking" class="headerlink" title="Working with implicit stacking"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/working-with-implicit-stacking">Working with implicit stacking</a></h3><p>What happens if you create a dynamic list and put more than one thing in each row? SwiftUIâ€™s solution is simple, flexible, and gives us great behavior by default: it creates an implicit <code>HStack</code> to hold your items, so they automatically get laid out horizontally.</p>
<p>List ä¼šéšå¼çš„åˆ›å»ºä¸€ä¸ª<code>HStack</code> å°è£…æ‰€æœ‰å…ƒç´ åˆ°Rowä¸­ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ExampleRow</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Example Row&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">Section</span>(header: <span class="type">Text</span>(<span class="string">&quot;Examples&quot;</span>)) &#123;</span><br><span class="line">                <span class="type">ExampleRow</span>()</span><br><span class="line">                <span class="type">ExampleRow</span>()</span><br><span class="line">                <span class="type">ExampleRow</span>()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.listStyle(.grouped)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Containers"><a href="#Containers" class="headerlink" title="Containers"></a>Containers</h2><p><strong>Place your views inside a navigation controller</strong></p>
<h3 id="Working-with-containers"><a href="#Working-with-containers" class="headerlink" title="Working with containers"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/working-with-containers">Working with containers</a></h3><p>SwiftUI is designed to be composed right out of the box, which means you can place one view inside another as much as you need.</p>
<p>å¸¸è§çš„å®¹å™¨æœ‰ï¼š  <code>NavigationView</code>, <code>TabbedView</code>, <code>Group</code></p>
<h3 id="How-to-embed-a-view-in-a-navigation-view"><a href="#How-to-embed-a-view-in-a-navigation-view" class="headerlink" title="How to embed a view in a navigation view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-embed-a-view-in-a-navigation-view">How to embed a view in a navigation view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NavigationView</span> &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;SwiftUI&quot;</span>)</span><br><span class="line">        .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Welcome&quot;</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-add-bar-items-to-a-navigation-view"><a href="#How-to-add-bar-items-to-a-navigation-view" class="headerlink" title="How to add bar items to a navigation view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-add-bar-items-to-a-navigation-view">How to add bar items to a navigation view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">NavigationView</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;SwiftUI&quot;</span>)</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Welcome&quot;</span>))</span><br><span class="line">            .navigationBarItems(trailing:</span><br><span class="line">                <span class="type">Button</span>(action: &#123;</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Help tapped!&quot;</span>)</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Help&quot;</span>)</span><br><span class="line">                &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-group-views-together"><a href="#How-to-group-views-together" class="headerlink" title="How to group views together"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-group-views-together">How to group views together</a></h3><p><code>Stack</code> ä¸èƒ½è¶…è¿‡10ä¸ªå…ƒç´ </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">VStack</span> &#123;</span><br><span class="line">        <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Alerts-and-action-sheets"><a href="#Alerts-and-action-sheets" class="headerlink" title="Alerts and action sheets"></a>Alerts and action sheets</h2><p><strong>Show modal notifications when something happens</strong></p>
<h3 id="Working-with-presentations"><a href="#Working-with-presentations" class="headerlink" title="Working with presentations"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/working-with-presentations">Working with presentations</a></h3><p>SwiftUIâ€™s declarative approach to programming means that we donâ€™t create and present alert and action sheets in the same way as we did in UIKit. Instead, we define the conditions in which they should be shown, tell it what they should look like, then leave it to figure the rest out for itself.</p>
<h3 id="How-to-show-an-alert"><a href="#How-to-show-an-alert" class="headerlink" title="How to show an alert"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-show-an-alert">How to show an alert</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showingAlert <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">self</span>.showingAlert <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Show Alert&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .presentation(<span class="variable">$showingAlert</span>) &#123;</span><br><span class="line">            <span class="type">Alert</span>(title: <span class="type">Text</span>(<span class="string">&quot;Important message&quot;</span>), message: <span class="type">Text</span>(<span class="string">&quot;Wear sunscreen&quot;</span>), dismissButton: .default(<span class="type">Text</span>(<span class="string">&quot;Got it!&quot;</span>)))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-add-actions-to-alert-buttons"><a href="#How-to-add-actions-to-alert-buttons" class="headerlink" title="How to add actions to alert buttons"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-add-actions-to-alert-buttons">How to add actions to alert buttons</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showingAlert <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">self</span>.showingAlert <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Show Alert&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">            .presentation(<span class="variable">$showingAlert</span>) &#123;</span><br><span class="line">                <span class="type">Alert</span>(title: <span class="type">Text</span>(<span class="string">&quot;Are you sure you want to delete this?&quot;</span>), message: <span class="type">Text</span>(<span class="string">&quot;There is no undo&quot;</span>), primaryButton: .destructive(<span class="type">Text</span>(<span class="string">&quot;Delete&quot;</span>)) &#123;</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;Deleting...&quot;</span>)</span><br><span class="line">                &#125;, secondaryButton: .cancel())</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-show-an-action-sheet"><a href="#How-to-show-an-action-sheet" class="headerlink" title="How to show an action sheet"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-show-an-action-sheet">How to show an action sheet</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showingSheet <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> sheet: <span class="type">ActionSheet</span> &#123;</span><br><span class="line">        <span class="type">ActionSheet</span>(title: <span class="type">Text</span>(<span class="string">&quot;Action&quot;</span>), message: <span class="type">Text</span>(<span class="string">&quot;Quote mark&quot;</span>), buttons: [.default(<span class="type">Text</span>(<span class="string">&quot;Woo&quot;</span>), onTrigger: &#123;</span><br><span class="line">            <span class="keyword">self</span>.showingSheet <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">        &#125;)])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">self</span>.showingSheet <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Woo&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">            .presentation(showingSheet <span class="operator">?</span> sheet : <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Presenting-views"><a href="#Presenting-views" class="headerlink" title="Presenting views"></a>Presenting views</h2><p><strong>Move your user from one view to another</strong></p>
<h3 id="How-to-push-a-new-view-using-NavigationButton"><a href="#How-to-push-a-new-view-using-NavigationButton" class="headerlink" title="How to push a new view using NavigationButton"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-push-a-new-view-using-navigationbutton">How to push a new view using NavigationButton</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">DetailView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Detail&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">NavigationButton</span>(destination: <span class="type">DetailView</span>()) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Click&quot;</span>)</span><br><span class="line">            &#125;.navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Navigation&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-push-a-new-view-when-a-list-row-is-tapped"><a href="#How-to-push-a-new-view-when-a-list-row-is-tapped" class="headerlink" title="How to push a new view when a list row is tapped"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-push-a-new-view-when-a-list-row-is-tapped">How to push a new view when a list row is tapped</a></h3><p>SwiftUI doesnâ€™t have a direct equivalent of the <code>didSelectRowAt</code> method of <code>UITableView</code>, but it doesnâ€™t need one because we can combine <code>NavigationButton</code>with a list row and get the behavior for free.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Restaurant</span>: <span class="title class_">Identifiable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> id <span class="operator">=</span> <span class="type">UUID</span>()</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">RestaurantRow</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> restaurant: <span class="type">Restaurant</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(restaurant.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">RestaurantView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> restaurant: <span class="type">Restaurant</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Come and eat at <span class="subst">\(restaurant.name)</span>&quot;</span>)</span><br><span class="line">            .font(.largeTitle)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> first <span class="operator">=</span> <span class="type">Restaurant</span>(name: <span class="string">&quot;Joe&#x27;s Original&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> restaurants <span class="operator">=</span> [first]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span>(restaurants) &#123; restaurant <span class="keyword">in</span></span><br><span class="line">                <span class="type">NavigationButton</span>(destination: <span class="type">RestaurantView</span>(restaurant: restaurant)) &#123;</span><br><span class="line">                    <span class="type">RestaurantRow</span>(restaurant: restaurant)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;.navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Select a restaurant&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="How-to-present-a-new-view-using-PresentationButton"><a href="#How-to-present-a-new-view-using-PresentationButton" class="headerlink" title="How to present a new view using PresentationButton"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-present-a-new-view-using-presentationbutton">How to present a new view using PresentationButton</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">DetailView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Detail&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">PresentationButton</span>(<span class="type">Text</span>(<span class="string">&quot;Click to show&quot;</span>), destination: <span class="type">DetailView</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Transforming-views"><a href="#Transforming-views" class="headerlink" title="Transforming views"></a>Transforming views</h2><p><strong>Clip, size, scale, spin, and more</strong></p>
<h3 id="How-to-give-a-view-a-custom-frame"><a href="#How-to-give-a-view-a-custom-frame" class="headerlink" title="How to give a view a custom frame"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-give-a-view-a-custom-frame">How to give a view a custom frame</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Button</span>(action: &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Button tapped&quot;</span>)</span><br><span class="line">&#125;) &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;Welcome&quot;</span>)</span><br><span class="line">        .frame(minWidth: <span class="number">0</span>, maxWidth: <span class="number">200</span>, minHeight: <span class="number">0</span>, maxHeight: <span class="number">200</span>)</span><br><span class="line">        .font(.largeTitle)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">Text</span>(<span class="string">&quot;Please log in&quot;</span>)</span><br><span class="line">.frame(minWidth: <span class="number">0</span>, maxWidth: .infinity, minHeight: <span class="number">0</span>, maxHeight: .infinity)</span><br><span class="line">    .font(.largeTitle)</span><br><span class="line">    .foregroundColor(.white)</span><br><span class="line">    .background(<span class="type">Color</span>.red)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-adjust-the-position-of-a-view"><a href="#How-to-adjust-the-position-of-a-view" class="headerlink" title="How to adjust the position of a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-adjust-the-position-of-a-view">How to adjust the position of a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">VStack</span> &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;Home&quot;</span>)</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;Options&quot;</span>)</span><br><span class="line">        .offset(y: <span class="number">15</span>)</span><br><span class="line">        .padding(.bottom, <span class="number">15</span>)</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;Help&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-color-the-padding-around-a-view"><a href="#How-to-color-the-padding-around-a-view" class="headerlink" title="How to color the padding around a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-color-the-padding-around-a-view">How to color the padding around a view</a></h3><p>Padding çš„å…ˆåé¡ºåºå½±å“ç»“æœï¼Œå› ä¸ºä»£ç æ˜¯é¡ºåºæ‰§è¡Œçš„ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hacking with Swift&quot;</span>)</span><br><span class="line">    .background(<span class="type">Color</span>.black)</span><br><span class="line">    .foregroundColor(.white)</span><br><span class="line">    .padding()</span><br><span class="line"></span><br><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hacking with Swift&quot;</span>)</span><br><span class="line">    .padding()</span><br><span class="line">    .background(<span class="type">Color</span>.black)</span><br><span class="line">    .foregroundColor(.white)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-stack-modifiers-to-create-more-advanced-effects"><a href="#How-to-stack-modifiers-to-create-more-advanced-effects" class="headerlink" title="How to stack modifiers to create more advanced effects"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-stack-modifiers-to-create-more-advanced-effects">How to stack modifiers to create more advanced effects</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Forecast: Sun&quot;</span>)</span><br><span class="line">    .font(.largeTitle)</span><br><span class="line">    .foregroundColor(.white)</span><br><span class="line">    .padding()</span><br><span class="line">    .background(<span class="type">Color</span>.red)</span><br><span class="line">    .padding()</span><br><span class="line">    .background(<span class="type">Color</span>.orange)</span><br><span class="line">    .padding()</span><br><span class="line">    .background(<span class="type">Color</span>.yellow)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-draw-a-border-around-a-view"><a href="#How-to-draw-a-border-around-a-view" class="headerlink" title="How to draw a border around a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-draw-a-border-around-a-view">How to draw a border around a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hacking with Swift&quot;</span>)</span><br><span class="line">    .padding()</span><br><span class="line">    .border(<span class="type">Color</span>.red, width: <span class="number">4</span>, cornerRadius: <span class="number">16</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-draw-a-shadow-around-a-view"><a href="#How-to-draw-a-shadow-around-a-view" class="headerlink" title="How to draw a shadow around a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-draw-a-shadow-around-a-view">How to draw a shadow around a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hacking with Swift&quot;</span>)</span><br><span class="line">    .padding()</span><br><span class="line">    .border(<span class="type">Color</span>.red, width: <span class="number">4</span>)</span><br><span class="line">    .shadow(color: .red, radius: <span class="number">5</span>, x: <span class="number">20</span>, y: <span class="number">20</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-clip-a-view-so-only-part-is-visible"><a href="#How-to-clip-a-view-so-only-part-is-visible" class="headerlink" title="How to clip a view so only part is visible"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-clip-a-view-so-only-part-is-visible">How to clip a view so only part is visible</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Button</span>(action: &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Button tapped&quot;</span>)</span><br><span class="line">&#125;) &#123;</span><br><span class="line">    <span class="type">Image</span>(systemName: <span class="string">&quot;bolt.fill&quot;</span>)</span><br><span class="line">        .foregroundColor(.white)</span><br><span class="line">        .padding()</span><br><span class="line">        .background(<span class="type">Color</span>.green)</span><br><span class="line">        .clipShape(<span class="type">Circle</span>())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-rotate-a-view"><a href="#How-to-rotate-a-view" class="headerlink" title="How to rotate a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-rotate-a-view">How to rotate a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> rotation: <span class="type">Double</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Slider</span>(value: <span class="variable">$rotation</span>, from: <span class="number">0.0</span>, through: <span class="number">360.0</span>, by: <span class="number">1.0</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Up we go&quot;</span>)</span><br><span class="line">                .rotationEffect(.degrees(rotation))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-rotate-a-view-in-3D"><a href="#How-to-rotate-a-view-in-3D" class="headerlink" title="How to rotate a view in 3D"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-rotate-a-view-in-3d">How to rotate a view in 3D</a></h3><p>SwiftUIâ€™s <code>rotation3DEffect()</code> modifier lets us rotate views in 3D space to create beautiful effects in almost no code.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;EPISODE LLVM&quot;</span>)</span><br><span class="line">    .font(.largeTitle)</span><br><span class="line">    .foregroundColor(.yellow)</span><br><span class="line">    .rotation3DEffect(.degrees(<span class="number">45</span>), axis: (x: <span class="number">1</span>, y: <span class="number">0</span>, z: <span class="number">0</span>))</span><br></pre></td></tr></table></figure>

<h3 id="How-to-scale-a-view-up-or-down"><a href="#How-to-scale-a-view-up-or-down" class="headerlink" title="How to scale a view up or down"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-scale-a-view-up-or-down">How to scale a view up or down</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Up we go&quot;</span>)</span><br><span class="line">    .scaleEffect(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-round-the-corners-of-a-view"><a href="#How-to-round-the-corners-of-a-view" class="headerlink" title="How to round the corners of a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-round-the-corners-of-a-view">How to round the corners of a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Round Me&quot;</span>)</span><br><span class="line">    .padding()</span><br><span class="line">    .background(<span class="type">Color</span>.red)</span><br><span class="line">    .cornerRadius(<span class="number">25</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-adjust-the-opacity-of-a-view"><a href="#How-to-adjust-the-opacity-of-a-view" class="headerlink" title="How to adjust the opacity of a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-adjust-the-opacity-of-a-view">How to adjust the opacity of a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Now you see me&quot;</span>)</span><br><span class="line">    .padding()</span><br><span class="line">    .background(<span class="type">Color</span>.red)</span><br><span class="line">    .opacity(<span class="number">0.3</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-adjust-the-accent-color-of-a-view"><a href="#How-to-adjust-the-accent-color-of-a-view" class="headerlink" title="How to adjust the accent color of a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-adjust-the-accent-color-of-a-view">How to adjust the accent color of a view</a></h3><p>iOS uses tint colors to give apps a coordinated theme, and the same functionality is available in SwiftUI under the name <em>accent colors</em>.</p>
<h3 id="How-to-mask-one-view-with-another"><a href="#How-to-mask-one-view-with-another" class="headerlink" title="How to mask one view with another"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-mask-one-view-with-another">How to mask one view with another</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Image</span>(<span class="string">&quot;stripes&quot;</span>)</span><br><span class="line">    .resizable()</span><br><span class="line">    .frame(width: <span class="number">300</span>, height: <span class="number">300</span>)</span><br><span class="line">    .mask(<span class="type">Text</span>(<span class="string">&quot;SWIFT!&quot;</span>)</span><br><span class="line">        .font(<span class="type">Font</span>.system(size: <span class="number">72</span>).weight(.black)))</span><br></pre></td></tr></table></figure>

<h3 id="How-to-blur-a-view"><a href="#How-to-blur-a-view" class="headerlink" title="How to blur a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-blur-a-view">How to blur a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Welcome to my SwiftUI app&quot;</span>)</span><br><span class="line">    .blur(radius: <span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-blend-views-together"><a href="#How-to-blend-views-together" class="headerlink" title="How to blend views together"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-blend-views-together">How to blend views together</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ZStack</span> &#123;</span><br><span class="line">    <span class="type">Image</span>(<span class="string">&quot;paul-hudson&quot;</span>)</span><br><span class="line">    <span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>)</span><br><span class="line">        .blendMode(.multiply)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-adjust-views-by-tinting-and-desaturating-and-more"><a href="#How-to-adjust-views-by-tinting-and-desaturating-and-more" class="headerlink" title="How to adjust views by tinting, and desaturating, and more"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-adjust-views-by-tinting-and-desaturating-and-more">How to adjust views by tinting, and desaturating, and more</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Image</span>(<span class="string">&quot;paul-hudson&quot;</span>)</span><br><span class="line">    .contrast(<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Animation"><a href="#Animation" class="headerlink" title="Animation"></a>Animation</h2><p><strong>Bring your views to life with movement</strong></p>
<h3 id="How-to-create-a-basic-animation"><a href="#How-to-create-a-basic-animation" class="headerlink" title="How to create a basic animation"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-basic-animation">How to create a basic animation</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> angle: <span class="type">Double</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> borderThickness: <span class="type">Length</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">self</span>.angle <span class="operator">+=</span> <span class="number">45</span></span><br><span class="line">            <span class="keyword">self</span>.borderThickness <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Tap here&quot;</span>)</span><br><span class="line">                .padding()</span><br><span class="line">                .border(<span class="type">Color</span>.red, width: borderThickness)</span><br><span class="line">                .rotationEffect(.degrees(angle))</span><br><span class="line">                .animation(.basic())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-a-spring-animation"><a href="#How-to-create-a-spring-animation" class="headerlink" title="How to create a spring animation"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-spring-animation">How to create a spring animation</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> angle: <span class="type">Double</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">self</span>.angle <span class="operator">+=</span> <span class="number">45</span></span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Tap here&quot;</span>)</span><br><span class="line">                .padding()</span><br><span class="line">                .rotationEffect(.degrees(angle))</span><br><span class="line">                .animation(.spring())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-an-explicit-animation"><a href="#How-to-create-an-explicit-animation" class="headerlink" title="How to create an explicit animation"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-an-explicit-animation">How to create an explicit animation</a></h3><p>Explicit animations are often helpful because they cause every affected view to animation, not just those that have implicit animations attached. For example, if view A has to make room for view B as part of the animation, but only view B has an animation attached, then view A will jump to its new position without animating unless you use explicit animations.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> opacity: <span class="type">Double</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            withAnimation &#123;</span><br><span class="line">                <span class="keyword">self</span>.opacity <span class="operator">-=</span> <span class="number">0.2</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Tap here&quot;</span>)</span><br><span class="line">                .padding()</span><br><span class="line">                .opacity(opacity)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-add-and-remove-views-with-a-transition"><a href="#How-to-add-and-remove-views-with-a-transition" class="headerlink" title="How to add and remove views with a transition"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-add-and-remove-views-with-a-transition">How to add and remove views with a transition</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showDetails <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Button</span>(action: &#123;</span><br><span class="line">                withAnimation &#123;</span><br><span class="line">                    <span class="keyword">self</span>.showDetails.toggle()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Tap to show details&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetails &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Details go here.&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>By default, SwiftUI uses a fade animation to insert or remove views, but you can change that if you want by attaching a <code>transition()</code> modifier to a view.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Details go here.&quot;</span>)</span><br><span class="line">    .transition(.move(edge: .bottom))</span><br></pre></td></tr></table></figure>

<h3 id="How-to-combine-transitions"><a href="#How-to-combine-transitions" class="headerlink" title="How to combine transitions"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-combine-transitions">How to combine transitions</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Details go here.&quot;</span>).transition(<span class="type">AnyTransition</span>.opacity.combined(with: .slide))</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ä½¿ç”¨æ‹“å±•æ¥å°è£…å¸¸ç”¨çš„è¿‡æ¸¡æ•ˆæœ</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">AnyTransition</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> moveAndScale: <span class="type">AnyTransition</span> &#123;</span><br><span class="line">        <span class="type">AnyTransition</span>.move(edge: .bottom).combined(with: .scale())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Usage</span></span><br><span class="line"><span class="type">Text</span>(<span class="string">&quot;Details go here.&quot;</span>).transition(.moveAndScale)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-asymmetric-transitions"><a href="#How-to-create-asymmetric-transitions" class="headerlink" title="How to create asymmetric transitions"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-asymmetric-transitions">How to create asymmetric transitions</a></h3><p>SwiftUI lets us specify one transition when adding a view and another when removing it, all done using the <code>asymmetric()</code> transition type.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Details go here.&quot;</span>).transition(.asymmetric(insertion: .move(edge: .leading), removal: .move(edge: .bottom)))</span><br></pre></td></tr></table></figure>

<h2 id="Composing-views"><a href="#Composing-views" class="headerlink" title="Composing views"></a>Composing views</h2><p><strong>Make your UI structure easier to understand</strong></p>
<h3 id="How-to-create-and-compose-custom-views"><a href="#How-to-create-and-compose-custom-views" class="headerlink" title="How to create and compose custom views"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-and-compose-custom-views">How to create and compose custom views</a></h3><p>éƒ½æ˜¯åŸºäºæ•°æ®é©±åŠ¨UIï¼Œæ‰€ä»¥æ¯ä¸€çº§å°è£…éƒ½æ˜¯ä¼ Modelï¼š<code>User</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> jobTitle: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> emailAddress: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> profilePicture: <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfilePicture</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> imageName: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Image</span>(imageName)</span><br><span class="line">            .resizable()</span><br><span class="line">            .frame(width: <span class="number">100</span>, height: <span class="number">100</span>)</span><br><span class="line">            .clipShape(<span class="type">Circle</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">EmailAddress</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> address: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            <span class="type">Image</span>(systemName: <span class="string">&quot;envelope&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(address)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">UserDetails</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> user: <span class="type">User</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Text</span>(user.name)</span><br><span class="line">                .font(.largeTitle)</span><br><span class="line">                .foregroundColor(.primary)</span><br><span class="line">            <span class="type">Text</span>(user.jobTitle)</span><br><span class="line">                .foregroundColor(.secondary)</span><br><span class="line">            <span class="type">EmailAddress</span>(address: user.emailAddress)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">UserView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> user: <span class="type">User</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            <span class="type">ProfilePicture</span>(imageName: user.profilePicture)</span><br><span class="line">            <span class="type">UserDetails</span>(user: user)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> user <span class="operator">=</span> <span class="type">User</span>(name: <span class="string">&quot;Paul Hudson&quot;</span>, jobTitle: <span class="string">&quot;Editor, Hacking with Swift&quot;</span>, emailAddress: <span class="string">&quot;paul@hackingwithswift.com&quot;</span>, profilePicture: <span class="string">&quot;paul-hudson&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">UserView</span>(user: user)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-combine-text-views-together"><a href="#How-to-combine-text-views-together" class="headerlink" title="How to combine text views together"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-combine-text-views-together">How to combine text views together</a></h3><p>è¿™æ ·å­æ‹¼æ¥æ–‡æœ¬å¾ˆæ–¹ä¾¿</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;SwiftUI &quot;</span>)</span><br><span class="line">        .font(.largeTitle)</span><br><span class="line">    <span class="operator">+</span> <span class="type">Text</span>(<span class="string">&quot;is &quot;</span>)</span><br><span class="line">        .font(.headline)</span><br><span class="line">    <span class="operator">+</span> <span class="type">Text</span>(<span class="string">&quot;awesome&quot;</span>)</span><br><span class="line">        .font(.footnote)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æœ‰ä¸ªä¿®æ”¹å™¨ä¸é€‚åˆæ‹¼æ¥å¦‚ï¼š<code>foregroundColor</code></p>
<p>è¿™æ—¶å€™å°±éœ€è¦æ¢æˆèƒ½å¤Ÿä½¿ç”¨<code>+</code>çš„ä¿®æ”¹å™¨ï¼Œå¦‚<code>color</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;SwiftUI &quot;</span>)</span><br><span class="line">    .color(.red)</span><br><span class="line"><span class="operator">+</span> <span class="type">Text</span>(<span class="string">&quot;is &quot;</span>)</span><br><span class="line">    .color(.orange)</span><br><span class="line"><span class="operator">+</span> <span class="type">Text</span>(<span class="string">&quot;awesome&quot;</span>)</span><br><span class="line">    .color(.blue)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-store-views-as-properties"><a href="#How-to-store-views-as-properties" class="headerlink" title="How to store views as properties"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-store-views-as-properties">How to store views as properties</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> title <span class="operator">=</span> <span class="type">Text</span>(<span class="string">&quot;Paul Hudson&quot;</span>)</span><br><span class="line">        .font(.largeTitle)</span><br><span class="line">    <span class="keyword">let</span> subtitle <span class="operator">=</span> <span class="type">Text</span>(<span class="string">&quot;Author&quot;</span>)</span><br><span class="line">        .foregroundColor(.secondary)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            title</span><br><span class="line">            .color(.red)</span><br><span class="line">            subtitle</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-custom-modifiers"><a href="#How-to-create-custom-modifiers" class="headerlink" title="How to create custom modifiers"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-custom-modifiers">How to create custom modifiers</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">PrimaryLabel</span>: <span class="title class_">ViewModifier</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">body</span>(<span class="params">content</span>: <span class="type">Content</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        content</span><br><span class="line">            .padding()</span><br><span class="line">            .background(<span class="type">Color</span>.red)</span><br><span class="line">            .foregroundColor(<span class="type">Color</span>.white)</span><br><span class="line">            .font(.largeTitle)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello, SwiftUI&quot;</span>)</span><br><span class="line">            .modifier(<span class="type">PrimaryLabel</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Tooling"><a href="#Tooling" class="headerlink" title="Tooling"></a>Tooling</h2><p><strong>Build better apps with help from Xcode</strong></p>
<h3 id="How-to-preview-your-layout-at-different-Dynamic-Type-sizes"><a href="#How-to-preview-your-layout-at-different-Dynamic-Type-sizes" class="headerlink" title="How to preview your layout at different Dynamic Type sizes"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-preview-your-layout-at-different-dynamic-type-sizes">How to preview your layout at different Dynamic Type sizes</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">#if</span> <span class="type">DEBUG</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Previews</span> : <span class="title class_">PreviewProvider</span> &#123;</span><br><span class="line">   <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">      <span class="type">Group</span> &#123;</span><br><span class="line">         <span class="type">ContentView</span>()</span><br><span class="line">            .environment(\.colorScheme, .dark)</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">#endif</span></span><br></pre></td></tr></table></figure>

<h3 id="How-to-preview-your-layout-in-light-and-dark-mode"><a href="#How-to-preview-your-layout-in-light-and-dark-mode" class="headerlink" title="How to preview your layout in light and dark mode"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-preview-your-layout-in-light-and-dark-mode">How to preview your layout in light and dark mode</a></h3><p>If you want to see both light and dark mode side by side, place multiple previews in a group, like this:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">#if</span> <span class="type">DEBUG</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Previews</span> : <span class="title class_">PreviewProvider</span> &#123;</span><br><span class="line">   <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">      <span class="type">Group</span> &#123;</span><br><span class="line">         <span class="type">ContentView</span>()</span><br><span class="line">            .environment(\.colorScheme, .light)</span><br><span class="line"></span><br><span class="line">         <span class="type">ContentView</span>()</span><br><span class="line">            .environment(\.colorScheme, .dark)</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">#endif</span></span><br></pre></td></tr></table></figure>

<h3 id="How-to-preview-your-layout-in-different-devices"><a href="#How-to-preview-your-layout-in-different-devices" class="headerlink" title="How to preview your layout in different devices"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-preview-your-layout-in-different-devices">How to preview your layout in different devices</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ContentView</span>()</span><br><span class="line">    .previewDevice(<span class="type">PreviewDevice</span>(rawValue: <span class="string">&quot;iPhone SE&quot;</span>))</span><br></pre></td></tr></table></figure>

<h3 id="How-to-preview-your-layout-in-a-navigation-view"><a href="#How-to-preview-your-layout-in-a-navigation-view" class="headerlink" title="How to preview your layout in a navigation view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-preview-your-layout-in-a-navigation-view">How to preview your layout in a navigation view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">   <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">      <span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">         .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Welcome&quot;</span>))</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">#if</span> <span class="type">DEBUG</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Previews</span> : <span class="title class_">PreviewProvider</span> &#123;</span><br><span class="line">   <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">      <span class="type">NavigationView</span> &#123;</span><br><span class="line">         <span class="type">ContentView</span>()</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">#endif</span></span><br></pre></td></tr></table></figure>

<h3 id="How-to-use-Instruments-to-profile-your-SwiftUI-code-and-identify-slow-layouts"><a href="#How-to-use-Instruments-to-profile-your-SwiftUI-code-and-identify-slow-layouts" class="headerlink" title="How to use Instruments to profile your SwiftUI code and identify slow layouts"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-use-instruments-to-profile-your-swiftui-code-and-identify-slow-layouts">How to use Instruments to profile your SwiftUI code and identify slow layouts</a></h3><p>ç¤ºä¾‹ä»£ç </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Combine</span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FrequentUpdater</span>: <span class="title class_">BindableObject</span> &#123;</span><br><span class="line">   <span class="keyword">var</span> didChange <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Void</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">   <span class="keyword">var</span> timer: <span class="type">Timer</span>?</span><br><span class="line"></span><br><span class="line">   <span class="keyword">init</span>() &#123;</span><br><span class="line">      timer <span class="operator">=</span> <span class="type">Timer</span>.scheduledTimer(</span><br><span class="line">         withTimeInterval: <span class="number">0.01</span>,</span><br><span class="line">         repeats: <span class="literal">true</span></span><br><span class="line">      ) &#123; <span class="keyword">_</span> <span class="keyword">in</span></span><br><span class="line">         <span class="keyword">self</span>.didChange.send(())</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">   <span class="meta">@ObjectBinding</span> <span class="keyword">var</span> updater <span class="operator">=</span> <span class="type">FrequentUpdater</span>()</span><br><span class="line">   <span class="meta">@State</span> <span class="keyword">var</span> tapCount <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">      <span class="type">VStack</span> &#123;</span><br><span class="line">         <span class="type">Text</span>(<span class="string">&quot;<span class="subst">\(UUID().uuidString)</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">         <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">self</span>.tapCount <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">         &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Tap count: <span class="subst">\(tapCount)</span>&quot;</span>)</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ£€æµ‹æˆ‘ä»¬çš„ä»£ç "><a href="#æ£€æµ‹æˆ‘ä»¬çš„ä»£ç " class="headerlink" title="æ£€æµ‹æˆ‘ä»¬çš„ä»£ç "></a>æ£€æµ‹æˆ‘ä»¬çš„ä»£ç </h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒSwiftUIå·¥å…·å‘Šè¯‰æˆ‘ä»¬å„ç§å„æ ·çš„äº‹æƒ…ï¼š</p>
<p>1.åœ¨æ­¤æœŸé—´åˆ›å»ºäº†å¤šå°‘è§†å›¾ä»¥åŠåˆ›å»ºå®ƒä»¬éœ€è¦å¤šé•¿æ—¶é—´ï¼ˆâ€œView Bodyâ€ï¼‰<br>2.è§†å›¾çš„å±æ€§æ˜¯ä»€ä¹ˆä»¥åŠå®ƒä»¬å¦‚ä½•éšæ—¶é—´å˜åŒ–ï¼ˆâ€œView Propertiesâ€ï¼‰<br>3.å‘ç”Ÿäº†å¤šå°‘æ¬¡Core Animationæäº¤ï¼ˆâ€œCore Animation Commitsâ€ï¼‰<br>4.æ¯ä¸ªå‡½æ•°è°ƒç”¨çš„ç¡®åˆ‡æ—¶é—´ï¼ˆâ€œTime Profilerâ€ï¼‰</p>
<p><img src="https://www.hackingwithswift.com/img/quick-start/swiftui/profiling-1.jpg"></p>
<h4 id="ç›‘è§†bodyè°ƒç”¨"><a href="#ç›‘è§†bodyè°ƒç”¨" class="headerlink" title="ç›‘è§†bodyè°ƒç”¨"></a>ç›‘è§†<code>body</code>è°ƒç”¨</h4><p>å¦‚æœæ‚¨é€‰æ‹©<code>View Body</code>è½¨é“ - è¿™æ˜¯instrumentåˆ—è¡¨ä¸­çš„ç¬¬ä¸€è¡Œ - æ‚¨åº”è¯¥èƒ½å¤Ÿçœ‹åˆ°ä¹å™¨å°†ç»“æœåˆ†è§£ä¸ºSwiftUIå’Œæ‚¨çš„é¡¹ç›®ï¼Œå‰è€…æ˜¯åŸå§‹ç±»å‹ï¼Œå¦‚æ–‡æœ¬è§†å›¾å’ŒæŒ‰é’®ï¼Œä»¥åŠåè€…åŒ…å«æ‚¨çš„è‡ªå®šä¹‰è§†å›¾ç±»å‹ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè¿™æ„å‘³ç€â€œContentViewâ€åº”è¯¥å‡ºç°åœ¨è‡ªå®šä¹‰è§†å›¾ä¸­ï¼Œå› ä¸ºè¿™æ˜¯æˆ‘ä»¬è§†å›¾çš„åç§°ã€‚</p>
<p>ç°åœ¨ï¼Œæ‚¨åœ¨è¿™é‡Œçœ‹ä¸åˆ°çš„æ˜¯æ‚¨çš„ä»£ç ä¸SwiftUIè§†å›¾çš„å®Œç¾ä¸€å¯¹ä¸€æ˜ å°„ï¼Œå› ä¸ºSwiftUIç§¯æåœ°æŠ˜å å…¶è§†å›¾å±‚æ¬¡ç»“æ„ä»¥å°½å¯èƒ½å°‘åœ°å®Œæˆå·¥ä½œã€‚æ‰€ä»¥ï¼Œä¸è¦æŒ‡æœ›åœ¨ä»£ç ä¸­çœ‹åˆ°ä»»ä½•VStackåˆ›å»º - è¿™ä¸ªåº”ç”¨ç¨‹åºå®é™…ä¸Šæ˜¯å…è´¹çš„ã€‚</p>
<p>åœ¨è¿™ä¸ªå±å¹•ä¸Šï¼Œé‡è¦çš„æ•°å­—æ˜¯è®¡æ•°å’Œå¹³å‡æŒç»­æ—¶é—´ - æ¯ä»¶äº‹åˆ›å»ºçš„æ¬¡æ•°ï¼Œä»¥åŠèŠ±è´¹çš„æ—¶é—´ã€‚å› ä¸ºè¿™æ˜¯ä¸€ä¸ªå‹åŠ›æµ‹è¯•ä½ åº”è¯¥çœ‹åˆ°éå¸¸é«˜çš„æ•°å­—ï¼Œä½†æˆ‘ä»¬çš„å¸ƒå±€æ˜¯å¾®ä¸è¶³é“çš„ï¼Œæ‰€ä»¥å¹³å‡æŒç»­æ—¶é—´å¯èƒ½æ˜¯å‡ åå¾®ç§’ã€‚</p>
<p><img src="https://www.hackingwithswift.com/img/quick-start/swiftui/profiling-2.jpg" alt="img"></p>
<h4 id="è·Ÿè¸ªçŠ¶æ€ï¼ˆstateï¼‰å˜åŒ–"><a href="#è·Ÿè¸ªçŠ¶æ€ï¼ˆstateï¼‰å˜åŒ–" class="headerlink" title="è·Ÿè¸ªçŠ¶æ€ï¼ˆstateï¼‰å˜åŒ–"></a>è·Ÿè¸ªçŠ¶æ€ï¼ˆstateï¼‰å˜åŒ–</h4><p>æ¥ä¸‹æ¥ï¼Œé€‰æ‹©â€œView Propertiesâ€è½¨é“ï¼Œè¿™æ˜¯ä»ªå™¨åˆ—è¡¨ä¸­çš„ç¬¬äºŒè¡Œã€‚è¿™å°†æ˜¾ç¤ºæ‰€æœ‰è§†å›¾çš„æ‰€æœ‰å±æ€§ï¼ŒåŒ…æ‹¬å…¶å½“å‰å€¼å’Œæ‰€æœ‰å…ˆå‰å€¼ã€‚</p>
<p>æˆ‘ä»¬çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºæœ‰ä¸€ä¸ªæŒ‰é’®ï¼Œé€šè¿‡åœ¨æ•°å­—ä¸­æ·»åŠ ä¸€ä¸ªæ¥æ›´æ”¹å…¶æ ‡ç­¾ï¼Œå¹¶ä¸”åœ¨æ­¤å·¥å…·ä¸­å¯è§ - è¯·æŸ¥çœ‹è§†å›¾ç±»å‹ContentViewå’Œå±æ€§ç±»å‹<code>State </code>ã€‚</p>
<p>å¯æ‚²çš„æ˜¯ï¼ŒInstrumentsè¿˜æ²¡æœ‰ï¼ˆè¿˜èƒ½ï¼‰å‘æˆ‘ä»¬å±•ç¤ºé‚£é‡Œçš„ç¡®åˆ‡å±æ€§åç§°ï¼Œå¦‚æœä½ è·Ÿè¸ªäº†å‡ ä¸ªæ•´æ•°çŠ¶æ€ï¼Œè¿™å¯èƒ½ä¼šæ›´åŠ ä»¤äººå›°æƒ‘ã€‚ç„¶è€Œï¼Œå®ƒç¡®å®æœ‰ä¸€ä¸ªä¸åŒçš„æŠ€å·§ï¼šåœ¨è®°å½•çª—å£çš„é¡¶éƒ¨æ˜¯ä¸€ä¸ªæ ‡è®°å½“å‰è§†å›¾ä½ç½®çš„ç®­å¤´ï¼Œå¦‚æœä½ æ‹–åŠ¨å®ƒï¼Œä½ ä¼šçœ‹åˆ°åº”ç”¨ç¨‹åºçŠ¶æ€éšæ—¶é—´çš„å˜åŒ– - æ¯æ¬¡ä½ ç‚¹å‡»æŒ‰é’®ï¼Œä½ ä¼šçœ‹åˆ°çŠ¶æ€æ•´æ•°ä¸Šå‡ä¸€ä¸ªï¼Œä½ å¯ä»¥å‰è¿›å’Œåé€€æ¥çœ‹å®ƒå‘ç”Ÿã€‚</p>
<p>è¿™å¯ä»¥é‡Šæ”¾å·¨å¤§çš„èƒ½åŠ›ï¼Œå› ä¸ºå®ƒå¯ä»¥è®©æˆ‘ä»¬ç›´æ¥çœ‹åˆ°çŠ¶æ€å˜åŒ–å¯¼è‡´æ…¢é€Ÿé‡ç»˜æˆ–å…¶ä»–å·¥ä½œ - è¿™å‡ ä¹å°±åƒæ˜¯åœ¨æ—¶é—´æœºå™¨ä¸­ï¼Œæ‚¨å¯ä»¥åœ¨è¿è¡ŒæœŸé—´çš„æ¯ä¸ªç‚¹æ£€æŸ¥åº”ç”¨ç¨‹åºçš„ç¡®åˆ‡çŠ¶æ€ã€‚</p>
<p><img src="https://www.hackingwithswift.com/img/quick-start/swiftui/profiling-3.jpg" alt="img"></p>
<h4 id="è¯†åˆ«æ…¢é€Ÿç»˜å›¾"><a href="#è¯†åˆ«æ…¢é€Ÿç»˜å›¾" class="headerlink" title="è¯†åˆ«æ…¢é€Ÿç»˜å›¾"></a>è¯†åˆ«æ…¢é€Ÿç»˜å›¾</h4><p>è™½ç„¶SwiftUIèƒ½å¤Ÿç›´æ¥è°ƒç”¨Metalä»¥æé«˜æ€§èƒ½ï¼Œä½†å¤§å¤šæ•°æƒ…å†µä¸‹å®ƒæ›´å–œæ¬¢ä½¿ç”¨Core Animationè¿›è¡Œæ¸²æŸ“ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä¼šè‡ªåŠ¨ä»Instrumentsè·å–å†…ç½®çš„Core Animationåˆ†æå·¥å…·ï¼ŒåŒ…æ‹¬æ£€æµ‹æ˜‚è´µæäº¤ï¼ˆexpensive commitsï¼‰çš„èƒ½åŠ›ã€‚</p>
<p>å½“å¤šä¸ªæ›´æ”¹æ”¾åœ¨ä¸€ä¸ªç»„ä¸­æ—¶ï¼ŒCore Animationçš„æ•ˆæœæœ€ä½³ï¼Œç§°ä¸º<code>transaction</code>ã€‚æˆ‘ä»¬åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æœ‰æ•ˆåœ°å †å äº†ä¸€ç³»åˆ—å·¥ä½œï¼Œç„¶åè¦æ±‚CAç»§ç»­æ¸²æŸ“å·¥ä½œ - ç§°ä¸º<em>æäº¤</em>äº‹åŠ¡ã€‚</p>
<p>å› æ­¤ï¼Œå½“Instrumentså‘æˆ‘ä»¬å±•ç¤ºæ˜‚è´µçš„Core Animationæäº¤æ—¶ï¼Œå®ƒçœŸæ­£å‘æˆ‘ä»¬å±•ç¤ºçš„æ˜¯SwiftUIå› ä¸ºæ›´æ–°è€Œè¢«è¿«é‡ç»˜å±å¹•ä¸Šçš„åƒç´ çš„æ¬¡æ•°ã€‚ç†è®ºä¸Šï¼Œè¿™åº”è¯¥åªåœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„å®é™…çŠ¶æ€å¯¼è‡´ä¸åŒçš„è§†å›¾å±‚æ¬¡ç»“æ„æ—¶å‘ç”Ÿï¼Œå› ä¸ºSwiftUIåº”è¯¥èƒ½å¤Ÿå°†æˆ‘ä»¬çš„<code>body</code>å±æ€§çš„æ–°è¾“å‡ºä¸å…ˆå‰çš„è¾“å‡ºè¿›è¡Œæ¯”è¾ƒã€‚</p>
<p><img src="https://www.hackingwithswift.com/img/quick-start/swiftui/profiling-4.jpg" alt="img"></p>
<h4 id="å¯»æ‰¾ç¼“æ…¢çš„å‡½æ•°è°ƒç”¨"><a href="#å¯»æ‰¾ç¼“æ…¢çš„å‡½æ•°è°ƒç”¨" class="headerlink" title="å¯»æ‰¾ç¼“æ…¢çš„å‡½æ•°è°ƒç”¨"></a>å¯»æ‰¾ç¼“æ…¢çš„å‡½æ•°è°ƒç”¨</h4><p>Time Profilerï¼Œå®ƒå‘æˆ‘ä»¬å±•ç¤ºäº†åœ¨ä»£ç çš„æ¯ä¸ªéƒ¨åˆ†èŠ±è´¹äº†å¤šå°‘æ—¶é—´ã€‚è¿™ä¸ä¹å™¨ä¸­çš„å¸¸è§„æ—¶é—´åˆ†æå™¨å®Œå…¨ç›¸åŒï¼Œä½†å¦‚æœæ‚¨ä¹‹å‰æ²¡æœ‰å°è¯•è¿‡ï¼Œé‚£ä¹ˆæ‚¨è‡³å°‘éœ€è¦çŸ¥é“ï¼š</p>
<ol>
<li><p>å³ä¾§çš„æ‰©å±•è¯¦ç»†ä¿¡æ¯çª—å£é»˜è®¤æ˜¾ç¤ºæœ€é‡çš„å †æ ˆè·Ÿè¸ªï¼Œè¿™æ˜¯è¿è¡Œæ—¶é—´æœ€é•¿çš„ä»£ç æ®µã€‚æ˜äº®çš„ä»£ç ï¼ˆç™½è‰²æˆ–é»‘è‰²ï¼Œå–å†³äºæ‚¨çš„macOSé…è‰²æ–¹æ¡ˆï¼‰æ˜¯æ‚¨ç¼–å†™çš„ä»£ç ;æ˜æš—ä»£ç ï¼ˆç°è‰²ï¼‰æ˜¯ç³»ç»Ÿåº“ä»£ç ã€‚</p>
</li>
<li><p>åœ¨å·¦ä¾§ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°åˆ›å»ºçš„æ‰€æœ‰çº¿ç¨‹ï¼Œä»¥åŠå…¬å¼€æŒ‡ç¤ºå™¨ï¼Œè®©æ‚¨æ·±å…¥äº†è§£å®ƒä»¬è°ƒç”¨çš„å‡½æ•°ä»¥åŠè¿™äº›å‡½æ•°è°ƒç”¨çš„å‡½æ•°ç­‰ã€‚å¤§å¤šæ•°å·¥ä½œå°†åœ¨â€œstartâ€å†…éƒ¨è¿›è¡Œã€‚</p>
</li>
<li><p>ä¸ºé¿å…æ··ä¹±ï¼Œæ‚¨å¯èƒ½éœ€è¦å•å‡»åº•éƒ¨çš„â€œè°ƒç”¨æ ‘â€æŒ‰é’®ï¼Œç„¶åé€‰æ‹©â€œéšè—ç³»ç»Ÿåº“â€ã€‚è¿™åªä¼šæ˜¾ç¤ºæ‚¨ç¼–å†™çš„ä»£ç ï¼Œä½†æ˜¯å¦‚æœæ‚¨çš„é—®é¢˜æ˜¯æ‚¨ä½¿ç”¨çš„ç³»ç»Ÿåº“å¾ˆç³Ÿç³•ï¼Œè¿™å¯èƒ½æ²¡æœ‰å¸®åŠ©ã€‚</p>
</li>
<li><p>è¦ç›´æ¥äº†è§£å…·ä½“ç»†èŠ‚ï¼Œæ‚¨è¿˜å¯ä»¥å•å‡»â€œè°ƒç”¨æ ‘â€å¹¶é€‰æ‹©â€œåè½¬è°ƒç”¨æ ‘â€ä»¥ç¿»è½¬äº‹ç‰©ï¼Œä»¥ä¾¿å¶å­åŠŸèƒ½ï¼ˆæ ‘æœ«ç«¯çš„åŠŸèƒ½ï¼‰æ˜¾ç¤ºåœ¨é¡¶éƒ¨ï¼Œç°åœ¨å¯ä»¥å‘ä¸‹é’»å–å…¬å¼€æŒ‡ç¤ºå™¨ï¼ˆå‘ä¸Šé’»å–ï¼Ÿï¼‰åˆ°è°ƒç”¨å®ƒä»¬çš„å‡½æ•°ã€‚</p>
<p><img src="https://www.hackingwithswift.com/img/quick-start/swiftui/profiling-5.jpg"></p>
</li>
</ol>
<h4 id="æœ€åä¸€äº›æç¤º"><a href="#æœ€åä¸€äº›æç¤º" class="headerlink" title="æœ€åä¸€äº›æç¤º"></a>æœ€åä¸€äº›æç¤º</h4><p>åœ¨æ‚¨æ”¶å–é…ç½®è‡ªå·±çš„ä»£ç ä¹‹å‰ï¼Œæœ‰ä¸€äº›äº‹æƒ…éœ€è¦æ³¨æ„ï¼š</p>
<ol>
<li>åœ¨æ£€æŸ¥åº”ç”¨ç¨‹åºæ€§èƒ½çš„ä¸€å°éƒ¨åˆ†æ—¶ï¼Œæ‚¨åº”è¯¥å•å‡»å¹¶æ‹–åŠ¨ç›¸å…³èŒƒå›´ï¼Œä»¥ä¾¿ä»…æŸ¥çœ‹è¯¥åº”ç”¨ç¨‹åºéƒ¨åˆ†çš„ç»Ÿè®¡ä¿¡æ¯ã€‚è¿™ä½¿æ‚¨å¯ä»¥ä¸“æ³¨äºç‰¹å®šæ“ä½œçš„æ€§èƒ½ï¼Œä¾‹å¦‚å“åº”æŒ‰ä¸‹æŒ‰é’®ã€‚</li>
<li>å³ä½¿ä½ åœ¨ä»ªå™¨ä¸­çœ‹åˆ°çº¯è‰²æ¡ï¼Œå®ƒä»¬åªæ˜¯ä»è¿œå¤„çœ‹èµ·æ¥é‚£æ · - ä½ å¯ä»¥é€šè¿‡æŒ‰ä½Cmdå¹¶æŒ‰ - å’Œ+æ¥æŸ¥çœ‹æ›´å¤šç»†èŠ‚</li>
<li>è¦è·å¾—æœ€å‡†ç¡®çš„æ•°å­—ï¼Œè¯·å§‹ç»ˆåœ¨çœŸå®è®¾å¤‡ä¸Šè¿›è¡Œé…ç½®ã€‚</li>
<li>å¦‚æœè¦é€šè¿‡åˆ†æä»£ç è¿›è¡Œæ›´æ”¹ï¼Œè¯·å§‹ç»ˆä¸€æ¬¡è¿›è¡Œä¸€æ¬¡æ›´æ”¹ã€‚å¦‚æœä½ è¿›è¡Œä¸¤æ¬¡æ›´æ”¹ï¼Œå¯èƒ½ä¼šä½¿ä½ çš„æ€§èƒ½æé«˜20ï¼…è€Œå¦ä¸€ç§ä¼šé™ä½10ï¼…ï¼Œä½†æ˜¯å°†å®ƒä»¬åˆåœ¨ä¸€èµ·æ„å‘³ç€ä½ å¯èƒ½ä¼šè®¤ä¸ºå®ƒä»¬æ•´ä½“æ€§èƒ½æé«˜äº†10ï¼…ã€‚</li>
<li>Instrumentsåœ¨releaseæ¨¡å¼ä¸‹è¿è¡Œæ‚¨çš„ä»£ç ï¼Œä»è€Œå®ç°Swiftçš„æ‰€æœ‰ä¼˜åŒ–ã€‚è¿™ä¹Ÿä¼šå½±å“æ‚¨æ·»åŠ åˆ°ä»£ç ä¸­çš„ä»»ä½•è°ƒè¯•æ ‡å¿—ï¼Œå› æ­¤è¯·å°å¿ƒã€‚</li>
</ol>
<h2 id="What-now"><a href="#What-now" class="headerlink" title="What now?"></a>What now?</h2><p><strong>How to continue learning SwiftUI after the basics</strong></p>
<h3 id="SwiftUI-tips-and-tricks"><a href="#SwiftUI-tips-and-tricks" class="headerlink" title="SwiftUI tips and tricks"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/swiftui-tips-and-tricks">SwiftUI tips and tricks</a></h3><p>SwiftUIæ‹¥æœ‰å¼ºå¤§çš„æ ‡é¢˜åŠŸèƒ½ï¼Œä½†ä¹Ÿæœ‰è®¸å¤šè¾ƒå°çš„æç¤ºå’ŒæŠ€å·§å¯ä»¥å¸®åŠ©æ‚¨ç¼–å†™æ›´å¥½çš„åº”ç”¨ç¨‹åºã€‚</p>
<h4 id="State-è®¾ä¸ºç§æœ‰"><a href="#State-è®¾ä¸ºç§æœ‰" class="headerlink" title="@State è®¾ä¸ºç§æœ‰"></a>@State è®¾ä¸ºç§æœ‰</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> score <span class="operator">=</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>

<h4 id="å…·æœ‰å¸¸é‡ç»‘å®šçš„åŸå‹"><a href="#å…·æœ‰å¸¸é‡ç»‘å®šçš„åŸå‹" class="headerlink" title="å…·æœ‰å¸¸é‡ç»‘å®šçš„åŸå‹"></a>å…·æœ‰å¸¸é‡ç»‘å®šçš„åŸå‹</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">TextField</span>(.constant(<span class="string">&quot;Hello&quot;</span>))</span><br><span class="line">    .textFieldStyle(.roundedBorder)</span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨è¯­ä¹‰é¢œè‰²"><a href="#ä½¿ç”¨è¯­ä¹‰é¢œè‰²" class="headerlink" title="ä½¿ç”¨è¯­ä¹‰é¢œè‰²"></a>ä½¿ç”¨è¯­ä¹‰é¢œè‰²</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Color</span>.red</span><br></pre></td></tr></table></figure>

<h4 id="ä¾é è‡ªé€‚åº”å¡«å……"><a href="#ä¾é è‡ªé€‚åº”å¡«å……" class="headerlink" title="ä¾é è‡ªé€‚åº”å¡«å……"></a>ä¾é è‡ªé€‚åº”å¡«å……</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Row 1&quot;</span>)</span><br><span class="line">    .padding(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<h4 id="åˆå¹¶æ–‡æœ¬è§†å›¾"><a href="#åˆå¹¶æ–‡æœ¬è§†å›¾" class="headerlink" title="åˆå¹¶æ–‡æœ¬è§†å›¾"></a>åˆå¹¶æ–‡æœ¬è§†å›¾</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Colored &quot;</span>)</span><br><span class="line">            .color(.red)</span><br><span class="line">        <span class="operator">+</span></span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;SwifUI &quot;</span>)</span><br><span class="line">                .color(.green)</span><br><span class="line">        <span class="operator">+</span></span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Text&quot;</span>)</span><br><span class="line">            .color(.blue)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å¦‚ä½•ä½¿print-å·¥ä½œ"><a href="#å¦‚ä½•ä½¿print-å·¥ä½œ" class="headerlink" title="å¦‚ä½•ä½¿print()å·¥ä½œ"></a>å¦‚ä½•ä½¿<code>print()</code>å·¥ä½œ</h4><p>å³é”®å•å‡»é¢„è§ˆç”»å¸ƒï¼ˆpreview canvasï¼‰ä¸­çš„æ’­æ”¾æŒ‰é’®ï¼Œç„¶åé€‰æ‹©â€œè°ƒè¯•é¢„è§ˆï¼ˆDebug Previewï¼‰â€ã€‚</p>
<h4 id="ä¾é éšå¼HStack"><a href="#ä¾é éšå¼HStack" class="headerlink" title="ä¾é éšå¼HStack"></a>ä¾é éšå¼<code>HStack</code></h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> imageNames <span class="operator">=</span> [<span class="string">&quot;paul-hudson&quot;</span>, <span class="string">&quot;swiftui&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span>(imageNames.identified(by: \.<span class="keyword">self</span>)) &#123; image <span class="keyword">in</span></span><br><span class="line">            <span class="type">Image</span>(image).resizable().frame(width: <span class="number">40</span>)</span><br><span class="line">            <span class="type">Text</span>(image)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åˆ†å‰²å¤§è§†å›¾"><a href="#åˆ†å‰²å¤§è§†å›¾" class="headerlink" title="åˆ†å‰²å¤§è§†å›¾"></a>åˆ†å‰²å¤§è§†å›¾</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> users <span class="operator">=</span> [<span class="string">&quot;Paul Hudson&quot;</span>, <span class="string">&quot;Taylor Swift&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span>(users.identified(by: \.<span class="keyword">self</span>)) &#123; user <span class="keyword">in</span></span><br><span class="line">                <span class="type">NavigationButton</span>(destination: <span class="type">Text</span>(<span class="string">&quot;Detail View&quot;</span>)) &#123;</span><br><span class="line">                    <span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>).resizable().frame(width: <span class="number">50</span>, height: <span class="number">50</span>)</span><br><span class="line"></span><br><span class="line">                    <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                        <span class="type">Text</span>(<span class="string">&quot;Johnny Appleseed&quot;</span>).font(.headline)</span><br><span class="line">                        <span class="type">Text</span>(<span class="string">&quot;Occupation: Programmer&quot;</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;.navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Users&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ›´å¥½çš„é¢„è§ˆ"><a href="#æ›´å¥½çš„é¢„è§ˆ" class="headerlink" title="æ›´å¥½çš„é¢„è§ˆ"></a>æ›´å¥½çš„é¢„è§ˆ</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">#if</span> <span class="type">DEBUG</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Previews</span> : <span class="title class_">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">ContentView</span>()</span><br><span class="line">                .environment(\.sizeCategory, .accessibilityExtraExtraExtraLarge)</span><br><span class="line">            <span class="type">ContentView</span>()</span><br><span class="line">                .environment(\.colorScheme, .dark)</span><br><span class="line">            <span class="type">NavigationView</span> &#123;</span><br><span class="line">                <span class="type">ContentView</span>()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">#endif</span></span><br></pre></td></tr></table></figure>

<h4 id="åˆ›å»ºè‡ªå®šä¹‰ä¿®æ”¹å™¨"><a href="#åˆ›å»ºè‡ªå®šä¹‰ä¿®æ”¹å™¨" class="headerlink" title="åˆ›å»ºè‡ªå®šä¹‰ä¿®æ”¹å™¨"></a>åˆ›å»ºè‡ªå®šä¹‰ä¿®æ”¹å™¨</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">PrimaryLabel</span>: <span class="title class_">ViewModifier</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">body</span>(<span class="params">content</span>: <span class="type">Content</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        content</span><br><span class="line">            .padding()</span><br><span class="line">            .background(<span class="type">Color</span>.black)</span><br><span class="line">            .foregroundColor(<span class="type">Color</span>.white)</span><br><span class="line">            .font(.largeTitle)</span><br><span class="line">            .cornerRadius(<span class="number">10</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">            .modifier(<span class="type">PrimaryLabel</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åŠ¨ç”»å˜åŒ–å¾ˆå®¹æ˜“"><a href="#åŠ¨ç”»å˜åŒ–å¾ˆå®¹æ˜“" class="headerlink" title="åŠ¨ç”»å˜åŒ–å¾ˆå®¹æ˜“"></a>åŠ¨ç”»å˜åŒ–å¾ˆå®¹æ˜“</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showingWelcome <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Toggle</span>(isOn: <span class="variable">$showingWelcome</span>.animation(.spring())) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Toggle label&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showingWelcome &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/03/17/Hackintosh-Installation-with-MSI-Z390-and-i9-9900K/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/03/17/Hackintosh-Installation-with-MSI-Z390-and-i9-9900K/" class="post-title-link" itemprop="url">é»‘è‹¹æœå®‰è£…è®°å½• MSI Z390 å’Œ i9-9900K</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-03-17 23:12:36" itemprop="dateCreated datePublished" datetime="2019-03-17T23:12:36+08:00">2019-03-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>å¾®æ˜Ÿ MSI Z390 GAMING PRO CARBON AC åç¡• Vega64 é»‘è‹¹æœ</p>
<h2 id="æœºå™¨é…ç½®"><a href="#æœºå™¨é…ç½®" class="headerlink" title="æœºå™¨é…ç½®"></a>æœºå™¨é…ç½®</h2><p>ä¸»æ¿ï¼š<a target="_blank" rel="noopener" href="https://www.msi.com/Motherboard/MPG-Z390-GAMING-PRO-CARBON-AC">å¾®æ˜Ÿ MSI MPG Z390 GAMING PRO CARBON AC</a></p>
<p>CPUï¼š<a target="_blank" rel="noopener" href="https://ark.intel.com/content/www/us/en/ark/products/186605/intel-core-i9-9900k-processor-16m-cache-up-to-5-00-ghz.html">Intel i9 9900K</a></p>
<p>å†…å­˜ï¼šAvexir DDR4 2400</p>
<p>æ˜¾å¡ï¼š<a target="_blank" rel="noopener" href="https://www.asus.com/us/Graphics-Cards/AREZ-STRIX-RXVEGA64-O8G-GAMING/">åç¡• ASUS AREZ-STRIX-RXVEGA64-O8G-GAMING</a></p>
<p>ç”µæºï¼š<a target="_blank" rel="noopener" href="https://www.evga.com/products/product.aspx?pn=120-GP-0750-X1">EVGA SuperNOVA 750 G+</a></p>
<p>æ•£çƒ­ï¼š<a target="_blank" rel="noopener" href="http://www.coolermaster.com/cooling/cpu-liquid-cooler/masterliquid-ml240r-rgb/">MASTERLIQUID ML240R RGB</a></p>
<p>å›ºæ€ï¼šä¸‰æ˜Ÿ 970 EVO 500G</p>
<p>æ¿è½½å£°å¡ï¼šALC S1220A</p>
<p>æ¿è½½æœ‰çº¿ç½‘å¡ï¼šIntel I219V7</p>
<p>æ˜¾ç¤ºå™¨ï¼šæˆ´å°” P2715Q 4Kæ˜¾ç¤ºå™¨</p>
<p>æœºç®±ï¼š<a target="_blank" rel="noopener" href="http://www.phanteks.com/Enthoo-Evolv-ATX-TemperedGlass.html">è¿½é£è€… PK-515ETG</a></p>
<h2 id="å®‰è£…è¿‡ç¨‹"><a href="#å®‰è£…è¿‡ç¨‹" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h2><p><strong>é‡è¦æç¤ºï¼šå·²é™ BIOS è‡³ <a target="_blank" rel="noopener" href="https://www.msi.com/Motherboard/support/MPG-Z390-GAMING-PRO-CARBON-AC">Version 7B17v10</a>ï¼Œä¸åœ¨å¡ no nvram variableã€‚</strong></p>
<ol>
<li><a target="_blank" rel="noopener" href="https://blog.daliansky.net/macOS-Mojave-10.14.3-18D42-official-version-with-Clover-4859-original-image.html">ã€é»‘æœå°å…µã€‘<strong>macOS Mojave 10.14.3 18D42</strong> æ­£å¼ç‰ˆ <strong>with Clover 4859</strong>åŸç‰ˆé•œåƒ</a></li>
<li>æ‰§è¡Œï¼š<strong>300</strong>ç³»åˆ—ä¸»æ¿è¯·äº<strong>drivers64UEFI</strong>ç›®å½•ä¸­ç§»é™¤<strong>AptioMemoryFix-64.efi</strong>æ·»åŠ <strong>OsxAptioFix2Drv-free2000.efi</strong>è¯¥é©±åŠ¨ä½äº**&#x2F;EFI&#x2F;CLOVER&#x2F;drivers-off<strong>ç›®å½•ä¸‹ã€‚é¡ºåˆ©è¿›å…¥</strong>macOS**å®‰è£…ç•Œé¢</li>
<li>ç³»ç»Ÿååºå®‰è£…å’Œå¤åˆ¶ <strong>EFI</strong> åˆ°ç¡¬ç›˜æ•™ç¨‹ï¼š<a target="_blank" rel="noopener" href="https://blog.daliansky.net/Lenovo-Xiaoxin-Air-13-macOS-Mojave-installation-tutorial.html">è”æƒ³å°æ–°<strong>Air 13</strong>å®‰è£…é»‘è‹¹æœå…¼<strong>macOS Mojave</strong>å®‰è£…æ•™ç¨‹</a></li>
<li>è¿›å…¥ç³»ç»Ÿè®¾ç½®é¡µé¢å‰ï¼šå¡åœ¨ <strong>AppleUSBHostResources panic</strong>ã€‚è§£å†³æ–¹æ¡ˆæ˜¯<strong>boot</strong> æ·»åŠ  <strong>safe mode</strong></li>
<li>åˆå¹¶ <strong>Windows</strong> å’Œ <strong>Clover</strong> å¼•å¯¼</li>
<li>å®Œå–„é©±åŠ¨</li>
<li>ç»“æŸ</li>
</ol>
<h2 id="é™„å›¾"><a href="#é™„å›¾" class="headerlink" title="é™„å›¾"></a>é™„å›¾</h2><h2 id="Hackintosh-i9-2019-03-15-https-gewill-org-assets-Hackintosh-i9-2019-03-15-png-æ€»ç»“"><a href="#Hackintosh-i9-2019-03-15-https-gewill-org-assets-Hackintosh-i9-2019-03-15-png-æ€»ç»“" class="headerlink" title="![Hackintosh-i9 2019-03-15](https://gewill.org/assets/Hackintosh-i9 2019-03-15.png)æ€»ç»“"></a>![Hackintosh-i9 2019-03-15](<a target="_blank" rel="noopener" href="https://gewill.org/assets/Hackintosh-i9">https://gewill.org/assets/Hackintosh-i9</a> 2019-03-15.png)æ€»ç»“</h2><ol>
<li>å°å…µæ•™ç¨‹å¾ˆå¥½ç”¨ã€‚</li>
<li>å°±æ˜¯ä¸€ç›´å¡åœ¨ BIOS éƒ¨åˆ†ï¼Œæ‰€ä»¥æ— è®ºåšä»€ä¹ˆåŠªåŠ›çš„éƒ½æ²¡æœ‰æ•ˆæœã€‚æ‰€ä»¥è´­ä¹°ä¸»æ¿ä¸€å®šè¦çœ‹ tonymacx86.com çš„ <a target="_blank" rel="noopener" href="https://www.tonymacx86.com/buyersguide/building-a-customac-hackintosh-the-ultimate-buyers-guide/">Buyerâ€™s Guide</a> å’Œç½‘å‹çš„æˆåŠŸè´´ã€‚æˆ‘åªä¹‹å‰å¾®æ˜Ÿ Z170A M3 å®‰è£…é»‘è‹¹æœæˆåŠŸï¼Œå°±æƒ³å½“ç„¶çš„ä¹°äº†å¾®æ˜Ÿçš„è¿™å—ä¸»æ¿ã€‚æ´»ç”Ÿç”Ÿçš„å› ä¸º BIOS é—®é¢˜ï¼Œè‡³å°‘1ä¸ªæœˆçš„å®‰è£…æ—¶é—´æµªè´¹äº†ã€‚</li>
<li>ä¹°ä¸»æ¿åˆ«ä¹°å¸¦æ— è§£çš„æ— çº¿ç½‘å¡ï¼Œæ˜æ˜å¯ä»¥çœ200å—ï¼Œå»ä¹°åŒç³»åˆ—çš„å¾®æ˜Ÿ MPG Z390 GAMING PRO CARBONã€‚ç„¶åå»ä¹°å…é©±çš„æ— çº¿è“ç‰™ç½‘å¡ï¼šBroadcom 94360CDã€‚</li>
</ol>
<h2 id="EFI"><a href="#EFI" class="headerlink" title="EFI"></a>EFI</h2><p>EFIå·²ä¸Šä¼  <a target="_blank" rel="noopener" href="https://github.com/gewill/Hackintosh-Installation-with-MSI-Z390-and-i9-9900K">https://github.com/gewill/Hackintosh-Installation-with-MSI-Z390-and-i9-9900K</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/10/25/Add-sh-in-fastlane-to-slim-HyphenateSDK/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/10/25/Add-sh-in-fastlane-to-slim-HyphenateSDK/" class="post-title-link" itemprop="url">fastlaneæ·»åŠ shæ¥ç»™ç¯ä¿¡SDKç˜¦èº«</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2018-10-25 14:32:32" itemprop="dateCreated datePublished" datetime="2018-10-25T14:32:32+08:00">2018-10-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="å¤„ç†æ–¹æ³•"><a href="#å¤„ç†æ–¹æ³•" class="headerlink" title="å¤„ç†æ–¹æ³•"></a>å¤„ç†æ–¹æ³•</h2><p>ç”±äºç¯ä¿¡å°† i386 x86_64 armv7 arm64 å‡ ä¸ªå¹³å°éƒ½åˆå¹¶åˆ°äº†ä¸€èµ·ï¼Œæ‰€ä»¥ä½¿ç”¨åŠ¨æ€åº“ä¸Šä¼ appstoreæ—¶éœ€è¦å°†i386 x86_64ä¸¤ä¸ªå¹³å°åˆ é™¤åï¼Œæ‰èƒ½æ­£å¸¸æäº¤å®¡æ ¸ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ fastlane sh åœ¨æ‰“åŒ…<code>gym</code> æ—¶å‰ååˆ†åˆ«å°† x86 çš„ç§»é™¤<code>remove86framework</code>å’Œæ·»åŠ <code>add86framework</code> ã€‚è¿™æ ·å°±å¯ä»¥ç»§ç»­ä½¿ç”¨ fastlane ä¸€é”®æ‰“åŒ…ã€‚</p>
<blockquote>
<p>å¦‚æœå‡ºé”™ï¼Œä½¿ç”¨ pod åˆ é™¤å¹¶é‡æ–°å®‰è£…å®Œæ•´ç‰ˆçš„ç¯ä¿¡ SDKã€‚</p>
</blockquote>
<h2 id="Fastfile"><a href="#Fastfile" class="headerlink" title="Fastfile"></a>Fastfile</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">desc <span class="string">&quot;Deploy a new version to the App Store&quot;</span></span><br><span class="line">  lane <span class="symbol">:release</span> <span class="keyword">do</span></span><br><span class="line">    remove86framework</span><br><span class="line">    gym</span><br><span class="line">    add86framework  </span><br><span class="line">    deliver(<span class="symbol">force:</span> <span class="literal">true</span>)</span><br><span class="line">    <span class="comment"># frameit</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">desc <span class="string">&quot;Remove x86 framework&quot;</span></span><br><span class="line">  lane <span class="symbol">:remove86framework</span> <span class="keyword">do</span></span><br><span class="line">    sh(<span class="string">%(</span></span><br><span class="line"><span class="string">      cd ../Pods/HyphenateLite/iOS_Pods_IMSDK*</span></span><br><span class="line"><span class="string">      pwd</span></span><br><span class="line"><span class="string">      </span></span><br><span class="line"><span class="string">      if [ ! -d &quot;./bak&quot; ]; then  </span></span><br><span class="line"><span class="string">        mkdir ./bak</span></span><br><span class="line"><span class="string">      fi</span></span><br><span class="line"><span class="string">      if [ -d &quot;./bak/HyphenateLite.framework&quot; ]; then  </span></span><br><span class="line"><span class="string">        rm -rf ./bak/HyphenateLite.framework</span></span><br><span class="line"><span class="string">      fi</span></span><br><span class="line"><span class="string">      cp -r HyphenateLite.framework ./bak</span></span><br><span class="line"><span class="string">      lipo HyphenateLite.framework/HyphenateLite -thin armv7 -output HyphenateLite_armv7</span></span><br><span class="line"><span class="string">      lipo HyphenateLite.framework/HyphenateLite -thin arm64 -output HyphenateLite_arm64</span></span><br><span class="line"><span class="string">      lipo -create HyphenateLite_armv7 HyphenateLite_arm64 -output HyphenateLite</span></span><br><span class="line"><span class="string">      mv HyphenateLite HyphenateLite.framework/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    )</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  desc <span class="string">&quot;Add x86 framework back&quot;</span></span><br><span class="line">  lane <span class="symbol">:add86framework</span> <span class="keyword">do</span></span><br><span class="line">    sh(<span class="string">%(</span></span><br><span class="line"><span class="string">      cd ../Pods/HyphenateLite/iOS_Pods_IMSDK*</span></span><br><span class="line"><span class="string">      pwd</span></span><br><span class="line"><span class="string">      if [ -d &quot;./HyphenateLite.framework&quot; ]; then  </span></span><br><span class="line"><span class="string">        rm -rf ./HyphenateLite.framework</span></span><br><span class="line"><span class="string">      fi</span></span><br><span class="line"><span class="string">      cp -r ./bak/HyphenateLite.framework HyphenateLite.framework</span></span><br><span class="line"><span class="string">    )</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure>



<h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ol>
<li>ç¯ä¿¡ï¼š<a target="_blank" rel="noopener" href="http://docs.easemob.com/im/300iosclientintegration/20iossdkimport#%E9%9B%86%E6%88%90%E5%8A%A8%E6%80%81%E5%BA%93%E4%B8%8A%E4%BC%A0appstore">http://docs.easemob.com/im/300iosclientintegration/20iossdkimport#%E9%9B%86%E6%88%90%E5%8A%A8%E6%80%81%E5%BA%93%E4%B8%8A%E4%BC%A0appstore</a> </li>
<li>fastlane sh æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://docs.fastlane.tools/actions/sh/">https://docs.fastlane.tools/actions/sh/</a></li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/08/01/RxSwift-%E2%85%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/08/01/RxSwift-%E2%85%A3/" class="post-title-link" itemprop="url">RxSwift â…£ï¼šRxSwift å’Œ RxCocoa è¿›é˜¶</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2018-08-01 22:02:03" itemprop="dateCreated datePublished" datetime="2018-08-01T22:02:03+08:00">2018-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>ä¸€æ—¦ä½ å¼€å§‹ç¼–å†™å®Œæ•´çš„åº”ç”¨ç¨‹åºä¸ RxSwift å’Œ RxCocoa, ä½ ä¹Ÿéœ€è¦ç…§é¡¾æ›´å¤šçš„ä¸­é—´ä¸»é¢˜æ¯”ç®€å•åœ°è§‚å¯Ÿäº‹ä»¶å’Œå¤„ç†ä»–ä»¬ä¸ Rxã€‚</p>
<p>åœ¨ä¸€ä¸ªå®Œæ•´çš„ç”Ÿäº§è´¨é‡åº”ç”¨ç¨‹åºä¸­, æ‚¨éœ€è¦æ„å»ºä¸€ä¸ªé”™è¯¯å¤„ç†ç­–ç•¥, æ‰§è¡Œæ›´é«˜çº§çš„å¤šçº¿ç¨‹å¤„ç†, åˆ›å»ºä¸€ä¸ªåšå®çš„æµ‹è¯•å¥—ä»¶ç­‰ç­‰ã€‚</p>
<p>åœ¨è¿™éƒ¨åˆ†, ä½ å°†é€šè¿‡å­¦ä¹ å››ä¸ªæŒ‘æˆ˜æ€§çš„ç« èŠ‚, è¿™å°†è§£é™¤æ‚¨çš„ Rx ä»ä¸€ä¸ªèœé¸Ÿçº§çš„çŠ¶æ€åˆ°ä¸€ä¸ªå®æˆ˜ç»éªŒçš„æˆ˜å£«ã€‚</p>
<h2 id="ç¬¬åå››ç« ï¼šé”™è¯¯å¤„ç†å®è·µ"><a href="#ç¬¬åå››ç« ï¼šé”™è¯¯å¤„ç†å®è·µ" class="headerlink" title="ç¬¬åå››ç« ï¼šé”™è¯¯å¤„ç†å®è·µ"></a>ç¬¬åå››ç« ï¼šé”™è¯¯å¤„ç†å®è·µ</h2><p>ç”Ÿæ´»å°†æ˜¯ç¾å¥½çš„, å¦‚æœæˆ‘ä»¬ç”Ÿæ´»åœ¨ä¸€ä¸ªå®Œç¾çš„ä¸–ç•Œ, ä½†ä¸å¹¸çš„äº‹æƒ…å¾€å¾€ä¸åƒé¢„æœŸçš„é‚£æ ·å»ã€‚å³ä½¿æ˜¯æœ€å¥½çš„ RxSwift å¼€å‘äººå‘˜ä¹Ÿä¸èƒ½é¿å…é‡åˆ°é”™è¯¯, å› æ­¤ä»–ä»¬éœ€è¦çŸ¥é“å¦‚ä½•ä¼˜é›…å’Œé«˜æ•ˆåœ°å¤„ç†å®ƒä»¬ã€‚åœ¨æœ¬ç« ä¸­, æ‚¨å°†å­¦ä¹ å¦‚ä½•å¤„ç†é”™è¯¯, å¦‚ä½•é€šè¿‡é‡è¯•æ¥ç®¡ç†é”™è¯¯æ¢å¤, æˆ–è€…åªæ˜¯å‘æ•´ä¸ªå®‡å®™æŠ•é™, è®©é”™è¯¯ç»§ç»­ã€‚</p>
<h3 id="ç®¡ç†é”™è¯¯"><a href="#ç®¡ç†é”™è¯¯" class="headerlink" title="ç®¡ç†é”™è¯¯"></a>ç®¡ç†é”™è¯¯</h3><p>å¸¸è§é”™è¯¯ç±»å‹ï¼šç½‘ç»œè¿æ¥å¤±è´¥ã€æ— æ•ˆçš„è¾“å…¥å’ŒAPIé”™è¯¯æˆ–è€…HTTPé”™è¯¯ã€‚</p>
<p>åœ¨ RxSwift ä¸­, é”™è¯¯å¤„ç†æ˜¯æ¡†æ¶çš„ä¸€éƒ¨åˆ†, å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼è¿›è¡Œå¤„ç†:Â Â   </p>
<ul>
<li><strong>Catch</strong>: ä»é”™è¯¯ä¸­æ¢å¤å¹¶ä½¿ç”¨é»˜è®¤å€¼ã€‚Â   </li>
<li><strong>Retry</strong>: é‡è¯•æœ‰é™ (æˆ–æ— é™åˆ¶) æ¬¡æ•°ã€‚</li>
</ul>
<p>æœ¬ç« é¡¹ç›®çš„èµ·å§‹ç‰ˆæœ¬æ²¡æœ‰ä»»ä½•å®é™…çš„é”™è¯¯å¤„ç†ã€‚æ‰€æœ‰é”™è¯¯éƒ½æ˜¯ç”¨ä¸€ä¸ªè¿”å›è™šæ‹Ÿç‰ˆæœ¬çš„ <code>catchErrorJustReturn</code> æ•è·çš„ã€‚è¿™å¬èµ·æ¥åƒæ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„è§£å†³æ–¹æ¡ˆ, ä½†æ˜¯åœ¨ RxSwift ä¸­æœ‰æ›´å¥½çš„å¤„ç†æ–¹æ³•ã€‚åœ¨ä»»ä½•ä¸€æµçš„åº”ç”¨ç¨‹åºä¸­, éƒ½åº”è¯¥æœ‰ä¸€ä¸ªä¸€è‡´çš„ã€ä¿¡æ¯é”™è¯¯å¤„ç†æ–¹æ³•ã€‚</p>
<h4 id="æŠ›å‡ºé”™è¯¯"><a href="#æŠ›å‡ºé”™è¯¯" class="headerlink" title="æŠ›å‡ºé”™è¯¯"></a>æŠ›å‡ºé”™è¯¯</h4><p>ä¸€ä¸ªå¥½çš„èµ·ç‚¹æ˜¯å¤„ç† RxCocoa é”™è¯¯ï¼Œå®ƒåŒ…è£…åº•å±‚ Apple æ¡†æ¶è¿”å›çš„ç³»ç»Ÿé”™è¯¯ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">data</span>(<span class="params">request</span>: <span class="type">URLRequest</span>) -&gt; <span class="type">Observable</span>&lt;<span class="type">Data</span>&gt; &#123;<span class="operator">...</span>&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="number">200</span> <span class="operator">..&lt;</span> <span class="number">300</span> <span class="operator">~=</span> response.statusCode &#123; </span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="keyword">throw</span> <span class="type">RxCocoaURLError</span>.httpRequestFailed(response: response, data: data) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç”¨-catch-å¤„ç†é”™è¯¯"><a href="#ç”¨-catch-å¤„ç†é”™è¯¯" class="headerlink" title="ç”¨ catch å¤„ç†é”™è¯¯"></a>ç”¨ catch å¤„ç†é”™è¯¯</h3><p>åœ¨è§£é‡Šå¦‚ä½•æŠ›å‡ºé”™è¯¯ä¹‹å, æ˜¯æ—¶å€™çœ‹çœ‹å¦‚ä½•å¤„ç†é”™è¯¯äº†ã€‚æœ€åŸºæœ¬çš„æ–¹æ³•æ˜¯ä½¿ç”¨ catchã€‚catch çš„å·¥ä½œæ–¹å¼å¾ˆåƒåœ¨Swift ä¸­çš„ <code>do-try-catch</code> æµç¨‹ã€‚æ‰§è¡Œå¯è§‚å¯Ÿçš„æ“ä½œ, å¦‚æœå‡ºç°é”™è¯¯, åˆ™è¿”å›åŒ…è£…é”™è¯¯çš„äº‹ä»¶ã€‚</p>
<p>åœ¨ RxSwift ä¸­æœ‰ä¸¤ä¸ªä¸»è¦çš„è¿ç®—ç¬¦æ¥æ•è·é”™è¯¯ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">catchError</span>(<span class="keyword">_</span> <span class="params">handler</span>:) -&gt; <span class="type">RxSwift</span>.<span class="type">Observable</span>&lt;<span class="keyword">Self</span>.<span class="type">E</span>&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">catchErrorJustReturn</span>(<span class="keyword">_</span> <span class="params">element</span>:) -&gt; <span class="type">RxSwift</span>.<span class="type">Observable</span>&lt;<span class="keyword">Self</span>.<span class="type">E</span>&gt;</span><br></pre></td></tr></table></figure>

<h4 id="ä¸€ä¸ªå¸¸è§çš„é™·é˜±"><a href="#ä¸€ä¸ªå¸¸è§çš„é™·é˜±" class="headerlink" title="ä¸€ä¸ªå¸¸è§çš„é™·é˜±"></a>ä¸€ä¸ªå¸¸è§çš„é™·é˜±</h4><p>é“¾å¼è°ƒç”¨æ—¶å€™ï¼Œä¸€ä¸ªé”™è¯¯å°±ä¼šå¯¼è‡´æ•´ä¸ªè®¢é˜…ä»¥é”™è¯¯ç»“æŸã€‚æœ‰çš„æ—¶å€™æˆ‘ä»¬æƒ³çŸ¥é“é”™è¯¯çš„ä»…æœ‰ä¸€æ­¥ç»†èŠ‚ï¼Œå¦‚ HTTP 404 é”™è¯¯ï¼Œå±äº API è¿”å›é”™è¯¯çš„å…·ä½“ä¿¡æ¯çš„çº¦å®šï¼Œå°±éœ€è¦ç§»é™¤ <code>.catchErrorJustReturn(ApiController.Weather.empty)</code> æ¥é¿å…å‡ºç°ä¸æœŸæœ›çš„é”™è¯¯äº‹ä»¶å‘å°„ã€‚</p>
<h3 id="æ•æ‰é”™è¯¯"><a href="#æ•æ‰é”™è¯¯" class="headerlink" title="æ•æ‰é”™è¯¯"></a>æ•æ‰é”™è¯¯</h3><p>æˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªå±æ€§æ¥ç¼“å­˜å¤©æ°”æ•°æ®ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cache <span class="operator">=</span> [<span class="type">String</span>: <span class="type">Weather</span>]()</span><br></pre></td></tr></table></figure>

<p>å†æŠŠè¾“å…¥æ¡†çš„åºåˆ—æ”¹ä¸ºï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> textSearch <span class="operator">=</span> searchInput.flatMap &#123; text <span class="keyword">in</span></span><br><span class="line">  <span class="keyword">return</span> <span class="type">ApiController</span>.shared.currentWeather(city: text <span class="operator">??</span> <span class="string">&quot;Error&quot;</span>)</span><br><span class="line">    .do(onNext: &#123; data <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">let</span> text <span class="operator">=</span> text &#123;</span><br><span class="line">        <span class="keyword">self</span>.cache[text] <span class="operator">=</span> data</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, onError: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] e <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">guard</span> <span class="keyword">let</span> strongSelf <span class="operator">=</span> <span class="keyword">self</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">      <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">        strongSelf.showError(error: e)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .retryWhen(retryHandler)</span><br><span class="line">    .catchError &#123; error <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">let</span> text <span class="operator">=</span> text, <span class="keyword">let</span> cachedData <span class="operator">=</span> <span class="keyword">self</span>.cache[text] &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Observable</span>.just(cachedData)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Observable</span>.just(<span class="type">ApiController</span>.<span class="type">Weather</span>.empty)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="é”™è¯¯çš„é‡è¯•æœºåˆ¶"><a href="#é”™è¯¯çš„é‡è¯•æœºåˆ¶" class="headerlink" title="é”™è¯¯çš„é‡è¯•æœºåˆ¶"></a>é”™è¯¯çš„é‡è¯•æœºåˆ¶</h3><p>å…³äºé‡è¯•ä¸Šé¢å·²ç»è®¾è®¡åˆ°äº† <code>.retryWhen(retryHandler)</code>ï¼Œå…·ä½“å¤„ç†å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> retryHandler: (<span class="type">Observable</span>&lt;<span class="type">Error</span>&gt;) -&gt; <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt; <span class="operator">=</span> &#123; e <span class="keyword">in</span></span><br><span class="line">  <span class="keyword">return</span> e.enumerated().flatMap &#123; (attempt, error) -&gt; <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt; <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">if</span> attempt <span class="operator">&gt;=</span> maxAttempts <span class="operator">-</span> <span class="number">1</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="type">Observable</span>.error(error)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> <span class="keyword">let</span> casted <span class="operator">=</span> error <span class="keyword">as?</span> <span class="type">ApiController</span>.<span class="type">ApiError</span>, casted <span class="operator">==</span> .invalidKey &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="type">ApiController</span>.shared.apiKey.filter &#123;<span class="variable">$0</span> <span class="operator">!=</span> <span class="string">&quot;&quot;</span>&#125;.map &#123; <span class="keyword">_</span> <span class="keyword">in</span> <span class="keyword">return</span> <span class="number">1</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;== retrying after <span class="subst">\(attempt <span class="operator">+</span> <span class="number">1</span>)</span> seconds ==&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.timer(<span class="type">Double</span>(attempt <span class="operator">+</span> <span class="number">1</span>), scheduler: 				<span class="type">MainScheduler</span>.instance).take(<span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ç®€åŒ–ç‰ˆï¼š<code>.retry(3)</code></p>
<h3 id="è‡ªå®šä¹‰é”™è¯¯"><a href="#è‡ªå®šä¹‰é”™è¯¯" class="headerlink" title="è‡ªå®šä¹‰é”™è¯¯"></a>è‡ªå®šä¹‰é”™è¯¯</h3><p>åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯éµå¾ªä¸€èˆ¬çš„ Swift åŸåˆ™, æ‰€ä»¥æ²¡æœ‰ä¸€ä¸ªå¥½çš„ Swift ç¨‹åºå‘˜ä¸ä¼šçŸ¥é“, ä½†å®ƒä»ç„¶æ˜¯å¥½çš„, çœ‹çœ‹å¦‚ä½•å¤„ç†é”™è¯¯å’Œåˆ›å»ºå®šåˆ¶çš„æ“ä½œç¬¦ã€‚</p>
<h4 id="åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯"><a href="#åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯" class="headerlink" title="åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯"></a>åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯</h4><p>å…ˆå®šä¹‰é”™è¯¯æšä¸¾ï¼Œç„¶ååœ¨ç»“æœè¿‡æ»¤ä¸­æŠ›å‡ºå®šä¹‰çš„é”™è¯¯å³å¯ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">ApiError</span>: <span class="title class_">Error</span> &#123;</span><br><span class="line">  <span class="keyword">case</span> cityNotFound</span><br><span class="line">  <span class="keyword">case</span> serverFailure</span><br><span class="line">  <span class="keyword">case</span> invalidKey</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> session.rx.response(request: request).map() &#123; response, data <span class="keyword">in</span></span><br><span class="line">  <span class="keyword">if</span> <span class="number">200</span> <span class="operator">..&lt;</span> <span class="number">300</span> <span class="operator">~=</span> response.statusCode &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">try</span> <span class="type">JSON</span>(data: data)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> response.statusCode <span class="operator">==</span> <span class="number">401</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="type">ApiError</span>.invalidKey</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> <span class="number">400</span> <span class="operator">..&lt;</span> <span class="number">500</span> <span class="operator">~=</span> response.statusCode &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="type">ApiError</span>.cityNotFound</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="type">ApiError</span>.serverFailure</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è®¢é˜…è€…å¯ä»¥æ ¹æ®å®é™…åœºæ™¯æŠŠé”™è¯¯å±•ç¤ºç»™ç”¨æˆ·ï¼Œè¿™éƒ¨åˆ†å’Œ Swift ä¸­è‡ªå®šä¹‰é”™è¯¯ä¸€è‡´ï¼Œå°±ä¸å±•å¼€è®²äº†ã€‚</p>
<h3 id="é”™è¯¯å¤„ç†è¿›é˜¶"><a href="#é”™è¯¯å¤„ç†è¿›é˜¶" class="headerlink" title="é”™è¯¯å¤„ç†è¿›é˜¶"></a>é”™è¯¯å¤„ç†è¿›é˜¶</h3><p>æ¯”å¦‚å¤„ç†API ä¸­ 401 ç±»å‹ï¼Œéœ€è¦æç¤ºç”¨æˆ·æˆæƒå¤±è´¥ï¼Œéœ€è¦é‡æ–°ç™»å½•æˆ–æˆæƒã€‚æœ¬ä¾‹ä¸­éœ€è¦æ˜¯æŒ‡API Key å¤±æ•ˆï¼Œéœ€è¦ç”¨æˆ·å¡«å†™æ–°çš„æœ‰æ•ˆçš„API Keyã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> response.statusCode <span class="operator">==</span> <span class="number">401</span> &#123;</span><br><span class="line">	<span class="keyword">throw</span> <span class="type">ApiError</span>.invalidKey</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h4 id="Materialize-å’Œ-dematerialize"><a href="#Materialize-å’Œ-dematerialize" class="headerlink" title="Materialize å’Œ dematerialize"></a>Materialize å’Œ dematerialize</h4><p>materialize å’Œ dematerialize é€šå¸¸ä¸€èµ·ä½¿ç”¨, å¹¶ä¸”æœ‰èƒ½åŠ›å®Œå…¨æ‰“ç ´åŸå§‹å¯è§‚å¯Ÿçš„åˆåŒã€‚å½“æ²¡æœ‰å…¶ä»–é€‰æ‹©æ¥å¤„ç†ç‰¹å®šçš„æƒ…å†µæ—¶, è¯·å°å¿ƒåœ°ä½¿ç”¨å®ƒä»¬, å¹¶ä¸”åªæœ‰åœ¨å¿…è¦çš„æ—¶å€™ã€‚</p>
<p>å¸¸è§çš„åº”ç”¨æ˜¯ï¼šè¿›è¡Œæ—¥å¿—è®°å½•</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">observableToLog.materialize()</span><br><span class="line">	.do(onNext: &#123; (event) <span class="keyword">in</span> </span><br><span class="line">		myAdvancedLogEvent(event) </span><br><span class="line">     &#125;)</span><br><span class="line">	.dematerialize()</span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬åäº”ç« ï¼šä»‹ç»è°ƒåº¦ç¨‹åº"><a href="#ç¬¬åäº”ç« ï¼šä»‹ç»è°ƒåº¦ç¨‹åº" class="headerlink" title="ç¬¬åäº”ç« ï¼šä»‹ç»è°ƒåº¦ç¨‹åº"></a>ç¬¬åäº”ç« ï¼šä»‹ç»è°ƒåº¦ç¨‹åº</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨å·²ç»è®¾æ³•ä½¿ç”¨è°ƒåº¦ç¨‹åºï¼ŒåŒæ—¶é¿å…ä»»ä½•æœ‰å…³å®ƒä»¬å¦‚ä½•å¤„ç†çº¿ç¨‹æˆ–å¹¶å‘çš„è§£é‡Šã€‚ åœ¨å‰é¢çš„ç« èŠ‚ä¸­ï¼Œæ‚¨ä½¿ç”¨äº†éšå¼ä½¿ç”¨æŸç§å¹¶å‘&#x2F;çº¿ç¨‹çº§åˆ«çš„æ–¹æ³•ï¼Œä¾‹å¦‚<code>buffer</code>ï¼Œ<code>delaySubscription</code>æˆ–<code>interval</code>è¿ç®—ç¬¦ã€‚</p>
<p>æ‚¨å¯èƒ½æ„Ÿè§‰è°ƒåº¦ç¨‹åºæœ‰ä¸€äº›ç¥å¥‡çš„ä¸œè¥¿ï¼Œä½†åœ¨æ‚¨äº†è§£è°ƒåº¦ç¨‹åºä¹‹å‰ï¼Œæ‚¨è¿˜éœ€è¦äº†è§£é‚£äº›<code>observeOn</code>å‡½æ•°çš„å…¨éƒ¨å†…å®¹ã€‚</p>
<p>æœ¬ç« å°†ä»‹ç»è°ƒåº¦ç¨‹åºèƒŒåçš„ç¾è§‚ï¼Œåœ¨è¿™é‡Œæ‚¨å°†äº†è§£ä¸ºä»€ä¹ˆRxæŠ½è±¡å¦‚æ­¤å¼ºå¤§ä»¥åŠä¸ºä»€ä¹ˆä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹è¿œæ¯”ä½¿ç”¨é”æˆ–é˜Ÿåˆ—æ›´çœå¿ƒã€‚</p>
<h3 id="è°ƒåº¦ç¨‹åºåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#è°ƒåº¦ç¨‹åºåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="è°ƒåº¦ç¨‹åºåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ"></a>è°ƒåº¦ç¨‹åºåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>åœ¨ä½ ç€æ‰‹å­¦ä¹ æ—¶è°ƒåº¦ç¨‹åº, äº†è§£ä»–ä»¬æ˜¯ä»€ä¹ˆå’Œä»–ä»¬ä¸æ˜¯ä»€ä¹ˆæ˜¯å¾ˆé‡è¦çš„ã€‚æ€»è€Œè¨€ä¹‹, è°ƒåº¦ç¨‹åºæ˜¯ä¸€ä¸ªè¿‡ç¨‹å‘ç”Ÿçš„ä¸Šä¸‹æ–‡ã€‚æ­¤ä¸Šä¸‹æ–‡å¯ä»¥æ˜¯çº¿ç¨‹ã€è°ƒåº¦é˜Ÿåˆ—æˆ–ç±»ä¼¼çš„å®ä½“, ç”šè‡³æ˜¯åœ¨ OperationQueueScheduler å†…éƒ¨ä½¿ç”¨çš„ NSOperationã€‚</p>
<p>ä¸‹å›¾æ˜¯ä¸ªå¥½çš„ä¾‹å­ï¼š</p>
<p><img src="https://gewill.org/assets/schedulerExample.png" alt="schedulerExample"></p>
<p>åœ¨æ­¤å›¾ä¸­ï¼Œå…·æœ‰ç¼“å­˜è¿ç®—ç¬¦çš„æ¦‚å¿µã€‚ observableå‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚å¹¶æ£€ç´¢ä¸€äº›æ•°æ®ã€‚æ­¤æ•°æ®ç”±åä¸ºcacheçš„è‡ªå®šä¹‰è¿ç®—ç¬¦å¤„ç†ï¼Œè¯¥è¿ç®—ç¬¦å°†æ•°æ®å­˜å‚¨åœ¨æŸå¤„ã€‚ åœ¨æ­¤ä¹‹åï¼Œæ•°æ®è¢«ä¼ é€’ç»™ä¸åŒè°ƒåº¦ç¨‹åºä¸­çš„æ‰€æœ‰è®¢é˜…è€…ï¼Œå¾ˆå¯èƒ½æ˜¯ä½äºä¸»çº¿ç¨‹ä¹‹ä¸Šçš„MainSchedulerï¼Œä½¿å¾—UIçš„æ›´æ–°æˆä¸ºå¯èƒ½ã€‚</p>
<h4 id="æ­å¼€è°ƒåº¦ç¨‹åº"><a href="#æ­å¼€è°ƒåº¦ç¨‹åº" class="headerlink" title="æ­å¼€è°ƒåº¦ç¨‹åº"></a>æ­å¼€è°ƒåº¦ç¨‹åº</h4><p>è°ƒåº¦ç¨‹åºè™½ç„¶å·¥ä½œæ–¹å¼å’ŒGCDç±»ä¼¼ï¼Œå´ä¸æ˜¯ç­‰ä»·çš„ã€‚</p>
<p>è¦è®°ä½çš„é‡è¦ä¸€ç‚¹æ˜¯, è°ƒåº¦ç¨‹åºä¸æ˜¯çº¿ç¨‹, å¹¶ä¸”å®ƒä»¬æ²¡æœ‰ä¸çº¿ç¨‹çš„ä¸€å¯¹ä¸€å…³ç³»ã€‚å§‹ç»ˆæ£€æŸ¥è®¡åˆ’ç¨‹åºæ‰§è¡Œæ“ä½œçš„ä¸Šä¸‹æ–‡, è€Œä¸æ˜¯çº¿ç¨‹ã€‚åœ¨æœ¬ç« çš„åé¢éƒ¨åˆ†, æ‚¨å°†é‡åˆ°ä¸€äº›å¥½çš„ä¾‹å­æ¥å¸®åŠ©æ‚¨ç†è§£è¿™ä¸€ç‚¹ã€‚</p>
<h3 id="è®¾ç½®é¡¹ç›®"><a href="#è®¾ç½®é¡¹ç›®" class="headerlink" title="è®¾ç½®é¡¹ç›®"></a>è®¾ç½®é¡¹ç›®</h3><p>ç¼–å†™ä¸¤ä¸ªå‡½æ•°æ‰“å°å½“å‰è°ƒåº¦ç¨‹åºæ‰€åœ¨çº¿ç¨‹ã€‚</p>
<h3 id="åˆ‡æ¢è°ƒåº¦ç¨‹åº"><a href="#åˆ‡æ¢è°ƒåº¦ç¨‹åº" class="headerlink" title="åˆ‡æ¢è°ƒåº¦ç¨‹åº"></a>åˆ‡æ¢è°ƒåº¦ç¨‹åº</h3><p>Rx ä¸­æœ€é‡è¦çš„äº‹æƒ…ä¹‹ä¸€æ˜¯éšæ—¶åˆ‡æ¢è°ƒåº¦ç¨‹åºçš„èƒ½åŠ›, æ²¡æœ‰ä»»ä½•é™åˆ¶, é™¤äº†å†…éƒ¨è¿›ç¨‹ç”Ÿæˆäº‹ä»¶æ‰€å¼ºåŠ çš„çº¦æŸä¹‹å¤–ã€‚</p>
<p><code>fruit</code> æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸Šç”Ÿæˆçš„, ä½†æ˜¯å°†å®ƒç§»åŠ¨åˆ°åå°çº¿ç¨‹æ˜¯å¾ˆå¥½çš„ã€‚è¦åœ¨åå°çº¿ç¨‹ä¸­åˆ›å»º <code>fruit</code> , å¿…é¡»ä½¿ç”¨ <code>subscribeOn</code>ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fruit <span class="operator">=</span> <span class="type">Observable</span>&lt;<span class="type">String</span>&gt;.create &#123; observer <span class="keyword">in</span></span><br><span class="line">  observer.onNext(<span class="string">&quot;[apple]&quot;</span>)</span><br><span class="line">  sleep(<span class="number">2</span>)</span><br><span class="line">  observer.onNext(<span class="string">&quot;[pineapple]&quot;</span>)</span><br><span class="line">  sleep(<span class="number">2</span>)</span><br><span class="line">  observer.onNext(<span class="string">&quot;[strawberry]&quot;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="type">Disposables</span>.create()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fruit</span><br><span class="line">  .subscribeOn(globalScheduler)</span><br><span class="line">  .dump()</span><br><span class="line">  .observeOn(<span class="type">MainScheduler</span>.instance)</span><br><span class="line">  .dumpingSubscription()</span><br><span class="line">  .disposed(by: bag)</span><br></pre></td></tr></table></figure>

<p>è§‚å¯Ÿæ˜¯ Rx çš„ä¸‰åŸºæœ¬æ¦‚å¿µä¹‹ä¸€ã€‚å®ƒæ¶‰åŠå®ä½“ç”Ÿæˆäº‹ä»¶, ä»¥åŠè¿™äº›äº‹ä»¶çš„è§‚å¯Ÿè€…ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹, åœ¨å¯¹åº” <code>subscribeOn</code> çš„æƒ…å†µä¸‹, æ“ä½œç¬¦ <code>observeOn</code> æ”¹å˜äº†è§‚å¯Ÿå‘ç”Ÿçš„è°ƒåº¦ç¨‹åºã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„æ¨¡å¼ã€‚æ‚¨ä½¿ç”¨åå°è¿›ç¨‹ä»æœåŠ¡å™¨æ£€ç´¢æ•°æ®å¹¶å¤„ç†æ¥æ”¶çš„æ•°æ®, åªåˆ‡æ¢åˆ° MainScheduler å¤„ç† <code>ï¬nal</code> äº‹ä»¶å¹¶åœ¨ç”¨æˆ·ç•Œé¢ä¸­æ˜¾ç¤ºæ•°æ®ã€‚</p>
<h3 id="é™·é˜±"><a href="#é™·é˜±" class="headerlink" title="é™·é˜±"></a>é™·é˜±</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> globalScheduler <span class="operator">=</span> <span class="type">ConcurrentDispatchQueueScheduler</span>(queue: <span class="type">DispatchQueue</span>.global())</span><br><span class="line"><span class="keyword">let</span> bag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line"><span class="keyword">let</span> animal <span class="operator">=</span> <span class="type">BehaviorSubject</span>(value: <span class="string">&quot;[dog]&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> animalsThread <span class="operator">=</span> <span class="type">Thread</span>() &#123;</span><br><span class="line">  sleep(<span class="number">3</span>)</span><br><span class="line">  animal.onNext(<span class="string">&quot;[cat]&quot;</span>)</span><br><span class="line">  sleep(<span class="number">3</span>)</span><br><span class="line">  animal.onNext(<span class="string">&quot;[tiger]&quot;</span>)</span><br><span class="line">  sleep(<span class="number">3</span>)</span><br><span class="line">  animal.onNext(<span class="string">&quot;[fox]&quot;</span>)</span><br><span class="line">  sleep(<span class="number">3</span>)</span><br><span class="line">  animal.onNext(<span class="string">&quot;[leopard]&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">animalsThread.name <span class="operator">=</span> <span class="string">&quot;Animals Thread&quot;</span></span><br><span class="line">animalsThread.start()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">animal.subscribeOn(<span class="type">MainScheduler</span>.instance)</span><br><span class="line">  .dump()</span><br><span class="line">  .observeOn(globalScheduler)</span><br><span class="line">  .dumpingSubscription()</span><br><span class="line">  .disposed(by:bag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">RunLoop</span>.main.run(until: <span class="type">Date</span>(timeIntervalSinceNow: <span class="number">13</span>))</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">00s | [D] [dog] received on Main Thread</span><br><span class="line">00s | [S] [dog] received on Anonymous Thread</span><br><span class="line">03s | [D] [cat] received on Animals Thread</span><br><span class="line">03s | [S] [cat] received on Anonymous Thread</span><br><span class="line">06s | [D] [tiger] received on Animals Thread</span><br><span class="line">06s | [S] [tiger] received on Anonymous Thread</span><br><span class="line">09s | [D] [fox] received on Animals Thread</span><br><span class="line">09s | [S] [fox] received on Anonymous Thread</span><br><span class="line">12s | [D] [leopard] received on Animals Thread</span><br><span class="line">12s | [S] [leopard] received on Anonymous Thread</span><br></pre></td></tr></table></figure>

<p>ç»“æœå‡ºäººæ„æ–™ï¼Œå¹¶æ²¡æœ‰å¦‚æ„¿å‘ç”Ÿåœ¨ä¸»çº¿ç¨‹ä¸Šã€‚è¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„å’Œå±é™©çš„é™·é˜±, å®ƒæ¥è‡ªäºåœ¨é»˜è®¤æƒ…å†µä¸‹è®¤ä¸º Rx æ˜¯å¼‚æ­¥çš„æˆ–å¤šçº¿ç¨‹çš„ï¼Œä½†è¿™ä¸æ˜¯äº‹å®ã€‚</p>
<p>Rx å’Œä¸€èˆ¬æŠ½è±¡æ˜¯è‡ªç”±çº¿ç¨‹çš„;åœ¨å¤„ç†æ•°æ®æ—¶, æ²¡æœ‰å‘ç”Ÿé­”æœ¯èˆ¬çš„çº¿ç¨‹åˆ‡æ¢ã€‚å¦‚æœä¸æŒ‡å®šå…¶ä»–çš„çº¿ç¨‹, åˆ™å§‹ç»ˆåœ¨åŸå§‹çº¿ç¨‹ä¸Šæ‰§è¡Œè®¡ç®—ã€‚</p>
<blockquote>
<p>ä»»ä½•çº¿ç¨‹åˆ‡æ¢éƒ½æ˜¯åœ¨ç¨‹åºå‘˜ä½¿ç”¨è¿ç®—ç¬¦ <code>subscribeOn</code> å’Œ <code>observeOn</code> çš„æ˜¾å¼è¯·æ±‚ä¹‹åå‘ç”Ÿçš„ã€‚</p>
</blockquote>
<p>è®¤ä¸º Rx åšä¸€äº›çº¿ç¨‹å¤„ç†é»˜è®¤ä¼šé™·å…¥ä¸€ä¸ªå¸¸è§çš„é™·é˜±ã€‚ä¸Šé¢å‘ç”Ÿçš„äº‹æƒ…æ˜¯å¯¹ Subject çš„è¯¯ç”¨ã€‚åŸå§‹è®¡ç®—åœ¨æŒ‡å®šçš„çº¿ç¨‹ä¸Šå‘ç”Ÿ, å¹¶ä¸”è¿™äº›äº‹ä»¶ä½¿ç”¨ <code>Thread() &#123; ... &#125;</code> åœ¨è¯¥çº¿ç¨‹ä¸­è¢«æ¨å…¥ã€‚ç”±äº Subject çš„æ€§è´¨, Rx æ²¡æœ‰èƒ½åŠ›åˆ‡æ¢åŸå§‹çš„è®¡ç®—è°ƒåº¦ç¨‹åº, å¹¶ç§»åŠ¨åˆ°å¦ä¸€ä¸ªçº¿ç¨‹, å› ä¸ºæ²¡æœ‰ç›´æ¥æ§åˆ¶çš„ Subject è¢«æ¨å‡ºã€‚</p>
<p>ä½†æ˜¯ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> globalScheduler <span class="operator">=</span> <span class="type">ConcurrentDispatchQueueScheduler</span>(queue: <span class="type">DispatchQueue</span>.global())</span><br><span class="line"><span class="keyword">let</span> bag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line"><span class="keyword">let</span> animal <span class="operator">=</span> <span class="type">BehaviorSubject</span>(value: <span class="string">&quot;[dog]&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> fruit <span class="operator">=</span> <span class="type">Observable</span>&lt;<span class="type">String</span>&gt;.create &#123; observer <span class="keyword">in</span></span><br><span class="line">  observer.onNext(<span class="string">&quot;[apple]&quot;</span>)</span><br><span class="line">  sleep(<span class="number">2</span>)</span><br><span class="line">  observer.onNext(<span class="string">&quot;[pineapple]&quot;</span>)</span><br><span class="line">  sleep(<span class="number">2</span>)</span><br><span class="line">  observer.onNext(<span class="string">&quot;[strawberry]&quot;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="type">Disposables</span>.create()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fruit.subscribeOn(globalScheduler)</span><br><span class="line">  .dump()</span><br><span class="line">  .observeOn(<span class="type">MainScheduler</span>.instance)</span><br><span class="line">  .dumpingSubscription()</span><br><span class="line">  .disposed(by:bag)</span><br><span class="line"></span><br><span class="line"><span class="type">RunLoop</span>.main.run(until: <span class="type">Date</span>(timeIntervalSinceNow: <span class="number">13</span>))</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">00s | [D] [apple] received on Anonymous Thread</span><br><span class="line">00s | [S] [apple] received on Main Thread</span><br><span class="line">02s | [D] [pineapple] received on Anonymous Thread</span><br><span class="line">02s | [S] [pineapple] received on Main Thread</span><br><span class="line">04s | [D] [strawberry] received on Anonymous Thread</span><br><span class="line">04s | [S] [strawberry] received on Main Thread</span><br></pre></td></tr></table></figure>

<p>ä¸ºä»€ä¹ˆè¿™é€‚ç”¨äºfruit çº¿ç¨‹å‘¢ï¼Ÿ è¿™æ˜¯å› ä¸ºä½¿ç”¨<code>Observable.create</code>å¯ä»¥è®©Rxæ§åˆ¶Threadå—å†…éƒ¨å‘ç”Ÿçš„äº‹æƒ…ï¼Œè¿™æ ·ä½ å°±å¯ä»¥æ›´åŠ ç²¾ç¡®åœ°å®šåˆ¶çº¿ç¨‹å¤„ç†ã€‚<br>è¿™ç§æ„æƒ³ä¸åˆ°çš„ç»“æœé€šå¸¸è¢«ç§°ä¸ºâ€œå†·å’Œçƒ­â€å¯è§‚æµ‹é—®é¢˜ã€‚<br>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä½ æ­£åœ¨å¤„ç†çƒ­è§‚å¯Ÿã€‚ observableåœ¨è®¢é˜…æœŸé—´æ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨ï¼Œä½†å®ƒç¡®å®æœ‰è‡ªå·±çš„ä¸Šä¸‹æ–‡ï¼Œå…¶ä¸­ç”Ÿæˆäº‹ä»¶å¹¶ä¸”RxSwiftæ— æ³•æ§åˆ¶å®ƒï¼ˆå³ï¼Œå®ƒè¿è¡Œè‡ªå·±çš„Threadï¼‰ã€‚<br>ç›¸åï¼Œå†·è§‚å¯Ÿä¸ä¼šåœ¨ä»»ä½•è§‚å¯Ÿè€…è®¢é˜…ä¹‹å‰äº§ç”Ÿä»»ä½•å…ƒç´ ã€‚ è¿™å®é™…ä¸Šæ„å‘³ç€å®ƒæ²¡æœ‰è‡ªå·±çš„ä¸Šä¸‹æ–‡ï¼Œç›´åˆ°è®¢é˜…æ—¶ï¼Œå®ƒåˆ›å»ºä¸€äº›ä¸Šä¸‹æ–‡å¹¶å¼€å§‹ç”Ÿæˆå…ƒç´ ã€‚</p>
<h4 id="çƒ­-vs-å†·"><a href="#çƒ­-vs-å†·" class="headerlink" title="çƒ­ vs å†·"></a>çƒ­ vs å†·</h4><p>ä¸Šé¢çš„éƒ¨åˆ†è°ˆåˆ°äº†å†·çƒ­è§‚æµ‹é‡çš„è¯é¢˜ã€‚å†·çƒ­è§‚æµ‹é‡çš„è¯é¢˜æ˜¯ç›¸å½“å›ºæ‰§å·±è§çš„, äº§ç”Ÿäº†å¾ˆå¤šäº‰è®º, æ‰€ä»¥è®©æˆ‘ä»¬ç®€å•åœ¨è¿™é‡Œçœ‹çœ‹ã€‚è¿™ä¸ªæ¦‚å¿µå¯ä»¥å½’ç»“ä¸ºä¸€ä¸ªéå¸¸ç®€å•çš„é—®é¢˜:</p>
<p><img src="https://gewill.org//assets/HotVSCold.png" alt="HotVSCold"></p>
<p>ä¸€äº›å‰¯ä½œç”¨çš„ä¾‹å­æ˜¯ï¼š</p>
<ul>
<li>å‘æœåŠ¡å™¨å‘é€è¯·æ±‚</li>
<li>ç¼–è¾‘æœ¬åœ°æ•°æ®åº“</li>
<li>å†™å…¥æ–‡ä»¶ç³»ç»Ÿ</li>
<li>å‘å°„ç«ç®­</li>
</ul>
<h2 id="æœ€ä½³å®è·µå’Œå†…ç½®è°ƒåº¦ç¨‹åº"><a href="#æœ€ä½³å®è·µå’Œå†…ç½®è°ƒåº¦ç¨‹åº" class="headerlink" title="æœ€ä½³å®è·µå’Œå†…ç½®è°ƒåº¦ç¨‹åº"></a>æœ€ä½³å®è·µå’Œå†…ç½®è°ƒåº¦ç¨‹åº</h2><p>è°ƒåº¦ç¨‹åºæ˜¯ä¸€ä¸ªéå¹³å‡¡çš„ä¸»é¢˜, å› æ­¤å®ƒä»¬ä¼šä¸ºæœ€å¸¸è§çš„ç”¨ä¾‹æä¾›ä¸€äº›æœ€ä½³å®è·µã€‚åœ¨æœ¬èŠ‚ä¸­, æ‚¨å°†è·å¾—ä¸²è¡Œå’Œå¹¶å‘è°ƒåº¦ç¨‹åºçš„å¿«é€Ÿä»‹ç», äº†è§£å®ƒä»¬å¦‚ä½•å¤„ç†æ•°æ®å¹¶æŸ¥çœ‹å“ªç§ç±»å‹å¯¹ç‰¹å®šä¸Šä¸‹æ–‡æ›´æœ‰æ•ˆã€‚</p>
<h4 id="ä¸²è¡Œä¸å¹¶å‘è°ƒåº¦ç¨‹åº"><a href="#ä¸²è¡Œä¸å¹¶å‘è°ƒåº¦ç¨‹åº" class="headerlink" title="ä¸²è¡Œä¸å¹¶å‘è°ƒåº¦ç¨‹åº"></a>ä¸²è¡Œä¸å¹¶å‘è°ƒåº¦ç¨‹åº</h4><p>è™‘åˆ°è°ƒåº¦ç¨‹åºåªæ˜¯ä¸€ä¸ªä¸Šä¸‹æ–‡, å®ƒå¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿ (è°ƒåº¦é˜Ÿåˆ—ã€çº¿ç¨‹ã€è‡ªå®šä¹‰ä¸Šä¸‹æ–‡), å¹¶ä¸”æ‰€æœ‰è½¬æ¢åºåˆ—çš„è¿ç®—ç¬¦éƒ½éœ€è¦ä¿ç•™éšå¼ä¿è¯, å› æ­¤éœ€è¦ç¡®ä¿æ‚¨ä½¿ç”¨çš„æ˜¯æ­£ç¡®çš„è®¡åˆ’ç¨‹åºã€‚</p>
<ul>
<li><p>å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ä¸²è¡Œè°ƒåº¦ç¨‹åº, Rx å°†æŒ‰é¡ºåºè¿›è¡Œè®¡ç®—ã€‚å¯¹äºä¸²è¡Œè°ƒåº¦é˜Ÿåˆ—, è°ƒåº¦ç¨‹åºè¿˜å¯ä»¥åœ¨åº•å±‚æ‰§è¡Œè‡ªå·±çš„ä¼˜åŒ–ã€‚</p>
</li>
<li><p>åœ¨å¹¶å‘è®¡åˆ’ç¨‹åºä¸­, Rx å°†å°è¯•åŒæ—¶è¿è¡Œä»£ç , ä½† <code>observeOn</code> å’Œ <code>subscribeOn</code> å°†ä¿ç•™æ‰§è¡Œä»»åŠ¡æ‰€éœ€çš„é¡ºåº, å¹¶ç¡®ä¿è®¢é˜…ä»£ç åœ¨æ­£ç¡®çš„è®¡åˆ’ç¨‹åºä¸Šç»“æŸã€‚</p>
<h4 id="MainScheduler"><a href="#MainScheduler" class="headerlink" title="MainScheduler"></a>MainScheduler</h4></li>
</ul>
<p>MainScheduler ä½äºä¸»çº¿ç¨‹çš„é¡¶ç«¯ã€‚æ­¤è®¡åˆ’ç¨‹åºç”¨äºå¤„ç†ç”¨æˆ·ç•Œé¢ä¸Šçš„æ›´æ”¹å¹¶æ‰§è¡Œå…¶ä»–é«˜ä¼˜å…ˆçº§ä»»åŠ¡ã€‚ä½œä¸ºåœ¨ iOSã€tvOS æˆ– macOS ä¸Šå¼€å‘åº”ç”¨ç¨‹åºçš„ä¸€èˆ¬åšæ³•, ä¸åº”ä½¿ç”¨æ­¤è®¡åˆ’ç¨‹åºæ‰§è¡Œé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡, å› æ­¤åº”é¿å…è¯¸å¦‚æœåŠ¡å™¨è¯·æ±‚æˆ–å…¶ä»–ç¹é‡ä»»åŠ¡ä¹‹ç±»çš„äº‹æƒ…ã€‚</p>
<p>MainScheduler è¿˜ç”¨äºåœ¨ä½¿ç”¨å•ä½å’Œæ›´å¤šç‰¹å®šçš„ï¼ˆå¦‚ï¼šDriverï¼‰æ‰§è¡Œæ‰€æœ‰è®¡ç®—ã€‚å¦‚å‰ä¸€ç« æ‰€è¿°, Driver ç¡®ä¿å§‹ç»ˆåœ¨ MainScheduler ä¸­æ‰§è¡Œè®¡ç®—, ä»¥ä½¿æ‚¨èƒ½å¤Ÿå°†æ•°æ®ç›´æ¥ç»‘å®šåˆ°åº”ç”¨ç¨‹åºçš„ç”¨æˆ·ç•Œé¢ã€‚</p>
<h4 id="SerialDispatchQueueScheduler"><a href="#SerialDispatchQueueScheduler" class="headerlink" title="SerialDispatchQueueScheduler"></a>SerialDispatchQueueScheduler</h4><p>SerialDispatchQueueScheduler è´Ÿè´£åœ¨ä¸²è¡Œ DispatchQueue ã€‚è¿™ä¸ªè°ƒåº¦ç¨‹åºåœ¨ä½¿ç”¨ <code>observeOn</code> æ—¶ï¼Œæœ‰å¾ˆå¤šä¼˜åŒ–çš„ä¼˜åŠ¿ã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨æ­¤è®¡åˆ’ç¨‹åºæ¥å¤„ç†ä»¥ä¸²è¡Œæ–¹å¼æ›´å¥½åœ°å®‰æ’çš„åå°ä½œä¸šã€‚ä¾‹å¦‚, å¦‚æœåº”ç”¨ç¨‹åºä¸æœåŠ¡å™¨çš„å•ä¸ªè·¯å¾„ (å¦‚Firebase æˆ– GraphQL åº”ç”¨ç¨‹åº) è¿›è¡Œå¯¹è¯, åˆ™å¯èƒ½éœ€è¦é¿å…è°ƒåº¦å¤šä¸ªåŒæ—¶è¯·æ±‚, è¿™ä¼šç»™æ¥æ”¶ç«¯é€ æˆå¤ªå¤§çš„å‹åŠ›ã€‚è¿™ä¸ªè°ƒåº¦ç¨‹åºæ˜¯ä½ ç»å¯¹æƒ³è¦çš„, åƒä¸²è¡Œä»»åŠ¡é˜Ÿåˆ—ä¸€æ ·å…ˆè¿›ã€‚</p>
<h4 id="ConcurrentDispatchQueueScheduler"><a href="#ConcurrentDispatchQueueScheduler" class="headerlink" title="ConcurrentDispatchQueueScheduler"></a>ConcurrentDispatchQueueScheduler</h4><p>ConcurrentDispatchQueueScheduler ä¸ SerialDispatchQueueSchedulerç±»ä¼¼ï¼Œè´Ÿè´£åœ¨DispatchQueueä¸ŠæŠ½è±¡å·¥ä½œã€‚ ä¸»è¦åŒºåˆ«åœ¨äºï¼Œè°ƒåº¦ç¨‹åºä½¿ç”¨å¹¶è¡Œé˜Ÿåˆ—è€Œä¸æ˜¯ä¸²è¡Œé˜Ÿåˆ—ã€‚</p>
<p>æ­¤ç±»è°ƒåº¦ç¨‹åºåœ¨ä½¿ç”¨ <code>observeOn</code> æ—¶æ²¡æœ‰è¿›è¡Œä¼˜åŒ–, å› æ­¤åœ¨å†³å®šä½¿ç”¨å“ªç§è°ƒåº¦ç¨‹åºæ—¶, è¯·è®°ä½è¯´æ˜è¿™ä¸€ç‚¹ã€‚</p>
<p>å¯¹äºéœ€è¦åŒæ—¶ç»“æŸçš„å¤šä¸ªé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ï¼Œå¹¶å‘çš„è°ƒåº¦ç¨‹åºå¯èƒ½æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ å°†å¤šä¸ªå¯è§‚å¯Ÿå¯¹è±¡ä¸é˜»å¡è¿ç®—ç¬¦ç»„åˆåœ¨ä¸€èµ·ï¼Œä»¥ä¾¿åœ¨å‡†å¤‡å¥½æ—¶å°†æ‰€æœ‰ç»“æœç»„åˆåœ¨ä¸€èµ·ï¼Œå¯ä»¥é˜²æ­¢ä¸²è¡Œè°ƒåº¦ç¨‹åºä»¥æœ€ä½³çŠ¶æ€æ‰§è¡Œã€‚ ç›¸åï¼Œå¹¶å‘è°ƒåº¦ç¨‹åºå¯ä»¥æ‰§è¡Œå¤šä¸ªå¹¶å‘ä»»åŠ¡å¹¶ä¼˜åŒ–ç»“æœçš„æ”¶é›†ã€‚</p>
<h4 id="OperationQueueScheduler"><a href="#OperationQueueScheduler" class="headerlink" title="OperationQueueScheduler"></a>OperationQueueScheduler</h4><p>OperationQueueSchedulerç±»ä¼¼äºConcurrentDispatchQueueSchedulerï¼Œä½†ä¸æ˜¯é€šè¿‡DispatchQueueæŠ½è±¡å·¥ä½œï¼Œå®ƒåœ¨NSOperationQueueä¸Šæ‰§è¡Œå·¥ä½œã€‚ æœ‰æ—¶ä½ éœ€è¦å¯¹æ­£åœ¨è¿è¡Œçš„å¹¶å‘ä½œä¸šè¿›è¡Œæ›´å¤šæ§åˆ¶ï¼Œè€Œå¯¹äºå¹¶å‘DispatchQueueåˆ™æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>
<p>å¦‚æœéœ€è¦è°ƒæ•´æœ€å¤§å¹¶å‘ä½œä¸šæ•°ï¼Œåˆ™è¿™æ˜¯ä½œä¸šçš„è°ƒåº¦ç¨‹åºã€‚ æ‚¨å¯ä»¥å®šä¹‰<code>maxConcurrentOperationCount</code>æ¥é™åˆ¶å¹¶å‘æ“ä½œçš„æ•°é‡ä»¥æ»¡è¶³æ‚¨çš„åº”ç”¨ç¨‹åºçš„éœ€è¦ã€‚</p>
<h4 id="TestScheduler"><a href="#TestScheduler" class="headerlink" title="TestScheduler"></a>TestScheduler</h4><p>TestScheduleræ˜¯ä¸€ç§ç‰¹æ®Šçš„é‡å…½ã€‚ å®ƒä»…ç”¨äºæµ‹è¯•ï¼Œå› æ­¤å°½é‡ä¸è¦åœ¨ç”Ÿäº§ä»£ç ä¸­ä½¿ç”¨æ­¤è°ƒåº¦ç¨‹åºã€‚ è¿™ç§ç‰¹æ®Šçš„è°ƒåº¦ç¨‹åºç®€åŒ–äº†æ“ä½œå‘˜æµ‹è¯•; å®ƒæ˜¯RxTeståº“çš„ä¸€éƒ¨åˆ†ã€‚ æ‚¨å°†åœ¨å…³äºæµ‹è¯•çš„ä¸“ç”¨ç« èŠ‚ä¸­äº†è§£å¦‚ä½•ä½¿ç”¨æ­¤è°ƒåº¦ç¨‹åºï¼Œä½†æ˜¯è®©æˆ‘ä»¬å¿«é€Ÿæµè§ˆä¸€ä¸‹ï¼Œå› ä¸ºæ‚¨æ­£åœ¨è¿›è¡Œè°ƒåº¦ç¨‹åºçš„å…¨ç¨‹æµè§ˆã€‚</p>
<h2 id="ç¬¬åå…­ç« ï¼šä½¿ç”¨-RxTest-è¿›è¡Œæµ‹è¯•"><a href="#ç¬¬åå…­ç« ï¼šä½¿ç”¨-RxTest-è¿›è¡Œæµ‹è¯•" class="headerlink" title="ç¬¬åå…­ç« ï¼šä½¿ç”¨ RxTest è¿›è¡Œæµ‹è¯•"></a>ç¬¬åå…­ç« ï¼šä½¿ç”¨ RxTest è¿›è¡Œæµ‹è¯•</h2><p>æœ¬ç« å°†å‘æ‚¨ä»‹ç» RxTest, ä»¥åŠä»¥åçš„ RxBlocking, é€šè¿‡ç¼–å†™é’ˆå¯¹å¤šä¸ª RxSwift æ“ä½œçš„æµ‹è¯•, è¿˜å¯ä»¥ç¼–å†™é’ˆå¯¹ç”Ÿäº§ RxSwift ä»£ç çš„æµ‹è¯•ã€‚</p>
<p>æœ¬ç« ä¾‹å­æ˜¯ï¼šä¸€ä¸ªå°†Hexé¢œè‰²å€¼è½¬æ¢ä¸ºRGBå€¼çš„åº”ç”¨ã€‚æ¶æ„æ˜¯MVVMã€‚</p>
<h3 id="ä½¿ç”¨-RxTest-æµ‹è¯•æ“ä½œç¬¦"><a href="#ä½¿ç”¨-RxTest-æµ‹è¯•æ“ä½œç¬¦" class="headerlink" title="ä½¿ç”¨ RxTest æµ‹è¯•æ“ä½œç¬¦"></a>ä½¿ç”¨ RxTest æµ‹è¯•æ“ä½œç¬¦</h3><p> RxTest æ˜¯ RxSwift å¤–ä¸€ä¸ªç‹¬ç«‹çš„åº“ã€‚å®ƒæ˜¯æ‰˜ç®¡åœ¨ RxSwift ä»“åº“, ä½†éœ€è¦ä¸€ä¸ªå•ç‹¬çš„ pod å®‰è£…å’Œå¯¼å…¥ã€‚RxTest ä¸ºæµ‹è¯• RxSwift ä»£ç æä¾›äº†è®¸å¤šæœ‰ç”¨çš„è¡¥å……, å¦‚ TestScheduler, å®ƒæ˜¯ä¸€ä¸ªè™šæ‹Ÿæ—¶é—´è®¡åˆ’ç¨‹åº, å®ƒä½¿ä½ å¯ä»¥å¯¹æµ‹è¯•çš„æ—¶é—´çº¿æ€§æ“ä½œè¿›è¡Œç²’çŠ¶æ§åˆ¶, å¹¶ä¸”åŒ…æ‹¬ <code>next(_:_:)</code>, <code>completed(_:_:)</code> å’Œ <code>error(_:_:)</code> åœ¨æµ‹è¯•ä¸­ speciï¬ed æ—¶é—´å¯ç”¨å°†è¿™äº›äº‹ä»¶æ·»åŠ åˆ°è§‚æµ‹é‡ä¸­ã€‚å®ƒè¿˜å¢åŠ äº†çƒ­å’Œå†·çš„è§‚æµ‹é‡, ä½ å¯ä»¥æƒ³åˆ°çš„çƒ­å’Œå†·ä¸‰æ˜æ²»ã€‚å½“ç„¶, ä¸æ˜¯çœŸçš„ä¸‰æ˜æ²»ã€‚</p>
<h4 id="çƒ­å’Œå†·çš„åºåˆ—æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#çƒ­å’Œå†·çš„åºåˆ—æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="çƒ­å’Œå†·çš„åºåˆ—æ˜¯ä»€ä¹ˆï¼Ÿ"></a>çƒ­å’Œå†·çš„åºåˆ—æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>RxSwift å¾ˆé•¿çš„æ—¶é—´æ¥ç®€åŒ–å’Œç®€åŒ–ä½ çš„ Rx ä»£ç , å¹¶ä¸”æœ‰çƒ­å’Œå†·çš„åºåˆ—çš„åŒºåˆ«, å½“å®ƒæ¶‰åŠåˆ°è§‚æµ‹é‡, åœ¨ RxSwift å¯ä»¥è¢«è®¤ä¸ºæ˜¯å¯è§‚æµ‹çš„ç‰¹å¾è€Œä¸æ˜¯å…·ä½“çš„ç±»å‹ã€‚</p>
<p><strong>çƒ­åºåˆ—ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨èµ„æºï¼Œæ— è®ºæ˜¯å¦æœ‰è®¢é˜…è€…ã€‚</li>
<li>ç”Ÿæˆå…ƒç´ ï¼Œæ— è®ºæ˜¯å¦æœ‰è®¢é˜…è€…ã€‚</li>
<li>ä¸»è¦ç”¨äºæœ‰çŠ¶æ€ç±»å‹ï¼Œå¦‚å˜é‡ã€‚</li>
</ul>
<p><strong>å†·åºåˆ—ï¼š</strong></p>
<ul>
<li>ä»…åœ¨è®¢é˜…æ—¶æ¶ˆè€—èµ„æºã€‚</li>
<li>ä»…åœ¨æœ‰è®¢é˜…è€…æ—¶æ‰ç”Ÿæˆå…ƒç´ ã€‚</li>
<li>ä¸»è¦ç”¨äºç½‘ç»œç­‰å¼‚æ­¥æ“ä½œã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ <code>amb</code> çš„æµ‹è¯•ç”¨ä¾‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">testAmb</span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> observer <span class="operator">=</span> scheduler.createObserver(<span class="type">String</span>.<span class="keyword">self</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> observableA <span class="operator">=</span> scheduler.createHotObservable([</span><br><span class="line">        next(<span class="number">100</span>, <span class="string">&quot;a&quot;</span>),</span><br><span class="line">        next(<span class="number">110</span>, <span class="string">&quot;b&quot;</span>),</span><br><span class="line">        next(<span class="number">300</span>, <span class="string">&quot;c&quot;</span>)</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> observableB <span class="operator">=</span> scheduler.createHotObservable([</span><br><span class="line">        next(<span class="number">90</span>, <span class="string">&quot;1&quot;</span>),</span><br><span class="line">        next(<span class="number">200</span>, <span class="string">&quot;2&quot;</span>),</span><br><span class="line">        next(<span class="number">300</span>, <span class="string">&quot;3&quot;</span>)</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> ambObservable <span class="operator">=</span> observableA.amb(observableB)</span><br><span class="line"></span><br><span class="line">    scheduler.scheduleAt(<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.subscription <span class="operator">=</span> ambObservable.subscribe(observer)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    scheduler.start()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> results <span class="operator">=</span> observer.events.map &#123;</span><br><span class="line">        <span class="variable">$0</span>.value.element<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">XCTAssertEqual</span>(results, [<span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æ˜¯åŒæ­¥æµ‹è¯•ï¼Œå¦‚æœæƒ³æµ‹è¯•å¼‚æ­¥é”™è¯¯ï¼Œæœ€ç®€å•åœ°æ˜¯ä½¿ç”¨ <code>RxBlocking</code>ã€‚</p>
<h4 id="ä½¿ç”¨-RxBlocking"><a href="#ä½¿ç”¨-RxBlocking" class="headerlink" title="ä½¿ç”¨ RxBlocking"></a>ä½¿ç”¨ RxBlocking</h4><p>RxBlocking æ˜¯å¦ä¸€ä¸ªåº“, å¯„å­˜åœ¨ RxSwift ä»“åº“ã€‚å®ƒçš„ä¸»è¦ç›®çš„æ˜¯é€šè¿‡å®ƒçš„ <code>toBlocking(timeout:)</code> æ–¹æ³•å°† <code>observable</code> è½¬æ¢ä¸º <code>BlockingObservable</code>ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">testToArray</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> scheduler <span class="operator">=</span> <span class="type">ConcurrentDispatchQueueScheduler</span>(qos: .default)</span><br><span class="line">    <span class="keyword">let</span> toArrayObservable <span class="operator">=</span> <span class="type">Observable</span>.of(<span class="number">1</span>, <span class="number">2</span>).subscribeOn(scheduler)</span><br><span class="line">    <span class="type">XCTAssertEqual</span>(<span class="keyword">try!</span> toArrayObservable.toBlocking().toArray(), [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">testToArrayMaterialized</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> scheduler <span class="operator">=</span> <span class="type">ConcurrentDispatchQueueScheduler</span>(qos: .default)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> toArrayObservable <span class="operator">=</span> <span class="type">Observable</span>.of(<span class="number">1</span>, <span class="number">2</span>).subscribeOn(scheduler)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> result <span class="operator">=</span> toArrayObservable</span><br><span class="line">        .toBlocking()</span><br><span class="line">        .materialize()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> result &#123;</span><br><span class="line">    <span class="keyword">case</span> .completed(elements: <span class="keyword">let</span> elements):</span><br><span class="line">        <span class="type">XCTAssertEqual</span>(elements, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">    <span class="keyword">case</span> .failed(<span class="keyword">_</span>, error: <span class="keyword">let</span> error):</span><br><span class="line">        <span class="type">XCTFail</span>(error.localizedDescription)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æµ‹è¯•-RxSwift-ç”Ÿäº§ä»£ç "><a href="#æµ‹è¯•-RxSwift-ç”Ÿäº§ä»£ç " class="headerlink" title="æµ‹è¯• RxSwift ç”Ÿäº§ä»£ç "></a>æµ‹è¯• RxSwift ç”Ÿäº§ä»£ç </h3><p>ä¸‹é¢ä¾‹å­æ˜¯æµ‹è¯•MVVMä¸­VMå±‚ï¼š</p>
<p>ä½¿ç”¨ <code>toBlocking</code>  å¾ˆæ–¹ä¾¿ç¼–å†™å¼‚æ­¥æµ‹è¯•ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> XCTest</span><br><span class="line"><span class="keyword">import</span> RxSwift</span><br><span class="line"><span class="keyword">import</span> RxCocoa</span><br><span class="line"><span class="keyword">import</span> RxTest</span><br><span class="line"><span class="keyword">@testable</span> <span class="keyword">import</span> Testing</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestingViewModel</span>: <span class="title class_">XCTestCase</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> viewModel: <span class="type">ViewModel</span>!</span><br><span class="line">    <span class="keyword">var</span> scheduler: <span class="type">ConcurrentDispatchQueueScheduler</span>!</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">setUp</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.setUp()</span><br><span class="line"></span><br><span class="line">        viewModel <span class="operator">=</span> <span class="type">ViewModel</span>()</span><br><span class="line">        scheduler <span class="operator">=</span> <span class="type">ConcurrentDispatchQueueScheduler</span>(qos: .default)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">testColorIsRedWhenHexStringIsFF0000_async</span>() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> disposeBag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> expect <span class="operator">=</span> expectation(description: <span class="keyword">#function</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> expectedColor <span class="operator">=</span> <span class="type">UIColor</span>(red: <span class="number">1.0</span>, green: <span class="number">0.0</span>, blue: <span class="number">0.0</span>, alpha: <span class="number">1.0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> result: <span class="type">UIColor</span>!</span><br><span class="line"></span><br><span class="line">        viewModel.color.asObservable()</span><br><span class="line">            .skip(<span class="number">1</span>)</span><br><span class="line">            .subscribe(onNext: &#123;</span><br><span class="line">                result <span class="operator">=</span> <span class="variable">$0</span></span><br><span class="line">                expect.fulfill()</span><br><span class="line">            &#125;)</span><br><span class="line">            .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">        viewModel.hexString.value <span class="operator">=</span> <span class="string">&quot;#ff0000&quot;</span></span><br><span class="line"></span><br><span class="line">        waitForExpectations(timeout: <span class="number">1.0</span>) &#123; error <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">guard</span> error <span class="operator">==</span> <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">XCTFail</span>(error<span class="operator">!</span>.localizedDescription)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">XCTAssertEqual</span>(expectedColor, result)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">testColorIsRedWhenHexStringIsFF0000</span>() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> colorObservable <span class="operator">=</span> viewModel.color.asObservable().subscribeOn(scheduler)</span><br><span class="line"></span><br><span class="line">        viewModel.hexString.value <span class="operator">=</span> <span class="string">&quot;#ff0000&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> result <span class="operator">=</span> <span class="keyword">try</span> colorObservable.toBlocking(timeout: <span class="number">1.0</span>).first() <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">XCTAssertEqual</span>(result, .red)</span><br><span class="line">        &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(error)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">testRgbIs010WhenHexStringIs00FF00</span>() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> rgbObservable <span class="operator">=</span> viewModel.rgb.asObservable().subscribeOn(scheduler)</span><br><span class="line"></span><br><span class="line">        viewModel.hexString.value <span class="operator">=</span> <span class="string">&quot;#00ff00&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> result <span class="operator">=</span> <span class="keyword">try!</span> rgbObservable.toBlocking().first()<span class="operator">!</span></span><br><span class="line"></span><br><span class="line">        <span class="type">XCTAssertEqual</span>(<span class="number">0</span> <span class="operator">*</span> <span class="number">255</span>, result.<span class="number">0</span>)</span><br><span class="line">        <span class="type">XCTAssertEqual</span>(<span class="number">1</span> <span class="operator">*</span> <span class="number">255</span>, result.<span class="number">1</span>)</span><br><span class="line">        <span class="type">XCTAssertEqual</span>(<span class="number">0</span> <span class="operator">*</span> <span class="number">255</span>, result.<span class="number">2</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">testColorNameIsRayWenderlichGreenWhenHexStringIs006636</span>() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> colorNameObservable <span class="operator">=</span> viewModel.colorName.asObservable().subscribeOn(scheduler)</span><br><span class="line"></span><br><span class="line">        viewModel.hexString.value <span class="operator">=</span> <span class="string">&quot;#006636&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="type">XCTAssertEqual</span>(<span class="keyword">try!</span> colorNameObservable.toBlocking().first()<span class="operator">!</span>, <span class="string">&quot;rayWenderlichGreen&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬åä¸ƒç« ï¼šåˆ›å»ºè‡ªå®šä¹‰å“åº”å¼æ‹“å±•"><a href="#ç¬¬åä¸ƒç« ï¼šåˆ›å»ºè‡ªå®šä¹‰å“åº”å¼æ‹“å±•" class="headerlink" title="ç¬¬åä¸ƒç« ï¼šåˆ›å»ºè‡ªå®šä¹‰å“åº”å¼æ‹“å±•"></a>ç¬¬åä¸ƒç« ï¼šåˆ›å»ºè‡ªå®šä¹‰å“åº”å¼æ‹“å±•</h2><p>åœ¨å­¦ä¹ äº†RxSwiftå’ŒRxCocoaï¼Œä»¥åŠå¦‚ä½•ç¼–å†™æµ‹è¯•ï¼Œè¿™é‡Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ç»™Appleå’Œç¬¬ä¸‰æ–¹åº“ç¼–å†™RxSwiftçš„æ‹“å±•ã€‚æœ¬ç« ä¾‹å­æ˜¯ç»™NSURLSessionç¼–å†™æ‹“å±•ï¼Œæ¥å®ç°ç½‘ç»œè¯·æ±‚ã€ç¼“å­˜ã€‚ä½†å´æ˜¯ä¸€ä¸ªæ•™å­¦å®ä¾‹ï¼Œå¦‚æœç”Ÿäº§é¡¹ç›®å¯ä»¥æœ‰å¾ˆå¤šç½‘ç»œåº“å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå¦‚RxAlamofireã€RxMoyaç­‰ã€‚</p>
<h3 id="å¦‚ä½•åˆ›å»ºæ‹“å±•"><a href="#å¦‚ä½•åˆ›å»ºæ‹“å±•" class="headerlink" title="å¦‚ä½•åˆ›å»ºæ‹“å±•"></a>å¦‚ä½•åˆ›å»ºæ‹“å±•</h3><p>åˆ›å»ºä¸€ä¸ªCocoaæˆ–åº“çš„æ‹“å±•ä¸æ˜¯ä¸€ä¸ªç®€å•çš„ä»»åŠ¡ã€‚ä½ ä¼šå‘ç°è¿™ä¸ªè¿‡ç¨‹å¯èƒ½å¾ˆæ£˜æ‰‹ï¼Œä½ çš„è§£å†³æ–¹æ¡ˆåœ¨ç»§ç»­ä¹‹å‰å¯èƒ½éœ€è¦ä¸€äº›å‰æœŸæ€è€ƒã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•æ‹“å±•URLSessionï¼ŒåŠ ä¸ŠRxçš„å‘½åç©ºé—´ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">Reactive</span> <span class="title class_">where</span> <span class="title class_">Base</span>: <span class="title class_">URLSession</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">response</span>(<span class="params">request</span>: <span class="type">URLRequest</span>) -&gt; <span class="type">Observable</span>&lt;(<span class="type">HTTPURLResponse</span>, <span class="type">Data</span>)&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Observable</span>.create &#123; observer <span class="keyword">in</span></span><br><span class="line">      <span class="comment">// content goes here</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">let</span> task <span class="operator">=</span> <span class="keyword">self</span>.base.dataTask(with: request) &#123; (data, response, error) <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> response <span class="operator">=</span> response, <span class="keyword">let</span> data <span class="operator">=</span> data <span class="keyword">else</span> &#123;</span><br><span class="line">          observer.on(.error(error <span class="operator">??</span> <span class="type">RxURLSessionError</span>.unknown))</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> httpResponse <span class="operator">=</span> response <span class="keyword">as?</span> <span class="type">HTTPURLResponse</span> <span class="keyword">else</span> &#123;</span><br><span class="line">          observer.on(.error(<span class="type">RxURLSessionError</span>.invalidResponse(response: response)))</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        observer.onNext((httpResponse, data))</span><br><span class="line">        observer.on(.completed)</span><br><span class="line">      &#125;</span><br><span class="line">      task.resume()</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="type">Disposables</span>.create(with: task.cancel)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">data</span>(<span class="params">request</span>: <span class="type">URLRequest</span>) -&gt; <span class="type">Observable</span>&lt;<span class="type">Data</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> url <span class="operator">=</span> request.url<span class="operator">?</span>.absoluteString, <span class="keyword">let</span> data <span class="operator">=</span> internalCache[url] &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="type">Observable</span>.just(data)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> response(request: request).cache().map &#123; (response, data) -&gt; <span class="type">Data</span> <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">if</span> <span class="number">200</span> <span class="operator">..&lt;</span> <span class="number">300</span> <span class="operator">~=</span> response.statusCode &#123;</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="type">RxURLSessionError</span>.requestFailed(response: response, data: data)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">string</span>(<span class="params">request</span>: <span class="type">URLRequest</span>) -&gt; <span class="type">Observable</span>&lt;<span class="type">String</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> data(request: request).map &#123; d <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">return</span> <span class="type">String</span>(data: d, encoding: .utf8) <span class="operator">??</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">json</span>(<span class="params">request</span>: <span class="type">URLRequest</span>) -&gt; <span class="type">Observable</span>&lt;<span class="type">JSON</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> data(request: request).map &#123; d <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">try</span> <span class="type">JSON</span>(data: d)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">image</span>(<span class="params">request</span>: <span class="type">URLRequest</span>) -&gt; <span class="type">Observable</span>&lt;<span class="type">UIImage</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> data(request: request).map &#123; d <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">return</span> <span class="type">UIImage</span>(data: d) <span class="operator">??</span> <span class="type">UIImage</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰è¿ç®—ç¬¦"><a href="#å¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰è¿ç®—ç¬¦" class="headerlink" title="å¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰è¿ç®—ç¬¦"></a>å¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰è¿ç®—ç¬¦</h3><p>è¿™é‡Œæˆ‘ä»¬æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨è¿ç®—ç¬¦è¿›è¡Œç¼“å­˜ç½‘ç»œè¯·æ±‚ç»“æœï¼ˆHTTPURLResponseã€Dataï¼‰çš„åºåˆ—ï¼Œç®€å•èµ·è§ä½¿ç”¨å­—å…¸ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fileprivate</span> <span class="keyword">var</span> internalCache <span class="operator">=</span> [<span class="type">String</span>: <span class="type">Data</span>]()</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">ObservableType</span> <span class="title class_">where</span> <span class="title class_">E</span> == (<span class="title class_">HTTPURLResponse</span>, <span class="title class_">Data</span>) &#123;</span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">cache</span>() -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.do(onNext: &#123; (response, data) <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">let</span> url <span class="operator">=</span> response.url<span class="operator">?</span>.absoluteString, <span class="number">200</span> <span class="operator">..&lt;</span> <span class="number">300</span> <span class="operator">~=</span> response.statusCode &#123;</span><br><span class="line">        internalCache[url] <span class="operator">=</span> data</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¦‚ä½•ä½¿ç”¨å°è£…çš„æ‹“å±•"><a href="#å¦‚ä½•ä½¿ç”¨å°è£…çš„æ‹“å±•" class="headerlink" title="å¦‚ä½•ä½¿ç”¨å°è£…çš„æ‹“å±•"></a>å¦‚ä½•ä½¿ç”¨å°è£…çš„æ‹“å±•</h3><p>åœ¨cellä¸­æ›´å…·ç»™å®šurlä¸‹è½½gifå¹¶æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">downloadAndDisplay</span>(<span class="params">gif</span> <span class="params">stringUrl</span>: <span class="type">String</span>) &#123;</span><br><span class="line">  <span class="keyword">guard</span> <span class="keyword">let</span> url <span class="operator">=</span> <span class="type">URL</span>(string: stringUrl) <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">  <span class="keyword">let</span> request <span class="operator">=</span> <span class="type">URLRequest</span>(url: url)</span><br><span class="line">  activityIndicator.startAnimating()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> s <span class="operator">=</span> <span class="type">URLSession</span>.shared.rx.data(request: request)</span><br><span class="line">    .observeOn(<span class="type">MainScheduler</span>.instance)</span><br><span class="line">    .subscribe(onNext: &#123; imageData <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">self</span>.gifImageView.animate(withGIFData: imageData)</span><br><span class="line">      <span class="keyword">self</span>.activityIndicator.stopAnimating()</span><br><span class="line">    &#125;)</span><br><span class="line">  disposable.setDisposable(s)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æµ‹è¯•å°è£…çš„æ‹“å±•"><a href="#æµ‹è¯•å°è£…çš„æ‹“å±•" class="headerlink" title="æµ‹è¯•å°è£…çš„æ‹“å±•"></a>æµ‹è¯•å°è£…çš„æ‹“å±•</h3><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨RxNimbleæ¥è¾…åŠ©æˆ‘ä»¬ç¼–å†™æµ‹è¯•ã€‚RxNimble ä½¿æµ‹è¯•æ›´å®¹æ˜“ç¼–å†™, å¹¶æœ‰åŠ©äºä»£ç æ›´ç®€æ˜ã€‚</p>
<p>RxBlockingç‰ˆæœ¬ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result <span class="operator">=</span> <span class="keyword">try!</span> observable.toBlocking().first()</span><br><span class="line">expect(result) <span class="operator">==</span> <span class="number">42</span></span><br></pre></td></tr></table></figure>

<p>RxNimbleç‰ˆæœ¬ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">expect(observable).first <span class="operator">==</span> <span class="number">42</span></span><br></pre></td></tr></table></figure>

<p>å®Œæ•´æµ‹è¯•ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> XCTest</span><br><span class="line"><span class="keyword">import</span> RxSwift</span><br><span class="line"><span class="keyword">import</span> RxBlocking</span><br><span class="line"><span class="keyword">import</span> Nimble</span><br><span class="line"><span class="keyword">import</span> RxNimble</span><br><span class="line"><span class="keyword">import</span> OHHTTPStubs</span><br><span class="line"><span class="keyword">import</span> SwiftyJSON</span><br><span class="line"></span><br><span class="line"><span class="keyword">@testable</span> <span class="keyword">import</span> iGif</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">iGifTests</span>: <span class="title class_">XCTestCase</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">let</span> obj <span class="operator">=</span> [<span class="string">&quot;array&quot;</span>:[<span class="string">&quot;foo&quot;</span>,<span class="string">&quot;bar&quot;</span>], <span class="string">&quot;foo&quot;</span>:<span class="string">&quot;bar&quot;</span>] <span class="keyword">as</span> [<span class="type">String</span> : <span class="keyword">Any</span>]</span><br><span class="line">  <span class="keyword">let</span> request <span class="operator">=</span> <span class="type">URLRequest</span>(url: <span class="type">URL</span>(string: <span class="string">&quot;http://raywenderlich.com&quot;</span>)<span class="operator">!</span>)</span><br><span class="line">  <span class="keyword">let</span> errorRequest <span class="operator">=</span> <span class="type">URLRequest</span>(url: <span class="type">URL</span>(string: <span class="string">&quot;http://rw.com&quot;</span>)<span class="operator">!</span>)</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">setUp</span>() &#123;</span><br><span class="line">    <span class="keyword">super</span>.setUp()</span><br><span class="line">    <span class="comment">// Put setup code here. This method is called before the invocation of each test method in the class.</span></span><br><span class="line">    stub(condition: isHost(<span class="string">&quot;raywenderlich.com&quot;</span>)) &#123; <span class="keyword">_</span> <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">return</span> <span class="type">OHHTTPStubsResponse</span>(jsonObject: <span class="keyword">self</span>.obj, statusCode: <span class="number">200</span>, headers: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    stub(condition: isHost(<span class="string">&quot;rw.com&quot;</span>)) &#123; <span class="keyword">_</span> <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">return</span> <span class="type">OHHTTPStubsResponse</span>(error: <span class="type">RxURLSessionError</span>.unknown)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">tearDown</span>() &#123;</span><br><span class="line">    <span class="comment">// Put teardown code here. This method is called after the invocation of each test method in the class.</span></span><br><span class="line">    <span class="keyword">super</span>.tearDown()</span><br><span class="line">    <span class="type">OHHTTPStubs</span>.removeAllStubs()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">testData</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> observable <span class="operator">=</span> <span class="type">URLSession</span>.shared.rx.data(request: <span class="keyword">self</span>.request)</span><br><span class="line">    expect(observable.toBlocking().firstOrNil()).toNot(beNil())</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">testString</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> observable <span class="operator">=</span> <span class="type">URLSession</span>.shared.rx.string(request: <span class="keyword">self</span>.request)</span><br><span class="line">    <span class="keyword">let</span> string <span class="operator">=</span> <span class="string">&quot;&#123;<span class="subst">\&quot;</span>array<span class="subst">\&quot;</span>:[<span class="subst">\&quot;</span>foo<span class="subst">\&quot;</span>,<span class="subst">\&quot;</span>bar<span class="subst">\&quot;</span>],<span class="subst">\&quot;</span>foo<span class="subst">\&quot;</span>:<span class="subst">\&quot;</span>bar<span class="subst">\&quot;</span>&#125;&quot;</span></span><br><span class="line">    expect(observable.toBlocking().firstOrNil()) <span class="operator">==</span> string</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">testJSON</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> observable <span class="operator">=</span> <span class="type">URLSession</span>.shared.rx.json(request: <span class="keyword">self</span>.request)</span><br><span class="line">    <span class="keyword">let</span> string <span class="operator">=</span> <span class="string">&quot;&#123;<span class="subst">\&quot;</span>array<span class="subst">\&quot;</span>:[<span class="subst">\&quot;</span>foo<span class="subst">\&quot;</span>,<span class="subst">\&quot;</span>bar<span class="subst">\&quot;</span>],<span class="subst">\&quot;</span>foo<span class="subst">\&quot;</span>:<span class="subst">\&quot;</span>bar<span class="subst">\&quot;</span>&#125;&quot;</span></span><br><span class="line">    <span class="keyword">let</span> json <span class="operator">=</span> <span class="keyword">try?</span> <span class="type">JSON</span>(data: string.data(using: .utf8)<span class="operator">!</span>)</span><br><span class="line">    expect(observable.toBlocking().firstOrNil()) <span class="operator">==</span> json</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">testError</span>() &#123;</span><br><span class="line">    <span class="keyword">var</span> erroredCorrectly <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">    <span class="keyword">let</span> observable <span class="operator">=</span> <span class="type">URLSession</span>.shared.rx.json(request: <span class="keyword">self</span>.errorRequest)</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> <span class="keyword">_</span> <span class="operator">=</span> <span class="keyword">try</span> observable.toBlocking().first()</span><br><span class="line">      <span class="built_in">assertionFailure</span>()</span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="type">RxURLSessionError</span>.unknown) &#123;</span><br><span class="line">      erroredCorrectly <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">      <span class="built_in">assertionFailure</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    expect(erroredCorrectly) <span class="operator">==</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">BlockingObservable</span> &#123;</span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">firstOrNil</span>() -&gt; <span class="type">E</span>? &#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">try</span> first()</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¸¸ç”¨å°è£…"><a href="#å¸¸ç”¨å°è£…" class="headerlink" title="å¸¸ç”¨å°è£…"></a>å¸¸ç”¨å°è£…</h3><p>RxSwiftç¤¾åŒºéå¸¸æ´»è·ƒï¼Œå¹¶ä¸”å·²ç»æœ‰å¾ˆå¤šæ‰©å±•å’Œå°è£…ã€‚ ä¸€äº›åŸºäºAppleç»„ä»¶ï¼Œè€Œå¦ä¸€äº›åˆ™åŸºäºè®¸å¤šiOSå’ŒmacOSé¡¹ç›®ä¸­å¹¿æ³›ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“ã€‚<br>ä½ å¯ä»¥åœ¨ <a target="_blank" rel="noopener" href="http://community.rxswift.org/">http://community.rxswift.org</a> æ‰¾åˆ°æœ€æ–°çš„å°è£…åˆ—è¡¨ã€‚</p>
<p>ä¸‹é¢å‡ ä¸ªå¸¸ç”¨çš„å°è£…ï¼š</p>
<ul>
<li>RxDataSources</li>
<li>RxAlamofire</li>
<li>RxBluetoothKit</li>
</ul>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>å…³äºä½•æ—¶éœ€è¦æŠ½è±¡ï¼Œæ²¡æœ‰çœŸæ­£æ˜ç¡®çš„è§„åˆ™ï¼Œä½†å»ºè®®å¦‚æœæ¡†æ¶æ»¡è¶³ä»¥ä¸‹ä¸€ä¸ªæˆ–å¤šä¸ªæ¡ä»¶ï¼Œåˆ™åº”ç”¨æ­¤ç­–ç•¥ï¼š</p>
<ul>
<li>ä½¿ç”¨å¸¦æœ‰å®Œæˆå’Œå¤±è´¥ä¿¡æ¯çš„å›è°ƒ</li>
<li>ä½¿ç”¨å¤§é‡å§”æ‰˜å¼‚æ­¥è¿”å›ä¿¡æ¯</li>
<li>éœ€è¦ä¸åº”ç”¨ç¨‹åºçš„å…¶ä»–RxSwiftéƒ¨åˆ†è¿›è¡Œäº’æ“ä½œ</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/08/01/RxSwift-%E2%85%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/08/01/RxSwift-%E2%85%A2/" class="post-title-link" itemprop="url">RxSwift â…¢ï¼šiOS åº”ç”¨ç¨‹åºä¸ RxCocoa</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2018-08-01 22:01:54" itemprop="dateCreated datePublished" datetime="2018-08-01T22:01:54+08:00">2018-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>ç”±äºRxæ˜¯ä¸€ä¸ªå¤šå¹³å°æ¡†æ¶ï¼Œå› æ­¤å®ƒä¸ä¼šå¯¹æ‚¨çš„Rxé©±åŠ¨çš„åº”ç”¨ç¨‹åºè¿è¡Œçš„è®¾å¤‡åšå‡ºä»»ä½•å‡è®¾ã€‚ RxSwiftä¸¥æ ¼éµå¾ªRxPythonï¼ŒRxRubyï¼ŒRxJSå’Œæ‰€æœ‰å…¶ä»–å¹³å°æ‰€éµå¾ªçš„é€šç”¨APIè®¾è®¡ï¼Œå› æ­¤å®ƒä¸åŒ…å«ä»»ä½•ç‰¹å®šåŠŸèƒ½æˆ–ä¸UIKitæˆ–Cocoaçš„é›†æˆï¼Œä»¥å¸®åŠ©æ‚¨å¼€å‘iOSæˆ–macOSã€‚</p>
<p>RxCocoaæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åº“ï¼ˆå°½ç®¡å®ƒä¸RxSwiftæ†ç»‘åœ¨ä¸€èµ·ï¼‰ï¼Œå®ƒå…è®¸æ‚¨ä½¿ç”¨è®¸å¤šé¢„æ„å»ºçš„åŠŸèƒ½æ¥æ›´å¥½åœ°ä¸UIKitå’ŒCocoaé›†æˆã€‚</p>
<p>RxCocoaå°†ä¸ºæ‚¨æä¾›å¼€ç®±å³ç”¨çš„ç±»æ¥è¿›è¡Œååº”å¼ç½‘ç»œï¼Œå¯¹ç”¨æˆ·äº¤äº’ä½œå‡ºååº”ï¼Œå°†æ•°æ®æ¨¡å‹ç»‘å®šåˆ°UIæ§ä»¶ç­‰ç­‰ã€‚</p>
<h2 id="ç¬¬åäºŒç« ï¼šå¼€å§‹å­¦ä¹ -RxCocoa"><a href="#ç¬¬åäºŒç« ï¼šå¼€å§‹å­¦ä¹ -RxCocoa" class="headerlink" title="ç¬¬åäºŒç« ï¼šå¼€å§‹å­¦ä¹  RxCocoa"></a>ç¬¬åäºŒç« ï¼šå¼€å§‹å­¦ä¹  RxCocoa</h2><p>æ›´æ–°å¤©æ°”ä¿¡æ¯ç•Œé¢ï¼Œæ ¹æ®APIè·å–çš„æ•°æ®ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ApiController</span>.shared.currentWeather(city: <span class="string">&quot;RxSwift&quot;</span>)</span><br><span class="line">      .observeOn(<span class="type">MainScheduler</span>.instance)</span><br><span class="line">      .subscribe(onNext: &#123; data <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">self</span>.tempLabel.text <span class="operator">=</span> <span class="string">&quot;<span class="subst">\(data.temperature)</span>Â° C&quot;</span></span><br><span class="line">        <span class="keyword">self</span>.iconLabel.text <span class="operator">=</span> data.icon</span><br><span class="line">        <span class="keyword">self</span>.humidityLabel.text <span class="operator">=</span> <span class="string">&quot;<span class="subst">\(data.humidity)</span>%&quot;</span></span><br><span class="line">        <span class="keyword">self</span>.cityNameLabel.text <span class="operator">=</span> data.cityName</span><br><span class="line">      &#125;)</span><br><span class="line">      .disposed(by:bag)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> search <span class="operator">=</span> searchCityName.rx.controlEvent(.editingDidEndOnExit).asObservable()</span><br><span class="line">      .map &#123; <span class="keyword">self</span>.searchCityName.text &#125;</span><br><span class="line">      .filter &#123; (<span class="variable">$0</span> <span class="operator">??</span> <span class="string">&quot;&quot;</span>).characters.count <span class="operator">&gt;</span> <span class="number">0</span> &#125;</span><br><span class="line">      .flatMapLatest &#123; text <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">return</span> <span class="type">ApiController</span>.shared.currentWeather(city: text <span class="operator">??</span> <span class="string">&quot;Error&quot;</span>)</span><br><span class="line">          .catchErrorJustReturn(<span class="type">ApiController</span>.<span class="type">Weather</span>.empty)</span><br><span class="line">      &#125;</span><br><span class="line">      .asDriver(onErrorJustReturn: <span class="type">ApiController</span>.<span class="type">Weather</span>.empty)</span><br><span class="line"></span><br><span class="line">    search.map &#123; <span class="string">&quot;<span class="subst">\(<span class="variable">$0</span>.temperature)</span>Â° C&quot;</span> &#125;</span><br><span class="line">      .drive(tempLabel.rx.text)</span><br><span class="line">      .disposed(by:bag)</span><br><span class="line"></span><br><span class="line">    search.map &#123; <span class="variable">$0</span>.icon &#125;</span><br><span class="line">      .drive(iconLabel.rx.text)</span><br><span class="line">      .disposed(by:bag)</span><br><span class="line"></span><br><span class="line">    search.map &#123; <span class="string">&quot;<span class="subst">\(<span class="variable">$0</span>.humidity)</span>%&quot;</span> &#125;</span><br><span class="line">      .drive(humidityLabel.rx.text)</span><br><span class="line">      .disposed(by:bag)</span><br><span class="line"></span><br><span class="line">    search.map &#123; <span class="variable">$0</span>.cityName &#125;</span><br><span class="line">      .drive(cityNameLabel.rx.text)</span><br><span class="line">      .disposed(by:bag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬åä¸‰ç« ï¼šRxCocoa-ä¸­çº§"><a href="#ç¬¬åä¸‰ç« ï¼šRxCocoa-ä¸­çº§" class="headerlink" title="ç¬¬åä¸‰ç« ï¼šRxCocoa ä¸­çº§"></a>ç¬¬åä¸‰ç« ï¼šRxCocoa ä¸­çº§</h2><p>æ·»åŠ æœç´¢æ¡†æ”¯æŒ</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidLoad</span>() &#123;</span><br><span class="line">  <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">  style()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> searchInput <span class="operator">=</span> searchCityName.rx.controlEvent(.editingDidEndOnExit).asObservable()</span><br><span class="line">    .map &#123; <span class="keyword">self</span>.searchCityName.text &#125;</span><br><span class="line">    .filter &#123; (<span class="variable">$0</span> <span class="operator">??</span> <span class="string">&quot;&quot;</span>).count <span class="operator">&gt;</span> <span class="number">0</span> &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> textSearch <span class="operator">=</span> searchInput.flatMap &#123; text <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> <span class="type">ApiController</span>.shared.currentWeather(city: text <span class="operator">??</span> <span class="string">&quot;Error&quot;</span>)</span><br><span class="line">      .catchErrorJustReturn(<span class="type">ApiController</span>.<span class="type">Weather</span>.dummy)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> mapInput <span class="operator">=</span> mapView.rx.regionDidChangeAnimated</span><br><span class="line">    .skip(<span class="number">1</span>)</span><br><span class="line">    .map &#123; <span class="keyword">_</span> <span class="keyword">in</span> <span class="keyword">self</span>.mapView.centerCoordinate &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> mapSearch <span class="operator">=</span> mapInput.flatMap &#123; coordinate <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> <span class="type">ApiController</span>.shared.currentWeather(lat: coordinate.latitude, lon: coordinate.longitude)</span><br><span class="line">      .catchErrorJustReturn(<span class="type">ApiController</span>.<span class="type">Weather</span>.dummy)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> currentLocation <span class="operator">=</span> locationManager.rx.didUpdateLocations</span><br><span class="line">    .map &#123; locations <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">return</span> locations[<span class="number">0</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    .filter &#123; location <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">return</span> location.horizontalAccuracy <span class="operator">&lt;</span> kCLLocationAccuracyHundredMeters</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> geoInput <span class="operator">=</span> geoLocationButton.rx.tap.asObservable()</span><br><span class="line">    .do(onNext: &#123;</span><br><span class="line">      <span class="keyword">self</span>.locationManager.requestWhenInUseAuthorization()</span><br><span class="line">      <span class="keyword">self</span>.locationManager.startUpdatingLocation()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> geoLocation <span class="operator">=</span> geoInput.flatMap &#123;</span><br><span class="line">    <span class="keyword">return</span> currentLocation.take(<span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> geoSearch <span class="operator">=</span> geoLocation.flatMap &#123; location <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> <span class="type">ApiController</span>.shared.currentWeather(lat: location.coordinate.latitude, lon: location.coordinate.longitude)</span><br><span class="line">      .catchErrorJustReturn(<span class="type">ApiController</span>.<span class="type">Weather</span>.dummy)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">let</span> search <span class="operator">=</span> <span class="type">Observable</span>.from([geoSearch, textSearch, mapSearch])</span><br><span class="line">  .merge()</span><br><span class="line">  .asDriver(onErrorJustReturn: <span class="type">ApiController</span>.<span class="type">Weather</span>.dummy)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> running <span class="operator">=</span> <span class="type">Observable</span>.from([searchInput.map &#123; <span class="keyword">_</span> <span class="keyword">in</span> <span class="literal">true</span> &#125;,</span><br><span class="line">                                 geoInput.map &#123; <span class="keyword">_</span> <span class="keyword">in</span> <span class="literal">true</span> &#125;,</span><br><span class="line">                                 mapInput.map &#123; <span class="keyword">_</span> <span class="keyword">in</span> <span class="literal">true</span>&#125;,</span><br><span class="line">                                 search.map &#123; <span class="keyword">_</span> <span class="keyword">in</span> <span class="literal">false</span> &#125;.asObservable()])</span><br><span class="line">  .merge()</span><br><span class="line">  .startWith(<span class="literal">true</span>)</span><br><span class="line">  .asDriver(onErrorJustReturn: <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">  running</span><br><span class="line">    .skip(<span class="number">1</span>)</span><br><span class="line">    .drive(activityIndicator.rx.isAnimating)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line">  </span><br><span class="line">  running</span><br><span class="line">    .drive(tempLabel.rx.isHidden)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line"></span><br><span class="line">  running</span><br><span class="line">    .drive(iconLabel.rx.isHidden)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line"></span><br><span class="line">  running</span><br><span class="line">    .drive(humidityLabel.rx.isHidden)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line"></span><br><span class="line">  running</span><br><span class="line">    .drive(cityNameLabel.rx.isHidden)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line">  </span><br><span class="line">  search.map &#123; <span class="string">&quot;<span class="subst">\(<span class="variable">$0</span>.temperature)</span>Â° C&quot;</span> &#125;</span><br><span class="line">    .drive(tempLabel.rx.text)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line"></span><br><span class="line">  search.map &#123; <span class="variable">$0</span>.icon &#125;</span><br><span class="line">    .drive(iconLabel.rx.text)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line"></span><br><span class="line">  search.map &#123; <span class="string">&quot;<span class="subst">\(<span class="variable">$0</span>.humidity)</span>%&quot;</span> &#125;</span><br><span class="line">    .drive(humidityLabel.rx.text)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line"></span><br><span class="line">  search.map &#123; <span class="variable">$0</span>.cityName &#125;</span><br><span class="line">    .drive(cityNameLabel.rx.text)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line"></span><br><span class="line">  locationManager.rx.didUpdateLocations</span><br><span class="line">    .subscribe(onNext: &#123; locations <span class="keyword">in</span></span><br><span class="line">      <span class="built_in">print</span>(locations)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line"></span><br><span class="line">  mapButton.rx.tap</span><br><span class="line">    .subscribe(onNext: &#123;</span><br><span class="line">      <span class="keyword">self</span>.mapView.isHidden <span class="operator">=</span> <span class="operator">!</span><span class="keyword">self</span>.mapView.isHidden</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line"></span><br><span class="line">  mapView.rx.setDelegate(<span class="keyword">self</span>)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line"></span><br><span class="line">  search.map &#123; [<span class="variable">$0</span>.overlay()] &#125;</span><br><span class="line">    .drive(mapView.rx.overlays)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/08/01/RxSwift-%E2%85%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/08/01/RxSwift-%E2%85%A1/" class="post-title-link" itemprop="url">RxSwift â…¡ï¼šæ“ä½œç¬¦å’Œæœ€ä½³å®è·µ</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2018-08-01 21:57:49" itemprop="dateCreated datePublished" datetime="2018-08-01T21:57:49+08:00">2018-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="ç¬¬äº”ç« ï¼šFiltering-Operator"><a href="#ç¬¬äº”ç« ï¼šFiltering-Operator" class="headerlink" title="ç¬¬äº”ç« ï¼šFiltering Operator"></a>ç¬¬äº”ç« ï¼šFiltering Operator</h2><h3 id="Ignoring"><a href="#Ignoring" class="headerlink" title="Ignoring"></a>Ignoring</h3><p>å¿½ç•¥æ‰€æœ‰eventï¼Œè½¬åŒ–ä¸ºä¸€ä¸ª Comletableã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">ignoreElements</span>() -&gt; <span class="type">Completable</span></span><br></pre></td></tr></table></figure>

<p>ä»…å‘å°„æŒ‡å®šindexçš„eventï¼Œå…¶ä½™éƒ½å¿½ç•¥ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">elementAt</span>(<span class="keyword">_</span> <span class="params">index</span>: <span class="type">Int</span>) -&gt; <span class="type">Observable</span>&lt;<span class="type">String</span>&gt;</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ç›´æ¥ä½¿ç”¨ <code>.filter</code> ï¼Œæ˜¯ RxSwift å¯¹ Swift æ ‡å‡†åº“ä¸­ <code>.filter</code> å¯¹åº”ç‰ˆæœ¬ã€‚å…·ä½“ç”¨æ³•å¾ˆç®€å•ï¼Œå’Œ Swift ç‰ˆä¸€æ ·ã€‚</p>
<h3 id="Skipping"><a href="#Skipping" class="headerlink" title="Skipping"></a>Skipping</h3><p><code>.skip(n) å³å¯è·³è¿‡å‰</code> n ä¸ª eventã€‚</p>
<p><code>.skipWhile</code> è·³è¿‡ç¬¦åˆæ¡ä»¶çš„ eventï¼Œä½†æ˜¯é‡åˆ°ä¸ç¬¦åˆæ¡ä»¶çš„ event åï¼Œä¸å†è·³è¿‡è¯¥ event ä»¥åŠåé¢çš„eventã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Observable</span>.of(<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">    .skipWhile &#123; integer <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;<span class="subst">\(integer)</span> skipWhile&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> integer <span class="operator">%</span> <span class="number">2</span> <span class="operator">==</span> <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    .subscribe(onNext: &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="variable">$0</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>

<p>Console è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">2 skipWhile</span><br><span class="line">2 skipWhile</span><br><span class="line">3 skipWhile</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td></tr></table></figure>

<p><code>.skipUntil(trigger)</code> æŒç»­è·³è¿‡ç›´åˆ°å¦ä¸€ä¸ªObservableç”Ÿæˆå…ƒç´ ã€‚</p>
<h3 id="Taking"><a href="#Taking" class="headerlink" title="Taking"></a>Taking</h3><p>Taking å’Œ Skipping æ˜¯ç›¸åçš„ã€‚</p>
<p><code>.take(n)</code> åªå‘å°„å‰ n ä¸ª event ã€‚</p>
<p><code>.takeWhile &#123; &#125;</code>  æ”¾å°„ç¬¦åˆæ¡ä»¶çš„eventï¼Œç›´åˆ°é‡åˆ°ä¸ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œä¸å†å‘å°„ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(<span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">6</span>)</span><br><span class="line">    .enumerated()</span><br><span class="line">    .takeWhile &#123; index, integer <span class="keyword">in</span></span><br><span class="line">        integer <span class="operator">%</span> <span class="number">2</span> <span class="operator">==</span> <span class="number">0</span> <span class="operator">&amp;&amp;</span> index <span class="operator">&lt;</span> <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">    .map &#123; <span class="variable">$0</span>.element &#125;</span><br><span class="line">    .subscribe(onNext: &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="variable">$0</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>

<p>Console è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">2</span><br><span class="line">4</span><br></pre></td></tr></table></figure>

<p><code>.takeUntil(trigger)</code>  ç±»ä¼¼çš„ï¼ŒæŒç»­å‘å°„ï¼Œç›´åˆ°å¦ä¸€ä¸ªObservableç”Ÿæˆå…ƒç´ ï¼Œåé¢ä¸å†å‘å°„ã€‚</p>
<h3 id="Distinct"><a href="#Distinct" class="headerlink" title="Distinct"></a>Distinct</h3><p><code>.distinctUntilChanged()</code> åªå‘å°„ä¸åŒäºå‰ä¸€ä¸ªçš„å…ƒç´ ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Observable</span>.of(<span class="string">&quot;A&quot;</span>, <span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;A&quot;</span>)</span><br><span class="line">    .distinctUntilChanged()</span><br><span class="line">    .subscribe(onNext: &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="variable">$0</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>

<p> Console è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A</span><br><span class="line">B</span><br><span class="line">A</span><br></pre></td></tr></table></figure>

<p><code>distinctUntilChanged(_:)</code> å¯¹é˜»æ­¢é‡å¤å‘å°„ä¸ç¬¦åˆ <code>Equatable</code> ç±»å‹çš„å…ƒç´ æ—¶å¾ˆæœ‰ç”¨ã€‚å› ä¸ºä½ å¯ä»¥æ§åˆ¶å‰åä¸¤ä¸ªå…ƒç´ æ˜¯å¦ç›¸ç­‰ã€‚</p>
<h2 id="ç¬¬å…­ç« ï¼šFiltering-å®è·µ"><a href="#ç¬¬å…­ç« ï¼šFiltering-å®è·µ" class="headerlink" title="ç¬¬å…­ç« ï¼šFiltering å®è·µ"></a>ç¬¬å…­ç« ï¼šFiltering å®è·µ</h2><p>ä¸Šä¸€ç« ä»‹ç»äº†RxSwiftä¸­å‡½æ•°å¼ç¼–ç¨‹çš„è§‚å¿µã€‚æ“ä½œç¬¦æ“ä½œä¸€ä¸ªObservableï¼Œè¾“å‡ºä¸€ä¸ªå¿ƒå¾—Observableã€‚å¾—ç›Šäºæ­¤ï¼Œæˆ‘ä¹ˆå¯ä»¥é“¾å¼è°ƒç”¨æ“ä½œç¬¦ã€‚</p>
<h3 id="æ”¹è¿›-Combinestagram-é¡¹ç›®"><a href="#æ”¹è¿›-Combinestagram-é¡¹ç›®" class="headerlink" title="æ”¹è¿› Combinestagram é¡¹ç›®"></a>æ”¹è¿› Combinestagram é¡¹ç›®</h3><p>å°±æ˜¯æŠŠä¸Šä¸€ç« çš„ filtering æ“ä½œç¬¦åº”ç”¨åœ¨é¡¹ç›®ä¸­ã€‚</p>
<h3 id="åŸºäºæ—¶é—´çš„æ“ä½œç¬¦"><a href="#åŸºäºæ—¶é—´çš„æ“ä½œç¬¦" class="headerlink" title="åŸºäºæ—¶é—´çš„æ“ä½œç¬¦"></a>åŸºäºæ—¶é—´çš„æ“ä½œç¬¦</h3><p>åŸºäºæ—¶é—´çš„æ“ä½œç¬¦ä½¿ç”¨ <strong>Scheduler</strong> ã€‚</p>
<p><code>take(_:scheduler:)</code> æ˜¯ä¸€ä¸ªè¿‡æ»¤æ“ä½œç¬¦ï¼Œå’Œ <code>take(1)</code> å’Œ <code>takeWhile(...)</code> ç±»ä¼¼ã€‚</p>
<p>åªä¼šå‘é€æŒ‡å®šæ—¶é—´æ®µå†…çš„å…ƒç´ ã€‚ä¸€æ—¦æ—¶é—´ç‚¹è¿‡äº†ï¼Œå°±ä¼šå‘é€ <code>.complete</code> äº‹ä»¶ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">errorMessage</span>() &#123;</span><br><span class="line">  alert(title: <span class="string">&quot;No access to Camera Roll&quot;</span>,</span><br><span class="line">        text: <span class="string">&quot;You can grant access to Combinestagram from the Settings app&quot;</span>)</span><br><span class="line">    .asObservable()</span><br><span class="line">    .take(<span class="number">5.0</span>, scheduler: <span class="type">MainScheduler</span>.instance)</span><br><span class="line">    .subscribe(onCompleted: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">self</span><span class="operator">?</span>.dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">      <span class="keyword">_</span> <span class="operator">=</span> <span class="keyword">self</span><span class="operator">?</span>.navigationController<span class="operator">?</span>.popViewController(animated: <span class="literal">true</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ä»¥ä¸‹æ˜¯ä¸€äº›åˆé€‚ä½¿ç”¨ <code>throttle</code> çš„åœºæ™¯ï¼š</p>
<ul>
<li>æœç´¢è¾“å…¥æ¡†çš„è®¢é˜…ï¼Œç„¶åå‘é€å½“å‰æ–‡æœ¬å†…å®¹çš„APIè¯·æ±‚ã€‚é€šè¿‡ <code>throttle</code> , ä½ å¯ä»¥è®©ç”¨æˆ·å¿«é€Ÿè¾“å…¥ï¼ŒåŒæ—¶ä»…åœ¨ç”¨æˆ·å®Œæˆè¾“å…¥æ—¶æ‰ä½ çš„å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚</li>
<li>å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ¥å±•ç¤ºä¸€ä¸ª modal view controller æ—¶ï¼Œä½ å¯ä»¥é˜»æ­¢åŒå‡»ä»¥åŠå±•ç¤ºä¸¤æ¬¡ modal view controllerã€‚é€šè¿‡ <code>throttle</code> ç‚¹å‡»äº‹ä»¶ï¼Œå¯ä»¥ç°å®åªæ¥æ”¶æœ€åä¸€æ¬¡ç‚¹å‡»äº‹ä»¶ï¼Œä¸è®ºç”¨æˆ·åŒå‡»æˆ–ä¸‰å‡»ã€‚</li>
<li>å¦‚æœä½ åªå…³å¿ƒç”¨æˆ·æ‹–åŠ¨æ‰‹åŠ¿æ—¶åœç•™çš„åœ°æ–¹ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>throttle</code> å½“å‰è§¦æ‘¸ä½ç½®ï¼Œåªè€ƒè™‘é‚£äº›åœæ­¢æ”¹å˜çš„ä½ç½®çš„å…ƒç´ ã€‚</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">images.asObservable()</span><br><span class="line">    .throttle(<span class="number">0.5</span>, scheduler: <span class="type">MainScheduler</span>.instance)</span><br><span class="line">    .subscribe(onNext: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] photos <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">guard</span> <span class="keyword">let</span> preview <span class="operator">=</span> <span class="keyword">self</span><span class="operator">?</span>.imagePreview <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">      preview.image <span class="operator">=</span> <span class="type">UIImage</span>.collage(images: photos,</span><br><span class="line">                                      size: preview.frame.size)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: bag)</span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬ä¸ƒç« ï¼šTransforming-Operator"><a href="#ç¬¬ä¸ƒç« ï¼šTransforming-Operator" class="headerlink" title="ç¬¬ä¸ƒç« ï¼šTransforming Operator"></a>ç¬¬ä¸ƒç« ï¼šTransforming Operator</h2><p>å½“ä½ å†³å®šå­¦ä¹  RxSwiftï¼Œæˆ–è®¸ä¼šè§‰å¾—å®ƒæ˜¯æ·±å¥¥çš„åº“ã€‚ä¹Ÿè®¸è®©ä½ æƒ³èµ·æ¥å½“åˆå­¦ä¹  iOS æˆ–è€… Swift çš„æ—¶å€™ã€‚ä½†å­¦ä¹ åˆ°ç¬¬ä¸ƒç« ä½ åº”è¯¥æ„è¯†åˆ° RxSwift å¹¶éé­”æ³•ã€‚å®ƒæ˜¯ç²¾å¿ƒæ„å»ºçš„APIï¼Œèƒ½è®©æå¤§åœ°æå‡æ•ˆç‡å’Œç®€åŒ–ä»£ç ã€‚å­¦åˆ°è¿™é‡Œä½ åº”è¯¥ä¼šæ„Ÿè§‰ä¸é”™ã€‚</p>
<p>æœ¬ç« ä½ å°†å­¦ä¹ è¿ç®—ç¬¦ä¸­æœ€é‡è¦çš„ä¸€ç±»ï¼štransforming è¿ç®—ç¬¦ã€‚ä½ å°†ä¸€ç›´ä½¿ç”¨ transformingï¼Œå‡†å¤‡Observableæ•°æ®ä»¥ä¾›è®¢é˜…è€…ä½¿ç”¨ã€‚éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼ŒRxSwift ä¸­çš„ transforming è¿ç®—ç¬¦ä¸ Swift æ ‡å‡†åº“ä¹‹é—´æœ‰ç›¸ä¼¼ä¹‹å¤„ ï¼Œå¦‚ <code>map (_:)</code> å’Œ <code>flatMap (_:)</code> ã€‚ </p>
<h3 id="Transforming-å…ƒç´ "><a href="#Transforming-å…ƒç´ " class="headerlink" title="Transforming å…ƒç´ "></a>Transforming å…ƒç´ </h3><p>å°†å¯è§‚å¯Ÿåˆ°çš„å•ä¸ªå…ƒç´ è½¬æ¢ä¸ºæ‰€æœ‰è¿™äº›å…ƒç´ çš„æ•°ç»„çš„ä¸€ç§ç®€ä¾¿æ–¹æ³•æ˜¯ä½¿ç”¨ <code>toArray</code>ã€‚<img src="https://gewill.org/assets/toArray.jpg" alt="toArray"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line"><span class="type">Observable</span>.of(<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>)</span><br><span class="line">  .toArray()</span><br><span class="line">  .subscribe(onNext: &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="variable">$0</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>

<p><code>map</code> å¯å°†æ¯ä¸ªå…ƒç´ è¿›è¡Œ transforming ã€‚<img src="https://gewill.org/assets/map.jpg" alt="map"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line"><span class="keyword">let</span> formatter <span class="operator">=</span> <span class="type">NumberFormatter</span>()</span><br><span class="line">formatter.numberStyle <span class="operator">=</span> .spellOut</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>&lt;<span class="type">NSNumber</span>&gt;.of(<span class="number">123</span>, <span class="number">4</span>, <span class="number">56</span>)</span><br><span class="line">    .map &#123;</span><br><span class="line">        formatter.string(from: <span class="variable">$0</span>) <span class="operator">??</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    .subscribe(onNext: &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="variable">$0</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line"><span class="type">Observable</span>.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">    .enumerated()</span><br><span class="line">    .map &#123; index, integer <span class="keyword">in</span></span><br><span class="line">        index <span class="operator">&gt;</span> <span class="number">2</span> <span class="operator">?</span> integer <span class="operator">*</span> <span class="number">2</span> : integer</span><br><span class="line">    &#125;</span><br><span class="line">    .subscribe(onNext: &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="variable">$0</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>



<h3 id="Transforming-å†…éƒ¨-Observable"><a href="#Transforming-å†…éƒ¨-Observable" class="headerlink" title="Transforming å†…éƒ¨ Observable"></a>Transforming å†…éƒ¨ Observable</h3><p>RxSwiftÂ åŒ…å« <code>flatMap</code> ç³»åˆ—ä¸­çš„å‡ ä¸ªè¿ç®—ç¬¦, å…è®¸ä½ æ·±å…¥Observable,å¤„ç†å…¶Observableç±»å‹çš„å±æ€§ã€‚<img src="https://gewill.org/assets/flatMap.jpg" alt="flatMap"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> score: <span class="type">BehaviorSubject</span>&lt;<span class="type">Int</span>&gt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> disposeBag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ryan <span class="operator">=</span> <span class="type">Student</span>(score: <span class="type">BehaviorSubject</span>(value: <span class="number">80</span>))</span><br><span class="line"><span class="keyword">let</span> charlotte <span class="operator">=</span> <span class="type">Student</span>(score: <span class="type">BehaviorSubject</span>(value: <span class="number">90</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> student <span class="operator">=</span> <span class="type">PublishSubject</span>&lt;<span class="type">Student</span>&gt;()</span><br><span class="line"></span><br><span class="line">student</span><br><span class="line">    .flatMap &#123;</span><br><span class="line">        <span class="variable">$0</span>.score</span><br><span class="line">    &#125;</span><br><span class="line">    .subscribe(onNext: &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="variable">$0</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">student.onNext(ryan)</span><br><span class="line">ryan.score.onNext(<span class="number">85</span>)</span><br><span class="line"></span><br><span class="line">student.onNext(charlotte)</span><br><span class="line">ryan.score.onNext(<span class="number">95</span>)</span><br><span class="line"></span><br><span class="line">charlotte.score.onNext(<span class="number">100</span>)</span><br></pre></td></tr></table></figure>

<p>What makes</p>
<p>flatMapLatest different is that it will automatically switch to the latest observable and</p>
<p>unsubscribe from the the previous one.</p>
<p><code>flatMapLatest</code> å’Œ <code>flatMap</code> ç•¥æœ‰ä¸åŒä¹‹å¤„æ˜¯å®ƒä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°æœ€åä¸€ä¸ª Observableï¼Œæ³¨é”€è®¢é˜…ä¹‹å‰çš„ Observableã€‚</p>
<p><img src="https://gewill.org/assets/flatMapLatest.jpg" alt="flatMapLatest"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ryan <span class="operator">=</span> <span class="type">Student</span>(score: <span class="type">BehaviorSubject</span>(value: <span class="number">80</span>))</span><br><span class="line"><span class="keyword">let</span> charlotte <span class="operator">=</span> <span class="type">Student</span>(score: <span class="type">BehaviorSubject</span>(value: <span class="number">90</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> student <span class="operator">=</span> <span class="type">PublishSubject</span>&lt;<span class="type">Student</span>&gt;()</span><br><span class="line"></span><br><span class="line">student</span><br><span class="line">    .flatMapLatest &#123;</span><br><span class="line">        <span class="variable">$0</span>.score</span><br><span class="line">    &#125;</span><br><span class="line">    .subscribe(onNext: &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="variable">$0</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">student.onNext(ryan)</span><br><span class="line"></span><br><span class="line">ryan.score.onNext(<span class="number">85</span>)</span><br><span class="line"></span><br><span class="line">student.onNext(charlotte)</span><br><span class="line"></span><br><span class="line">ryan.score.onNext(<span class="number">95</span>)</span><br><span class="line"></span><br><span class="line">charlotte.score.onNext(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Only one thing to point out here thatâ€™s different from the previous example of flatMap:</span></span><br><span class="line"><span class="comment">// Changing ryanâ€™s score here will have no effect. It will not be printed out. This is because flatMapLatest has already switched to the latest observable, for charlotte.</span></span><br></pre></td></tr></table></figure>



<h3 id="è§‚å¯Ÿäº‹ä»¶"><a href="#è§‚å¯Ÿäº‹ä»¶" class="headerlink" title="è§‚å¯Ÿäº‹ä»¶"></a>è§‚å¯Ÿäº‹ä»¶</h3><p>ä½¿ç”¨å…·ä½“åŒ–è¿ç®—ç¬¦ <code>materialize</code>, å¯ä»¥å°† Observable å‘å°„çš„æ¯ä¸ªäº‹ä»¶åŒ…è£…æˆ Observableã€‚æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ä¸­ <code>$0.score.materialize()</code>  å°† <code>BehaviorSubject&lt;Int&gt;</code> å°è£…ä¸º  <code>Observable&lt;Event&lt;Int&gt;&gt;</code> ã€‚è¿™æ ·çš„è¯ï¼Œæˆ‘çš„å°±å¯ä»¥è‡ªå·±å¤„ç† .error å’Œ .complete äº‹ä»¶ï¼Œè€Œä¸ç»ˆç»“è¯¥ Observable ã€‚</p>
<p>å¯¹åº”çš„æˆ‘ä»¬å†ä½¿ç”¨ <code>.dematerialize()</code>  è½¬å› <code>Observable&lt;Int&gt;</code> ï¼Œå³å¯æ­£å¸¸è®¢é˜…ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">MyError</span>: <span class="title class_">Error</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> anError</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> disposeBag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ryan <span class="operator">=</span> <span class="type">Student</span>(score: <span class="type">BehaviorSubject</span>(value: <span class="number">80</span>))</span><br><span class="line"><span class="keyword">let</span> charlotte <span class="operator">=</span> <span class="type">Student</span>(score: <span class="type">BehaviorSubject</span>(value: <span class="number">100</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> student: <span class="type">BehaviorSubject</span>&lt;<span class="type">Student</span>&gt; <span class="operator">=</span> <span class="type">BehaviorSubject</span>(value: ryan)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> studentScore: <span class="type">Observable</span>&lt;<span class="type">Event</span>&lt;<span class="type">Int</span>&gt;&gt; <span class="operator">=</span> student</span><br><span class="line">    .flatMapLatest &#123;</span><br><span class="line">        <span class="variable">$0</span>.score.materialize()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">studentScore</span><br><span class="line">    .filter &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="variable">$0</span>.error <span class="operator">==</span> <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="variable">$0</span>.error<span class="operator">!</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    .dematerialize()</span><br><span class="line">    .subscribe(onNext: &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;subscribe: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">ryan.score.onNext(<span class="number">85</span>)</span><br><span class="line">ryan.score.onError(<span class="type">MyError</span>.anError)</span><br><span class="line">ryan.score.onNext(<span class="number">90</span>)</span><br><span class="line">student.onNext(charlotte)</span><br></pre></td></tr></table></figure>

<p>Console è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">subscribe: 80</span><br><span class="line">subscribe: 85</span><br><span class="line">anError</span><br><span class="line">subscribe: 100</span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬å…«ç« ï¼šTransforming-å®è·µ"><a href="#ç¬¬å…«ç« ï¼šTransforming-å®è·µ" class="headerlink" title="ç¬¬å…«ç« ï¼šTransforming å®è·µ"></a>ç¬¬å…«ç« ï¼šTransforming å®è·µ</h2><p>åœ¨ä¸Šä¸€ç« ä¸­å­¦ä¹ äº† RxSwift çš„ä¸»è¦åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼šmap å’Œ flatMap ã€‚</p>
<h3 id="å¼€å§‹-GitFeed-é¡¹ç›®"><a href="#å¼€å§‹-GitFeed-é¡¹ç›®" class="headerlink" title="å¼€å§‹ GitFeed é¡¹ç›®"></a>å¼€å§‹ GitFeed é¡¹ç›®</h3><p>æœ¬ç« ä¸­è¦å¤„ç†çš„é¡¹ç›®å°†æ˜¾ç¤º GitHub ä»“åº“çš„åŠ¨æ€, å¦‚æ‰€æœ‰æœ€æ–°çš„ like, fork å’Œ comment.ã€‚</p>
<p>è¯¥é¡¹ç›®å°†æœ‰ä¸¤ä¸ªä¸åŒçš„æ•…äº‹æƒ…èŠ‚:</p>
<ul>
<li>ä¸»è¦çš„æƒ…èŠ‚æ˜¯è¦æ¥è§¦åˆ° GitHub çš„ JSON API, æ¥æ”¶ JSON å“åº”, å¹¶æœ€ç»ˆå°†å…¶è½¬æ¢ä¸ºå¯¹è±¡é›†åˆ.Â Â   </li>
<li>æ¬¡è¦å°†æå–çš„å¯¹è±¡ä¿å­˜åˆ°ç£ç›˜å¹¶åœ¨ â€œæ–°â€ æ´»åŠ¨åˆ—è¡¨ä¹‹å‰çš„è¡¨ä¸­æ˜¾ç¤ºå®ƒä»¬ã€‚ä»æœåŠ¡å™¨è·å–äº‹ä»¶ã€‚</li>
</ul>
<h3 id="ç½‘ç»œè·å–æ•°æ®"><a href="#ç½‘ç»œè·å–æ•°æ®" class="headerlink" title="ç½‘ç»œè·å–æ•°æ®"></a>ç½‘ç»œè·å–æ•°æ®</h3><p>æˆ‘ä»¬å°†ä¼šå°† URLSession æ·»åŠ ä¸ªå“åº”å¼æ‹“å±•ã€‚</p>
<p><img src="https://gewill.org/assets/CocoaAPIToRxAPI.jpeg" alt="CocoaAPIToRxAPI"></p>
<p>å…·ä½“å°±æ˜¯æŠŠç½‘ç»œAPIçš„è¯·æ±‚å’Œå“åº”åˆ†åˆ«å°è£…èµ·æ¥ï¼š</p>
<p>å…¶ä¸­ <code>share(replay:, scope:)</code> ï¼Œå¯ä»¥é¿å… <code>URLSession.rx.response(request:)</code> å› è¿‡æ—© .complete é€ æˆè®¢é˜…æ—¶é‡æ–°å‘é€ç½‘ç»œè¯·æ±‚ã€‚åŸç†å°±æ˜¯å°è£…å¤šä¸ª Observable çš„å…ƒç´ ä¸ºä¸€ä¸ªæ–°çš„ Observableï¼Œå¹¶æŒ‡å®šç¼“å†²åŒºæœ€å¤§å…ƒç´ æ•°é‡ï¼Œç”Ÿå‘½å‘¨æœŸã€‚å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">share</span>(<span class="params">replay</span>: <span class="type">Int</span> <span class="operator">=</span> <span class="keyword">default</span>, <span class="params">scope</span>: <span class="type">SubjectLifetimeScope</span> <span class="operator">=</span> <span class="keyword">default</span>)</span><br></pre></td></tr></table></figure>

<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">fetchEvents</span>(<span class="params">repo</span>: <span class="type">String</span>) &#123;</span><br><span class="line">    	<span class="comment">// 1. ä½¿ç”¨ map æ„é€ ä¸€ä¸ªè¯·æ±‚</span></span><br><span class="line">        <span class="keyword">let</span> response <span class="operator">=</span> <span class="type">Observable</span>.from([repo])</span><br><span class="line">            .map &#123; urlString -&gt; <span class="type">URL</span> <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">return</span> <span class="type">URL</span>(string: <span class="string">&quot;https://api.github.com/repos/<span class="subst">\(urlString)</span>/events&quot;</span>)<span class="operator">!</span></span><br><span class="line">            &#125;</span><br><span class="line">            .map &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] url -&gt; <span class="type">URLRequest</span> <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">var</span> request <span class="operator">=</span> <span class="type">URLRequest</span>(url: url)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">let</span> modifiedHeader <span class="operator">=</span> <span class="keyword">self</span><span class="operator">?</span>.lastModified.value &#123;</span><br><span class="line">                    request.addValue(modifiedHeader <span class="keyword">as</span> <span class="type">String</span>,</span><br><span class="line">                        forHTTPHeaderField: <span class="string">&quot;Last-Modified&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> request</span><br><span class="line">            &#125;</span><br><span class="line">            .flatMap &#123; request -&gt; <span class="type">Observable</span>&lt;(response: <span class="type">HTTPURLResponse</span>, data: <span class="type">Data</span>)&gt; <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">return</span> <span class="type">URLSession</span>.shared.rx.response(request: request)</span><br><span class="line">            &#125;</span><br><span class="line">            .share(replay: <span class="number">1</span>, scope: .whileConnected)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. è½¬æ¢å“åº”</span></span><br><span class="line">        response</span><br><span class="line">            .filter &#123; response, <span class="keyword">_</span> <span class="keyword">in</span></span><br><span class="line">                 <span class="comment">// æ£€æŸ¥å³è¾¹çš„å€¼æ˜¯å¦åœ¨å·¦è¾¹çš„ range å†…</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">200</span><span class="operator">..&lt;</span><span class="number">300</span> <span class="operator">~=</span> response.statusCode</span><br><span class="line">            &#125;</span><br><span class="line">            .map &#123; <span class="keyword">_</span>, data -&gt; [[<span class="type">String</span>: <span class="keyword">Any</span>]] <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">guard</span> <span class="keyword">let</span> jsonObject <span class="operator">=</span> <span class="keyword">try?</span> <span class="type">JSONSerialization</span>.jsonObject(with: data, options: []),</span><br><span class="line">                    <span class="keyword">let</span> result <span class="operator">=</span> jsonObject <span class="keyword">as?</span> [[<span class="type">String</span>: <span class="keyword">Any</span>]] <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> []</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> result</span><br><span class="line">            &#125;</span><br><span class="line">            .filter &#123; objects <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">return</span> objects.count <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line">            &#125;</span><br><span class="line">            .map &#123; objects <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">return</span> objects.flatMap(<span class="type">Event</span>.<span class="keyword">init</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            .subscribe(onNext: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] newEvents <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">self</span><span class="operator">?</span>.processEvents(newEvents)</span><br><span class="line">            &#125;)</span><br><span class="line">            .disposed(by: bag)</span><br><span class="line"></span><br><span class="line">        response</span><br><span class="line">            .filter &#123; response, <span class="keyword">_</span> <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">200</span><span class="operator">..&lt;</span><span class="number">400</span> <span class="operator">~=</span> response.statusCode</span><br><span class="line">            &#125;</span><br><span class="line">            .flatMap &#123; response, <span class="keyword">_</span> -&gt; <span class="type">Observable</span>&lt;<span class="type">NSString</span>&gt; <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">guard</span> <span class="keyword">let</span> value <span class="operator">=</span> response.allHeaderFields[<span class="string">&quot;Last-Modified&quot;</span>] <span class="keyword">as?</span> <span class="type">NSString</span> <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="type">Observable</span>.empty()</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="type">Observable</span>.just(value)</span><br><span class="line">            &#125;</span><br><span class="line">            .subscribe(onNext: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] modifiedHeader <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">guard</span> <span class="keyword">let</span> strongSelf <span class="operator">=</span> <span class="keyword">self</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">                strongSelf.lastModified.value <span class="operator">=</span> modifiedHeader</span><br><span class="line">                <span class="keyword">try?</span> modifiedHeader.write(to: strongSelf.modifiedFileURL, atomically: <span class="literal">true</span>,</span><br><span class="line">                    encoding: <span class="type">String</span>.<span class="type">Encoding</span>.utf8.rawValue)</span><br><span class="line">            &#125;)</span><br><span class="line">            .disposed(by: bag)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬ä¹ç« ï¼šåˆå¹¶Operator"><a href="#ç¬¬ä¹ç« ï¼šåˆå¹¶Operator" class="headerlink" title="ç¬¬ä¹ç« ï¼šåˆå¹¶Operator"></a>ç¬¬ä¹ç« ï¼šåˆå¹¶Operator</h2><p>åœ¨å‰é¢çš„ç« èŠ‚ä¸­, ä½ å­¦ä¹ äº†å¦‚ä½•åˆ›å»ºã€ï¬lter å’Œè½¬æ¢å¯è§‚å¯Ÿåºåˆ—ã€‚RxSwift ï¬ltering å’Œè½¬æ¢è¿ç®—ç¬¦çš„è¡Œä¸ºä¸ Swift çš„æ ‡å‡†é›†åˆè¿ç®—ç¬¦éå¸¸ç›¸ä¼¼ã€‚ä½ çœ‹åˆ°äº† RxSwift ä¸ flatMap çš„çœŸæ­£åŠ›é‡, å®ƒè®©ä½ ç”¨å¾ˆå°‘çš„ä»£ç æ‰§è¡Œå¾ˆå¤šä»»åŠ¡.Â   </p>
<p>è¿™ä¸€ç« å°†å‘ä½ å±•ç¤ºå‡ ç§ä¸åŒçš„ç»„åˆåºåˆ—çš„æ–¹æ³•, ä»¥åŠå¦‚ä½•åœ¨æ¯ä¸ªåºåˆ—ä¸­ç»„åˆæ•°æ®ã€‚ä½ å°†ä½¿ç”¨çš„ä¸€äº›æ“ä½œå‘˜ä¸ Swift é›†åˆæ“ä½œå‘˜éå¸¸ç›¸ä¼¼ã€‚å®ƒä»¬æœ‰åŠ©äºç»“åˆå¼‚æ­¥åºåˆ—ä¸­çš„å…ƒç´ , å°±åƒä½¿ç”¨ Swift æ•°ç»„ä¸€æ ·ã€‚</p>
<h3 id="å‰ç¼€å’Œä¸²è”"><a href="#å‰ç¼€å’Œä¸²è”" class="headerlink" title="å‰ç¼€å’Œä¸²è”"></a>å‰ç¼€å’Œä¸²è”</h3><p>ä» <code>startWith(_:)</code> è¿ç®—ç¬¦èµ‹å€¼ç»™å®šåˆå§‹å€¼çš„å¯è§‚å¯Ÿåºåˆ—ã€‚æ­¤å€¼å¿…é¡»ä¸å¯è§‚å¯Ÿå…ƒç´ çš„ç±»å‹ç›¸åŒã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers <span class="operator">=</span> <span class="type">Observable</span>.of(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"><span class="keyword">let</span> observable <span class="operator">=</span> numbers.startWith(<span class="number">1</span>) observable.subscribe(onNext: &#123; value <span class="keyword">in</span> <span class="built_in">print</span>(value) &#125;)</span><br></pre></td></tr></table></figure>

<p>ç±»ä¼¼åœ° <code>.concat(_:)</code> å¯ä»¥åˆå¹¶ä¸¤ä¸ªåºåˆ—ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> first <span class="operator">=</span> <span class="type">Observable</span>.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>) <span class="keyword">let</span> second <span class="operator">=</span> <span class="type">Observable</span>.of(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line"><span class="keyword">let</span> observable <span class="operator">=</span> <span class="type">Observable</span>.concat([first, second])</span><br><span class="line">observable.subscribe(onNext: &#123; value <span class="keyword">in</span> <span class="built_in">print</span>(value) &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="Merge"><a href="#Merge" class="headerlink" title="Merge"></a>Merge</h3><p>Merge ä¹Ÿæ˜¯åˆå¹¶ï¼Œä¸è¿‡ä¼šæŒ‰ç…§é¡ºåºå‘å°„äº‹ä»¶ã€‚</p>
<p><img src="https://gewill.org/assets/merge.jpg" alt="merge"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> left <span class="operator">=</span> <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> right <span class="operator">=</span> <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> source <span class="operator">=</span> <span class="type">Observable</span>.of(left.asObservable(), right.asObservable())</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> observable <span class="operator">=</span> source.merge()</span><br><span class="line"><span class="keyword">let</span> disposable <span class="operator">=</span> observable.subscribe(onNext: &#123; value <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> leftValues <span class="operator">=</span> [<span class="string">&quot;Berlin&quot;</span>, <span class="string">&quot;Munich&quot;</span>, <span class="string">&quot;Frankfurt&quot;</span>]</span><br><span class="line"><span class="keyword">var</span> rightValues <span class="operator">=</span> [<span class="string">&quot;Madrid&quot;</span>, <span class="string">&quot;Barcelona&quot;</span>, <span class="string">&quot;Valencia&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">repeat</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> arc4random_uniform(<span class="number">2</span>) <span class="operator">==</span> <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="operator">!</span>leftValues.isEmpty &#123;</span><br><span class="line">            left.onNext(<span class="string">&quot;Left:  &quot;</span> <span class="operator">+</span> leftValues.removeFirst())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> <span class="operator">!</span>rightValues.isEmpty &#123;</span><br><span class="line">        right.onNext(<span class="string">&quot;Right: &quot;</span> <span class="operator">+</span> rightValues.removeFirst())</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">while</span> <span class="operator">!</span>leftValues.isEmpty <span class="operator">||</span> <span class="operator">!</span>rightValues.isEmpty</span><br><span class="line"></span><br><span class="line">disposable.dispose()</span><br></pre></td></tr></table></figure>

<p>Console è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Right: Madrid</span><br><span class="line">Right: Barcelona</span><br><span class="line">Left:  Berlin</span><br><span class="line">Left:  Munich</span><br><span class="line">Left:  Frankfurt</span><br><span class="line">Right: Valencia</span><br></pre></td></tr></table></figure>

<h3 id="Combining-å…ƒç´ "><a href="#Combining-å…ƒç´ " class="headerlink" title="Combining å…ƒç´ "></a>Combining å…ƒç´ </h3><p>RxSwiftä¸­ä¸€ç»„åŸºæœ¬çš„è¿ç®—ç¬¦æ˜¯ <code>combineLatest</code> ã€‚ä»–ä»¬ç»„åˆæ¥è‡ªå‡ ä¸ªåºåˆ—çš„å€¼ï¼š</p>
<p><img src="https://gewill.org/assets/Combining%20elements.jpg" alt="Combining elements"></p>
<p>Every time one of the inner (combined) sequences emits a value, it calls a closure you provide. You receive the last value from each of the inner sequences. This has many concrete applications, such as observing several text ï¬elds at once and combining their value, watching the status of multiple sources, and so on.</p>
<p>æ¯å½“å†…éƒ¨ï¼ˆç»„åˆï¼‰åºåˆ—ä¸­çš„ä¸€ä¸ªå‘å‡ºä¸€ä¸ªå€¼æ—¶ï¼Œå®ƒä¼šè°ƒç”¨æ‚¨æä¾›çš„é—­åŒ…ã€‚ ä½ ä¼šæ”¶åˆ°æ¯ä¸ªå†…éƒ¨åºåˆ—çš„æœ€åä¸€ä¸ªå€¼ã€‚ è¿™é‡Œæœ‰å¾ˆå¤šå…·ä½“çš„åº”ç”¨åœºæ™¯ï¼Œä¾‹å¦‚ä¸€æ¬¡è§‚å¯Ÿå‡ ä¸ªæ–‡æœ¬å­—æ®µå¹¶ç»“åˆå®ƒä»¬çš„ä»·å€¼ï¼Œè§‚å¯Ÿå¤šä¸ªæ¥æºçš„çŠ¶æ€ç­‰ç­‰ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> left <span class="operator">=</span> <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> right <span class="operator">=</span> <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> observable <span class="operator">=</span> <span class="type">Observable</span>.combineLatest(left, right, resultSelector: &#123;</span><br><span class="line">    lastLeft, lastRight <span class="keyword">in</span></span><br><span class="line">    <span class="string">&quot;<span class="subst">\(lastLeft)</span> <span class="subst">\(lastRight)</span>&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> disposable <span class="operator">=</span> observable.subscribe(onNext: &#123; value <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&gt; Sending a value to Left&quot;</span>)</span><br><span class="line">left.onNext(<span class="string">&quot;Hello,&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&gt; Sending a value to Right&quot;</span>)</span><br><span class="line">right.onNext(<span class="string">&quot;world&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&gt; Sending another value to Right&quot;</span>)</span><br><span class="line">right.onNext(<span class="string">&quot;RxSwift&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&gt; Sending another value to Left&quot;</span>)</span><br><span class="line">left.onNext(<span class="string">&quot;Have a good day,&quot;</span>)</span><br><span class="line"></span><br><span class="line">disposable.dispose()</span><br></pre></td></tr></table></figure>

<p>Console è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; Sending a value to Left</span><br><span class="line">&gt; Sending a value to Right</span><br><span class="line">Hello, world</span><br><span class="line">&gt; Sending another value to Right</span><br><span class="line">Hello, RxSwift</span><br><span class="line">&gt; Sending another value to Left</span><br><span class="line">Have a good day, RxSwift</span><br></pre></td></tr></table></figure>

<p><code>zip</code> æ€»æ˜¯æŒ‰ç…§é¡ºåºä¸€å¯¹ä¸€å¯¹çš„ç»„åˆã€‚ç±»ä¼¼æŠŠä¸¤ä¸ªæ•°ç»„æŒ‰ç…§ç›¸åŒçš„ä¸‹æ ‡è¿›è¡Œç»„åˆã€‚</p>
<p> <img src="https://gewill.org/assets/zip.jpg" alt="zip"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Weather</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> cloudy</span><br><span class="line">    <span class="keyword">case</span> sunny</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> left: <span class="type">Observable</span>&lt;<span class="type">Weather</span>&gt; <span class="operator">=</span> <span class="type">Observable</span>.of(.sunny, .cloudy, .cloudy, .sunny)</span><br><span class="line"><span class="keyword">let</span> right <span class="operator">=</span> <span class="type">Observable</span>.of(<span class="string">&quot;Lisbon&quot;</span>, <span class="string">&quot;Copenhagen&quot;</span>, <span class="string">&quot;London&quot;</span>, <span class="string">&quot;Madrid&quot;</span>, <span class="string">&quot;Vienna&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> observable <span class="operator">=</span> <span class="type">Observable</span>.zip(left, right) &#123; weather, city <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;It&#x27;s <span class="subst">\(weather)</span> in <span class="subst">\(city)</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">observable.subscribe(onNext: &#123; value <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>Console è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">It&#x27;s sunny in Lisbon</span><br><span class="line">It&#x27;s cloudy in Copenhagen</span><br><span class="line">It&#x27;s cloudy in London</span><br><span class="line">It&#x27;s sunny in Madrid</span><br></pre></td></tr></table></figure>

<h3 id="Triggers"><a href="#Triggers" class="headerlink" title="Triggers"></a>Triggers</h3><p>åº”ç”¨ç¨‹åºæœ‰ä¸åŒçš„éœ€æ±‚ï¼Œå¿…é¡»ç®¡ç†å¤šä¸ªè¾“å…¥æºã€‚ ä½ ç»å¸¸éœ€è¦ç«‹å³æ¥å—æ¥è‡ªå¤šä¸ªè§‚å¯Ÿå¯¹è±¡çš„è¾“å…¥ã€‚ æœ‰äº›ä¼šç®€å•åœ°åœ¨ä»£ç ä¸­è§¦å‘è¡Œä¸ºï¼Œè€Œå…¶ä»–çš„å°†æä¾›æ•°æ®ã€‚ RxSwift å·²ç»è¦†ç›–äº†å¼ºå¤§çš„è¿ç®—ç¬¦è¿™ä¼šè®©ä½ çš„ç”Ÿæ´»æ›´è½»æ¾ã€‚ æˆ–è€…ï¼Œè‡³å°‘ä½ çš„ç¼–ç ç”Ÿæ´»ï¼</p>
<p>é¦–å…ˆçœ‹çœ‹ <code>withLatestFrom(_:)</code>ã€‚ ç»å¸¸è¢«åˆå­¦è€…å¿½ç•¥ï¼Œå®ƒåœ¨å¤„ç†ç”¨æˆ·ç•Œé¢ç­‰æ–¹é¢æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„é…å¥—å·¥å…·ã€‚<img src="https://gewill.org/assets/trigger.jpg" alt="trigger"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> button <span class="operator">=</span> <span class="type">PublishSubject</span>&lt;<span class="type">Void</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> textField <span class="operator">=</span> <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> observable <span class="operator">=</span> button.withLatestFrom(textField)</span><br><span class="line"><span class="keyword">_</span> <span class="operator">=</span> observable.subscribe(onNext: &#123; value <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">textField.onNext(<span class="string">&quot;Par&quot;</span>)</span><br><span class="line">textField.onNext(<span class="string">&quot;Pari&quot;</span>)</span><br><span class="line">textField.onNext(<span class="string">&quot;Paris&quot;</span>)</span><br><span class="line">button.onNext(())</span><br><span class="line">button.onNext(())</span><br></pre></td></tr></table></figure>

<p>Console è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Paris</span><br><span class="line">Paris</span><br></pre></td></tr></table></figure>

<p><code>sample(_:)</code> å’Œ å‡ ä¹åªæœ‰ä¸€ä¸ªå˜åŒ–ï¼šæ¯å½“è§¦å‘å™¨observableå‘å°„ä¸€ä¸ªå€¼æ—¶ï¼Œ<code>sample(_:)</code> ä»å…¶å®ƒçš„å¯è§‚å¯Ÿå€¼å‘å‡ºæœ€æ–°å€¼ï¼Œä½†åªæœ‰åœ¨è‡ªä¸Šä¸€æ¬¡å…ƒç´ åæ‰åˆ°è¾¾ã€‚ å¦‚æœæ²¡æœ‰æ–°çš„æ•°æ®åˆ°è¾¾ï¼Œ<code>sample(_:)</code> å°†ä¸ä¼šå‘å°„ä»»ä½•ä¸œè¥¿ã€‚<img src="https://gewill.org/assets/sample.jpg" alt="sample"></p>
<h3 id="Switches"><a href="#Switches" class="headerlink" title="Switches"></a>Switches</h3><p><img src="https://gewill.org/assets/Switches.jpg" alt="Switches"></p>
<p><code>amb(_:)</code> è¿ç®—ç¬¦è®¢é˜…å·¦ä¾§å’Œå³ä¾§çš„å¯è§‚å¯Ÿåºåˆ—ã€‚ å®ƒç­‰å¾…å…¶ä¸­ä»»ä½•ä¸€ä¸ªå‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç„¶åé€€è®¢å¦ä¸€ä¸ªåºåˆ—ã€‚ ä¹‹åï¼Œå®ƒåªä¼ é€’ç¬¬ä¸€ä¸ªæ´»åŠ¨å¯è§‚å¯Ÿå…ƒç´ ã€‚ å®ƒå¯ä»¥ä»æ¨¡æ£±ä¸¤å¯ä¸­é€‰å‡ºä¸€ä¸ªï¼šé¦–å…ˆï¼Œä½ ä¸çŸ¥é“ä½ æ„Ÿå…´è¶£çš„æ˜¯å“ªä¸€ä¸ªåºåˆ—ï¼Œç­‰å…¶ä¸­å…ˆå‘å°„ä¸€ä¸ªåºåˆ—å†åšå†³å®šã€‚</p>
<p>è¿™ä¸ªè¿ç®—ç¬¦ç»å¸¸è¢«å¿½è§†ã€‚ å®ƒæœ‰ä¸€äº›ç²¾é€‰çš„å®é™…åº”ç”¨åœºæ™¯ï¼Œå¦‚è¿æ¥åˆ°å†—ä½™æœåŠ¡å™¨ï¼Œå¹¶åšæŒä½¿ç”¨ç¬¬ä¸€ä¸ªå“åº”çš„æœåŠ¡å™¨ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> left <span class="operator">=</span> <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> right <span class="operator">=</span> <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> observable <span class="operator">=</span> left.amb(right)</span><br><span class="line"><span class="keyword">let</span> disposable <span class="operator">=</span> observable.subscribe(onNext: &#123; value <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">left.onNext(<span class="string">&quot;Lisbon&quot;</span>)</span><br><span class="line">right.onNext(<span class="string">&quot;Copenhagen&quot;</span>)</span><br><span class="line">left.onNext(<span class="string">&quot;London&quot;</span>)</span><br><span class="line">left.onNext(<span class="string">&quot;Madrid&quot;</span>)</span><br><span class="line">right.onNext(<span class="string">&quot;Vienna&quot;</span>)</span><br><span class="line"></span><br><span class="line">disposable.dispose()</span><br></pre></td></tr></table></figure>



<p>æ›´æµè¡Œçš„é€‰é¡¹æ˜¯ <code>switchLatest()</code> è¿ç®—ç¬¦ï¼š</p>
<p>å¯ä»¥è‡ªç”±åˆ‡æ¢åçˆ±é‚£ä¸ªå­åºåˆ—å‘å°„çš„å…ƒç´ ã€‚<img src="https://gewill.org/assets/switchLatest.jpg" alt="switchLatest"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> one <span class="operator">=</span> <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> two <span class="operator">=</span> <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> three <span class="operator">=</span> <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> source <span class="operator">=</span> <span class="type">PublishSubject</span>&lt;<span class="type">Observable</span>&lt;<span class="type">String</span>&gt;&gt;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> observable <span class="operator">=</span> source.switchLatest()</span><br><span class="line"><span class="keyword">let</span> disposable <span class="operator">=</span> observable.subscribe(onNext: &#123; value <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">source.onNext(one)</span><br><span class="line">one.onNext(<span class="string">&quot;Some text from sequence one&quot;</span>)</span><br><span class="line">two.onNext(<span class="string">&quot;Some text from sequence two&quot;</span>)</span><br><span class="line"></span><br><span class="line">source.onNext(two)</span><br><span class="line">two.onNext(<span class="string">&quot;More text from sequence two&quot;</span>)</span><br><span class="line">one.onNext(<span class="string">&quot;and also from sequence one&quot;</span>)</span><br><span class="line"></span><br><span class="line">source.onNext(three)</span><br><span class="line">two.onNext(<span class="string">&quot;Why don&#x27;t you seem me?&quot;</span>)</span><br><span class="line">one.onNext(<span class="string">&quot;I&#x27;m alone, help me&quot;</span>)</span><br><span class="line">three.onNext(<span class="string">&quot;Hey it&#x27;s three. I win.&quot;</span>)</span><br><span class="line"></span><br><span class="line">source.onNext(one)</span><br><span class="line">one.onNext(<span class="string">&quot;Nope. It&#x27;s me, one!&quot;</span>)</span><br><span class="line"></span><br><span class="line">disposable.dispose()</span><br></pre></td></tr></table></figure>

<p>Console è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Some text from sequence one</span><br><span class="line">More text from sequence two</span><br><span class="line">Hey it&#x27;s three. I win.</span><br><span class="line">Nope. It&#x27;s me, one!</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å½¢æˆå¯è§‚å¯Ÿåºåˆ—çš„å¿ƒæ™ºæ¨¡å‹å¯èƒ½å¾ˆå›°éš¾ã€‚ åˆ«æ‹…å¿ƒï¼Œ ä½ ä¼šä¹ æƒ¯å®ƒã€‚ <strong>ç»ƒä¹ æ˜¯é¡ºåºç†è§£åºåˆ—çš„å…³é”®</strong>ã€‚ éšç€æ‚¨çš„ä½“éªŒå¢é•¿ï¼Œè¯·éšæ—¶å®¡æŸ¥è¿™äº›ç¤ºä¾‹ï¼ ä½ å°†åœ¨ä¸‹ä¸€ç« ä¸­æ›´å¥½åœ°äº†è§£å¦‚ä½•ä½¿ç”¨å®ƒã€‚</p>
<h3 id="Combining-ä¸€ä¸ªåºåˆ—ä¸­å…ƒç´ "><a href="#Combining-ä¸€ä¸ªåºåˆ—ä¸­å…ƒç´ " class="headerlink" title="Combining ä¸€ä¸ªåºåˆ—ä¸­å…ƒç´ "></a>Combining ä¸€ä¸ªåºåˆ—ä¸­å…ƒç´ </h3><p>æ‰€æœ‰çš„å¨å¸ˆéƒ½çŸ¥é“ä½ å‡å°‘å¾—è¶Šå¤šï¼Œé…±æ±å°±è¶Šç¾å‘³ã€‚ è™½ç„¶ä¸æ˜¯é’ˆå¯¹å¨å¸ˆï¼Œä½† RxSwift æ‹¥æœ‰å°†é…±æ±å‡å°‘åˆ°æœ€æœ‰å‘³é“çš„ç»„åˆ†çš„å·¥å…·ã€‚</p>
<p><code>reduce(_:_:)</code> å’Œ Swift æ ‡å‡†åº“ä¸­ç±»ä¼¼ã€‚<img src="https://gewill.org/assets/reduce.jpg" alt="reduce"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> source <span class="operator">=</span> <span class="type">Observable</span>.of(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>)</span><br><span class="line"><span class="keyword">let</span> observable <span class="operator">=</span> source.reduce(<span class="number">0</span>, accumulator: &#123; summary, newValue <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> summary <span class="operator">+</span> newValue</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">observable.subscribe(onNext: &#123; value <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>Console è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">25</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>scan(_:accumulator:)</code> å’Œ<code>reduce(_:_:)</code> åªæœ‰ä¸€ä¸ªæœ€ç»ˆç»“æœä¸åŒï¼šæ¯æ¬¡å‘å°„äº‹ä»¶ï¼Œéƒ½ä¼šè®¡ç®—ç»“æœå¹¶å‘å°„ã€‚<img src="https://gewill.org/assets/scan.jpg" alt="scan"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> source <span class="operator">=</span> <span class="type">Observable</span>.of(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> observable <span class="operator">=</span> source.scan(<span class="number">0</span>, accumulator: <span class="operator">+</span>)</span><br><span class="line">observable.subscribe(onNext: &#123; value <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>Console è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">4</span><br><span class="line">9</span><br><span class="line">16</span><br><span class="line">25</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬åç« ï¼šåˆå¹¶Operatorå®è·µ"><a href="#ç¬¬åç« ï¼šåˆå¹¶Operatorå®è·µ" class="headerlink" title="ç¬¬åç« ï¼šåˆå¹¶Operatorå®è·µ"></a>ç¬¬åç« ï¼šåˆå¹¶Operatorå®è·µ</h2><p>åœ¨å‰ä¸€ç« ä¸­ï¼Œä½ å­¦ä¹ äº†å°†æ“ä½œç¬¦åˆå¹¶ï¼Œå¹¶é€šè¿‡å¯¹ä¸€äº›ç›¸å½“ä»¤äººå¤´è„‘çµæ´»çš„æ¦‚å¿µè¿›è¡Œè¶Šæ¥è¶Šè¯¦ç»†çš„ç»ƒä¹ ã€‚ ä¸€äº›è¿ç®—ç¬¦å¯èƒ½ä¼šè®©ä½ å¯¹è¿™äº›ååº”æ€§æ¦‚å¿µçš„çœŸå®åº”ç”¨æ„Ÿåˆ°ç–‘æƒ‘ã€‚<br>åœ¨â€œâ€¦â€¦å®è·µâ€ä¸€ç« ä¸­ï¼Œä½ å°†æœ‰æœºä¼šå°è¯•ä¸€äº›æœ€å¼ºå¤§çš„è¿ç®—ç¬¦ã€‚ ä½ å°†å­¦ä¼šè§£å†³ç±»ä¼¼äºä½ åœ¨è‡ªå·±çš„åº”ç”¨ç¨‹åºä¸­é‡åˆ°çš„é—®é¢˜ã€‚</p>
<h3 id="å‡†å¤‡ç½‘ç»œåç«¯æœåŠ¡"><a href="#å‡†å¤‡ç½‘ç»œåç«¯æœåŠ¡" class="headerlink" title="å‡†å¤‡ç½‘ç»œåç«¯æœåŠ¡"></a>å‡†å¤‡ç½‘ç»œåç«¯æœåŠ¡</h3><p>è¿™é‡Œä½¿ç”¨NASAçš„EONETæœåŠ¡ã€‚</p>
<p>æˆ‘ä»¬ç§°ä¹‹ä¸ºEONETæœåŠ¡ã€‚ å®ƒæŠ½è±¡è®¿é—®ç”±EONETæœåŠ¡å™¨å…¬å¼€çš„æ•°æ®ï¼Œå°†å®ƒä»¬ä½œä¸ºæœåŠ¡æä¾›ç»™ä½ çš„åº”ç”¨ç¨‹åºã€‚ ä½ ä¼šçœ‹åˆ°ï¼Œç»“åˆRxï¼Œè¿™ç§æ¨¡å¼å°†æ‰¾åˆ°è®¸å¤šåº”ç”¨ç¨‹åºã€‚ å®ƒå¯ä»¥è®©ä½ åœ¨åº”ç”¨ç¨‹åºå†…æ¸…æ™°åœ°åˆ†ç¦»æ•°æ®ç”Ÿäº§å’Œæ¶ˆè€—ã€‚ ä½ å¯ä»¥è½»æ¾æ›¿æ¢æˆ–æ¨¡æ‹Ÿç”Ÿäº§ç¯å¢ƒï¼Œè€Œä¸ä¼šå¯¹ç”¨æˆ·æ–¹é¢äº§ç”Ÿä»»ä½•å½±å“ã€‚</p>
<p>å…ˆå°è£…ä¸€ä¸ªé€šç”¨ç½‘ç»œè¯·æ±‚ï¼Œç„¶åæŠŠ categories å°è£…ä¸ºå•ä¾‹ï¼Œæ–¹ä¾¿æ‰€æœ‰è®¢é˜…è€…è®¢é˜…ã€‚</p>
<h3 id="Categories-view-controller"><a href="#Categories-view-controller" class="headerlink" title="Categories view controller"></a>Categories view controller</h3><p>categories view controller æ˜¾ç¤º categories åˆ—è¡¨ã€‚</p>
<h3 id="Adding-the-event-download-service"><a href="#Adding-the-event-download-service" class="headerlink" title="Adding the event download service"></a>Adding the event download service</h3><h3 id="Getting-events-for-categories"><a href="#Getting-events-for-categories" class="headerlink" title="Getting events for categories"></a>Getting events for categories</h3><h3 id="Events-view-controller"><a href="#Events-view-controller" class="headerlink" title="Events view controller"></a>Events view controller</h3><h3 id="Wiring-the-days-selector"><a href="#Wiring-the-days-selector" class="headerlink" title="Wiring the days selector"></a>Wiring the days selector</h3><h3 id="Splitting-event-downloads"><a href="#Splitting-event-downloads" class="headerlink" title="Splitting event downloads"></a>Splitting event downloads</h3><h2 id="ç¬¬åä¸€ç« ï¼šåŸºäºæ—¶é—´çš„Operator"><a href="#ç¬¬åä¸€ç« ï¼šåŸºäºæ—¶é—´çš„Operator" class="headerlink" title="ç¬¬åä¸€ç« ï¼šåŸºäºæ—¶é—´çš„Operator"></a>ç¬¬åä¸€ç« ï¼šåŸºäºæ—¶é—´çš„Operator</h2><p>æ—¶é—´å°±æ˜¯ä¸€åˆ‡ã€‚å“åº”å¼ç¼–ç¨‹èƒŒåçš„æ ¸å¿ƒæ€æƒ³æ˜¯åŸºäºæ—¶é—´å¼‚æ­¥æ•°æ®æµçš„æ¨¡å‹ã€‚åœ¨è¿™æ–¹é¢, RxSwift æä¾›äº†ä¸€ç³»åˆ—æ“ä½œ, ä½¿ä½ èƒ½å¤Ÿå¤„ç†æ—¶é—´å’Œåºåˆ—åœ¨ä¸€æ®µæ—¶é—´å†…çš„å“åº”å’Œè½¬æ¢æ–¹å¼ã€‚æ­£å¦‚ä½ å°†åœ¨æœ¬ç« ä¸­çœ‹åˆ°çš„, ç®¡ç†åºåˆ—çš„æ—¶é—´ç»´åº¦æ˜¯ç®€å•è€Œç›´æ¥çš„ã€‚</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/05/18/RxSwift-I/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/05/18/RxSwift-I/" class="post-title-link" itemprop="url">RxSwift Iï¼šå¼€å§‹å­¦ä¹  RxSwift</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2018-05-18 23:01:03" itemprop="dateCreated datePublished" datetime="2018-05-18T23:01:03+08:00">2018-05-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/RxSwift/" itemprop="url" rel="index"><span itemprop="name">RxSwift</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="ğŸ“’RxSwift-Iï¼šå¼€å§‹å­¦ä¹ -RxSwift"><a href="#ğŸ“’RxSwift-Iï¼šå¼€å§‹å­¦ä¹ -RxSwift" class="headerlink" title="ğŸ“’RxSwift Iï¼šå¼€å§‹å­¦ä¹  RxSwift"></a>ğŸ“’<strong>RxSwift</strong> Iï¼šå¼€å§‹å­¦ä¹  RxSwift</h1><p> <img src="https://gewill.org/assets/Rx_Logo_M.png" alt="Rx_Logo_M.png"></p>
<h2 id="ç¬¬ä¸€ç« ï¼šRxSwift-ä»‹ç»"><a href="#ç¬¬ä¸€ç« ï¼šRxSwift-ä»‹ç»" class="headerlink" title="ç¬¬ä¸€ç« ï¼šRxSwift ä»‹ç»"></a>ç¬¬ä¸€ç« ï¼šRxSwift ä»‹ç»</h2><p>RxSwiftæ˜¯ä¸€ä¸ªç»„åˆå¼‚æ­¥å’Œäº‹ä»¶é©±åŠ¨ç¼–ç¨‹çš„åº“ï¼Œé€šè¿‡ä½¿ç”¨å¯è§‚å¯Ÿåºåˆ—å’ŒåŠŸèƒ½æ ·å¼è¿ç®—ç¬¦æ¥ï¼Œä»è€Œå…è®¸é€šè¿‡è°ƒåº¦ç¨‹åºè¿›è¡Œå‚æ•°åŒ–æ‰§è¡Œã€‚</p>
<p>RxSwift åœ¨æœ¬è´¨ä¸Šç®€åŒ–äº†å¼€å‘å¼‚æ­¥ç¨‹åºï¼Œå…è®¸ä»£ç å¯¹æ–°æ•°æ®ä½œå‡ºååº”ï¼Œå¹¶ä»¥é¡ºåºå’Œå­¤ç«‹çš„æ–¹å¼å¤„ç†å®ƒã€‚</p>
<h3 id="ä»‹ç»å¼‚æ­¥ç¼–ç¨‹"><a href="#ä»‹ç»å¼‚æ­¥ç¼–ç¨‹" class="headerlink" title="ä»‹ç»å¼‚æ­¥ç¼–ç¨‹"></a>ä»‹ç»å¼‚æ­¥ç¼–ç¨‹</h3><p><img src="https://gewill.org/assets/51526546882_.pic.jpg" alt="51526546882_.pic.jpg"></p>
<p>ä½¿ç”¨ Cocoa å’Œ UIKit å¼‚æ­¥çš„APIçš„é—®é¢˜åœ¨äºï¼šå¤æ‚çš„å¼‚æ­¥ä»£ç å˜å¾—éå¸¸éš¾å†™ï¼Œéƒ¨åˆ†åŸå› æ˜¯è‹¹æœSDKæä¾›çš„APIç§ç±»ç¹å¤šã€‚å¦‚NotificationCenterã€Delegateã€GCDã€é—­åŒ…ã€Combineã€‚</p>
<p>å¼‚æ­¥ç¼–ç¨‹è¯æ±‡è¡¨ï¼š</p>
<ol>
<li>çŠ¶æ€ï¼ˆStateï¼‰ï¼Œå…·ä½“åœ°è¯´ï¼šå…±äº«å¯å˜çŠ¶æ€</li>
<li>å‘½ä»¤å¼ç¼–ç¨‹ï¼ˆImperative programmingï¼‰</li>
<li>å‰¯ä½œç”¨ï¼ˆSide effectsï¼‰</li>
<li>å£°æ˜å¼ç¼–ç¨‹ï¼ˆDeclarative codeï¼‰ï¼šå£°æ˜å¼ä»£ç è®©æ‚¨å¯ä»¥å®šä¹‰è¡Œä¸ºç‰‡æ®µã€‚åªè¦æœ‰ç›¸å…³äº‹ä»¶å‘ç”Ÿï¼ŒRxSwift å°±ä¼šè¿è¡Œè¿™äº›è¡Œä¸ºï¼Œå¹¶æä¾›ä¸€ä¸ªä¸å¯å˜çš„ã€å­¤ç«‹çš„æ•°æ®ç‰‡æ®µæ¥å¤„ç†ã€‚è¿™æ ·ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å¼‚æ­¥ä»£ç ï¼Œä½†åšå‡ºä¸ç®€å• for å¾ªç¯ç›¸åŒçš„å‡è®¾ï¼šæ‚¨æ­£åœ¨ä½¿ç”¨ä¸å¯å˜æ•°æ®å¹¶ä¸”å¯ä»¥ä»¥é¡ºåºã€ç¡®å®šçš„æ–¹å¼æ‰§è¡Œä»£ç ã€‚</li>
<li>å“åº”å¼ç³»ç»Ÿï¼ˆReactive systemsï¼‰</li>
</ol>
<p>å“åº”å¼ç³»ç»Ÿï¼ˆReactive systemsï¼‰æ˜¯ä¸€ä¸ªç›¸å½“æŠ½è±¡çš„æœ¯è¯­ï¼Œå®ƒæ¶µç›–äº†Webæˆ–iOSåº”ç”¨ç¨‹åºï¼Œå®ƒä»¬æ˜¾ç¤ºäº†å¤§å¤šæ•°æˆ–å…¨éƒ¨ä»¥ä¸‹ç‰¹æ€§ï¼š</p>
<ul>
<li>å“åº”å¼è®¾è®¡ï¼ˆResponsiveï¼‰ï¼šå§‹ç»ˆä¿æŒUIæ›´æ–°ï¼Œä»£è¡¨äº†æœ€æ–°çš„åº”ç”¨ç¨‹åºçŠ¶æ€ã€‚</li>
<li>èƒ½å¤åŸçš„ï¼ˆResilientï¼‰ï¼šæ¯ä¸ªè¡Œä¸ºéƒ½æ˜¯ç‹¬ç«‹å®šä¹‰çš„ï¼Œå¹¶æä¾›çµæ´»çš„é”™è¯¯æ¢å¤ã€‚</li>
<li>çµæ´»çš„ï¼ˆElasticï¼‰: è¯¥ä»£ç å¤„ç†ä¸åŒçš„å·¥ä½œè´Ÿè½½ï¼Œé€šå¸¸å®ç°è¯¸å¦‚æ‡’æƒ°é©±åŠ¨æ•°æ®æ”¶é›†ã€äº‹ä»¶èŠ‚æµå’Œèµ„æºå…±äº«ç­‰ç‰¹æ€§ã€‚</li>
<li>æ¶ˆæ¯é©±åŠ¨ï¼ˆMessage drivenï¼‰ï¼šç»„ä»¶ä½¿ç”¨åŸºäºæ¶ˆæ¯çš„é€šä¿¡æ¥æé«˜å¯é‡ç”¨æ€§å’Œéš”ç¦»æ€§ï¼Œè§£è€¦ç±»çš„ç”Ÿå‘½å‘¨æœŸå’Œå®ç°ã€‚</li>
</ul>
<h3 id="RxSwift-åŸºç¡€"><a href="#RxSwift-åŸºç¡€" class="headerlink" title="RxSwift åŸºç¡€"></a>RxSwift åŸºç¡€</h3><p><img src="https://gewill.org/assets/61526549641_.pic_hd.jpg" alt="61526549641_.pic_hd.jpg"></p>
<p>è¿™ä¸ªæ ‡å¿—æ˜¯ä¸€åªç”µé³—ã€‚(Rx é¡¹ç›®æ›¾ç»è¢«ç§°ä¸ºVoltaï¼‰</p>
<p>RxSwift æ˜¯å¾®è½¯å¼€æºçš„ ReactiveX çš„Swiftè¯­è¨€çš„å®ç°ã€‚</p>
<p><strong>RxSwift</strong> åœ¨ä¼ ç»Ÿçš„<strong>Cocoa</strong>ç¼–ç¨‹å’Œçº¯å‡½æ•°ç¼–ç¨‹ä¹‹é—´æ‰¾åˆ°äº†æœ€ä½³ä½ç½®ã€‚å®ƒå…è®¸æ‚¨å¯¹äº‹ä»¶ä½œå‡ºååº”, æ–¹æ³•æ˜¯ä½¿ç”¨ä¸å¯å˜çš„ä»£ç å®šä¹‰ä»¥ç¡®å®šæ€§çš„ã€å¯ç»„åˆçš„æ–¹å¼å¤„ç†å¼‚æ­¥è¾“å…¥éƒ¨åˆ†ã€‚</p>
<p>Rxä»£ç çš„ä¸‰ä¸ªç»„æˆéƒ¨åˆ†æ˜¯ <code>Observable</code>, <code>Operator</code>å’Œ <code>Scheduler</code>ã€‚</p>
<p><code>Observable&lt;Element&gt;</code>ç±»æä¾›äº†Rxä»£ç çš„åŸºç¡€ï¼šå¼‚æ­¥äº§ç”Ÿä¸€ç³»åˆ—äº‹ä»¶çš„èƒ½åŠ›ï¼Œå®ƒå¯ä»¥â€œæºå¸¦â€æ•°æ®çš„ä¸å¯å˜å¿«ç…§ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå…è®¸ç±»åœ¨ä¸€æ®µæ—¶é—´å†…è®¢é˜…å…¶ä»–ç±»å‘å‡ºçš„å€¼ã€‚</p>
<p><code>ObservableType</code> åè®® (<code>Observable</code>éœ€è¦éµå¾ªçš„) éå¸¸ç®€å•ã€‚<code>Observable</code>å¯èƒ½å‘å‡º (å¹¶ä¸”<code>Observer</code>èƒ½æ¥å—) ä»…ä¸‰ç±»å‹äº‹ä»¶:</p>
<p>- next ä¸‹ä¸€ä¸ªäº‹ä»¶: â€œæºå¸¦â€ æœ€æ–° (æˆ–  â€œä¸‹ä¸€ä¸ª â€œ) æ•°æ®å€¼çš„äº‹ä»¶ã€‚è¿™æ˜¯<code>Observer</code> â€œæ¥æ”¶â€ å€¼çš„æ–¹å¼ã€‚</p>
<p>- completed å·²å®Œæˆçš„äº‹ä»¶: æ­¤äº‹ä»¶ä»¥æˆåŠŸç»ˆæ­¢äº‹ä»¶åºåˆ—ã€‚è¿™æ„å‘³ç€<code>Observable</code>å®Œæˆå…¶ç”Ÿå‘½å‘¨æœŸæˆåŠŸ, ä¸ä¼šå‘å‡ºä»»ä½•å…¶ä»–äº‹ä»¶ã€‚</p>
<p>- error é”™è¯¯äº‹ä»¶: <code>Observable</code>ç»ˆæ­¢å¸¦æœ‰é”™è¯¯, ä¸ä¼šå‘å‡ºå…¶ä»–äº‹ä»¶.</p>
<p>ä¸¤ç§ä¸åŒçš„å¯è§‚æµ‹åºåˆ—: æœ‰é™å’Œæ— é™çš„ã€‚</p>
<p>ç”±äºå®ƒä»¬æ˜¯é«˜åº¦è§£è€¦å’Œå¯ç»„åˆçš„, æ‰€ä»¥è¿™äº›æ–¹æ³•é€šå¸¸ç§°ä¸º<code>Operator</code>ã€‚æ¯”å¦‚filterã€‚</p>
<p><code>Operator</code>ä¹Ÿæ˜¯é«˜åº¦å¯ç»„åˆçš„ï¼Œå®ƒä»¬æ€»æ˜¯æŠŠæ•°æ®ä½œä¸ºè¾“å…¥å¹¶è¾“å‡ºå®ƒä»¬çš„ç»“æœï¼Œæ‰€ä»¥ä½ å¯ä»¥ç”¨è®¸å¤šä¸åŒçš„æ–¹å¼è½»æ¾åœ°å°†å®ƒä»¬è¿æ¥èµ·æ¥ï¼Œå®ç°æ¯”å•ä¸ª<code>Operator</code>è‡ªå·±èƒ½åšçš„æ›´å¤šçš„äº‹æƒ…ã€‚</p>
<p> <code>Scheduler</code>æ˜¯<a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/DISPATCH">GCD</a>å’Œ<a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/foundation/operationqueue">OperationQueue</a>çš„Rxç­‰ä»·ç‰©ã€‚</p>
<p>RxSwiftå°†å……å½“ä½ çš„è®¢é˜…ï¼ˆåœ¨å·¦è¾¹ï¼‰å’Œ<code>Scheduler</code>ï¼ˆåœ¨å³è¾¹ï¼‰ä¹‹é—´çš„è°ƒåº¦å™¨ï¼Œå°†å·¥ä»¶å‘é€åˆ°æ­£ç¡®çš„ä¸Šä¸‹æ–‡ï¼Œå¹¶æ— ç¼åœ°å…è®¸å®ƒä»¬ä¸å½¼æ­¤çš„è¾“å‡ºä¸€èµ·å·¥ä½œã€‚</p>
<p><img src="https://gewill.org/assets/71526551674_.pic_hd.jpg" alt="71526551674_.pic_hd.jpg"></p>
<p>è¦è¯»å–æ­¤å…³ç³»å›¾, è¯·åœ¨ä¸åŒçš„è®¡åˆ’ç¨‹åºä¸­æŒ‰é¢„å®šçš„é¡ºåº (1ã€2ã€3ã€â€¦) æ¥æ‰§è¡Œå½©è‰²ä½œå“ã€‚ä¾‹å¦‚:</p>
<p>Â·è“è‰²ç½‘ç»œè®¢é˜…ä»¥åœ¨åŸºäºè‡ªå®šä¹‰ NSOperation çš„è®¡åˆ’ç¨‹åºä¸Šè¿è¡Œçš„ä¸€æ®µä»£ç  (1) å¼€å§‹ã€‚</p>
<p>Â·æ•°æ®è¾“å‡ºå—ä½œä¸ºä¸‹ä¸€ä¸ªå— (2) çš„è¾“å…¥, å®ƒè¿è¡Œåœ¨ä¸€ä¸ªä¸åŒçš„è°ƒåº¦ç¨‹åºä¸Š, å®ƒä½äºå¹¶å‘åå° GCD é˜Ÿåˆ—ä¸­ã€‚</p>
<p>Â·æœ€å, åœ¨ä¸»çº¿ç¨‹è°ƒåº¦ç¨‹åºä¸Šè®¡åˆ’æœ€åä¸€å—è“è‰²ä»£ç  (3), ä»¥ä¾¿ç”¨æ–°æ•°æ®æ›´æ–° UIã€‚</p>
<h3 id="App-architecture-åº”ç”¨çš„æ¶æ„"><a href="#App-architecture-åº”ç”¨çš„æ¶æ„" class="headerlink" title="App architecture åº”ç”¨çš„æ¶æ„"></a>App architecture åº”ç”¨çš„æ¶æ„</h3><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒRxSwiftå¹¶æ²¡æœ‰ä»¥ä»»ä½•æ–¹å¼æ”¹å˜åº”ç”¨ç¨‹åºçš„æ¶æ„ï¼›å®ƒä¸»è¦å¤„ç†äº‹ä»¶ã€å¼‚æ­¥æ•°æ®åºåˆ—å’Œé€šç”¨é€šä¿¡åè®®ã€‚</p>
<p>é€šè¿‡åœ¨è‹¹æœå¼€å‘æ–‡æ¡£ä¸­å®ç°MVCä½“ç³»ç»“æ„ï¼Œå¯ä»¥åˆ›å»ºå…·æœ‰Rxçš„åº”ç”¨ç¨‹åºã€‚å¦‚æœä½ å–œæ¬¢çš„è¯ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©å®ç°MVPæ¶æ„æˆ–MVVMã€‚RxSwiftä¹Ÿå¯ä»¥å¸®ä½ å®ç°è‡ªå·±çš„å•å‘æ•°æ®æ¶æ„ã€‚</p>
<p>å¾®è½¯çš„MVVMæ¶æ„æ˜¯ä¸“é—¨é’ˆå¯¹åœ¨å¹³å°ä¸Šåˆ›å»ºçš„äº‹ä»¶é©±åŠ¨è½¯ä»¶å¼€å‘çš„ï¼Œè¯¥å¹³å°æä¾›æ•°æ®ç»‘å®šã€‚RxSwiftå’ŒMVVMå¾ˆå¥½åœ°ç»“åˆåœ¨ä¸€èµ·ï¼Œåœ¨è¿™æœ¬ä¹¦çš„æœ«å°¾ï¼Œä½ ä¼šçœ‹åˆ°è¿™ä¸ªæ¨¡å¼ä»¥åŠå¦‚ä½•ç”¨RxSwiftæ¥å®ç°å®ƒã€‚</p>
<p>MVVMå’ŒRxSwiftç»“åˆåœ¨ä¸€èµ·çš„åŸå› æ˜¯ï¼ŒViewModelå…è®¸æ‚¨å…¬å¼€<code>Observable</code>å±æ€§ï¼Œè¿™äº›å±æ€§å¯ä»¥ç›´æ¥ç»‘å®šåˆ°View Controller ä»£ç ä¸­çš„UIKitæ§ä»¶ã€‚è¿™ä½¿å¾—ç»‘å®šæ¨¡å‹æ•°æ®åˆ°UIéå¸¸ç®€å•åœ°å±•ç¤ºå’Œç¼–ç ï¼š</p>
<p><img src="https://gewill.org/assets/81526552550_.pic.jpg" alt="81526552550_.pic.jpg"></p>
<p>æœ¬ä¹¦ä¸­çš„æ‰€æœ‰å…¶ä»–ç¤ºä¾‹éƒ½ä½¿ç”¨MVCæ¶æ„æ¥ä¿æŒç¤ºä¾‹ä»£ç ç®€å•æ˜“æ‡‚ã€‚</p>
<h3 id="RxCocoa"><a href="#RxCocoa" class="headerlink" title="RxCocoa"></a>RxCocoa</h3><p>RxSwiftæ˜¯é€šç”¨Rx APIçš„å®ç°ã€‚å› æ­¤ï¼Œå®ƒä¸æ¶‰åŠä»»ä½•Cocoaæˆ–UIKitç±»ã€‚</p>
<p>RxCocoaæ˜¯RxSwiftçš„é…å¥—åº“ï¼Œæ‰€æœ‰çš„ç±»éƒ½æœ‰åŠ©äºUIKitå’ŒCocoaçš„å¼€å‘ã€‚é™¤äº†å…·æœ‰ä¸€äº›é«˜çº§ç±»ä¹‹å¤–ï¼ŒRxCocoaè¿˜ä¸ºè®¸å¤šUIç»„ä»¶æ·»åŠ äº†å“åº”å¼æ‰©å±•ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥è®¢é˜…ä¸åŒçš„UIäº‹ä»¶ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä½¿ç”¨RxCocoaè®¢é˜…UISwitchçš„çŠ¶æ€å˜åŒ–æ˜¯éå¸¸å®¹æ˜“çš„ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">toggleSwitch.rx.isOn</span><br><span class="line">	.subcribe(onNext: &#123;enabled <span class="keyword">in</span></span><br><span class="line">    	<span class="built_in">print</span>(enabled <span class="operator">?</span> <span class="string">&quot;it&#x27;s ON&quot;</span> : <span class="string">&quot;it&#x27;s OFF&quot;</span>)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<p>RxCocoa adds the rx.isOn property (among others) to the UISwitch class so you can subscribe to generally useful event sequences.</p>
<p>RxCocoaå°†rx.isOnå±æ€§ï¼ˆå…¶ä¸­ä¹‹ä¸€ï¼‰æ·»åŠ åˆ°UISwitchç±»ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥è®¢é˜…é€šå¸¸æœ‰ç”¨çš„<code>Observable</code>åºåˆ—ã€‚</p>
<p><img src="https://gewill.org/assets/101526552877_.pic.jpg" alt="101526552877_.pic.jpg"></p>
<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>å®˜æ–¹gitï¼š<a target="_blank" rel="noopener" href="https://github.com/ReactiveX/RxSwift">https://github.com/ReactiveX/RxSwift</a></p>
<p>ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://guides.cocoapods.org/using/using-cocoapods.html">CocoaPods</a> ã€ <a target="_blank" rel="noopener" href="https://github.com/Carthage/Carthage">Carthage</a> å’Œ <a target="_blank" rel="noopener" href="https://github.com/apple/swift-package-manager">Swift Package Manager</a> å‡å¾ˆæ–¹ä¾¿é›†æˆRxSwiftã€‚</p>
<h3 id="RxSwift-å’Œ-Combine"><a href="#RxSwift-å’Œ-Combine" class="headerlink" title="RxSwift å’Œ Combine"></a>RxSwift å’Œ Combine</h3><p>RxSwift å’Œ Combineï¼ˆä»¥åŠ Swift ä¸­çš„å…¶ä»–ç›¸åº”å¼ç¼–ç¨‹æ¡†æ¶ï¼‰å…±äº«è®¸å¤šé€šç”¨è¯­è¨€å’Œéå¸¸ç›¸ä¼¼çš„æ¦‚å¿µã€‚</p>
<p>RxSwiftæ˜¯ä¸€ä¸ªè¾ƒæ—§çš„ï¼Œå®Œå–„çš„æ¡†æ¶ï¼Œå…·æœ‰ä¸€äº›è‡ªå·±çš„åŸå§‹æ¦‚å¿µï¼Œè¿ç®—ç¬¦åç§°å’Œç±»å‹å¤šæ ·æ€§ï¼Œè¿™ä¸»è¦æ˜¯ç”±äºå…¶å¤šå¹³å°è·¨è¯­è¨€æ ‡å‡†ï¼Œè¯¥æ ‡å‡†ä¹Ÿé€‚ç”¨äºLinuxï¼Œè¿™å¯¹äºServer-Side Swiftéå¸¸æœ‰ç”¨ã€‚å®ƒä¹Ÿæ˜¯å¼€æºçš„ï¼Œæ‰€ä»¥å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥ç›´æ¥ä¸ºå…¶æ ¸å¿ƒåšå‡ºè´¡çŒ®ï¼Œå¹¶ç¡®åˆ‡åœ°çœ‹åˆ°å®ƒçš„ç‰¹å®šéƒ¨åˆ†æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚å®ƒä¸æ‰€æœ‰æ”¯æŒ Swift çš„ Apple å¹³å°ç‰ˆæœ¬å…¼å®¹ï¼Œä¸€ç›´æ”¯æŒ iOS 8ã€‚</p>
<p>Combine æ˜¯ Apple æ–°çš„ã€é—ªäº®çš„æ¡†æ¶ï¼Œæ¶µç›–äº†ç±»ä¼¼çš„æ¦‚å¿µï¼Œä½†ä¸“é—¨é’ˆå¯¹ Swift å’Œ Apple è‡ªå·±çš„å¹³å°é‡èº«å®šåˆ¶ã€‚å®ƒä¸ Swift æ ‡å‡†åº“å…±äº«è®¸å¤šé€šç”¨è¯­è¨€ï¼Œå› æ­¤å³ä½¿æ–°æ‰‹ä¹Ÿè§‰å¾— API éå¸¸ç†Ÿæ‚‰ã€‚å®ƒä»…æ”¯æŒä»iOS 13ï¼ŒmacOS 10.15ç­‰å¼€å§‹çš„è¾ƒæ–°çš„Appleå¹³å°ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæˆªè‡³ä»Šå¤©ï¼Œå®ƒè¿˜æ²¡æœ‰å¼€æºï¼Œå¹¶ä¸”ä¸æ”¯æŒLinuxã€‚</p>
<p>å¹¸è¿çš„æ˜¯ï¼Œç”±äº RxSwift å’Œ Combine éå¸¸ç›¸ä¼¼ï¼Œå› æ­¤æ‚¨çš„ RxSwift çŸ¥è¯†å¯ä»¥è½»æ¾è½¬ç§»åˆ° Combineï¼Œåä¹‹äº¦ç„¶ã€‚RxCombineï¼ˆ<a target="_blank" rel="noopener" href="https://github.com/CombineCommunity/RxCombine%EF%BC%89%E7%AD%89%E9%A1%B9%E7%9B%AE%E5%85%81%E8%AE%B8%E6%82%A8%E6%A0%B9%E6%8D%AE%E9%9C%80%E8%A6%81%E6%B7%B7%E5%90%88%E6%90%AD%E9%85%8D">https://github.com/CombineCommunity/RxCombineï¼‰ç­‰é¡¹ç›®å…è®¸æ‚¨æ ¹æ®éœ€è¦æ··åˆæ­é…</a> RxSwift Observables å’Œ Combine Publishersã€‚</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ReactiveX/RxSwift/releases/tag/6.5.0">RxSwift 6.5.0</a> ä¹Ÿè¿æ¥äº† Swift Concurrency çš„æ”¯æŒã€‚æä¾›äº†äº’æ“ä½œæ€§ï¼š</p>
<ol>
<li><code>await  </code> è°ƒç”¨<code>Observable</code>çš„<code>values</code></li>
<li>å°è£… <code>async</code> Task ä¸º <code>Observable</code></li>
</ol>
<h3 id="ç¤¾åŒº"><a href="#ç¤¾åŒº" class="headerlink" title="ç¤¾åŒº"></a>ç¤¾åŒº</h3><p>RxSwiftç¤¾åŒºéå¸¸å‹å¥½ï¼Œæ€æƒ³å¼€æ”¾ï¼Œå¹¶ä¸”çƒ­è¡·äºè®¨è®ºæ¨¡å¼ï¼Œå¸¸ç”¨æŠ€å·§æˆ–äº’ç›¸å¸®åŠ©ã€‚</p>
<p>æ›´å¤šçš„Rxåº“å’Œå®éªŒï¼Œåƒé›¨åæ˜¥ç¬‹ä¸€æ ·çš„æ¶Œç°ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼š<a target="_blank" rel="noopener" href="https://github.com/RxSwiftCommunity">https://github.com/RxSwiftCommunity</a></p>
<p>å¯èƒ½æœ€å¥½çš„æ–¹å¼æ¥æ»¡è¶³è®¸å¤šå¯¹RxSwiftæ„Ÿå…´è¶£çš„äººï¼Œè¿™æ˜¯Slackçš„é¢‘é“ï¼š<a target="_blank" rel="noopener" href="http://rxswift-slack.herokuapp.com/">http://rxswift-slack.herokuapp.com</a>ã€‚</p>
<p>Slacké¢‘é“æ‹¥æœ‰çº¦5000åæˆå‘˜ï¼ æ—¥å¸¸çš„ä¸»é¢˜åŒ…æ‹¬ï¼šäº’ç›¸å¸®åŠ©ï¼Œè®¨è®ºRxSwiftæˆ–å…¶åŒä¼´åº“çš„æ½œåœ¨æ–°åŠŸèƒ½ï¼Œä»¥åŠå…±äº«RxSwiftåšå®¢æ–‡ç« å’Œä¼šè®®è®²åº§ã€‚</p>
<h2 id="ç¬¬äºŒç« ï¼šObservables"><a href="#ç¬¬äºŒç« ï¼šObservables" class="headerlink" title="ç¬¬äºŒç« ï¼šObservables"></a>ç¬¬äºŒç« ï¼šObservables</h2><h3 id="Observable-æ˜¯ä»€ä¹ˆ"><a href="#Observable-æ˜¯ä»€ä¹ˆ" class="headerlink" title="Observable æ˜¯ä»€ä¹ˆ"></a>Observable æ˜¯ä»€ä¹ˆ</h3><p>Observableã€observable sequence å’Œ sequence åœ¨ Rx éƒ½æ˜¯ä¸€ä¸ªæ„æ€ã€‚æˆ–è€…åœ¨å…¶ä»–Rxå®ç°ä¸­ç§°ä¹‹ä¸ºstreamã€‚</p>
<blockquote>
<p>æœ€å¥½ç§°ä¹‹ä¸º Observableï¼Œä¸è¿‡ç¿»è¯‘è¿‡æ¥è¿˜æ˜¯åºåˆ—é¡ºå£äº›ã€‚</p>
</blockquote>
<h3 id="Observable-çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#Observable-çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Observable çš„ç”Ÿå‘½å‘¨æœŸ"></a>Observable çš„ç”Ÿå‘½å‘¨æœŸ</h3><ul>
<li>observableå‘å‡ºåŒ…å«å…ƒç´ çš„<strong>next</strong>äº‹ä»¶ã€‚ å®ƒå¯ä»¥ç»§ç»­è¿™æ ·åšï¼Œç›´åˆ°å®ƒï¼š</li>
<li>â€¦å‘å‡º<strong>error</strong>äº‹ä»¶å¹¶ç»ˆæ­¢ï¼Œæˆ–</li>
<li>â€¦å‘å‡º<strong>completed</strong>äº‹ä»¶å¹¶ç»ˆæ­¢ã€‚</li>
<li>ä¸€æ—¦observableè¢«ç»ˆæ­¢ï¼Œå®ƒä¸èƒ½å†å‘å‡ºäº‹ä»¶ã€‚</li>
</ul>
<p>å°†è¿™ç§æ¦‚å¿µåŒ–çš„æœ€ä½³æ–¹æ³•ä¹‹ä¸€æ˜¯ä½¿ç”¨å¼¹ç å›¾ï¼ˆ<strong>Marble Diagrams</strong> åŸºäºæ—¶é—´è½´ä¸Šç»˜åˆ¶çš„å€¼ï¼‰ã€‚</p>
<p><img src="https://gewill.org/assets/141526623515_.pic.jpg" alt="141526623515_.pic.jpg"></p>
<p><img src="https://gewill.org/assets/151526623523_.pic.jpg" alt="151526623523_.pic.jpg"></p>
<h3 id="åˆ›å»º-Observable"><a href="#åˆ›å»º-Observable" class="headerlink" title="åˆ›å»º Observable"></a><strong>åˆ›å»º</strong> <strong>Observable</strong></h3><p>ç±»å‹æ“¦é™¤çš„ObservableTypeï¼Œä¹Ÿå°±æ˜¯ Swift ä¸­çš„æ³›å‹ã€‚</p>
<p>å®ƒä»£è¡¨äº†ä¸€ç§æ¨å¼é£æ ¼é˜Ÿåˆ—ã€‚</p>
<p>let observable: Observable<Int> &#x3D; Observable<Int>.just(one)</p>
<h3 id="è®¢é˜…-Observable"><a href="#è®¢é˜…-Observable" class="headerlink" title="è®¢é˜… Observable"></a><strong>è®¢é˜…</strong> <strong>Observable</strong></h3><p>è®¢é˜…observable sequenceçš„äº‹ä»¶å¤„ç†ç¨‹åºã€‚</p>
<p>func subscribe(_ on: @escaping (RxSwift.Event&lt;Self.E&gt;) -&gt; Swift.Void) -&gt; Disposable</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> one <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> two <span class="operator">=</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">let</span> three <span class="operator">=</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> observable <span class="operator">=</span> <span class="type">Observable</span>.of(one, two, three)</span><br><span class="line"></span><br><span class="line">observable.subscribe(onNext: &#123; element <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(element)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>åœ¨æŒ‡å®šçš„èŒƒå›´å†…ç”Ÿæˆä¸€ä¸ªæ•´æ•°çš„observable sequenceï¼Œä½¿ç”¨æŒ‡å®šçš„schedulerç”Ÿæˆå’Œå‘é€<code>Observer</code>æ¶ˆæ¯ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">range</span>(<span class="params">start</span>: <span class="keyword">Self</span>.<span class="type">E</span>, <span class="params">count</span>: <span class="keyword">Self</span>.<span class="type">E</span>, <span class="params">scheduler</span>: <span class="type">ImmediateSchedulerType</span> <span class="operator">=</span> <span class="keyword">default</span>) -&gt; <span class="type">RxSwift</span>.<span class="type">Observable</span>&lt;<span class="keyword">Self</span>.<span class="type">E</span>&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> observable <span class="operator">=</span> <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.range(start: <span class="number">1</span>, count: <span class="number">10</span>)</span><br><span class="line">observable</span><br><span class="line">    .subscribe(onNext: &#123; i <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">let</span> n <span class="operator">=</span> <span class="type">Double</span>(i)</span><br><span class="line">        <span class="keyword">let</span> fibonacci <span class="operator">=</span> <span class="type">Int</span>(((pow(<span class="number">1.61803</span>, n) <span class="operator">-</span> pow(<span class="number">0.61803</span>, n)) <span class="operator">/</span></span><br><span class="line">            <span class="number">2.23606</span>).rounded())</span><br><span class="line">        <span class="built_in">print</span>(fibonacci)</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="Disposing-å’Œ-terminating"><a href="#Disposing-å’Œ-terminating" class="headerlink" title="Disposing å’Œ terminating"></a><strong>Disposing å’Œ terminating</strong></h3><p>è¯·è®°ä½, åœ¨æ”¶åˆ°è®¢é˜…ä¹‹å‰, Observableçš„å†…å®¹ä¸ä¼šæ‰§è¡Œä»»ä½•äº‹æƒ…ã€‚å®ƒæ˜¯è§¦å‘ä¸€ä¸ªObservableçš„å¼€å§‹å‘å‡ºäº‹ä»¶çš„è®¢é˜…, ç›´åˆ°å®ƒå‘å‡º. error æˆ–.completedå®Œæˆäº‹ä»¶å¹¶ç»ˆæ­¢ã€‚æ‚¨å¯ä»¥é€šè¿‡å–æ¶ˆå¯¹å®ƒçš„è®¢é˜…æ¥æ‰‹åŠ¨ç»ˆæ­¢Observableã€‚</p>
<p><code>subscription.dispose()</code></p>
<p>å•ç‹¬ç®¡ç†æ¯ä¸ªè®¢é˜…å°†æ˜¯å•è°ƒä¹å‘³çš„, å› æ­¤ RxSwift å¼•å…¥ DisposeBag ç±»å‹ã€‚DisposeBag æŒæœ‰ disposableåè®®çš„å¯¹è±¡ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨<code>.disposed(by:)</code> æ–¹æ³•, å¹¶å°†è°ƒç”¨dispose(), å½“DisposeBagå³å°†deallocatedã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> observable <span class="operator">=</span> <span class="type">Observable</span>.of(<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subscription <span class="operator">=</span> observable.subscribe &#123; event <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(event)</span><br><span class="line">&#125;</span><br><span class="line">subscription.dispose()</span><br></pre></td></tr></table></figure>

<p>createæ“ä½œç¬¦æ¥å—ä¸€ä¸ªåä¸ºsubscribeçš„å‚æ•°ã€‚ å®ƒçš„å·¥ä½œæ˜¯æä¾›å¯¹å¯è§‚å¯Ÿå¯¹è±¡è¿›è¡Œè°ƒç”¨è®¢é˜…çš„å®ç°ã€‚ æ¢å¥è¯è¯´ï¼Œå®ƒå®šä¹‰äº†å°†å‘é€ç»™è®¢é˜…è€…çš„æ‰€æœ‰äº‹ä»¶ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">create</span>(<span class="keyword">_</span> <span class="params">subscribe</span>: <span class="keyword">@escaping</span> (<span class="type">AnyObserver</span>&lt;<span class="type">String</span>&gt;) -&gt; <span class="type">Disposable</span>) -&gt; <span class="type">Observable</span>&lt;<span class="type">String</span>&gt;</span><br></pre></td></tr></table></figure>

<h3 id="åˆ›å»º-observable-å·¥å‚ç±»"><a href="#åˆ›å»º-observable-å·¥å‚ç±»" class="headerlink" title="åˆ›å»º observable å·¥å‚ç±»"></a><strong>åˆ›å»º observable å·¥å‚ç±»</strong></h3><p>å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯è§‚å¯Ÿçš„å·¥å‚ï¼Œå‘æ¯ä¸ªè®¢é˜…è€…å‘å¸ƒä¸€ä¸ªæ–°çš„Observableï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªç­‰å¾…è®¢é˜…è€…çš„Observableã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">deferred</span>(<span class="keyword">_</span> <span class="params">observableFactory</span>: <span class="keyword">@escaping</span> () <span class="keyword">throws</span> -&gt; <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;) -&gt; <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> flip <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> factory: <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt; <span class="operator">=</span> <span class="type">Observable</span>.deferred &#123;</span><br><span class="line">    flip <span class="operator">=</span> <span class="operator">!</span>flip</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> flip &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Observable</span>.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Observable</span>.of(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">_</span> <span class="keyword">in</span> <span class="number">0</span><span class="operator">...</span><span class="number">3</span> &#123;</span><br><span class="line">    factory.subscribe(onNext: &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="variable">$0</span>, terminator: <span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">        .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">123 </span><br><span class="line">456 </span><br><span class="line">123 </span><br><span class="line">456</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨Traits"><a href="#ä½¿ç”¨Traits" class="headerlink" title="ä½¿ç”¨Traits"></a><strong>ä½¿ç”¨Traits</strong></h3><p><strong>Traits</strong>æ˜¯å…·æœ‰æ¯”å¸¸è§„Observableæ›´çª„çš„è¡Œä¸ºé›†åˆçš„ä¸€ç§Observableã€‚å®ƒä»¬çš„ä½¿ç”¨æ˜¯å¯é€‰çš„ï¼›æ‚¨å¯ä»¥åœ¨ä»»ä½•å¯èƒ½ä½¿ç”¨traitçš„åœ°æ–¹ä½¿ç”¨å¸¸è§„Observableã€‚ä»–ä»¬çš„ç›®çš„æ˜¯æä¾›ä¸€ç§ç»™ä½ çš„APIæˆ–è€…ä»£ç çš„è¯»è€…æ›´æ¸…æ¥šåœ°è¡¨è¾¾æ„å›¾çš„æ–¹å¼ã€‚ </p>
<p>RxSwiftä¸­æœ‰ä¸‰ç§Traits: Single, Maybe å’Œ Completable.</p>
<p>Singleså°†å‘å‡º.success(value)æˆ–.erroräº‹ä»¶ã€‚ .success(value)å®é™…ä¸Šæ˜¯.nextå’Œ.completedäº‹ä»¶çš„ç»„åˆã€‚ è¿™å¯¹äºä¸€æ¬¡æ€§è¿›ç¨‹éå¸¸æœ‰ç”¨ï¼Œå®ƒå¯ä»¥æˆåŠŸå¹¶äº§ç”Ÿä¸€ä¸ªå€¼æˆ–å¤±è´¥ï¼Œä¾‹å¦‚ä¸‹è½½æ•°æ®æˆ–ä»ç£ç›˜åŠ è½½æ•°æ®ã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­æ˜¯è¯»å– <code>Copyright.txt</code> çš„æ–‡ä»¶å†…å®¹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">FileReadError</span>: <span class="title class_">Error</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> fileNotFound, unreadable, encodingFailed</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">loadText</span>(<span class="params">from</span> <span class="params">filename</span>: <span class="type">String</span>) -&gt; <span class="type">Single</span>&lt;<span class="type">String</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Single</span>.create &#123; single <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">let</span> disposable <span class="operator">=</span> <span class="type">Disposables</span>.create()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> path <span class="operator">=</span> <span class="type">Bundle</span>.main.path(forResource: filename, ofType: <span class="string">&quot;txt&quot;</span>) <span class="keyword">else</span> &#123;</span><br><span class="line">            single(.error(<span class="type">FileReadError</span>.fileNotFound))</span><br><span class="line">            <span class="keyword">return</span> disposable</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> data <span class="operator">=</span> <span class="type">FileManager</span>.default.contents(atPath: path) <span class="keyword">else</span> &#123;</span><br><span class="line">            single(.error(<span class="type">FileReadError</span>.unreadable))</span><br><span class="line">            <span class="keyword">return</span> disposable</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> contents <span class="operator">=</span> <span class="type">String</span>(data: data, encoding: .utf8) <span class="keyword">else</span> &#123;</span><br><span class="line">            single(.error(<span class="type">FileReadError</span>.encodingFailed))</span><br><span class="line">            <span class="keyword">return</span> disposable</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        single(.success(contents))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> disposable</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">loadText(from: <span class="string">&quot;Copyright&quot;</span>)</span><br><span class="line">    .subscribe &#123;</span><br><span class="line">        <span class="keyword">switch</span> <span class="variable">$0</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> .success(<span class="keyword">let</span> string):</span><br><span class="line">            <span class="built_in">print</span>(string)</span><br><span class="line">        <span class="keyword">case</span> .error(<span class="keyword">let</span> error):</span><br><span class="line">            <span class="built_in">print</span>(error)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>



<h3 id="å‰¯ä½œç”¨"><a href="#å‰¯ä½œç”¨" class="headerlink" title="å‰¯ä½œç”¨"></a><strong>å‰¯ä½œç”¨</strong></h3><p> <code>do</code> Operatorå…è®¸æ’å…¥å‰¯ä½œç”¨ï¼Œå¤„ç†ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­å¹¶ä¸ä¼šä»¥ä»»ä½•æ–¹å¼æ›´æ”¹å‘å‡ºçš„äº‹ä»¶çš„æ“ä½œã€‚</p>
<h3 id="æ‰“å°debug-ä¿¡æ¯"><a href="#æ‰“å°debug-ä¿¡æ¯" class="headerlink" title="æ‰“å°debug ä¿¡æ¯"></a><strong>æ‰“å°debug ä¿¡æ¯</strong></h3><p><code>debug</code> Operator, å®ƒå°†æ‰“å°observableçš„æ¯ä¸ªäº‹ä»¶çš„ä¿¡æ¯ã€‚</p>
<h2 id="ç¬¬ä¸‰ç« ï¼šSubjects"><a href="#ç¬¬ä¸‰ç« ï¼šSubjects" class="headerlink" title="ç¬¬ä¸‰ç« ï¼šSubjects"></a>ç¬¬ä¸‰ç« ï¼šSubjects</h2><h3 id="Subject-æ˜¯ä»€ä¹ˆ"><a href="#Subject-æ˜¯ä»€ä¹ˆ" class="headerlink" title="Subject æ˜¯ä»€ä¹ˆ"></a>Subject æ˜¯ä»€ä¹ˆ</h3><p>æ—¢å¯ä»¥ä½œä¸º<code>Observable</code>ï¼Œä¹Ÿå¯ä»¥ä½œä¸º<code>Observer</code>ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ Subjectsã€‚</p>
<blockquote>
<p>ä¹Ÿæ˜¯æœ€æ–¹ä¾¿äº’æ“ä½œçš„ï¼Œ<code>BehaviorRelay</code>æ¯”è¾ƒå¸¸ç”¨ã€‚</p>
</blockquote>
<p>RxSwift ä¸­æœ‰å››ä¸ªsubjectç±»å‹: </p>
<ol>
<li><code>PublishSubject</code>: å¼€å§‹ä¸ºç©º, åªå‘è®¢é˜…è€…å‘å‡ºæ–°å…ƒç´ . </li>
<li><code>ReplaySubject</code>: ç”¨ç¼“å†²åŒºå¤§å°, å¹¶å°†ä¿æŒå…ƒç´ çš„ç¼“å†²åŒºå¤§å°, å¹¶å°†å…¶é‡æ’­åˆ°æ–°è®¢é˜…è€…. </li>
<li><code>BehaviorSubject</code>: ä»åˆå§‹å€¼å¼€å§‹, å°†å…¶é‡æ’­æˆ–å°†æœ€æ–°çš„å…ƒç´ ç»™æ–°è®¢é˜…è€…. </li>
<li><code>AsyncSubject</code>ï¼šä»…å‘å‡ºåºåˆ—ä¸­çš„æœ€åä¸€ä¸ªnextäº‹ä»¶ï¼Œå¹¶ä¸”ä»…å½“subjectæ”¶åˆ°completedäº‹ä»¶æ—¶æ‰å‘å‡ºã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå°‘ä½¿ç”¨çš„ä¸»é¢˜ã€‚</li>
</ol>
<h3 id="PublishSubject"><a href="#PublishSubject" class="headerlink" title="PublishSubject"></a>PublishSubject</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// Represents an object that is both an observable sequence as well as an observer.</span></span><br><span class="line"><span class="comment">/// Each notification is broadcasted to all subscribed observers.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">PublishSubject</span>&lt;<span class="title class_">Element</span>&gt;</span><br></pre></td></tr></table></figure>

<p>å½“ä½ åªæ˜¯æƒ³è®©è®¢é˜…è€…åªæ¥å—åœ¨è®¢é˜…çš„æ—¶å€™ä»¥åå‘ç”Ÿçš„æ–°çš„äº‹ä»¶ï¼Œç›´åˆ°ä»–ä»¬unsubscribeï¼Œæˆ–è€…subjectå·²ç»terminatedä»¥.completedæˆ–.erroräº‹ä»¶çš„æ–¹å¼ï¼ŒPublishSubjectå°±å¯ä»¥æ´¾ä¸Šç”¨åœºã€‚</p>
<p><img src="https://gewill.org/assets/RxSwiftPublishSubject.jpg" alt="RxSwiftPublishSubject"></p>
<p>ç¬¬ä¸€ä¸ªè®¢é˜…è€…åœ¨å°† 1 æ·»åŠ åˆ°subjectåè¿›è¡Œè®¢é˜…ï¼Œå› æ­¤å®ƒä¸ä¼šæ”¶åˆ°è¯¥äº‹ä»¶ã€‚ä¸è¿‡ï¼Œå®ƒç¡®å®å¾—åˆ°äº†2å’Œ3ã€‚ç”±äºç¬¬äºŒä¸ªè®¢é˜…è€…åœ¨æ·»åŠ 2ä¹‹å‰ä¸ä¼šåŠ å…¥ï¼Œå› æ­¤å®ƒåªèƒ½è·å¾—3ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">ObservableType</span> &#123;</span><br><span class="line">    <span class="comment">/// æ·»åŠ å¸¦æœ‰`id`çš„è§‚å¯Ÿè€…å¹¶æ‰“å°æ¯ä¸ªå‘å‡ºçš„äº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">addObserver</span>(<span class="keyword">_</span> <span class="params">id</span>: <span class="type">String</span>) -&gt; <span class="type">Disposable</span> &#123;</span><br><span class="line">        subscribe &#123; <span class="built_in">print</span>(<span class="string">&quot;è§‚å¯Ÿè€…:&quot;</span>, id, <span class="string">&quot;äº‹ä»¶:&quot;</span>, <span class="variable">$0</span>) &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»è®¢é˜…å¼€å§‹å‘æ‰€æœ‰è§‚å¯Ÿè€…å¹¿æ’­æ–°äº‹ä»¶ã€‚</span></span><br><span class="line">example(<span class="string">&quot;PublishSubject&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> disposeBag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line">    <span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"></span><br><span class="line">    subject.addObserver(<span class="string">&quot;1&quot;</span>).disposed(by: disposeBag)</span><br><span class="line">    subject.onNext(<span class="string">&quot;ğŸ¶&quot;</span>)</span><br><span class="line">    subject.onNext(<span class="string">&quot;ğŸ±&quot;</span>)</span><br><span class="line"></span><br><span class="line">    subject.addObserver(<span class="string">&quot;2&quot;</span>).disposed(by: disposeBag)</span><br><span class="line">    subject.onNext(<span class="string">&quot;ğŸ…°ï¸&quot;</span>)</span><br><span class="line">    subject.onNext(<span class="string">&quot;ğŸ…±ï¸&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    subject.onCompleted()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">--- PublishSubject example ---</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ¶)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ±)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ…°ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: next(ğŸ…°ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ…±ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: next(ğŸ…±ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: completed</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: completed</span><br></pre></td></tr></table></figure>

<h3 id="ReplaySubject"><a href="#ReplaySubject" class="headerlink" title="ReplaySubject"></a>ReplaySubject</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// Represents an object that is both an observable sequence as well as an observer.</span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// Each notification is broadcasted to all subscribed and future observers, subject to buffer trimming policies.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReplaySubject</span>&lt;<span class="title class_">Element</span>&gt;</span><br></pre></td></tr></table></figure>

<p>ReplaySubjectå°†ä¸´æ—¶ç¼“å­˜, æˆ–ç¼“å†²åŒº, å®ƒä»¬å‘å‡ºçš„æœ€æ–°å…ƒç´ , ç”±æ‚¨é€‰æ‹©çš„ speciï¬ed å¤§å°å†³å®šã€‚ç„¶å, ä»–ä»¬ä¼šå°†è¯¥ç¼“å†²åŒºé‡æ’­åˆ°æ–°è®¢é˜…è€…ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘æ‰€æœ‰è§‚å¯Ÿè€…å¹¿æ’­æ–°äº‹ä»¶ï¼Œå¹¶å‘æ–°è§‚å¯Ÿè€…å¹¿æ’­ä¹‹å‰æŒ‡å®šçš„bufferSizeå¤§å°çš„äº‹ä»¶æ•°ã€‚</span></span><br><span class="line">example(<span class="string">&quot;ReplaySubject&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> disposeBag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line">    <span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">ReplaySubject</span>&lt;<span class="type">String</span>&gt;.create(bufferSize: <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    subject.addObserver(<span class="string">&quot;1&quot;</span>).disposed(by: disposeBag)</span><br><span class="line">    subject.onNext(<span class="string">&quot;ğŸ¶&quot;</span>)</span><br><span class="line">    subject.onNext(<span class="string">&quot;ğŸ±&quot;</span>)</span><br><span class="line"></span><br><span class="line">    subject.addObserver(<span class="string">&quot;2&quot;</span>).disposed(by: disposeBag)</span><br><span class="line">    subject.onNext(<span class="string">&quot;ğŸ…°ï¸&quot;</span>)</span><br><span class="line">    subject.onNext(<span class="string">&quot;ğŸ…±ï¸&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    subject.onCompleted()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">--- ReplaySubject example ---</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ¶)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ±)</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: next(ğŸ±) // ç›¸æ¯”PublishSubjectå¤šäº†è®¢é˜…å‰ä¸€ä¸ªäº‹ä»¶</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ…°ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: next(ğŸ…°ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ…±ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: next(ğŸ…±ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: completed</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: completed</span><br></pre></td></tr></table></figure>



<h3 id="BehaviorSubject"><a href="#BehaviorSubject" class="headerlink" title="BehaviorSubject"></a>BehaviorSubject</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// Represents a value that changes over time.</span></span><br><span class="line"><span class="comment">/// Observers can subscribe to the subject to receive the last (or initial) value and all subsequent notifications.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">BehaviorSubject</span>&lt;<span class="title class_">Element</span>&gt;</span><br></pre></td></tr></table></figure>

<p>å½“æ‚¨å¸Œæœ›ä½¿ç”¨æœ€æ–°æ•°æ®é¢„å…ˆå¡«å……Viewæ—¶, BehaviorSubjectéå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚, å¯ä»¥å°†ç”¨æˆ·è¯¦æƒ…é¡µä¸­çš„æ§ä»¶ç»‘å®šåˆ°BehaviorSubject, ä»¥ä¾¿åœ¨åº”ç”¨ç¨‹åºè·å–æ–°æ•°æ®æ—¶, å¯ä»¥ä½¿ç”¨æœ€æ–°å€¼æ¥é¢„å…ˆå¡«å……æ˜¾ç¤ºã€‚ </p>
<p><img src="https://gewill.org/assets/RxSwiftBehaviorSubject.png" alt="RxSwiftBehaviorSubject"> </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">&quot;BehaviorSubject&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> disposeBag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line">    <span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">BehaviorSubject</span>(value: <span class="string">&quot;ğŸ”´&quot;</span>)</span><br><span class="line"></span><br><span class="line">    subject.addObserver(<span class="string">&quot;1&quot;</span>).disposed(by: disposeBag)</span><br><span class="line">    subject.onNext(<span class="string">&quot;ğŸ¶&quot;</span>)</span><br><span class="line">    subject.onNext(<span class="string">&quot;ğŸ±&quot;</span>)</span><br><span class="line"></span><br><span class="line">    subject.addObserver(<span class="string">&quot;2&quot;</span>).disposed(by: disposeBag)</span><br><span class="line">    subject.onNext(<span class="string">&quot;ğŸ…°ï¸&quot;</span>)</span><br><span class="line">    subject.onNext(<span class="string">&quot;ğŸ…±ï¸&quot;</span>)</span><br><span class="line">  </span><br><span class="line">    subject.onCompleted()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">--- BehaviorSubject example ---</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ”´) // ç›¸æ¯”ReplaySubjectå¤šäº†è®¢é˜…å‰ä¸€ä¸ªäº‹ä»¶</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ¶)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ±)</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: next(ğŸ±)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ…°ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: next(ğŸ…°ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ…±ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: next(ğŸ…±ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: completed</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: completed</span><br></pre></td></tr></table></figure>

<h3 id="Relay"><a href="#Relay" class="headerlink" title="Relay"></a>Relay</h3><p>Relayåœ¨ä¿æŒå…¶replayè¡Œä¸ºçš„åŒæ—¶åŒ…è£…äº†subjectã€‚ä¸å…¶ä»–subjectä¸åŒï¼Œå¯ä»¥ä½¿ç”¨ <code>accept(_:)</code> æ·»åŠ å€¼ï¼Œè€Œé <code>onNext(_:)</code>ã€‚è¿™æ˜¯å› ä¸ºRelayåªèƒ½æ¥å—å€¼ï¼Œå³ä¸èƒ½å‘å®ƒä»¬æ·»åŠ é”™è¯¯æˆ–å·²å®Œæˆçš„äº‹ä»¶ã€‚</p>
<p>PublishRelayå°†åŒ…è£…PublishSubject ï¼Œè€ŒBehaviorRelayå°†åŒ…è£…BehaviorSubjectã€‚ä¸­ç»§ä¸åŒ…è£…ä¸»ä½“çš„åŒºåˆ«åœ¨äºï¼Œå®ƒä»¬å¯ä»¥ä¿è¯æ°¸è¿œä¸ä¼šç»ˆæ­¢ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> RxRelay</span><br><span class="line"></span><br><span class="line">example(<span class="string">&quot;PublishRelay&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> disposeBag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line">    <span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">PublishRelay</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"></span><br><span class="line">    subject.addObserver(<span class="string">&quot;1&quot;</span>).disposed(by: disposeBag)</span><br><span class="line">    subject.accept(<span class="string">&quot;ğŸ¶&quot;</span>)</span><br><span class="line">    subject.accept(<span class="string">&quot;ğŸ±&quot;</span>)</span><br><span class="line"></span><br><span class="line">    subject.addObserver(<span class="string">&quot;2&quot;</span>).disposed(by: disposeBag)</span><br><span class="line">    subject.accept(<span class="string">&quot;ğŸ…°ï¸&quot;</span>)</span><br><span class="line">    subject.accept(<span class="string">&quot;ğŸ…±ï¸&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--- PublishRelay example ---</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ¶) //nextäº‹ä»¶å’ŒPublishSubjectä¸€æ ·ï¼Œå°‘äº†completedäº‹ä»¶</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ±)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ…°ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: next(ğŸ…°ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ…±ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: next(ğŸ…±ï¸)</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> RxRelay</span><br><span class="line"></span><br><span class="line">example(<span class="string">&quot;BehaviorRelay&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> disposeBag <span class="operator">=</span> <span class="type">DisposeBag</span>()</span><br><span class="line">    <span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">BehaviorRelay</span>&lt;<span class="type">String</span>&gt;(value: <span class="string">&quot;ğŸ”´&quot;</span>)</span><br><span class="line"></span><br><span class="line">    subject.addObserver(<span class="string">&quot;1&quot;</span>).disposed(by: disposeBag)</span><br><span class="line">    subject.accept(<span class="string">&quot;ğŸ¶&quot;</span>)</span><br><span class="line">    subject.accept(<span class="string">&quot;ğŸ±&quot;</span>)</span><br><span class="line"></span><br><span class="line">    subject.addObserver(<span class="string">&quot;2&quot;</span>).disposed(by: disposeBag)</span><br><span class="line">    subject.accept(<span class="string">&quot;ğŸ…°ï¸&quot;</span>)</span><br><span class="line">    subject.accept(<span class="string">&quot;ğŸ…±ï¸&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">--- BehaviorRelay example ---</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ”´)  //nextäº‹ä»¶å’ŒBehaviorSubjectï¼Œå°‘äº†completedäº‹ä»¶</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ¶)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ±)</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: next(ğŸ±)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ…°ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: next(ğŸ…°ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 1 äº‹ä»¶: next(ğŸ…±ï¸)</span><br><span class="line">è§‚å¯Ÿè€…: 2 äº‹ä»¶: next(ğŸ…±ï¸)</span><br></pre></td></tr></table></figure>



<h2 id="ç¬¬å››ç« ï¼šObservables-å’Œ-Subjects-å®è·µ"><a href="#ç¬¬å››ç« ï¼šObservables-å’Œ-Subjects-å®è·µ" class="headerlink" title="ç¬¬å››ç« ï¼šObservables å’Œ Subjects å®è·µ"></a>ç¬¬å››ç« ï¼šObservables å’Œ Subjects å®è·µ</h2><p>æœ¬ç« é‡ç‚¹æ˜¯åœ¨ä¸€ä¸ªå®Œæ•´çš„åº”ç”¨å¼€å‘ä¸­ä½¿ç”¨RxSwiftï¼Œä¸€æ­¥ä¸€æ­¥çš„å­¦ä¼šå¦‚ä½•æŠŠæ¦‚å¿µåº”ç”¨åˆ°å®é™…é¡¹ç›®ä¸­ã€‚</p>
<h3 id="åœ¨-view-controller-ä¸­ä½¿ç”¨-subject-x2F-relay"><a href="#åœ¨-view-controller-ä¸­ä½¿ç”¨-subject-x2F-relay" class="headerlink" title="åœ¨ view controller ä¸­ä½¿ç”¨ subject&#x2F;relay"></a>åœ¨ view controller ä¸­ä½¿ç”¨ subject&#x2F;relay</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidLoad</span>() &#123;</span><br><span class="line">  <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line"></span><br><span class="line">  images</span><br><span class="line">    .subscribe(onNext: &#123; [<span class="keyword">weak</span> imagePreview] photos <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">guard</span> <span class="keyword">let</span> preview <span class="operator">=</span> imagePreview <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">      preview.image <span class="operator">=</span> photos.collage(size: preview.frame.size)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line"></span><br><span class="line">  images</span><br><span class="line">    .subscribe(onNext: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] photos <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">self</span><span class="operator">?</span>.updateUI(photos: photos)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: bag)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨-subject-åœ¨-view-controller-ä¹‹é—´ä¼ å€¼"><a href="#ä½¿ç”¨-subject-åœ¨-view-controller-ä¹‹é—´ä¼ å€¼" class="headerlink" title="ä½¿ç”¨ subject åœ¨ view controller ä¹‹é—´ä¼ å€¼"></a>ä½¿ç”¨ subject åœ¨ view controller ä¹‹é—´ä¼ å€¼</h3><p>view controller ä¹‹é—´ä¼ å€¼å¯ä»¥é€šè¿‡ delegateï¼Œä½†æ˜¯ç”¨ subject æ›´å¥½ã€‚</p>
<p><img src="https://gewill.org/assets/Talkingtootherviewcontrollersviadelegate.jpg" alt="Talkingtootherviewcontrollersviadelegate"></p>
<p><img src="https://gewill.org/assets/Talkingtootherviewcontrollersviasubjects.jpg" alt="Talkingtootherviewcontrollersviasubjects"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@IBAction</span> <span class="keyword">func</span> <span class="title function_">actionAdd</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> photosViewController <span class="operator">=</span> storyboard<span class="operator">!</span>.instantiateViewController(</span><br><span class="line">        withIdentifier: <span class="string">&quot;PhotosViewController&quot;</span>) <span class="keyword">as!</span> <span class="type">PhotosViewController</span></span><br><span class="line"></span><br><span class="line">    navigationController<span class="operator">!</span>.pushViewController(photosViewController, animated: <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">    photosViewController.selectedPhotos</span><br><span class="line">        .subscribe(</span><br><span class="line">            onNext: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] newImage <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">guard</span> <span class="keyword">let</span> images <span class="operator">=</span> <span class="keyword">self</span><span class="operator">?</span>.images <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">                images.accept(images.value <span class="operator">+</span> [newImage])</span><br><span class="line">            &#125;,</span><br><span class="line">            onDisposed: &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;completed photo selection&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">        .disposed(by: bag)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å°è£…å·²æœ‰APIä¸ºObservable"><a href="#å°è£…å·²æœ‰APIä¸ºObservable" class="headerlink" title="å°è£…å·²æœ‰APIä¸ºObservable"></a>å°è£…å·²æœ‰APIä¸ºObservable</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> Photos</span><br><span class="line"><span class="keyword">import</span> RxSwift</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PhotoWriter</span> &#123;</span><br><span class="line">  <span class="keyword">enum</span> <span class="title class_">Errors</span>: <span class="title class_">Error</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> couldNotSavePhoto</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">save</span>(<span class="keyword">_</span> <span class="params">image</span>: <span class="type">UIImage</span>) -&gt; <span class="type">Observable</span>&lt;<span class="type">String</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Observable</span>.create &#123; observer <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">var</span> savedAssetId: <span class="type">String</span>?</span><br><span class="line">      <span class="type">PHPhotoLibrary</span>.shared().performChanges(&#123;</span><br><span class="line">        <span class="keyword">let</span> request <span class="operator">=</span> <span class="type">PHAssetChangeRequest</span>.creationRequestForAsset(from: image)</span><br><span class="line">        savedAssetId <span class="operator">=</span> request.placeholderForCreatedAsset<span class="operator">?</span>.localIdentifier</span><br><span class="line">      &#125;, completionHandler: &#123; success, error <span class="keyword">in</span></span><br><span class="line">        <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">          <span class="keyword">if</span> success, <span class="keyword">let</span> id <span class="operator">=</span> savedAssetId &#123;</span><br><span class="line">            observer.onNext(id)</span><br><span class="line">            observer.onCompleted()</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            observer.onError(error <span class="operator">??</span> <span class="type">Errors</span>.couldNotSavePhoto)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="type">Disposables</span>.create()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="RxSwift-traits-å®è·µ"><a href="#RxSwift-traits-å®è·µ" class="headerlink" title="RxSwift traits å®è·µ"></a>RxSwift traits å®è·µ</h3><h4 id="Single"><a href="#Single" class="headerlink" title="Single"></a>Single</h4><p>Single åªæœ‰<code>.success</code> æˆ– <code>.error</code> ä¸¤ç§äº‹ä»¶ ã€‚é€‚åˆä½œä¸ºå°è£…ç½‘ç»œæ¥å£çš„è¿”å›å€¼ï¼Œè¦ä¹ˆæˆåŠŸï¼Œè¦ä¹ˆå¤±è´¥ã€‚<img src="https://gewill.org/assets/single.jpg" alt="single"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">PhotoWriter</span>.save(image)</span><br><span class="line">      .asSingle()</span><br><span class="line">      .subscribe(onSuccess: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] id <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">self</span><span class="operator">?</span>.showMessage(<span class="string">&quot;Saved with id: <span class="subst">\(id)</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">self</span><span class="operator">?</span>.actionClear()</span><br><span class="line">        &#125;, onError: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] error <span class="keyword">in</span></span><br><span class="line">          <span class="keyword">self</span><span class="operator">?</span>.showMessage(<span class="string">&quot;Error&quot;</span>, description: error.localizedDescription)</span><br><span class="line">      &#125;)</span><br><span class="line">      .disposed(by: bag)</span><br></pre></td></tr></table></figure>

<h4 id="Maybe"><a href="#Maybe" class="headerlink" title="Maybe"></a>Maybe</h4><p>Maybe æœ‰ä¸‰ç§äº‹ä»¶ï¼š<code>.success</code>ã€<code>.completed</code> å’Œ <code>.error</code> ã€‚</p>
<p>å’Œ Single ä¸€æ ·ï¼Œä½ æ—¢å¯ä»¥é€šè¿‡ <code>Maybe.create(&#123; ... &#125;)</code> ç›´æ¥åˆ›å»ºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>.asMaybe()</code></p>
<p><img src="https://gewill.org/assets/maybe.jpg" alt="maybe"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">PhotoWriter</span>.save(image)</span><br><span class="line">    .asMaybe()</span><br><span class="line">    .subscribe(</span><br><span class="line">        onSuccess: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] id <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span><span class="operator">?</span>.showMessage(<span class="string">&quot;Saved with id: <span class="subst">\(id)</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">self</span><span class="operator">?</span>.actionClear()</span><br><span class="line">        &#125;,</span><br><span class="line">        onError: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] error <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span><span class="operator">?</span>.showMessage(<span class="string">&quot;Error&quot;</span>, description: error.localizedDescription)</span><br><span class="line">        &#125;,</span><br><span class="line">        onCompleted: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span><span class="operator">?</span>.showMessage(<span class="string">&quot;Saved&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">    .disposed(by: bag)</span><br></pre></td></tr></table></figure>

<h4 id="Completable"><a href="#Completable" class="headerlink" title="Completable"></a>Completable</h4><p>Completable åªæœ‰<code>.completed</code> å’Œ <code>.error</code> ä¸¤ç§äº‹ä»¶ã€‚é€‚åˆåªå…³å¿ƒæ˜¯å¦å®Œæˆï¼Œè€Œä¸éœ€è¦ä¼ é€’valueçš„æƒ…å†µã€‚ä½¿ç”¨æ–¹æ³•ï¼š<code>Completable.create(&#123; ... &#125;)</code></p>
<p><img src="https://gewill.org/assets/completable.jpg" alt="completable"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PhotoWriter</span> &#123;</span><br><span class="line">  <span class="keyword">enum</span> <span class="title class_">Errors</span>: <span class="title class_">Error</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> couldNotSavePhoto</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">save</span>(<span class="keyword">_</span> <span class="params">image</span>: <span class="type">UIImage</span>) -&gt; <span class="type">Completable</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Completable</span>.create &#123; completable <span class="keyword">in</span></span><br><span class="line">      <span class="type">PHPhotoLibrary</span>.shared().performChanges(&#123;</span><br><span class="line">        <span class="type">PHAssetChangeRequest</span>.creationRequestForAsset(from: image)</span><br><span class="line">      &#125;, completionHandler: &#123; success, error <span class="keyword">in</span></span><br><span class="line">        <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">          <span class="keyword">if</span> success &#123;</span><br><span class="line">            completable(.completed)</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            completable(.error(error <span class="operator">??</span> <span class="type">Errors</span>.couldNotSavePhoto))</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">return</span> <span class="type">Disposables</span>.create()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">PhotoWriter</span>.save(image)</span><br><span class="line">  .subscribe(</span><br><span class="line">    onCompleted: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">self</span><span class="operator">?</span>.showMessage(<span class="string">&quot;Saved&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    onError: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] error <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">self</span><span class="operator">?</span>.showMessage(<span class="string">&quot;Error&quot;</span>, description: error.localizedDescription)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .disposed(by: bag)</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Ge Will</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  





</body>
</html>
