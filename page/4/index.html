<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
<meta property="og:type" content="website">
<meta property="og:title" content="Will&#39;s Blog">
<meta property="og:url" content="http://example.com/page/4/index.html">
<meta property="og:site_name" content="Will&#39;s Blog">
<meta property="og:description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Ge Will">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/4/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/4/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Will's Blog</title>
  







<head>
    <!-- 霞鹜文楷字体 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.7.0/style.css"/>

    <!-- datapulse统计 -->
    <script defer type="text/javascript" src="https://datapulse.app/datapulse.min.js" id="datapulse" data-endpoint="https://datapulse.app/api/v1/event" data-workspace="cljxqml5q0y0f8j37d4futnbl"></script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DR0FC9YJLH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'G-DR0FC9YJLH');
    </script>

    <!-- 看板娘 -->
    <script src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script>
</head>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Will's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">194</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">11</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">1</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Ge Will"
      src="/images/avatar.jpeg">
  <p class="site-author-name" itemprop="name">Ge Will</p>
  <div class="site-description" itemprop="description">The people who are crazy enough to think they can change the world, are the ones who DO.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">194</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/gewill" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;gewill" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:531sunlight@gmail.com" title="E-Mail → mailto:531sunlight@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/gewei" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;gewei" rel="noopener me" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/BoJack_D" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;BoJack_D" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/16/introducing-SwiftyModel/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/16/introducing-SwiftyModel/" class="post-title-link" itemprop="url">SwiftyModel介绍</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-16 18:21:00" itemprop="dateCreated datePublished" datetime="2021-11-16T18:21:00+08:00">2021-11-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://gewill.org/assets/SwiftyModel-mac-preview.jpg" alt="SwiftyModel-mac-preview"></p>
<h1 id="介绍Introducing"><a href="#介绍Introducing" class="headerlink" title="介绍Introducing"></a>介绍Introducing</h1><p>使用 SwiftyJSON 生成在 Swift 语言中支持 SwiftyJSON 的 Model（模型）。</p>
<p>一键复制和分享代码。</p>
<p>Use SwiftyJSON to generate models that support SwiftyJSON in Swift Language.</p>
<p>One-click to copy or share code.</p>
<p>例如输入以下JSON：</p>
<p>For example, enter the following JSON:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Jacky&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;notifications&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;pets&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;cat&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;dog&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出Swift Model：</p>
<p>Output Swift Model:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> SwiftyJSON</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">NewModel</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> id: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> notifications: <span class="type">Bool</span></span><br><span class="line">    <span class="keyword">let</span> pets: [<span class="type">String</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="params">json</span>: <span class="type">JSON</span>) &#123;</span><br><span class="line">        id <span class="operator">=</span> json[<span class="string">&quot;id&quot;</span>].intValue</span><br><span class="line">        name <span class="operator">=</span> json[<span class="string">&quot;name&quot;</span>].stringValue</span><br><span class="line">        notifications <span class="operator">=</span> json[<span class="string">&quot;notifications&quot;</span>].boolValue</span><br><span class="line">        pets <span class="operator">=</span> json[<span class="string">&quot;pets&quot;</span>].arrayValue.map &#123; <span class="variable">$0</span>.stringValue &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下载地址：<a target="_blank" rel="noopener" href="https://apps.apple.com/us/app/swiftymodel/id1594180242">App Store</a></p>
<p><a target="_blank" rel="noopener" href="https://apps.apple.com/cn/app/swiftymodel/id1594180242">App Store下载</a><br><a target="_blank" rel="noopener" href="https://apps.apple.com/app/swiftymodel/id1594180242">Download on the App Store</a></p>
<p>有任何疑问或者建议，可以通过 <a href="mailto:531sunlight@gmail.com">Email</a> 联系。</p>
<p>If you have any questions or suggestions, you can contact them through <a href="mailto:531sunlight@gmail.com">Email</a>.</p>
<h1 id="隐私政策Privacy-policy"><a href="#隐私政策Privacy-policy" class="headerlink" title="隐私政策Privacy policy"></a>隐私政策Privacy policy</h1><p>本App不进行任何隐私信息收集或上传。</p>
<p>This App does not collect or upload any private information.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/04/18/introducing-Subscriptions-Bill/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/18/introducing-Subscriptions-Bill/" class="post-title-link" itemprop="url">阅账介绍</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-04-18 20:35:29" itemprop="dateCreated datePublished" datetime="2021-04-18T20:35:29+08:00">2021-04-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://gewill.org/assets/subscriptions-mac-preview.jpg" alt="subscriptions-mac-preview"></p>
<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><ol>
<li><p>轻松记录全部订阅账单。</p>
</li>
<li><p>统计平均每日、每周、每月和每年花费。</p>
</li>
<li><p>支持iCloud同步全设备。</p>
</li>
</ol>
<p>下载地址：<a target="_blank" rel="noopener" href="https://apps.apple.com/cn/app/%E9%98%85%E5%B8%90/id1561803236">App Store</a></p>
<p>有任何疑问或者建议，可以通过 <a href="mailto:531sunlight@gmail.com">Email</a> 联系。</p>
<h2 id="隐私政策"><a href="#隐私政策" class="headerlink" title="隐私政策"></a>隐私政策</h2><p>本隐私政策描述了我们如何收集，使用和披露与服务有关的个人信息，您通过访问服务即表示同意。“个人信息”是指有关可识别个人的信息，但不包括商业信息。</p>
<h3 id="收集哪些信息"><a href="#收集哪些信息" class="headerlink" title="收集哪些信息"></a>收集哪些信息</h3><p>阅账希望使您与我们的体验令人满意且安全。我们的数据收集政策使您可以选择向我们提供多少个人信息，并控制我们如何使用这些信息。我们的目标是为您提供满意的体验，同时让您控制自己的隐私。阅账收集和使用信息主要是为了使您使用我们的服务更轻松，更有意义。如果您选择向我们注册，则可能会在不同时间要求您提供信息，我们将竭尽所能使阅账满足您的服务并只为您提供所需的内容。</p>
<h3 id="收集的信息与用途"><a href="#收集的信息与用途" class="headerlink" title="收集的信息与用途"></a>收集的信息与用途</h3><p>为识别您的设备 ID 并预防恶意程序、提高服务安全性、保障运营质量及效率，我们使用的第三方平台包括Firebase 会收集您的设备信息（包括IMEI、MEID、IMSI、GUID、MAC地址）、您安装的应用信息或运行中的进程信息。</p>
<p><strong>匿名信息</strong>是指无法与特定个人联系在一起的信息，我们不知道您的姓名，住处或出生日期。匿名信息可能以多种方式收集，包括通过使用 Cookie，网络信标或从您使用的设备中收集。</p>
<h3 id="第三方分析工具"><a href="#第三方分析工具" class="headerlink" title="第三方分析工具"></a>第三方分析工具</h3><p>我们的服务可能包含来自我们服务提供商的第三方跟踪以及数据收集和分析工具，例如 Google Analytics（分析）和 Google Firebase 。此类第三方可以在我们的服务中使用 Cookie，API 和 SDK，以使他们能够代表我们收集和分析与用户和设备相关的数据和信息。第三方可能会访问并收集有关您的数据和信息，例如您的设备标识符(包括IMEI、MEID、IMSI、GUID、MAC地址及其他相关信息)，语言环境（使用特定语言的特定位置），地理位置信息，IP 地址，应用程序使用情况，访问权限和会话时间，传感器数据，设备上存在的或在设备上特定时间使用的应用程序以及您对广告的观看和互动，以提供其服务，包括例如启用，提供和投放广告在下面有更详细的说明。</p>
<p>我们的服务提供商的隐私政策可能包括有关其数据收集和使用惯例以及跟踪技术的其他条款和披露，我们鼓励您检查这些隐私政策以了解有关其数据收集和使用惯例以及 Cookie 的使用的更多信息以及其他类似的跟踪技术。</p>
<p>为识别您的设备 ID 并预防恶意程序、提高服务安全性、保障运营质量及效率，我们使用的第三方平台将获取设备序列号。</p>
<ul>
<li><strong>Google</strong><br>隐私政策：<a target="_blank" rel="noopener" href="https://policies.google.com/privacy">https://policies.google.com/privacy</a></li>
</ul>
<h3 id="第三方广告合作伙伴"><a href="#第三方广告合作伙伴" class="headerlink" title="第三方广告合作伙伴"></a>第三方广告合作伙伴</h3><p>我们与各种广告商，广告网络，广告服务器和分析公司合作。这些广告商，广告网络，广告服务器和分析公司使用各种技术以及第三方公司的技术来收集数据，以便向您和其他用户发送（或投放）相关广告。这些技术可能包括放置Cookie或网络信标，使用唯一或非唯一的非个人标识符，或在我们的服务上使用其他技术，并且这些技术可用于跟踪用户行为，跟踪我们如何服务正在使用中，有可能为您提供更多相关的广告。这些目标广告可能会出现在我们的服务或您访问的其他服务上。本隐私政策不涵盖广告商，广告网络，广告服务器和分析公司对各种技术的使用。这些公司还可能从您从其他公司使用的服务中获取信息，这些服务包括但不限于其他网站，移动网站，可移动下载的应用程序和可下载的桌面应用程序，并将这些信息与他们通过我们的服务通过这些第三方技术获取的信息结合在一起。您应该意识到，我们无法控制这些第三方技术或其中包含的信息。</p>
<h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><p>阅账可以随时修改本隐私政策。请经常检查是否有任何更改。继续使用服务，即表示您接受本隐私政策的所有更新。此版本于 2023 年 02 月 01 日更新。</p>
<h3 id="联系我们"><a href="#联系我们" class="headerlink" title="联系我们"></a>联系我们</h3><p>我们希望此声明能为您提供丰富而清晰的信息。如果您有任何疑问或进一步的信息，请给我们发送电子邮件。</p>
<p>App 与服务反馈: <a href="mailto:531sunlight@gmail.com">531sunlight@gmail.com</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/11/14/Update-Hackintosh-to-Big-Sur-with-Open-Core/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/11/14/Update-Hackintosh-to-Big-Sur-with-Open-Core/" class="post-title-link" itemprop="url">使用 Open Core 黑苹果升级至 Big Sur</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-11-14 14:59:53" itemprop="dateCreated datePublished" datetime="2020-11-14T14:59:53+08:00">2020-11-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="机器配置"><a href="#机器配置" class="headerlink" title="机器配置"></a>机器配置</h2><p>主板：<a target="_blank" rel="noopener" href="https://www.msi.com/Motherboard/MPG-Z390-GAMING-PRO-CARBON-AC">微星 MSI MPG Z390 GAMING PRO CARBON AC</a></p>
<p>CPU：<a target="_blank" rel="noopener" href="https://ark.intel.com/content/www/us/en/ark/products/186605/intel-core-i9-9900k-processor-16m-cache-up-to-5-00-ghz.html">Intel i9 9900K</a></p>
<p>内存：科赋 DDR4 3200  16G*4</p>
<p>显卡：<a target="_blank" rel="noopener" href="https://www.asus.com/us/Graphics-Cards/AREZ-STRIX-RXVEGA64-O8G-GAMING/">华硕 ASUS AREZ-STRIX-RXVEGA64-O8G-GAMING</a></p>
<p>电源：<a target="_blank" rel="noopener" href="https://www.evga.com/products/product.aspx?pn=120-GP-0750-X1">EVGA SuperNOVA 750 G+</a></p>
<p>散热：<a target="_blank" rel="noopener" href="http://www.coolermaster.com/cooling/cpu-liquid-cooler/masterliquid-ml240r-rgb/">MASTERLIQUID ML240R RGB</a></p>
<p>固态：三星 970 EVO 500G</p>
<p>板载声卡：ALC S1220A</p>
<p>板载有线网卡：Intel I219V7</p>
<p>无线网卡和蓝牙：BCM94360CD</p>
<p>显示器：戴尔 P2715Q 4K显示器</p>
<p>机箱：<a target="_blank" rel="noopener" href="http://www.phanteks.com/Enthoo-Evolv-ATX-TemperedGlass.html">追风者 PK-515ETG</a></p>
<h2 id="具体步骤"><a href="#具体步骤" class="headerlink" title="具体步骤"></a>具体步骤</h2><ol>
<li>替换Clover为Open Core v0.6.2，感谢 <a target="_blank" rel="noopener" href="https://github.com/pOH7">pOH7</a>&#x2F;<strong><a target="_blank" rel="noopener" href="https://github.com/pOH7/hackintosh-z390-h-9700k">hackintosh-z390-h-9700kuzh</a></strong> 的EFI。</li>
<li>下载并升级Big Sur，重启几次后，无法进入Big Sur的安装界面。</li>
<li>升级Open Core v0.6.3，感谢 <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=QK9Kmvmnp0A">Ryzentosh Big Sur Updating OpenCore From 0.6.2 to 0.6.3</a><ol>
<li>打开<a target="_blank" rel="noopener" href="https://opencore.slowgeek.com/">OpenCore Sanity Checker</a> ，拖进<code>config.plist</code>，根据建议修改。</li>
<li>下载<a target="_blank" rel="noopener" href="https://github.com/acidanthera/OpenCorePkg">OpenCorePkg</a>、 <a target="_blank" rel="noopener" href="https://github.com/acidanthera/WhateverGreen">WhateverGreen</a>、<a target="_blank" rel="noopener" href="https://github.com/acidanthera/VirtualSMC">VirtualSMC</a>、<a target="_blank" rel="noopener" href="https://github.com/acidanthera/Lilu">Lilu</a> 并替换。其中OpenCore只需要替换<code>EFI/OC/OpenCore.efi</code> 和 <code>EFI/BOOT/BOOTx64.efi</code>。</li>
</ol>
</li>
<li>顺利进入Big Sur的安装界面，升级成功🎉</li>
<li>EFI下载地址： [Big Sur Open Core 0.6.3 EFI 20201114.zip](<a target="_blank" rel="noopener" href="https://github.com/gewill/Hackintosh-Installation-with-MSI-Z390-and-i9-9900K/blob/master/Big">https://github.com/gewill/Hackintosh-Installation-with-MSI-Z390-and-i9-9900K/blob/master/Big</a> Sur Open Core 0.6.3 EFI 20201114.zip)</li>
</ol>
<p><img src="https://gewill.org/assets/Hackintosh-Big-Sur.jpg" alt="Hackintosh-Big-Sur"></p>
<h2 id="已知问题"><a href="#已知问题" class="headerlink" title="已知问题"></a>已知问题</h2><ol>
<li>USB 2.0 不可用，需USB定制。</li>
<li><del>硬件加速不可用</del>，BIOS集成显卡打开即可硬件加速。</li>
</ol>
<p><img src="https://gewill.org/assets/Hardware-Acceleration-On-Big-Sur.png" alt="Hardware-Acceleration-On-Big-Sur"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/07/27/triggers-a-runtime-error-in-swift-standard-library/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/27/triggers-a-runtime-error-in-swift-standard-library/" class="post-title-link" itemprop="url">在Swift标准库中触发运行时错误</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-07-27 22:06:26" itemprop="dateCreated datePublished" datetime="2020-07-27T22:06:26+08:00">2020-07-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-12-15 00:19:12" itemprop="dateModified" datetime="2023-12-15T00:19:12+08:00">2023-12-15</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Array-swift"><a href="#Array-swift" class="headerlink" title="Array.swift"></a>Array.swift</h1><p>Using a negative number or an index equal to or greater than <code>count</code> triggers a runtime error.</p>
<p>使用负数或大于等于<code>count</code>的索引会触发运行时错误。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(emptyDoubles[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<h1 id="ClosedRange-swift"><a href="#ClosedRange-swift" class="headerlink" title="ClosedRange.swift"></a>ClosedRange.swift</h1><p>An equivalent range must be representable as a closed range.  For example, passing an empty range as <code>other</code> triggers a runtime error,  because an empty range cannot be represented by a closed range instance.</p>
<p>等效范围必须可以表示为闭合范围。例如，将空范围作为 <code>other</code> 传递会触发运行时错误，因为空范围不能由封闭范围实例表示。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> emptyRange <span class="operator">=</span> <span class="number">0</span><span class="operator">..&lt;</span><span class="number">0</span></span><br><span class="line"><span class="type">ClosedRange</span>(emptyRange)</span><br></pre></td></tr></table></figure>

<h1 id="Dictionary-swift"><a href="#Dictionary-swift" class="headerlink" title="Dictionary.swift"></a>Dictionary.swift</h1><p>Passing a sequence with duplicate keys to this initializer results in a runtime error. If your sequence might have duplicate keys, use the <code>Dictionary(_:uniquingKeysWith:)</code> initializer instead.</p>
<p>向此构造器传递具有重复键的序列会导致运行时错误。如果序列可能有重复的键，则使用<code>Dictionary(_:uniquingKeysWith:)</code> 初始化。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> digitWords <span class="operator">=</span> [<span class="string">&quot;one&quot;</span>, <span class="string">&quot;two&quot;</span>, <span class="string">&quot;three&quot;</span>, <span class="string">&quot;four&quot;</span>, <span class="string">&quot;five&quot;</span>]</span><br><span class="line"><span class="keyword">let</span> wordToValue <span class="operator">=</span> <span class="type">Dictionary</span>(uniqueKeysWithValues: <span class="built_in">zip</span>(digitWords, <span class="number">1</span> <span class="operator">...</span> <span class="number">5</span>))</span><br><span class="line"><span class="keyword">let</span> wordToValueAndRemoveDuplicateKeys <span class="operator">=</span> <span class="type">Dictionary</span>(<span class="built_in">zip</span>([<span class="string">&quot;one&quot;</span>, <span class="string">&quot;one&quot;</span>, <span class="string">&quot;three&quot;</span>, <span class="string">&quot;four&quot;</span>, <span class="string">&quot;five&quot;</span>], <span class="number">1</span> <span class="operator">...</span> <span class="number">5</span>)) &#123; <span class="built_in">max</span>(<span class="variable">$0</span>, <span class="variable">$1</span>) &#125;</span><br></pre></td></tr></table></figure>

<h1 id="DictionaryCasting-swift"><a href="#DictionaryCasting-swift" class="headerlink" title="DictionaryCasting.swift"></a>DictionaryCasting.swift</h1><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dic: [<span class="type">String</span>: <span class="keyword">Any</span>] <span class="operator">=</span> [<span class="string">&quot;name&quot;</span>: <span class="string">&quot;li&quot;</span>, <span class="string">&quot;age&quot;</span>: <span class="number">18</span>]</span><br><span class="line">dic <span class="keyword">as!</span> [<span class="type">String</span>: <span class="type">String</span>]</span><br></pre></td></tr></table></figure>

<h1 id="Integers-swift"><a href="#Integers-swift" class="headerlink" title="Integers.swift"></a>Integers.swift</h1><p>When the additive inverse of a value is unrepresentable in a conforming type, the operation should either trap or return an exceptional value. For example, using the negation operator (prefix <code>-</code>) with <code>Int.min</code> results in a runtime error.</p>
<p>当一个值的负值在一个符合类型中不可表示时，操作应该捕获或返回一个异常值。例如，将否定运算符(前缀<code>-</code>)与 <code>Int.min</code>一起使用会导致运行时错误。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x <span class="operator">=</span> <span class="type">Int</span>.min</span><br><span class="line"><span class="keyword">let</span> y <span class="operator">=</span> <span class="operator">-</span>x</span><br><span class="line"><span class="comment">// Overflow error</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> z <span class="operator">=</span> <span class="operator">-</span><span class="type">Int8</span>.min</span><br><span class="line"><span class="comment">// Overflow error</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> y <span class="operator">=</span> <span class="type">Int8</span>.min</span><br><span class="line">y.negate()</span><br><span class="line"><span class="comment">// Overflow error</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> z <span class="operator">=</span> <span class="type">UInt32</span>(<span class="operator">-</span><span class="number">500</span>)</span><br><span class="line"><span class="comment">// Error</span></span><br></pre></td></tr></table></figure>

<h1 id="Optional-swift"><a href="#Optional-swift" class="headerlink" title="Optional.swift"></a>Optional.swift</h1><p>In debug builds (<code>-Onone</code>), the <code>unsafelyUnwrapped</code> property has the same behavior as using the postfix <code>!</code> operator and triggers a runtime error if the instance is <code>nil</code>.</p>
<p>在调试版本(<code>-Onone</code>)中，<code>unsafelyUnwrapped</code>属性的行为与使用后缀的行为相同<code>!</code>如果实例为<code> nil</code> ，则触发运行时错误。<strong>谨慎使用</strong>。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> optionalInt: <span class="type">Int</span>? <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">optionalInt.unsafelyUnwrapped</span><br><span class="line">optionalInt<span class="operator">!</span></span><br></pre></td></tr></table></figure>

<h1 id="Policy-swift"><a href="#Policy-swift" class="headerlink" title="Policy.swift"></a>Policy.swift</h1><p>If you have prior knowledge that an <code>AnyObject</code> instance has a particular type, you can use the unconditional downcast operator (<code>as!</code>). Performing an invalid cast triggers a runtime error.</p>
<p>如果您事先知道<code>AnyObject</code>实例具有特定的类型，则可以使用无条件向下转换运算符(<code>as</code>)。 执行无效强制转换会触发运行时错误。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> message <span class="operator">=</span> s <span class="keyword">as!</span> <span class="type">String</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Successful cast to String: <span class="subst">\(message)</span>&quot;</span>)</span><br><span class="line"><span class="comment">// Prints &quot;Successful cast to String: This is a bridged string.&quot;</span></span><br><span class="line"><span class="keyword">let</span> badCase <span class="operator">=</span> v <span class="keyword">as!</span> <span class="type">String</span></span><br><span class="line"><span class="comment">// Runtime error</span></span><br></pre></td></tr></table></figure>

<h1 id="Range-swift"><a href="#Range-swift" class="headerlink" title="Range.swift"></a>Range.swift</h1><p>An equivalent range must be representable as an instance of Range<Bound>. For example, passing a closed range with an upper bound of <code>Int.max</code> triggers a runtime error, because the resulting half-open range would require an upper bound of <code>Int.max + 1</code>, which is not representable as</p>
<p>范围边界值越界会触发运行时错误，如设置最大值为<code>Int.max</code>时。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Range</span>(<span class="number">0</span> <span class="operator">...</span> <span class="type">Int</span>.max)</span><br></pre></td></tr></table></figure>



<p>Always use the slice’s <code>startIndex</code> property instead of assuming that its indices start at a particular value. Attempting to access an element by using an index outside the bounds of the slice’s indices may result in a runtime error, even if that index is valid for the original collection.</p>
<p>始终使用 slice 的<code>startIndex</code>属性，而不是假设它的索引以特定的值开始。试图通过在slice索引的边界之外使用索引来访问元素可能会导致运行时错误，即使该索引对原始集合有效。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> streets <span class="operator">=</span> [<span class="string">&quot;Adams&quot;</span>, <span class="string">&quot;Bryant&quot;</span>, <span class="string">&quot;Channing&quot;</span>, <span class="string">&quot;Douglas&quot;</span>, <span class="string">&quot;Evarts&quot;</span>]</span><br><span class="line"><span class="keyword">let</span> streetsSlice <span class="operator">=</span> streets[<span class="number">2</span><span class="operator">...</span>]</span><br><span class="line"><span class="built_in">print</span>(streetsSlice)</span><br><span class="line"><span class="comment">// [&quot;Channing&quot;, &quot;Douglas&quot;, &quot;Evarts&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(streetsSlice.startIndex)</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="built_in">print</span>(streetsSlice[<span class="number">2</span>])</span><br><span class="line"><span class="comment">// &quot;Channing&quot;</span></span><br><span class="line"><span class="built_in">print</span>(streetsSlice[<span class="number">0</span>])</span><br><span class="line"><span class="comment">// error: Index out of bounds</span></span><br></pre></td></tr></table></figure>

<h1 id="RangeReplaceableCollection-swift"><a href="#RangeReplaceableCollection-swift" class="headerlink" title="RangeReplaceableCollection.swift"></a>RangeReplaceableCollection.swift</h1><p>Attempting to remove more elements than exist in the collection triggers a runtime error.</p>
<p>尝试移除集合中存在的元素数目多于存在的元素会触发运行时错误。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> array <span class="operator">=</span> <span class="type">Array</span>(<span class="number">0</span> <span class="operator">..&lt;</span> <span class="number">5</span>)</span><br><span class="line">array.removeFirst(<span class="number">6</span>)</span><br><span class="line">array.removeLast(<span class="number">6</span>)</span><br></pre></td></tr></table></figure>

<h1 id="SetCasting-swift"><a href="#SetCasting-swift" class="headerlink" title="SetCasting.swift"></a>SetCasting.swift</h1><p> We can’t just delegate to _setDownCastConditional here because we rely on  <code>as!</code> to generate nice runtime errors when the downcast fails.</p>
<p>Set 向下强制转换失败时，会产生运行时错误。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s: <span class="type">Set</span>&lt;<span class="type">AnyHashable</span>&gt; <span class="operator">=</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="string">&quot;3&quot;</span>]</span><br><span class="line">s <span class="keyword">as!</span> <span class="type">Set</span>&lt;<span class="type">Int</span>&gt;</span><br></pre></td></tr></table></figure>

<h1 id="StaticString-swift"><a href="#StaticString-swift" class="headerlink" title="StaticString.swift"></a>StaticString.swift</h1><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// * a pointer to a null-terminated sequence of UTF-8 code units:</span></span><br><span class="line"><span class="keyword">let</span> emoji: <span class="type">StaticString</span> <span class="operator">=</span> <span class="string">&quot;<span class="subst">\u&#123;1F600&#125;</span>&quot;</span></span><br><span class="line">emoji.hasPointerRepresentation <span class="comment">// -&gt; true</span></span><br><span class="line">emoji.isASCII <span class="comment">// -&gt; false</span></span><br><span class="line"><span class="comment">// emoji.unicodeScalar // -&gt; Fatal error!</span></span><br><span class="line">emoji.utf8CodeUnitCount <span class="comment">// -&gt; 4</span></span><br><span class="line">emoji.utf8Start[<span class="number">0</span>] <span class="comment">// -&gt; 0xF0</span></span><br><span class="line">emoji.utf8Start[<span class="number">1</span>] <span class="comment">// -&gt; 0x9F</span></span><br><span class="line">emoji.utf8Start[<span class="number">2</span>] <span class="comment">// -&gt; 0x98</span></span><br><span class="line">emoji.utf8Start[<span class="number">3</span>] <span class="comment">// -&gt; 0x80</span></span><br><span class="line">emoji.utf8Start[<span class="number">4</span>] <span class="comment">// -&gt; 0x00</span></span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// * a single Unicode scalar value, under very limited circumstances:</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MyStaticScalar</span>: <span class="title class_">ExpressibleByUnicodeScalarLiteral</span> &#123;</span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">UnicodeScalarLiteralType</span> <span class="operator">=</span> <span class="type">StaticString</span></span><br><span class="line">    <span class="keyword">let</span> value: <span class="type">StaticString</span></span><br><span class="line">    <span class="keyword">init</span>(<span class="params">unicodeScalarLiteral</span> <span class="params">value</span>: <span class="type">StaticString</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.value <span class="operator">=</span> value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> emoji: <span class="type">StaticString</span> <span class="operator">=</span> <span class="type">MyStaticScalar</span>(<span class="string">&quot;<span class="subst">\u&#123;1F600&#125;</span>&quot;</span>).value</span><br><span class="line">emoji.hasPointerRepresentation <span class="comment">// -&gt; false</span></span><br><span class="line">emoji.isASCII <span class="comment">// -&gt; false</span></span><br><span class="line">emoji.unicodeScalar.value <span class="comment">// -&gt; 0x1F600</span></span><br><span class="line">emoji.utf8CodeUnitCount <span class="comment">// -&gt; Fatal error!</span></span><br><span class="line">emoji.utf8Start <span class="comment">// -&gt; Fatal error!</span></span><br></pre></td></tr></table></figure>

<p><code>hasPointerRepresentation</code> 一个布尔值，表示静态字符串是否存储指向以 null 结尾的 UTF-8代码单元序列的指针。</p>
<ul>
<li>true：这时访问<code>unicodeScalar</code>会触发运行时错误；</li>
<li>false：静态字符串存储单个 Unicode 标量值。这时访问<code>utf8</code>开头的属性会触发运行时错误；</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/11/18/Data-Structures-and-Algorithms-in-Swift-Notes-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/11/18/Data-Structures-and-Algorithms-in-Swift-Notes-2/" class="post-title-link" itemprop="url">Swift数据结构和算法（二）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-11-18 14:44:13" itemprop="dateCreated datePublished" datetime="2019-11-18T14:44:13+08:00">2019-11-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="第三部分：树"><a href="#第三部分：树" class="headerlink" title="第三部分：树"></a>第三部分：树</h2><h3 id="第十章：树"><a href="#第十章：树" class="headerlink" title="第十章：树"></a>第十章：树</h3><p>树在数据结构中相当重要。它用于解决软件开发中的许多反复出现的挑战：</p>
<ul>
<li><p>表示层次关系。</p>
</li>
<li><p>管理排序的数据。</p>
</li>
<li><p>促进快速查找操作。</p>
</li>
</ul>
<p>相关术语</p>
<ul>
<li>节点（Node）</li>
<li>父子（Parent and child）</li>
<li>根（Root）</li>
<li>叶子（Leaf）</li>
</ul>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TreeNode</span>&lt;<span class="title class_">T</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> value: <span class="type">T</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> children: [<span class="type">TreeNode</span>] <span class="operator">=</span> []</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">T</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.value <span class="operator">=</span> value</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">add</span>(<span class="keyword">_</span> <span class="params">child</span>: <span class="type">TreeNode</span>) &#123;</span><br><span class="line">    children.append(child)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="遍历算法"><a href="#遍历算法" class="headerlink" title="遍历算法"></a>遍历算法</h4><p>遍历线性的集合（如：数组和链表）是非常直接的。因为有直接的首尾。</p>
<p>但是遍历树就复杂了。是左边优先，还是深度优先，要看具体解决的问题。</p>
<h5 id="深度优先遍历（Depth-ﬁrst-traversal）"><a href="#深度优先遍历（Depth-ﬁrst-traversal）" class="headerlink" title="深度优先遍历（Depth-ﬁrst traversal）"></a>深度优先遍历（Depth-ﬁrst traversal）</h5><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">TreeNode</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">forEachDepthFirst</span>(<span class="params">visit</span>: (<span class="type">TreeNode</span>) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">    visit(<span class="keyword">self</span>)</span><br><span class="line">    children.forEach &#123;</span><br><span class="line">      <span class="variable">$0</span>.forEachDepthFirst(visit: visit)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="层级优先遍历（Level-order-traversal）"><a href="#层级优先遍历（Level-order-traversal）" class="headerlink" title="层级优先遍历（Level-order traversal）"></a>层级优先遍历（Level-order traversal）</h5><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">TreeNode</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">forEachLevelOrder</span>(<span class="params">visit</span>: (<span class="type">TreeNode</span>) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">    visit(<span class="keyword">self</span>)</span><br><span class="line">    <span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">Queue</span>&lt;<span class="type">TreeNode</span>&gt;()</span><br><span class="line">    children.forEach &#123; queue.enqueue(<span class="variable">$0</span>) &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> node <span class="operator">=</span> queue.dequeue() &#123;</span><br><span class="line">      visit(node)</span><br><span class="line">      node.children.forEach &#123; queue.enqueue(<span class="variable">$0</span>) &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h5><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">TreeNode</span> <span class="title class_">where</span> <span class="title class_">T</span>: <span class="title class_">Equatable</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">search</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">T</span>) -&gt; <span class="type">TreeNode</span>? &#123;</span><br><span class="line">    <span class="keyword">var</span> result: <span class="type">TreeNode</span>?</span><br><span class="line">    forEachDepthFirst &#123; node <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">if</span> node.value <span class="operator">==</span> value &#123;</span><br><span class="line">        result <span class="operator">=</span> node</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ol>
<li>树与链接列表具有一些相似之处，但是，链接列表节点只能链接到另一个节点，而树节点可以链接到无限多个节点。</li>
<li>熟悉树的术语，例如父，子，叶子和根。 这些术语中有许多是其他程序员常用的语言，将用于帮助解释其他树形结构。</li>
<li>遍历（例如深度优先遍历和层级遍历）不是特定于常规树的。 它们也可以在其他树上工作，尽管根据树的结构，它们的实现会略有不同。</li>
</ol>
<h3 id="第十一章：树挑战"><a href="#第十一章：树挑战" class="headerlink" title="第十一章：树挑战"></a>第十一章：树挑战</h3><p>打印所有的值，按照他们层级的顺序。同意层级应该打印在一行</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">15 </span><br><span class="line">1 17 20</span><br><span class="line">1 5 0 2 5 7</span><br></pre></td></tr></table></figure>

<p>实现：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">printEachLevel</span>&lt;<span class="type">T</span>&gt;(<span class="params">for</span> <span class="params">tree</span>: <span class="type">TreeNode</span>&lt;<span class="type">T</span>&gt;) &#123;</span><br><span class="line">    <span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">Queue</span>&lt;<span class="type">TreeNode</span>&lt;<span class="type">T</span>&gt;&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// 加入每层的节点计数，当打印完时，换行</span></span><br><span class="line">    <span class="keyword">var</span> nodesLeftInCurrentLevel <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    queue.enqueue(tree)</span><br><span class="line">    <span class="keyword">while</span> <span class="operator">!</span>queue.isEmpty &#123;</span><br><span class="line">        nodesLeftInCurrentLevel <span class="operator">=</span> queue.count</span><br><span class="line">        <span class="keyword">while</span> nodesLeftInCurrentLevel <span class="operator">&gt;</span> <span class="number">0</span> &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> node <span class="operator">=</span> queue.dequeue() <span class="keyword">else</span> &#123; <span class="keyword">break</span> &#125;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;<span class="subst">\(node.value)</span> &quot;</span>, terminator: <span class="string">&quot;&quot;</span>)</span><br><span class="line">            node.children.forEach &#123; queue.enqueue(<span class="variable">$0</span>) &#125;</span><br><span class="line">            nodesLeftInCurrentLevel <span class="operator">-=</span> <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/08/05/Server-Side-Swift-with-Kitura-Notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/08/05/Server-Side-Swift-with-Kitura-Notes/" class="post-title-link" itemprop="url">Kitura Swift后端开发-笔记</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-08-05 15:49:35" itemprop="dateCreated datePublished" datetime="2019-08-05T15:49:35+08:00">2019-08-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="第一章：引言"><a href="#第一章：引言" class="headerlink" title="第一章：引言"></a>第一章：引言</h2><p><strong>Kitura是什么？</strong></p>
<p>在词源学上，Kitura这个词松散地源于希伯来语Keturah，字面意思是“香”。</p>
<p><strong>为什么选择Swift写后端？</strong></p>
<p>支持为服务器编写Swift的核心论点是在应用程序的前端和后端之间共享代码和知识。如果你是一个团队，这种精简可以说是更加关键和赋权。这包括但不限于模型对象代码。</p>
<p>BFF（Backonnd for Frontend）是一种设计模式，很快就会成为你最好的朋友（永远？）。</p>
<p>这个模式在这个特定用例中起作用的几个原因：</p>
<ol>
<li><p>你可以确定从此API发出请求的唯一设备将是iOS设备。这意味着你可以更少担心平衡请求负载。</p>
</li>
<li><p>你可以更好地控制对iOS设备的响应中的数据。在此之前，你可能已经等待后端开发人员最终帮助你，并根据User-Agent首部有条件地修剪响应数据。现在，你可以让后端开发人员不间断地工作，并通过将响应数据解析为你的BFF设备所需的内容来解决你的问题。</p>
</li>
<li><p>在我们的特定用例中，你可以在发送响应之前保存一个用户可能对数据库进行的查询的响应。这意味着，如果其他人在相同的位置请求餐馆信息（例子是请求包含地理位置的餐馆信息），并且存储的数据足够新以满足你的刷新策略，你甚至不必向主服务器发送查询！你只需发送缓存的数据，并相信它对你的用户来说足够新。</p>
</li>
<li><p>你可以使用你已经知道如何在Swift中编写代码的语言完成1-3！</p>
</li>
</ol>
<h2 id="第二章：Hello-World"><a href="#第二章：Hello-World" class="headerlink" title="第二章：Hello, World!"></a>第二章：Hello, World!</h2><p>如何Kitura项目</p>
<p>先安装Kitura macOS App和Kitura CLI</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew tap ibm-swift/kitura</span><br><span class="line">brew install kitura</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">kitura</span><br><span class="line">Usage: kitura [options] [command]</span><br><span class="line"></span><br><span class="line">Kitura command-line interface</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -V, --version  output the version number</span><br><span class="line">  -h, --help     output usage information</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  build          build the project in a local container</span><br><span class="line">  create         interactively create a Kitura project</span><br><span class="line">  idt            install IBM Cloud Developer Tools</span><br><span class="line">  init           scaffold a bare-bones Kitura project</span><br><span class="line">  kit            print Cocoapods boilerplate for KituraKit</span><br><span class="line">  run            run the project in a local container</span><br><span class="line">  sdk            generate a client SDK from an OpenAPI/Swagger spec</span><br><span class="line">  help [cmd]     display help for [cmd]</span><br></pre></td></tr></table></figure>



<p>创建的Kitura项目提供了一个开箱即用的全功能Kitura应用程序。 它提供了在生产环境中运行的任何应用程序可能需要的一些功能，包括：</p>
<ul>
<li><p>使用HeliumLogger记录信息，警告和错误消息。</p>
</li>
<li><p>使用CloudEnvironment进行动态配置查找和设置。</p>
</li>
<li><p>使用Health查看和报告应用程序健康状况。</p>
</li>
<li><p>使用SwiftMetrics进行App和Kitura框架指标和监控。</p>
</li>
</ul>
<p>项目使用SPM管理依赖</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// swift-tools-version:4.0</span></span><br><span class="line"><span class="keyword">import</span> PackageDescription</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> package <span class="operator">=</span> <span class="type">Package</span>(</span><br><span class="line">    name: <span class="string">&quot;EmojiJournalServer&quot;</span>,</span><br><span class="line">    dependencies: [</span><br><span class="line">      .package(url: <span class="string">&quot;https://github.com/IBM-Swift/Kitura.git&quot;</span>, .upToNextMinor(from: <span class="string">&quot;2.5.0&quot;</span>)),</span><br><span class="line">      .package(url: <span class="string">&quot;https://github.com/IBM-Swift/HeliumLogger.git&quot;</span>, from: <span class="string">&quot;1.7.1&quot;</span>),</span><br><span class="line">      .package(url: <span class="string">&quot;https://github.com/IBM-Swift/CloudEnvironment.git&quot;</span>, from: <span class="string">&quot;9.0.0&quot;</span>),</span><br><span class="line">      .package(url: <span class="string">&quot;https://github.com/RuntimeTools/SwiftMetrics.git&quot;</span>, from: <span class="string">&quot;2.0.0&quot;</span>),</span><br><span class="line">      .package(url: <span class="string">&quot;https://github.com/IBM-Swift/Health.git&quot;</span>, from: <span class="string">&quot;1.0.0&quot;</span>),</span><br><span class="line">    ],</span><br><span class="line">    targets: [</span><br><span class="line">      .target(name: <span class="string">&quot;EmojiJournalServer&quot;</span>, dependencies: [ .target(name: <span class="string">&quot;Application&quot;</span>), <span class="string">&quot;Kitura&quot;</span> , <span class="string">&quot;HeliumLogger&quot;</span>]),</span><br><span class="line">      .target(name: <span class="string">&quot;Application&quot;</span>, dependencies: [ <span class="string">&quot;Kitura&quot;</span>, <span class="string">&quot;CloudEnvironment&quot;</span>,<span class="string">&quot;SwiftMetrics&quot;</span>,<span class="string">&quot;Health&quot;</span>,      ]),</span><br><span class="line"></span><br><span class="line">      .testTarget(name: <span class="string">&quot;ApplicationTests&quot;</span> , dependencies: [.target(name: <span class="string">&quot;Application&quot;</span>), <span class="string">&quot;Kitura&quot;</span>,<span class="string">&quot;HeliumLogger&quot;</span> ])</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Application.swift包含应用程序的生命周期处理，提供emojiJournalServer目标中main.swift使用的核心<code>init()</code>和<code>run()</code>方法来启动应用程序。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> Kitura</span><br><span class="line"><span class="keyword">import</span> LoggerAPI</span><br><span class="line"><span class="keyword">import</span> Configuration</span><br><span class="line"><span class="keyword">import</span> CloudEnvironment</span><br><span class="line"><span class="keyword">import</span> KituraContracts</span><br><span class="line"><span class="keyword">import</span> Health</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">let</span> projectPath <span class="operator">=</span> <span class="type">ConfigurationManager</span>.<span class="type">BasePath</span>.project.path</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">let</span> health <span class="operator">=</span> <span class="type">Health</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> router <span class="operator">=</span> <span class="type">Router</span>()</span><br><span class="line">  <span class="keyword">let</span> cloudEnv <span class="operator">=</span> <span class="type">CloudEnv</span>()</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() <span class="keyword">throws</span> &#123;</span><br><span class="line">    <span class="comment">// Run the metrics initializer</span></span><br><span class="line">    initializeMetrics(router: router)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">postInit</span>() <span class="keyword">throws</span> &#123;</span><br><span class="line">    <span class="comment">// Endpoints</span></span><br><span class="line">    initializeHealthRoutes(app: <span class="keyword">self</span>)</span><br><span class="line">    router.get(<span class="string">&quot;/&quot;</span>, handler: helloWorldHandler)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">helloWorldHandler</span>(<span class="params">request</span>: <span class="type">RouterRequest</span>, <span class="params">response</span>: <span class="type">RouterResponse</span>, <span class="params">next</span>: ()-&gt;()) &#123;</span><br><span class="line">    response.send(<span class="string">&quot;Hello, World!&quot;</span>)</span><br><span class="line">    next()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">run</span>() <span class="keyword">throws</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> postInit()</span><br><span class="line">    <span class="type">Kitura</span>.addHTTPServer(onPort: cloudEnv.port, with: router)</span><br><span class="line">    <span class="type">Kitura</span>.run()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行后</p>
<p>欢迎页：<a target="_blank" rel="noopener" href="http://localhost:8090/">http://localhost:8090</a></p>
<p>健康：<a target="_blank" rel="noopener" href="http://localhost:8090/health">http://localhost:8090/health</a></p>
<p>监控仪表板：<a target="_blank" rel="noopener" href="http://localhost:8090/swiftmetrics-dash">http://localhost:8090/swiftmetrics-dash</a></p>
<p>HTTP吞吐量视图使用每秒请求（RPS）度量标准显示在任何时间点发生的请求量。</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8090/metrics">http://localhost:8090/metrics</a></p>
<p><strong>使用Docker在Linux上运行应用程序</strong></p>
<p>Docker和Kubernetes是Kitura部署的核心，它们提供了重要的性能和扩展优势。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kitura build</span><br><span class="line">kitura run</span><br></pre></td></tr></table></figure>

<h2 id="第三章：RESTful-APIs"><a href="#第三章：RESTful-APIs" class="headerlink" title="第三章：RESTful APIs"></a>第三章：RESTful APIs</h2><p>在开始构建这些RESTful API之前，将了解RESTful API本身，包括它们的架构方法和设计原则。</p>
<h3 id="REpresentational-State-Transfer-REST"><a href="#REpresentational-State-Transfer-REST" class="headerlink" title="REpresentational State Transfer (REST)"></a>REpresentational State Transfer (REST)</h3><p>REpresentational State Transfer（REST）是一种架构风格或设计模式的API。 如果一个API符合Roy Fielding博士在他的2000年论文“架构风格和基于网络的软件架构设计”中提出的一系列约束，那么它就是RESTful。</p>
<h4 id="Fielding提出了以下六个限制："><a href="#Fielding提出了以下六个限制：" class="headerlink" title="Fielding提出了以下六个限制："></a>Fielding提出了以下六个限制：</h4><ol>
<li>客户端 - 服务器</li>
</ol>
<p>RESTful API在客户端和服务器之间提供明确的分离，允许客户端和服务器彼此独立地开发。这种分离使得为同一服务器实现多个客户端成为可能，就像你为EmojiJournal创建iOS和Web应用程序客户端时所做的那样。</p>
<ol start="2">
<li>无状态</li>
</ol>
<p>RESTful API应该是无状态的。每个请求都应该是自包含的，并且不应该依赖于存储在服务器上的先前请求的任何会话上下文。</p>
<ol start="3">
<li>可缓存</li>
</ol>
<p>由于RESTful API是无状态和自包含的，因此可以将请求的结果缓存到RESTful API。这可以由客户端或诸如web代理之类的中介来完成。</p>
<p>设计良好的RESTful API应该鼓励尽可能存储可缓存的数据，对请求的响应被隐式或显式标记为可缓存，可缓存到特定时间（expires-at）或不可缓存。</p>
<ol start="4">
<li>分层系统</li>
</ol>
<p>RESTful API可以是分层的，因此客户端不知道它是直接连接到API本身还是通过代理或负载均衡器间接连接。另外，API本身可以由服务器系统本身内的若干层或源组成和构建。</p>
<ol start="5">
<li>按需代码（可选）</li>
</ol>
<p>RESTful API可以提供可以直接在客户端上运行的功能。实际上，这通常仅限于在浏览器中运行的JavaScript或Java Applet。</p>
<ol start="6">
<li>统一界面</li>
</ol>
<p>RESTful API最重要的概念之一是资源的使用。资源可以是API可以提供有关信息的任何对象，例如你将使用的JournalEntry资源。</p>
<h4 id="提供统一接口的RESTful-API必须满足以下四个约束："><a href="#提供统一接口的RESTful-API必须满足以下四个约束：" class="headerlink" title="提供统一接口的RESTful API必须满足以下四个约束："></a>提供统一接口的RESTful API必须满足以下四个约束：</h4><ul>
<li>请求必须确定他们采取行动的资源。 </li>
<li>请求和响应必须使用资源的表示。 </li>
<li>消息必须是自描述的，自包含的，并且只能使用标准操作。</li>
<li>资源必须通过链接连接到其他资源。</li>
</ul>
<p>另请注意，没有提及HTTP和Web请求。虽然RESTful API最常使用HTTP实现，但这不是必需的。也就是说，我们将仅介绍如何使用标准HTTP操作构建RESTful API，我们接下来将简要介绍HTTP本身。</p>
<h3 id="HyperText-Transfer-Protocol-HTTP"><a href="#HyperText-Transfer-Protocol-HTTP" class="headerlink" title="HyperText Transfer Protocol (HTTP)"></a>HyperText Transfer Protocol (HTTP)</h3><p>超文本传输协议（HTTP）是一种客户端 - 服务器，基于请求 - 响应的协议，是网站和基于Web的流量的基础。 因此，它受到客户端和服务器的普遍支持。</p>
<h3 id="HTTP-based-RESTful-APIs"><a href="#HTTP-based-RESTful-APIs" class="headerlink" title="HTTP-based RESTful APIs"></a>HTTP-based RESTful APIs</h3><h4 id="URL作为资源"><a href="#URL作为资源" class="headerlink" title="URL作为资源"></a>URL作为资源</h4><p>统一接口的第一个要求是请求标识它们所依赖的资源。在HTTP中，这是通过RESTful API使用请求的URL实现的。</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/entries</span><br></pre></td></tr></table></figure>

<h4 id="特定资源的URL编码标识符"><a href="#特定资源的URL编码标识符" class="headerlink" title="特定资源的URL编码标识符"></a>特定资源的URL编码标识符</h4><p>将提供这些URL以使客户端能够与所有日记帐分录和特定日记帐分录进行交互：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/entries </span><br><span class="line">/entries/&lt;identifier&gt;</span><br></pre></td></tr></table></figure>

<h4 id="用于资源组的URL编码查询参数"><a href="#用于资源组的URL编码查询参数" class="headerlink" title="用于资源组的URL编码查询参数"></a>用于资源组的URL编码查询参数</h4><p>你可能还希望提供与资源子集的API。 这再次通过URL完成，这次使用URL查询参数。</p>
<p>URL查询参数以<code>?</code>开头。 他们可以使用<code>&lt;key&gt; = &lt;value&gt;</code>格式的键值对传递有关资源的任何其他信息。 可以使用键值对之间的<code>＆</code>分隔符聚合和传递多个键值对。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/entries </span><br><span class="line">/entries?emoji=&lt;emoji&gt;&amp;date=&lt;date&gt; </span><br><span class="line">/entries/&lt;idenfifier&gt;</span><br></pre></td></tr></table></figure>

<h4 id="分层API的分层URL"><a href="#分层API的分层URL" class="headerlink" title="分层API的分层URL"></a>分层API的分层URL</h4><p>RESTful URL也可以是分层的。 在你的EmojiJournal应用程序中，你只会支持拥有单个EmojiJournal的用户。 但是，假设你希望支持拥有多个期刊的用户，每个期刊都有自己的日记帐分录。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/journals </span><br><span class="line">/journals/&lt;identifier&gt; </span><br><span class="line">/journals/&lt;identifier&gt;/entries </span><br><span class="line">/journals/&lt;identifier&gt;/entries?emoji=&lt;emoji&gt;&amp;date=&lt;date&gt; /journals/&lt;identifier&gt;/entries/&lt;identifier&gt;</span><br></pre></td></tr></table></figure>

<p>例如，对以下URL的客户端请求将与日记2中的条目20进行交互：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/journals/2/entries/20</span><br></pre></td></tr></table></figure>

<h4 id="资源表示"><a href="#资源表示" class="headerlink" title="资源表示"></a>资源表示</h4><p>回想一下，统一接口的第二个概念是请求和响应应该使用资源的表示。 这是通过在HTTP正文数据中编码资源的表示，在基于HTTP的RESTful API中实现的。</p>
<p>HTTP消息，无论是请求还是响应，基本上由两部分组成：一组标题和正文数据。 为了完整性，响应还包含一个状态代码，用于报告请求的状态。</p>
<h4 id="HTTP首部和正文数据"><a href="#HTTP首部和正文数据" class="headerlink" title="HTTP首部和正文数据"></a>HTTP首部和正文数据</h4><p>HTTP首部为请求和响应提供了额外的元数据。 首部在请求或响应开始时传输，并存储为键值对，一些首部允许多个值。</p>
<p>你可以使用HTTP首部存储你希望的任何其他信息。 你应该了解两个正式定义的标准标题，请参阅<a target="_blank" rel="noopener" href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html">https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html</a>（由正式的核心RFC规范定义），以及不太正式但广泛使用的非标准的首部，请参阅<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Common_non-standard_request_fields">https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Common_non-standard_request_fields</a>。</p>
<p>标准头用于传递诸如Cookie，授权，ContentType（描述正文数据的媒体类型）和Content-Length（以字节为单位描述正文数据长度）等信息。</p>
<p>HTTP消息正文包含与请求或响应关联的数据。 在响应对网页的请求的情况下，正文数据包含网页本身的来源。 看一下对Hello，World的请求生成的HTTP响应！ 你在上一章中创建的应用程序。</p>
<h4 id="正文数据中的资源表示"><a href="#正文数据中的资源表示" class="headerlink" title="正文数据中的资源表示"></a>正文数据中的资源表示</h4><p>如前所述，RESTful API对返回的HTTP正文数据中的资源表示进行编码。 身体通常由三部分组成：</p>
<ol>
<li>Content-Type首部</li>
</ol>
<p>Content-Type首部表示用于表示正文数据中的资源的编码。最常用的方法是使用JavaScript Object Notation（JSON）对表示进行编码，并将Content-Type首部设置为<code>application/json</code>。有时与RESTful API一起使用的身体数据编码的其他示例包括Protobuf，Thrift和Avro。</p>
<ol start="2">
<li>接受首部（仅限请求）</li>
</ol>
<p>接受首部指示客户端将接受响应的编码。这通常是<code>application/json</code>，但它也可以包含编码列表。例如，如果客户端在JSON和Protobuf中都接受了响应，则此值可能设置为：<code>application/json;application/protobuf</code>。</p>
<ol start="3">
<li>编码的正文数据</li>
</ol>
<p>最后，使用Content-Type首部中设置的编码将资源本身编码为正文数据。在最常见的<code>application/json</code>场景中，这是资源的JSON表示。 JSON的细节取决于特定资源的模型。例如，在本书后面稍后，JournalEntry的资源将包含id，emoji和date，类似于：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">	<span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="string">&quot;1&quot;</span><span class="punctuation">,</span> </span><br><span class="line">	<span class="attr">&quot;emoji&quot;</span><span class="punctuation">:</span><span class="string">&quot;😊 &quot;</span><span class="punctuation">,</span> </span><br><span class="line">	<span class="attr">&quot;date&quot;</span><span class="punctuation">:</span><span class="string">&quot;2018-09-18T00:07:01Z&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="自我描述性的信息"><a href="#自我描述性的信息" class="headerlink" title="自我描述性的信息"></a>自我描述性的信息</h4><p>你已经了解了资源的识别和表示，但你如何对这些资源进行操作？</p>
<p>统一接口的第三个原则解决了这个问题。 它规定请求和响应都应该是自描述的，并且它们仅使用客户端和服务器都理解的标准操作。 在基于HTML的RESTful API中，这是通过使用特定的HTTP方法实现的。</p>
<p>RFC 2616概述了八种HTTP方法：OPTIONS，GET，HEAD，POST，PUT，DELETE，TRACE和CONNECT。</p>
<h4 id="通过链接连接资源"><a href="#通过链接连接资源" class="headerlink" title="通过链接连接资源"></a>通过链接连接资源</h4><p>统一接口的第四个也是最后一个概念是资源应该通过链接连接到其他资源。</p>
<p>如你所见，基于HTTP的RESTful API使用URL和基于URL的标识符来提供对资源的访问并指定单个资源。 因此，资源之间的链接只是进一步的RESTful URL和链接到连接资源的基于URL的标识符。</p>
<p>有两种常见的场景需要URL或标识资源：</p>
<ul>
<li>请求的资源引用另一个（子或相关）资源。</li>
<li>你需要知道资源的标识符。</li>
</ul>
<h3 id="构建RESTful-API"><a href="#构建RESTful-API" class="headerlink" title="构建RESTful API"></a>构建RESTful API</h3><p><img src="/../assets/image-20190806103823282.png" alt="image-20190806103823282"></p>
<p>到目前为止，你已经学会了所有基础知识。 当你了解有关设计和实现RESTful API的更多信息时，你会发现除了我们在此处介绍的范围之外还有其他最佳实践。 这包括设置正确的Content-Type和Accepts标头，为成功创建设置Location标头，并为请求中的任何故障设置正确的HTTP状态代码。</p>
<p>此外，需要对请求和响应主体进行编码和解码，最常见的是来自JSON。 这曾经是一项艰巨的任务。 由于强大的Codable协议，Swift使JSON优雅且无痛。</p>
<h2 id="第四章：Codable简介"><a href="#第四章：Codable简介" class="headerlink" title="第四章：Codable简介"></a>第四章：Codable简介</h2><p>Codable协议是Swift编程语言最强大的功能之一。 在一个句子中，当你扩展对象以符合Codable时，你可以使该对象自动序列化为任何外部可读格式，例如JSON，XML或协议缓冲区。</p>
<h3 id="The-bare-necessities"><a href="#The-bare-necessities" class="headerlink" title="The bare necessities"></a>The bare necessities</h3><p>直接看一个例子</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1 Cadabe 是一个组合的协议：Decodable &amp; Encodable</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">Song</span>: <span class="title class_">Codable</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> title: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> length: <span class="type">Int</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">enum</span> <span class="title class_">CodingKeys</span>: <span class="title class_">String</span>, <span class="title class_">CodingKey</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> title <span class="operator">=</span> <span class="string">&quot;songTitle&quot;</span></span><br><span class="line">    <span class="keyword">case</span> length <span class="operator">=</span> <span class="string">&quot;songLength&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">Animal</span>: <span class="title class_">Codable</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> age: <span class="type">Int</span>?</span><br><span class="line">  <span class="keyword">var</span> isFriendly: <span class="type">Bool</span></span><br><span class="line">  <span class="keyword">var</span> birthday: <span class="type">Date</span></span><br><span class="line">  <span class="keyword">var</span> songs: [<span class="type">Song</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2 嵌套</span></span><br><span class="line"><span class="keyword">let</span> baloo <span class="operator">=</span> <span class="type">Animal</span>(name: <span class="string">&quot;Baloo&quot;</span>,</span><br><span class="line">                   age: <span class="number">5</span>,</span><br><span class="line">                   isFriendly: <span class="literal">true</span>,</span><br><span class="line">                   birthday: <span class="type">Date</span>(),</span><br><span class="line">                   songs: [<span class="type">Song</span>(title: <span class="string">&quot;The Bare Necessities&quot;</span>, length: <span class="number">180</span>)])</span><br><span class="line"><span class="keyword">let</span> bagheera <span class="operator">=</span> <span class="type">Animal</span>(name: <span class="string">&quot;Bagheera&quot;</span>,</span><br><span class="line">                      age: <span class="literal">nil</span>,</span><br><span class="line">                      isFriendly: <span class="literal">true</span>,</span><br><span class="line">                      birthday: <span class="type">Date</span>(),</span><br><span class="line">                      songs: [<span class="type">Song</span>(title: <span class="string">&quot;Jungle&#x27;s No Place For A Boy&quot;</span>, length: <span class="number">95</span>)])</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3 处理日期格式，驼峰式与蛇式转换</span></span><br><span class="line"><span class="keyword">let</span> encoder <span class="operator">=</span> <span class="type">JSONEncoder</span>()</span><br><span class="line">encoder.keyEncodingStrategy <span class="operator">=</span> .convertToSnakeCase</span><br><span class="line">encoder.dateEncodingStrategy <span class="operator">=</span> .iso8601</span><br><span class="line"><span class="keyword">let</span> decoder <span class="operator">=</span> <span class="type">JSONDecoder</span>()</span><br><span class="line">decoder.keyDecodingStrategy <span class="operator">=</span> .convertFromSnakeCase</span><br><span class="line">decoder.dateDecodingStrategy <span class="operator">=</span> .iso8601</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="comment">// 4</span></span><br><span class="line">  <span class="keyword">let</span> encodedBaloo <span class="operator">=</span> <span class="keyword">try</span> encoder.encode(baloo)</span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">let</span> balooString <span class="operator">=</span> <span class="type">String</span>(data: encodedBaloo, encoding: .utf8) &#123;</span><br><span class="line">    <span class="built_in">print</span>(balooString)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> encodedBagheera <span class="operator">=</span> <span class="keyword">try</span> encoder.encode(bagheera)</span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">let</span> bagheeraString <span class="operator">=</span> <span class="type">String</span>(data: encodedBagheera, encoding: .utf8) &#123;</span><br><span class="line">    <span class="built_in">print</span>(bagheeraString)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 5</span></span><br><span class="line">  <span class="keyword">let</span> decodedBaloo <span class="operator">=</span> <span class="keyword">try</span> decoder.decode(<span class="type">Animal</span>.<span class="keyword">self</span>, from: encodedBaloo)</span><br><span class="line">  <span class="built_in">print</span>(decodedBaloo)</span><br><span class="line">  <span class="keyword">let</span> decodedBagheera <span class="operator">=</span> <span class="keyword">try</span> decoder.decode(<span class="type">Animal</span>.<span class="keyword">self</span>, from: encodedBagheera)</span><br><span class="line">  <span class="built_in">print</span>(decodedBagheera)</span><br><span class="line">&#125; <span class="keyword">catch</span> <span class="keyword">let</span> error &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Error occurred: <span class="subst">\(error.localizedDescription)</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="第五章：Codable-Routing"><a href="#第五章：Codable-Routing" class="headerlink" title="第五章：Codable Routing"></a>第五章：Codable Routing</h2><p>Codable Routing支持以完全类型安全的方式在你的应用程序的结构和类以及HTTP请求和响应中使用的正文数据之间自动转换。 它大大减少了构建路由处理程序时需要编写的代码，并使Kitura能够代表你执行数据验证和错误处理。</p>
<p>看Model和Route的实现：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">JournalEntry</span>: <span class="title class_">Codable</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> id: <span class="type">String</span>?</span><br><span class="line">  <span class="keyword">var</span> emoji: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> date: <span class="type">Date</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> LoggerAPI</span><br><span class="line"><span class="keyword">import</span> Kitura</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> entries: [<span class="type">JournalEntry</span>] <span class="operator">=</span> []</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">initializeEntryRoutes</span>(<span class="params">app</span>: <span class="type">App</span>) &#123;</span><br><span class="line">  app.router.get(<span class="string">&quot;/entries&quot;</span>, handler: getAllEntries)</span><br><span class="line">  app.router.post(<span class="string">&quot;/entries&quot;</span>, handler: addEntry)</span><br><span class="line">  app.router.delete(<span class="string">&quot;/entries&quot;</span>, handler: deleteEntry)</span><br><span class="line">  <span class="type">Log</span>.info(<span class="string">&quot;Journal entry routes created&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">addEntry</span>(<span class="params">entry</span>: <span class="type">JournalEntry</span>, <span class="params">completion</span>: <span class="keyword">@escaping</span> (<span class="type">JournalEntry</span>?, <span class="type">RequestError</span>?) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> storedEntry <span class="operator">=</span> entry</span><br><span class="line">  storedEntry.id <span class="operator">=</span> entries.count.value</span><br><span class="line">  entries.append(storedEntry)</span><br><span class="line">  completion(storedEntry, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">getAllEntries</span>(<span class="params">completion</span>: <span class="keyword">@escaping</span> ([<span class="type">JournalEntry</span>]<span class="operator">?</span>, <span class="type">RequestError</span>?) -&gt; <span class="type">Void</span>) -&gt; <span class="type">Void</span> &#123;</span><br><span class="line">  completion(entries, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">deleteEntry</span>(<span class="params">id</span>: <span class="type">String</span>, <span class="params">completion</span>: <span class="keyword">@escaping</span> (<span class="type">RequestError</span>?) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">  <span class="keyword">guard</span> <span class="keyword">let</span> index <span class="operator">=</span> entries.index(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> id &#125;) <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> completion(.notFound)</span><br><span class="line">  &#125;</span><br><span class="line">  entries.remove(at: index)</span><br><span class="line">  completion(<span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Codable Routing的一个独特功能是它只需要你在处理函数中定义你希望从请求中接收的值，以及你将通过完成处理程序添加到响应中的值。</p>
<blockquote>
<p>目前，Kitura仅支持从<code>application/json</code>解码。 这意味着，实际上，Content-Type当前必须始终设置为<code>application/json</code>。 但是，Kitura团队计划在即将发布的版本中支持其他编码类型。</p>
</blockquote>
<h2 id="第六章：OpenAPI规范"><a href="#第六章：OpenAPI规范" class="headerlink" title="第六章：OpenAPI规范"></a>第六章：OpenAPI规范</h2><h3 id="Swagger的目标"><a href="#Swagger的目标" class="headerlink" title="Swagger的目标"></a>Swagger的目标</h3><p>在Tony Tam开创性的开源项目的基础上，其他公司开始做出贡献。 最终，Linux基金会承担了该项目的赞助，并将其名称更改为OpenAPI Initiative。 这种广泛的支持使OpenAPI规范在开源软件开发中占据了非常突出的位置。</p>
<p>当Tony开始研究Swagger API项目时，他确定了三个关键目标：</p>
<ul>
<li>API开发</li>
<li>API文档</li>
<li>API交互</li>
</ul>
<h3 id="生成你的规格"><a href="#生成你的规格" class="headerlink" title="生成你的规格"></a>生成你的规格</h3><p>通过添加<code>Kitura-OpenAPI</code>依赖</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.package(url: <span class="string">&quot;https://github.com/IBM-Swift/Kitura-OpenAPI.git&quot;</span>, from: <span class="string">&quot;1.1.1&quot;</span>),</span><br></pre></td></tr></table></figure>

<p> 运行后</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8080/openapi">http://localhost:8080/openapi</a></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;schemes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;http&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;swagger&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;info&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;title&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Kitura Project&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Generated by Kitura&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;paths&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;\/entries&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;get&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;responses&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;200&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;schema&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;type&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;array&quot;</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;items&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;$ref&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;#\/definitions\/JournalEntry&quot;</span></span><br><span class="line">              <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;successful response&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;consumes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;produces&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;post&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;consumes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;produces&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;responses&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;200&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;schema&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;$ref&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;#\/definitions\/JournalEntry&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;successful response&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;parameters&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;in&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;body&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;input&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;required&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;schema&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;$ref&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;#\/definitions\/JournalEntry&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;\/health&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;get&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;responses&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;200&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;schema&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;$ref&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;#\/definitions\/Status&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;successful response&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;consumes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;produces&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;\/entries\/&#123;id&#125;&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;delete&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;consumes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;produces&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;application\/json&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;responses&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;200&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;successful response&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;parameters&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;in&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;path&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;id&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;required&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;basePath&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;\/&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;definitions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;JournalEntry&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;object&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;required&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;date&quot;</span><span class="punctuation">,</span><span class="string">&quot;emoji&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;emoji&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;number&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Status&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;object&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;required&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;status&quot;</span><span class="punctuation">,</span><span class="string">&quot;details&quot;</span><span class="punctuation">,</span><span class="string">&quot;timestamp&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;details&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;items&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;array&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;timestamp&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>此代码段的顶部表示你正在查看路径<code>/entries</code>的GET路由。 三个子节点描述了这条路线：</p>
<ul>
<li><p>“responses”提供用户可以接收的一系列响应。</p>
</li>
<li><p>“consumes”指定必须给出此方法的数据类型。</p>
</li>
<li><p>“produces”描述响应将包含的数据类型。</p>
</li>
</ul>
<h3 id="使用Kitura-OpenAPI-UI"><a href="#使用Kitura-OpenAPI-UI" class="headerlink" title="使用Kitura OpenAPI UI"></a>使用Kitura OpenAPI UI</h3><p>同步生成的还有UI调试界面</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8080/openapi/ui">http://localhost:8080/openapi/ui</a></p>
<p><img src="https://gewill.org/assets/image-20190807140446505.png" alt="image-20190807140446505"></p>
<p>这对于你需要进行快速而肮脏的测试的情况非常有用 - 或者如果你无法让顽固的队友相信这个模块真的有用！</p>
<h3 id="为你的iOS应用生成SDK"><a href="#为你的iOS应用生成SDK" class="headerlink" title="为你的iOS应用生成SDK"></a>为你的iOS应用生成SDK</h3><p>终端运行，即可生成SDK，一个功能齐全的Swift SDK，可以处理与此特定服务器的所有网络通信。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker pull swaggerapi/swagger-codegen-cli</span><br><span class="line">docker run --<span class="built_in">rm</span> -v <span class="variable">$&#123;PWD&#125;</span>:/local swaggerapi/swagger-codegen-cli langs</span><br><span class="line"><span class="built_in">mkdir</span> GeneratedSDK </span><br><span class="line"><span class="built_in">touch</span> specification.json </span><br><span class="line">//  复制http://localhost:8080/openapi的内容到specification.json</span><br><span class="line">docker run --<span class="built_in">rm</span> -v <span class="variable">$&#123;PWD&#125;</span>:/local swaggerapi/swagger-codegen-cli generate -i /local/specification.json -l swift -o /local/GeneratedSDK</span><br></pre></td></tr></table></figure>

<p>在实践中，这不仅可以节省时间并让你快速启动和运行，还可以节省错误，并且对于那些没有（喘气）在Swift工作的人来说尤其有用！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/08/01/Data-Structures-and-Algorithms-in-Swift-Notes-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/08/01/Data-Structures-and-Algorithms-in-Swift-Notes-1/" class="post-title-link" itemprop="url">Swift数据结构和算法（一）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-08-01 14:59:59" itemprop="dateCreated datePublished" datetime="2019-08-01T14:59:59+08:00">2019-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="第一部分：引言"><a href="#第一部分：引言" class="headerlink" title="第一部分：引言"></a>第一部分：引言</h2><h3 id="第一章：前言"><a href="#第一章：前言" class="headerlink" title="第一章：前言"></a>第一章：前言</h3><p>数据结构是一门经过充分研究的学科，其概念与语言无关; 来自C的数据结构在功能上和概念上与任何其他语言中的相同数据结构相同，例如Swift。 与此同时，Swift的高级表现力使其成为学习这些核心概念的理想选择，而不会牺牲太多的性能。</p>
<p>Swift标准库有一小组通用集合类型; 他们甚至没有涵盖每一个案例。正如您将看到的，这些 原始的类型可以用作构建更复杂和特殊用途构造的一个很好的起点。 了解比标准数组和字典更多的数据结构，您可以使用更多的工具来构建自己的应用程序。</p>
<h3 id="第二章：Swift标准库"><a href="#第二章：Swift标准库" class="headerlink" title="第二章：Swift标准库"></a>第二章：Swift标准库</h3><p>在开始构建自己的自定义数据结构之前，了解Swift标准库已经提供的主要数据结构非常重要。</p>
<p>字典缺乏明确的排序劣势，却又带来了一些其他的优点。 与数组不同，字典不需要担心元素的转移。 插入字典总是O(1)。 查找操作也在O(1)时间内完成，这比在需要O(n)扫描的数组中找到特定元素要快得多。</p>
<h3 id="第三章：复杂度"><a href="#第三章：复杂度" class="headerlink" title="第三章：复杂度"></a>第三章：复杂度</h3><p>常见的时间复杂度和空间复杂度。</p>
<p>对于计算机，算法的资源是内存。空间复杂度就意味着内存占用率。</p>
<p><strong>总结</strong></p>
<ul>
<li><p>时间复杂度衡量输入大小增加时运行算法所需的时间。</p>
</li>
<li><p>空间复杂度衡量算法运行所需的资源。</p>
</li>
<li><p>Big O表示法用于表示时间和空间复杂性的一般形式。</p>
</li>
<li><p>时间和空间复杂性是可扩展性的高级度量; 它们不测量算法本身的实际速度。</p>
</li>
<li><p>对于小型数据集，时间复杂度通常无关紧要。 拟线性算法可能比线性算法慢。</p>
</li>
</ul>
<h2 id="第二部分：基本数据类型"><a href="#第二部分：基本数据类型" class="headerlink" title="第二部分：基本数据类型"></a>第二部分：基本数据类型</h2><h3 id="第四章：链表"><a href="#第四章：链表" class="headerlink" title="第四章：链表"></a>第四章：链表</h3><p>链表是以线性单向序列排列的值的集合。链表比连续存储选项（如Swift数组）具有几个理论上的优势：</p>
<ul>
<li>从列表前面插入和删除恒定时间。</li>
<li>可靠的性能特征。</li>
</ul>
<p><img src="https://gewill.org/assets/image-20190801154442688.png" alt="image-20190801154442688"></p>
<p>如图所示，链表是一系列节点。 节点有两个职责：</p>
<p>1.保存一个值。</p>
<p>2.保存对下一个节点的引用。 空表示列表的结尾。<img src="https://gewill.org/assets/image-20190801154554314.png" alt="image-20190801154554314"></p>
<p>节点</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;<span class="title class_">Value</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> value: <span class="type">Value</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> next: <span class="type">Node</span>?</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">value</span>: <span class="type">Value</span>, <span class="params">next</span>: <span class="type">Node</span>? <span class="operator">=</span> <span class="literal">nil</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.value <span class="operator">=</span> value</span><br><span class="line">    <span class="keyword">self</span>.next <span class="operator">=</span> next</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>链表</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">LinkedList</span>&lt;<span class="title class_">Value</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> head: <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;?</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> tail: <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;?</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> head <span class="operator">==</span> <span class="literal">nil</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// MARK: - 增加和删除节点的方法</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 时间复杂度：O(1)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">push</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">Value</span>) &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    head <span class="operator">=</span> <span class="type">Node</span>(value: value, next: head)</span><br><span class="line">    <span class="keyword">if</span> tail <span class="operator">==</span> <span class="literal">nil</span> &#123;</span><br><span class="line">      tail <span class="operator">=</span> head</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 时间复杂度：O(1)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">append</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">Value</span>) &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    <span class="keyword">guard</span> <span class="operator">!</span>isEmpty <span class="keyword">else</span> &#123;</span><br><span class="line">      push(value)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    tail<span class="operator">!</span>.next <span class="operator">=</span> <span class="type">Node</span>(value: value)</span><br><span class="line">    tail <span class="operator">=</span> tail<span class="operator">!</span>.next</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 时间复杂度：O(i) , i 就是给定的index</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">node</span>(<span class="params">at</span> <span class="params">index</span>: <span class="type">Int</span>) -&gt; <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;? &#123;</span><br><span class="line">    <span class="keyword">var</span> currentNode <span class="operator">=</span> head</span><br><span class="line">    <span class="keyword">var</span> currentIndex <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> currentNode <span class="operator">!=</span> <span class="literal">nil</span> <span class="operator">&amp;&amp;</span> currentIndex <span class="operator">&lt;</span> index &#123;</span><br><span class="line">      currentNode <span class="operator">=</span> currentNode<span class="operator">!</span>.next</span><br><span class="line">      currentIndex <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> currentNode</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 时间复杂度：O(1)</span></span><br><span class="line">  <span class="keyword">@discardableResult</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">insert</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">Value</span>, <span class="params">after</span> <span class="params">node</span>: <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;) -&gt; <span class="type">Node</span>&lt;<span class="type">Value</span>&gt; &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    <span class="keyword">guard</span> tail <span class="operator">!==</span> node <span class="keyword">else</span> &#123;</span><br><span class="line">      append(value)</span><br><span class="line">      <span class="keyword">return</span> tail<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line">    node.next <span class="operator">=</span> <span class="type">Node</span>(value: value, next: node.next)</span><br><span class="line">    <span class="keyword">return</span> node.next<span class="operator">!</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 时间复杂度：O(1)  </span></span><br><span class="line">  <span class="keyword">@discardableResult</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">pop</span>() -&gt; <span class="type">Value</span>? &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    <span class="keyword">defer</span> &#123;</span><br><span class="line">      head <span class="operator">=</span> head<span class="operator">?</span>.next</span><br><span class="line">      <span class="keyword">if</span> isEmpty &#123;</span><br><span class="line">        tail <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head<span class="operator">?</span>.value</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 时间复杂度：O(n)</span></span><br><span class="line">  <span class="keyword">@discardableResult</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">removeLast</span>() -&gt; <span class="type">Value</span>? &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> head <span class="operator">=</span> head <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">guard</span> head.next <span class="operator">!=</span> <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> pop()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> prev <span class="operator">=</span> head</span><br><span class="line">    <span class="keyword">var</span> current <span class="operator">=</span> head</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> next <span class="operator">=</span> current.next &#123;</span><br><span class="line">      prev <span class="operator">=</span> current</span><br><span class="line">      current <span class="operator">=</span> next</span><br><span class="line">    &#125;</span><br><span class="line">    prev.next <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">    tail <span class="operator">=</span> prev</span><br><span class="line">    <span class="keyword">return</span> current.value</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 时间复杂度：O(1)  </span></span><br><span class="line">  <span class="keyword">@discardableResult</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">remove</span>(<span class="params">after</span> <span class="params">node</span>: <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;) -&gt; <span class="type">Value</span>? &#123;</span><br><span class="line">    copyNodes()</span><br><span class="line">    <span class="keyword">defer</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> node.next <span class="operator">===</span> tail &#123;</span><br><span class="line">        tail <span class="operator">=</span> node</span><br><span class="line">      &#125;</span><br><span class="line">      node.next <span class="operator">=</span> node.next<span class="operator">?</span>.next</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> node.next<span class="operator">?</span>.value</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// MARK: - 实现值类型和写入时复制</span></span><br><span class="line">  <span class="comment">//使用COW实现价值语义的策略非常简单。在改变链接列表的内容之前，您希望执行底层存储的副本并将所有引用（头部和尾部）更新为新副本。</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">copyNodes</span>() &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="operator">!</span><span class="built_in">isKnownUniquelyReferenced</span>(<span class="operator">&amp;</span>head) <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">var</span> oldNode <span class="operator">=</span> head <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    head <span class="operator">=</span> <span class="type">Node</span>(value: oldNode.value)</span><br><span class="line">    <span class="keyword">var</span> newNode <span class="operator">=</span> head</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> nextOldNode <span class="operator">=</span> oldNode.next &#123;</span><br><span class="line">      newNode<span class="operator">!</span>.next <span class="operator">=</span> <span class="type">Node</span>(value: nextOldNode.value)</span><br><span class="line">      newNode <span class="operator">=</span> newNode<span class="operator">!</span>.next</span><br><span class="line">      oldNode <span class="operator">=</span> nextOldNode</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    tail <span class="operator">=</span> newNode</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - 实现Swift的Collection协议</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Swift Collection还允许通过下标进行访问，这是一个很好的术语，用于表示索引可以映射到集合中的值。</span></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">LinkedList</span>: <span class="title class_">Collection</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">Index</span>: <span class="title class_">Comparable</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> node: <span class="type">Node</span>&lt;<span class="type">Value</span>&gt;?</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">==</span>(<span class="params">lhs</span>: <span class="type">Index</span>, <span class="params">rhs</span>: <span class="type">Index</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">      <span class="keyword">switch</span> (lhs.node, rhs.node) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="keyword">let</span> (left<span class="operator">?</span>, right<span class="operator">?</span>):</span><br><span class="line">        <span class="keyword">return</span> left.next <span class="operator">===</span> right.next</span><br><span class="line">      <span class="keyword">case</span> (<span class="literal">nil</span>, <span class="literal">nil</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">&lt;</span>(<span class="params">lhs</span>: <span class="type">Index</span>, <span class="params">rhs</span>: <span class="type">Index</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">      <span class="keyword">guard</span> lhs <span class="operator">!=</span> rhs <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">let</span> nodes <span class="operator">=</span> <span class="built_in">sequence</span>(first: lhs.node) &#123; <span class="variable">$0</span><span class="operator">?</span>.next &#125;</span><br><span class="line">      <span class="keyword">return</span> nodes.contains &#123; <span class="variable">$0</span> <span class="operator">===</span> rhs.node &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> startIndex: <span class="type">Index</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Index</span>(node: head)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> endIndex: <span class="type">Index</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Index</span>(node: tail<span class="operator">?</span>.next)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">index</span>(<span class="params">after</span> <span class="params">i</span>: <span class="type">Index</span>) -&gt; <span class="type">Index</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Index</span>(node: i.node<span class="operator">?</span>.next)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">subscript</span>(<span class="params">position</span>: <span class="type">Index</span>) -&gt; <span class="type">Value</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> position.node<span class="operator">!</span>.value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>关键点</strong></p>
<ul>
<li>链接列表是线性和单向的。 只要将引用从一个节点移动到另一个节点，就无法返回。</li>
<li>链接列表的头部第一次插入具有O(1)时间复杂度。 对于头部第一次插入，数组有O(n)时间复杂度。</li>
<li>符合Swift收集协议（如序列和集合），可为相当少的要求提供一系列有用的方法。</li>
<li>写时复制行为使您可以实现值语义。</li>
</ul>
<h3 id="第五章：链表挑战"><a href="#第五章：链表挑战" class="headerlink" title="第五章：链表挑战"></a>第五章：链表挑战</h3><h4 id="逆序打印所有节点元素"><a href="#逆序打印所有节点元素" class="headerlink" title="逆序打印所有节点元素"></a>逆序打印所有节点元素</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">printInReverse</span>&lt;<span class="type">T</span>&gt;(<span class="keyword">_</span> <span class="params">list</span>: <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;) &#123;</span><br><span class="line">  <span class="comment">//巧妙的递归：先迭代后打印，这样打印的就是逆序了</span></span><br><span class="line">  printInReverse(list.head)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">printInReverse</span>&lt;<span class="type">T</span>&gt;(<span class="keyword">_</span> <span class="params">node</span>: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?) &#123;</span><br><span class="line">  <span class="keyword">guard</span> <span class="keyword">let</span> node <span class="operator">=</span> node <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">  printInReverse(node.next)</span><br><span class="line">  <span class="built_in">print</span>(node.value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="取中间节点"><a href="#取中间节点" class="headerlink" title="取中间节点"></a>取中间节点</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">getMiddle</span>&lt;<span class="type">T</span>&gt;(<span class="keyword">_</span> <span class="params">list</span>: <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;) -&gt; <span class="type">Node</span>&lt;<span class="type">T</span>&gt;? &#123;</span><br><span class="line">  	<span class="comment">//两个步长差一倍，这样快的遍历到终点，慢的刚好到中间</span></span><br><span class="line">    <span class="keyword">var</span> fast <span class="operator">=</span> list.head</span><br><span class="line">    <span class="keyword">var</span> slow <span class="operator">=</span> list.head</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> nextFast <span class="operator">=</span> fast<span class="operator">?</span>.next &#123;</span><br><span class="line">        fast <span class="operator">=</span> nextFast.next</span><br><span class="line">        slow <span class="operator">=</span> slow<span class="operator">?</span>.next</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> slow</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="反转链表"><a href="#反转链表" class="headerlink" title="反转链表"></a>反转链表</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">LinkedList</span> &#123;</span><br><span class="line">    <span class="comment">// 不断的分割链表，从头部开始，下一步时把之前分割的节点拼接在新的节点之后。</span></span><br><span class="line">    <span class="comment">// 如此遍历到底，就实现了逆序。</span></span><br><span class="line">    <span class="comment">// 核心思路：把每个节点的前节点变成后节点，同时通过遍历时分割成2~3个分段。</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">reverse</span>() &#123;</span><br><span class="line">        tail <span class="operator">=</span> head</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> current <span class="operator">=</span> head<span class="operator">?</span>.next</span><br><span class="line">        <span class="comment">//  临时存储逆序的链表</span></span><br><span class="line">        <span class="keyword">var</span> prev <span class="operator">=</span> head</span><br><span class="line">        prev<span class="operator">?</span>.next <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> current <span class="operator">!=</span> <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> next <span class="operator">=</span> current<span class="operator">?</span>.next</span><br><span class="line">            current<span class="operator">?</span>.next <span class="operator">=</span> prev</span><br><span class="line">            prev <span class="operator">=</span> current</span><br><span class="line">            current <span class="operator">=</span> next</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        head <span class="operator">=</span> prev</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="合并两个已经排序好的链表"><a href="#合并两个已经排序好的链表" class="headerlink" title="合并两个已经排序好的链表"></a>合并两个已经排序好的链表</h4><p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// list1 1 -&gt; 4 -&gt; 10 -&gt; 11</span><br><span class="line"></span><br><span class="line">// list2 -1 -&gt; 2 -&gt; 3 -&gt; 6</span><br><span class="line"></span><br><span class="line">// merged list -1 -&gt; 1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 6 -&gt; 10 -&gt; 11</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">mergeSorted</span>&lt;<span class="type">T</span>: <span class="type">Comparable</span>&gt;(<span class="keyword">_</span> <span class="params">left</span>: <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;,</span><br><span class="line">                                <span class="keyword">_</span> <span class="params">right</span>: <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;) -&gt; <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="operator">!</span>left.isEmpty <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> right</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">guard</span> <span class="operator">!</span>right.isEmpty <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> left</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义新的链表的首尾</span></span><br><span class="line">    <span class="keyword">var</span> newHead: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">    <span class="keyword">var</span> tail: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 原有链表的游标，后面以此遍历</span></span><br><span class="line">    <span class="keyword">var</span> currentLeft <span class="operator">=</span> left.head</span><br><span class="line">    <span class="keyword">var</span> currentRight <span class="operator">=</span> right.head</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始设置</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> leftNode <span class="operator">=</span> currentLeft, <span class="keyword">let</span> rightNode <span class="operator">=</span> currentRight &#123;</span><br><span class="line">        <span class="keyword">if</span> leftNode.value <span class="operator">&lt;</span> rightNode.value &#123;</span><br><span class="line">            newHead <span class="operator">=</span> leftNode</span><br><span class="line">            currentLeft <span class="operator">=</span> leftNode.next</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            newHead <span class="operator">=</span> rightNode</span><br><span class="line">            currentRight <span class="operator">=</span> rightNode.next</span><br><span class="line">        &#125;</span><br><span class="line">        tail <span class="operator">=</span> newHead</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 遍历</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> leftNode <span class="operator">=</span> currentLeft, <span class="keyword">let</span> rightNode <span class="operator">=</span> currentRight &#123;</span><br><span class="line">        <span class="keyword">if</span> leftNode.value <span class="operator">&lt;</span> rightNode.value &#123;</span><br><span class="line">            tail<span class="operator">?</span>.next <span class="operator">=</span> leftNode</span><br><span class="line">            currentLeft <span class="operator">=</span> leftNode.next</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tail<span class="operator">?</span>.next <span class="operator">=</span> rightNode</span><br><span class="line">            currentRight <span class="operator">=</span> rightNode.next</span><br><span class="line">        &#125;</span><br><span class="line">        tail <span class="operator">=</span> tail<span class="operator">?</span>.next</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> leftNode <span class="operator">=</span> currentLeft &#123;</span><br><span class="line">        tail<span class="operator">?</span>.next <span class="operator">=</span> leftNode</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> rightNode <span class="operator">=</span> currentRight &#123;</span><br><span class="line">        tail<span class="operator">?</span>.next <span class="operator">=</span> rightNode</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理新的链表的首尾</span></span><br><span class="line">    <span class="keyword">var</span> list <span class="operator">=</span> <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;()</span><br><span class="line"></span><br><span class="line">    list.head <span class="operator">=</span> newHead</span><br><span class="line">    <span class="comment">// 找到真的尾部节点</span></span><br><span class="line">    list.tail <span class="operator">=</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">let</span> next <span class="operator">=</span> tail<span class="operator">?</span>.next &#123;</span><br><span class="line">            tail <span class="operator">=</span> next</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> tail</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> list</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="创建一个从链表中删除所有特定元素的函数"><a href="#创建一个从链表中删除所有特定元素的函数" class="headerlink" title="创建一个从链表中删除所有特定元素的函数"></a>创建一个从链表中删除所有特定元素的函数</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">LinkedList</span> <span class="title class_">where</span> <span class="title class_">Value</span>: <span class="title class_">Equatable</span> &#123;</span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">removeAll</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">Value</span>) &#123;</span><br><span class="line">        <span class="comment">// 头部的值相等时单独处理</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">let</span> head <span class="operator">=</span> <span class="keyword">self</span>.head, head.value <span class="operator">==</span> value &#123;</span><br><span class="line">            <span class="keyword">self</span>.head <span class="operator">=</span> head.next</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> current <span class="operator">=</span> head<span class="operator">?</span>.next</span><br><span class="line">        <span class="keyword">var</span> prev <span class="operator">=</span> head</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 遍历</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">let</span> currentNode <span class="operator">=</span> current &#123;</span><br><span class="line">            <span class="keyword">guard</span> currentNode.value <span class="operator">!=</span> value <span class="keyword">else</span> &#123;</span><br><span class="line">                prev<span class="operator">?</span>.next <span class="operator">=</span> currentNode.next</span><br><span class="line">                current <span class="operator">=</span> prev<span class="operator">?</span>.next</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            prev <span class="operator">=</span> current</span><br><span class="line">            current <span class="operator">=</span> current<span class="operator">?</span>.next</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        tail <span class="operator">=</span> prev</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在时间复杂度上优化，所以一般都是2~3个临时变量（牺牲一点空间复杂度）。相当于让更多人协同做一件事情，肯定更快。但是如果是资源有限的时候，比如说雇人做事，总的成本不一定会减少。但是通常情况下，电脑的内存容量是既定的，而且够用的情况下，就要优化时间复杂度，不用吝惜内存。</p>
</blockquote>
<h3 id="第六章：栈"><a href="#第六章：栈" class="headerlink" title="第六章：栈"></a>第六章：栈</h3><p>栈无处不在。 以下是您要栈的一些常见示例：</p>
<ul>
<li>薄煎饼</li>
<li>书籍</li>
<li>纸张</li>
</ul>
<p>在概念上，栈数据结构与物理栈相同。 将项目添加到栈时，将其放在栈顶部。 从栈中删除项目时，始终会删除最顶层的项目。</p>
<h4 id="栈的操作"><a href="#栈的操作" class="headerlink" title="栈的操作"></a>栈的操作</h4><p>栈的操作只有两个：</p>
<ol>
<li>push：将元素添加到栈顶部。</li>
<li>pop：删除栈的顶部元素。</li>
</ol>
<p>这意味着您只能在数据结构的一侧添加或删除元素。在计算机科学中，栈被称为LIFO（后进先出）数据结构。最后推入的元素是第一个被弹出的元素。</p>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//泛型Element为存储的元素</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">Stack</span>&lt;<span class="title class_">Element</span>&gt; &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//内部为数组存储所有元素</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> storage: [<span class="type">Element</span>] <span class="operator">=</span> []</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123; &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">elements</span>: [<span class="type">Element</span>]) &#123;</span><br><span class="line">    storage <span class="operator">=</span> elements</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">push</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">Element</span>) &#123;</span><br><span class="line">    storage.append(element)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@discardableResult</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">pop</span>() -&gt; <span class="type">Element</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> storage.popLast()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">peek</span>() -&gt; <span class="type">Element</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> storage.last</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> peek() <span class="operator">==</span> <span class="literal">nil</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Stack</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> topDivider <span class="operator">=</span> <span class="string">&quot;----top----<span class="subst">\n</span>&quot;</span></span><br><span class="line">    <span class="keyword">let</span> bottomDivider <span class="operator">=</span> <span class="string">&quot;<span class="subst">\n</span>-----------&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> stackElements <span class="operator">=</span> storage</span><br><span class="line">      .map &#123; <span class="string">&quot;<span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span> &#125;</span><br><span class="line">      .reversed()</span><br><span class="line">      .joined(separator: <span class="string">&quot;<span class="subst">\n</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> topDivider <span class="operator">+</span> stackElements <span class="operator">+</span> bottomDivider</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Stack</span>: <span class="title class_">ExpressibleByArrayLiteral</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">arrayLiteral</span> <span class="params">elements</span>: <span class="type">Element</span>...) &#123;</span><br><span class="line">    storage <span class="operator">=</span> elements</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>你可能想知道是否可以为栈采用Swift集合协议。栈的目的是限制访问数据的方式的数量，并采用诸如Collection之类的协议将通过迭代器和下标公开所有元素来违背此目标。在这种情况下，少即是多！</p>
<h3 id="第七章：栈挑战"><a href="#第七章：栈挑战" class="headerlink" title="第七章：栈挑战"></a>第七章：栈挑战</h3><h4 id="逆序打印链表，但是不能用递归"><a href="#逆序打印链表，但是不能用递归" class="headerlink" title="逆序打印链表，但是不能用递归"></a>逆序打印链表，但是不能用递归</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> list: <span class="type">LinkedList</span>&lt;<span class="type">Int</span>&gt; <span class="operator">=</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> list <span class="operator">=</span> <span class="type">LinkedList</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line">  list.push(<span class="number">3</span>)</span><br><span class="line">  list.push(<span class="number">2</span>)</span><br><span class="line">  list.push(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">return</span> list</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">printInReverse</span>&lt;<span class="type">T</span>&gt;(<span class="keyword">_</span> <span class="params">list</span>: <span class="type">LinkedList</span>&lt;<span class="type">T</span>&gt;) &#123;</span><br><span class="line">  <span class="keyword">var</span> current <span class="operator">=</span> list.head</span><br><span class="line">  <span class="keyword">var</span> stack <span class="operator">=</span> <span class="type">Stack</span>&lt;<span class="type">T</span>&gt;()</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">while</span> <span class="keyword">let</span> node <span class="operator">=</span> current &#123;</span><br><span class="line">    stack.push(node.value)</span><br><span class="line">    current <span class="operator">=</span> node.next</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">while</span> <span class="keyword">let</span> value <span class="operator">=</span> stack.pop() &#123;</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">printInReverse(list)</span><br></pre></td></tr></table></figure>

<h4 id="检查括号的匹配"><a href="#检查括号的匹配" class="headerlink" title="检查括号的匹配"></a>检查括号的匹配</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> testString1 <span class="operator">=</span> <span class="string">&quot;h((e))llo(world)()&quot;</span></span><br><span class="line"><span class="keyword">var</span> testString2 <span class="operator">=</span> <span class="string">&quot;(hello world&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">checkParentheses</span>(<span class="keyword">_</span> <span class="params">string</span>: <span class="type">String</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> stack <span class="operator">=</span> <span class="type">Stack</span>&lt;<span class="type">Character</span>&gt;()</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> character <span class="keyword">in</span> string &#123;</span><br><span class="line">    <span class="keyword">if</span> character <span class="operator">==</span> <span class="string">&quot;(&quot;</span> &#123;</span><br><span class="line">      stack.push(character)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> character <span class="operator">==</span> <span class="string">&quot;)&quot;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> stack.isEmpty &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        stack.pop()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> stack.isEmpty</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">checkParentheses(testString1)</span><br><span class="line">checkParentheses(testString2)</span><br></pre></td></tr></table></figure>

<h3 id="第八章：队列"><a href="#第八章：队列" class="headerlink" title="第八章：队列"></a>第八章：队列</h3><p>我们都熟悉排队，无论是买票还是排队打印。</p>
<p>队列使用FIFO或先进先出顺序，这意味着添加的第一个元素将始终是第一个被删除的元素。当您需要维护元素的顺序以便稍后处理时，队列很方便。</p>
<h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><p>让我们先确定队列的协议：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">protocol</span> <span class="title class_">Queue</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">associatedtype</span> <span class="type">Element</span></span><br><span class="line">  <span class="comment">///在队列后面插入一个元素。如果操作成功，则返回true。</span></span><br><span class="line">  <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">enqueue</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">Element</span>) -&gt; <span class="type">Bool</span></span><br><span class="line">  <span class="comment">///删除队列前面的元素并将其返回。</span></span><br><span class="line">  <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">dequeue</span>() -&gt; <span class="type">Element</span>?</span><br><span class="line">  <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">  <span class="keyword">var</span> peek: <span class="type">Element</span>? &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在以下部分中，将以四种不同的方式创建队列：</p>
<ol>
<li>数组</li>
<li>双向列表</li>
<li>环形缓冲区</li>
<li>双栈</li>
</ol>
<h4 id="用数组来实现"><a href="#用数组来实现" class="headerlink" title="用数组来实现"></a>用数组来实现</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">QueueArray</span>&lt;<span class="title class_">T</span>&gt;: <span class="title class_">Queue</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> array: [<span class="type">T</span>] <span class="operator">=</span> []</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> array.isEmpty</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> peek: <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> array.first</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">enqueue</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    array.append(element)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">dequeue</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> isEmpty <span class="operator">?</span> <span class="literal">nil</span> : array.removeFirst()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueArray</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: array)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">QueueArray</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line">queue.enqueue(<span class="string">&quot;Ray&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Brian&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Eric&quot;</span>)</span><br><span class="line">queue</span><br><span class="line">queue.dequeue()</span><br><span class="line">queue</span><br><span class="line">queue.peek</span><br></pre></td></tr></table></figure>

<h5 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h5><h5 id=""><a href="#" class="headerlink" title=""></a><img src="https://gewill.org/assets/image-20190912160423263.png" alt="image-20190912160423263"></h5><p>很明显只有<code>enqueue</code>是O(1)，其他都是O(n)。</p>
<h4 id="用双向链表来实现"><a href="#用双向链表来实现" class="headerlink" title="用双向链表来实现"></a>用双向链表来实现</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QueueLinkedList</span>&lt;<span class="title class_">T</span>&gt;: <span class="title class_">Queue</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> list <span class="operator">=</span> <span class="type">DoublyLinkedList</span>&lt;<span class="type">T</span>&gt;()</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">enqueue</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    list.append(element)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">dequeue</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="operator">!</span>list.isEmpty, <span class="keyword">let</span> element <span class="operator">=</span> list.first <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list.remove(element)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> peek: <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> list.first<span class="operator">?</span>.value</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> list.isEmpty</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueLinkedList</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: list)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">QueueLinkedList</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line">queue.enqueue(<span class="string">&quot;Ray&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Brian&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Eric&quot;</span>)</span><br><span class="line">queue</span><br><span class="line">queue.dequeue()</span><br><span class="line">queue</span><br><span class="line">queue.peek</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - DoublyLinkedList</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;<span class="title class_">T</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> value: <span class="type">T</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> next: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> previous: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">value</span>: <span class="type">T</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.value <span class="operator">=</span> value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Node</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DoublyLinkedList</span>&lt;<span class="title class_">T</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> head: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> tail: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123; &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> head <span class="operator">==</span> <span class="literal">nil</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> first: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;? &#123;</span><br><span class="line">    <span class="keyword">return</span> head</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">append</span>(<span class="keyword">_</span> <span class="params">value</span>: <span class="type">T</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> newNode <span class="operator">=</span> <span class="type">Node</span>(value: value)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> tailNode <span class="operator">=</span> tail <span class="keyword">else</span> &#123;</span><br><span class="line">      head <span class="operator">=</span> newNode</span><br><span class="line">      tail <span class="operator">=</span> newNode</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    newNode.previous <span class="operator">=</span> tailNode</span><br><span class="line">    tailNode.next <span class="operator">=</span> newNode</span><br><span class="line">    tail <span class="operator">=</span> newNode</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">remove</span>(<span class="keyword">_</span> <span class="params">node</span>: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;) -&gt; <span class="type">T</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> prev <span class="operator">=</span> node.previous</span><br><span class="line">    <span class="keyword">let</span> next <span class="operator">=</span> node.next</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> prev <span class="operator">=</span> prev &#123;</span><br><span class="line">      prev.next <span class="operator">=</span> next</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      head <span class="operator">=</span> next</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    next<span class="operator">?</span>.previous <span class="operator">=</span> prev</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> next <span class="operator">==</span> <span class="literal">nil</span> &#123;</span><br><span class="line">      tail <span class="operator">=</span> prev</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    node.previous <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">    node.next <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> node.value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">DoublyLinkedList</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> string <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">var</span> current <span class="operator">=</span> head</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> node <span class="operator">=</span> current &#123;</span><br><span class="line">      string.append(<span class="string">&quot;<span class="subst">\(node.value)</span> -&gt; &quot;</span>)</span><br><span class="line">      current <span class="operator">=</span> node.next</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> string <span class="operator">+</span> <span class="string">&quot;end&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedListIterator</span>&lt;<span class="title class_">T</span>&gt;: <span class="title class_">IteratorProtocol</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> current: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">init</span>(<span class="params">node</span>: <span class="type">Node</span>&lt;<span class="type">T</span>&gt;?) &#123;</span><br><span class="line">    current <span class="operator">=</span> node</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">next</span>() -&gt; <span class="type">Node</span>&lt;<span class="type">T</span>&gt;? &#123;</span><br><span class="line">    <span class="keyword">defer</span> &#123; current <span class="operator">=</span> current<span class="operator">?</span>.next &#125;</span><br><span class="line">    <span class="keyword">return</span> current</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">DoublyLinkedList</span>: <span class="title class_">Sequence</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">makeIterator</span>() -&gt; <span class="type">LinkedListIterator</span>&lt;<span class="type">T</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">LinkedListIterator</span>(node: head)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="优缺点-1"><a href="#优缺点-1" class="headerlink" title="优缺点"></a>优缺点<img src="https://gewill.org/assets/image-20190912161101034.png" alt="image-20190912161101034"></h5><p>出来空间复杂度是O(n)，其他的都是O(1)。</p>
<p>双向列表的主要弱点在表中并不明显。尽管有O(1)的性能，但它的开销很高。每个元素都必须有额外的存储空间用于前向和后向引用。而且，每次创建新元素时，都需要相对昂贵的动态分配。相比之下，数组进行批量分配，速度更快。</p>
<h4 id="用环形缓冲区来实现"><a href="#用环形缓冲区来实现" class="headerlink" title="用环形缓冲区来实现"></a>用环形缓冲区来实现</h4><p>环形缓冲区，也称为循环缓冲区，是固定大小的阵列。当最终没有更多项目需要删除时，这种数据结构战略性地包含在开头。</p>
<p>详见：[<a target="_blank" rel="noopener" href="https://github.com/raywenderlich/swift-algorithm-club/tree/master/Ring%20Buffer]">https://github.com/raywenderlich/swift-algorithm-club/tree/master/Ring%20Buffer]</a>(<a target="_blank" rel="noopener" href="https://github.com/raywenderlich/swift-algorithm-club/tree/master/Ring">https://github.com/raywenderlich/swift-algorithm-club/tree/master/Ring</a> Buffer)</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">QueueRingBuffer</span>&lt;<span class="title class_">T</span>&gt;: <span class="title class_">Queue</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> ringBuffer: <span class="type">RingBuffer</span>&lt;<span class="type">T</span>&gt;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">count</span>: <span class="type">Int</span>) &#123;</span><br><span class="line">    ringBuffer <span class="operator">=</span> <span class="type">RingBuffer</span>&lt;<span class="type">T</span>&gt;(count: count)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> ringBuffer.isEmpty</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> peek: <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> ringBuffer.first</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">enqueue</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> ringBuffer.write(element)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">dequeue</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> isEmpty <span class="operator">?</span> <span class="literal">nil</span> : ringBuffer.read()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueRingBuffer</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: ringBuffer)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">QueueRingBuffer</span>&lt;<span class="type">String</span>&gt;(count: <span class="number">10</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Ray&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Brian&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Eric&quot;</span>)</span><br><span class="line">queue</span><br><span class="line">queue.dequeue()</span><br><span class="line">queue</span><br><span class="line">queue.peek</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - RingBuffer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">RingBuffer</span>&lt;<span class="title class_">T</span>&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> array: [<span class="type">T</span>?]</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> readIndex <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> writeIndex <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">count</span>: <span class="type">Int</span>) &#123;</span><br><span class="line">    array <span class="operator">=</span> <span class="type">Array</span>&lt;<span class="type">T</span>?&gt;(repeating: <span class="literal">nil</span>, count: count)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> first: <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> array[readIndex]</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">write</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="operator">!</span>isFull &#123;</span><br><span class="line">      array[writeIndex <span class="operator">%</span> array.count] <span class="operator">=</span> element</span><br><span class="line">      writeIndex <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">read</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="operator">!</span>isEmpty &#123;</span><br><span class="line">      <span class="keyword">let</span> element <span class="operator">=</span> array[readIndex <span class="operator">%</span> array.count]</span><br><span class="line">      readIndex <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">      <span class="keyword">return</span> element</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> availableSpaceForReading: <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> writeIndex <span class="operator">-</span> readIndex</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> availableSpaceForReading <span class="operator">==</span> <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> availableSpaceForWriting: <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> array.count <span class="operator">-</span> availableSpaceForReading</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isFull: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> availableSpaceForWriting <span class="operator">==</span> <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">RingBuffer</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> values <span class="operator">=</span> (<span class="number">0</span><span class="operator">..&lt;</span>availableSpaceForReading).map &#123;</span><br><span class="line">      <span class="type">String</span>(describing: array[(<span class="variable">$0</span> <span class="operator">+</span> readIndex) <span class="operator">%</span> array.count]<span class="operator">!</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;[&quot;</span> <span class="operator">+</span> values.joined(separator: <span class="string">&quot;, &quot;</span>) <span class="operator">+</span> <span class="string">&quot;]&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="优缺点-2"><a href="#优缺点-2" class="headerlink" title="优缺点"></a>优缺点</h5><p><img src="https://gewill.org/assets/image-20190912162139308.png" alt="image-20190912162139308"></p>
<p>基于环缓冲区的队列具有与链表实现相同的入队和出队时间复杂度。唯一的区别是空间复杂性。环形缓冲区具有固定大小，这意味着入队可能会失败。</p>
<h4 id="用双栈来实现"><a href="#用双栈来实现" class="headerlink" title="用双栈来实现"></a>用双栈来实现</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">QueueStack</span>&lt;<span class="title class_">T</span>&gt; : <span class="title class_">Queue</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> leftStack: [<span class="type">T</span>] <span class="operator">=</span> []</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> rightStack: [<span class="type">T</span>] <span class="operator">=</span> []</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>() &#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> leftStack.isEmpty <span class="operator">&amp;&amp;</span> rightStack.isEmpty</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> peek: <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="operator">!</span>leftStack.isEmpty <span class="operator">?</span> leftStack.last : rightStack.first</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">enqueue</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    rightStack.append(element)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">dequeue</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">if</span> leftStack.isEmpty &#123;</span><br><span class="line">      leftStack <span class="operator">=</span> rightStack.reversed()</span><br><span class="line">      rightStack.removeAll()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> leftStack.popLast()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueStack</span>: <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> printList <span class="operator">=</span> leftStack.reversed() <span class="operator">+</span> rightStack</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: printList)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> queue <span class="operator">=</span> <span class="type">QueueStack</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line">queue.enqueue(<span class="string">&quot;Ray&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Brian&quot;</span>)</span><br><span class="line">queue.enqueue(<span class="string">&quot;Eric&quot;</span>)</span><br><span class="line">queue</span><br><span class="line">queue.dequeue()</span><br><span class="line">queue</span><br><span class="line">queue.peek</span><br></pre></td></tr></table></figure>

<p>出队：<img src="https://gewill.org/assets/image-20190912162831309.png" alt="image-20190912162831309"></p>
<p>入队：</p>
<p>![image-20190912162918069](&#x2F;Users&#x2F;will&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20190912162918069.png)</p>
<h5 id="优缺点-3"><a href="#优缺点-3" class="headerlink" title="优缺点"></a>优缺点</h5><h5 id="image-20190912163001741-x2F-Users-x2F-will-x2F-Library-x2F-Application-Support-x2F-typora-user-images-x2F-image-20190912163001741-png"><a href="#image-20190912163001741-x2F-Users-x2F-will-x2F-Library-x2F-Application-Support-x2F-typora-user-images-x2F-image-20190912163001741-png" class="headerlink" title="![image-20190912163001741](&#x2F;Users&#x2F;will&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20190912163001741.png)"></a>![image-20190912163001741](&#x2F;Users&#x2F;will&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20190912163001741.png)</h5><p>与基于数组的实现相比，通过利用两个堆栈，您可以将<code>dequeue(_ :)</code>转换为分摊的O(1)操作。</p>
<p>此外，您的双栈实现是完全动态的，并且没有基于环形缓冲区的队列实现所具有的固定大小限制。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ul>
<li><p>队列采用FIFO策略，首先必须先删除添加的元素。</p>
</li>
<li><p>Enqueue将元素插入队列的后面。</p>
</li>
<li><p>Dequeue删除队列前面的元素。</p>
</li>
<li><p>数组中的元素在连续的内存块中布局，而链表中的元素更加分散，可能存在缓存未命中。</p>
</li>
<li><p>基于环路缓冲区队列的实现适用于具有固定大小的队列。</p>
</li>
<li><p>与其他数据结构相比，利用两个栈可以将出列<code>dequeue(_ :)</code>时间复杂度提高到摊销的O(1)操作。</p>
</li>
<li><p>双栈实现在空间复杂度方面击败了链表。</p>
</li>
</ul>
<h3 id="第九章：队列挑战"><a href="#第九章：队列挑战" class="headerlink" title="第九章：队列挑战"></a>第九章：队列挑战</h3><h4 id="解释栈和队列之间的区别"><a href="#解释栈和队列之间的区别" class="headerlink" title="解释栈和队列之间的区别"></a>解释栈和队列之间的区别</h4><p>为每个数据结构提供两个实际示例。</p>
<h4 id="画逐步图表"><a href="#画逐步图表" class="headerlink" title="画逐步图表"></a>画逐步图表</h4><p>演示四种实现时，每一步对队列的有影响。</p>
<p>如队列为：”SWIFT”</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">enqueue(<span class="string">&quot;R&quot;</span>) </span><br><span class="line">enqueue(<span class="string">&quot;O&quot;</span>) </span><br><span class="line">dequeue() </span><br><span class="line">enqueue(<span class="string">&quot;C&quot;</span>) </span><br><span class="line">dequeue() </span><br><span class="line">dequeue() </span><br><span class="line">enqueue(<span class="string">&quot;K&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="给队列添加next协议"><a href="#给队列添加next协议" class="headerlink" title="给队列添加next协议"></a>给队列添加<code>next</code>协议</h4><p>用来大富翁游戏，指派下一个玩家</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">protocol</span> <span class="title class_">BoardGameManager</span> &#123;</span><br><span class="line">  <span class="keyword">associatedtype</span> <span class="type">Player</span></span><br><span class="line">  <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">nextPlayer</span>() -&gt; <span class="type">Player</span>?</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueArray</span>: <span class="title class_">BoardGameManager</span> &#123;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">typealias</span> <span class="type">Player</span> <span class="operator">=</span> <span class="type">T</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">nextPlayer</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> person <span class="operator">=</span> dequeue() <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    enqueue(person)</span><br><span class="line">    <span class="keyword">return</span> person</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="逆序排列队列"><a href="#逆序排列队列" class="headerlink" title="逆序排列队列"></a>逆序排列队列</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">QueueArray</span> &#123;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">reversed</span>() -&gt; <span class="type">QueueArray</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> queue <span class="operator">=</span> <span class="keyword">self</span></span><br><span class="line">    <span class="keyword">var</span> stack <span class="operator">=</span> <span class="type">Stack</span>&lt;<span class="type">T</span>&gt;()</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> element <span class="operator">=</span> queue.dequeue() &#123;</span><br><span class="line">      stack.push(element)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> element <span class="operator">=</span> stack.pop() &#123;</span><br><span class="line">      queue.enqueue(element)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> queue</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/06/26/Advanced-Apple-Debugging-and-Reverse-Engineering-Notes-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/06/26/Advanced-Apple-Debugging-and-Reverse-Engineering-Notes-1/" class="post-title-link" itemprop="url">苹果调试和逆向工程进阶-笔记（一）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-06-26 10:32:44" itemprop="dateCreated datePublished" datetime="2019-06-26T10:32:44+08:00">2019-06-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>写这本书的目的</p>
<p>每个开发人员都应该研究调试代码的艺术。 但是，有些人会从本书中获得更多。 本书是为：</p>
<ol>
<li><p>希望更好地使用LLDB进行调试的开发人员</p>
</li>
<li><p>希望使用LLDB构建复杂调试命令的开发人员</p>
</li>
<li><p>希望深入了解Swift和Objective-C内部的开发人员</p>
</li>
<li><p>有兴趣了解：通过逆向工程，他们可以做些什么的开发人员</p>
</li>
<li><p>对现代主动逆向工程策略感兴趣的开发人员</p>
</li>
<li><p>希望在发现有关其计算机或软件问题的答案时有所帮助的开发人员</p>
</li>
</ol>
<p>自定义LLDB脚本repo:</p>
<p><a target="_blank" rel="noopener" href="https://github.com/DerekSelander/LLDB">https://github.com/DerekSelander/LLDB</a></p>
<p>这些脚本将有助于您的调试&#x2F;逆向工程，并为您自己的LLDB脚本提供新颖的想法。</p>
<h2 id="第一节：开始LLDB命令"><a href="#第一节：开始LLDB命令" class="headerlink" title="第一节：开始LLDB命令"></a>第一节：开始LLDB命令</h2><p>到本节结束时，您将能够使用调试器来执行调试所需的大多数基本任务，以及创建自己的简单自定义命令</p>
<h3 id="第1章：入门"><a href="#第1章：入门" class="headerlink" title="第1章：入门"></a>第1章：入门</h3><p>想知道为什么命令是po？ po代表打印对象。 还有p，它只是打印RDI的内容。 po通常更有用，因为它提供了NSObject的描述或debugDescription方法（如果可用）。</p>
<p>如果您想将调试提升到一个新的水平，汇编（Assembly）是一项重要的技能。</p>
<p>它可以让您深入了解Apple的代码 - 即使您没有任何源代码可供阅读。 它将使您更好地了解Swift编译器团队如何使用Swift在Objective-C中跳出，并且它将使您更好地了解Apple设备上的一切是如何工作的。</p>
<p>如果可以，我将始终选择在调试器中使用Objective-C，因为使用Objective-C LLDB比使用Swift更稳定。</p>
<h3 id="第2章：Help和Apropos"><a href="#第2章：Help和Apropos" class="headerlink" title="第2章：Help和Apropos"></a>第2章：Help和Apropos</h3><p><code>help</code>将转储(dump)所有可用的命令，包括从〜&#x2F; .lldbinit加载的自定义命令。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) help breakpoint</span><br></pre></td></tr></table></figure>

<p><code>apropos</code>命令可以为您执行此操作;这有点像使用搜索引擎在网络上找到一些东西。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) apropos swift</span><br></pre></td></tr></table></figure>

<h3 id="第3章：使用LLDB-Attaching"><a href="#第3章：使用LLDB-Attaching" class="headerlink" title="第3章：使用LLDB Attaching"></a>第3章：使用LLDB Attaching</h3><p>LLDB“Attaching”的短语实际上有点误导。 名为debugserver(位于Xcode.app&#x2F;Contents&#x2F;SharedFrameworks&#x2F;LLDB.framework&#x2F;Resources&#x2F;)的程序负责附加(attaching)到目标进程。</p>
<p>如果它是远程进程，例如在远程设备上运行的iOS，watchOS或tvOS应用程序，则会在该远程设备上启动远程调试服务器。 LLDB的工作是启动，连接和协调调试服务器，以处理调试应用程序时的所有交互。</p>
<h4 id="附加到现有进程"><a href="#附加到现有进程" class="headerlink" title="附加到现有进程"></a>附加到现有进程</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lldb -n Xcode</span><br></pre></td></tr></table></figure>

<h4 id="附加到未来的进程"><a href="#附加到未来的进程" class="headerlink" title="附加到未来的进程"></a>附加到未来的进程</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lldb -n Finder -w</span><br></pre></td></tr></table></figure>

<h4 id="launch可选的参数"><a href="#launch可选的参数" class="headerlink" title="launch可选的参数"></a>launch可选的参数</h4><p>这告诉LLDB使用<code>/bin/ls</code>（文件列表命令）作为目标可执行文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lldb -f /bin/ls</span><br></pre></td></tr></table></figure>



<p>使用 process 的选项 <code>-w</code> 更改工作目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) process launch -w /Applications</span><br></pre></td></tr></table></figure>



<p>直接传递参数给<code>程序</code>，也就是<code>/bin/ls</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) process launch -- /Applications</span><br></pre></td></tr></table></figure>

<p>等价于</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ls /Applications</span><br></pre></td></tr></table></figure>



<p><code>-X</code>选项可扩展您提供的任何shell参数，例如代字号。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) process launch -X true -- ~/Desktop</span><br></pre></td></tr></table></figure>

<p><code>run</code> 是 <code>process launch -X true —</code>的缩写，所以</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run ~/Desktop</span><br></pre></td></tr></table></figure>



<p>stdin也有一个选项<code>-i</code>，用来处理标准的输入输出。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) target delete</span><br><span class="line">(lldb) target create /usr/bin/wc</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ echo &quot;hello world&quot; &gt; /tmp/wc_input.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(lldb) process launch -i /tmp/wc_input.txt</span><br><span class="line">Process 24511 launched: &#x27;/usr/bin/wc&#x27; (x86_64)</span><br><span class="line">1 2 12 </span><br><span class="line">Process 24511 exited with status = 0 (0x00000000)</span><br></pre></td></tr></table></figure>

<p>等同于</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ wc &lt; /tmp/wc_input.txt</span><br><span class="line"> 1  2 12</span><br></pre></td></tr></table></figure>

<h3 id="第4章：在代码中停止"><a href="#第4章：在代码中停止" class="headerlink" title="第4章：在代码中停止"></a>第4章：在代码中停止</h3><p>无论您是在技术堆栈中使用Swift，Objective-C，C ++，C还是完全不同的语言，您都需要学习如何创建断点。 可以轻松地在Xcode中单击侧面板以使用GUI创建断点，但LLDB控制台可以让您更好地控制断点。</p>
<h4 id="Signals（信号）"><a href="#Signals（信号）" class="headerlink" title="Signals（信号）"></a>Signals（信号）</h4><p>Unix信号是进程间通信的基本形式。</p>
<p>例如，其中一个信号SIGSTOP可用于保存状态并暂停执行进程，而其对应的SIGCONT则被发送到程序以恢复执行。调试器可以使用这两个信号暂停并继续执行程序。</p>
<h5 id="Xcode-断点"><a href="#Xcode-断点" class="headerlink" title="Xcode 断点"></a>Xcode 断点</h5><p>符号断点（Symbolic breakpoints）是Xcode的一个很好的调试功能。它们允许您在应用程序中的某个符号上设置断点。例如<code>[NSObject init]</code>，它引用NSObject实例的init方法。</p>
<p><img src="/../assets/xcode_breakpoints.png"></p>
<blockquote>
<p>您将学习如何在第10章“汇编，寄存器和调用约定”中正确使用和操作寄存器，但是现?在，只需知道<code> arg1</code>与​<code> $rdi</code>寄存器同义，并且可以被认为是持有实例的调用init时的类。</p>
</blockquote>
<p>还有Swift错误断点，它通过在swift_willThrow方法上创建断点来随时停止Swift抛出错误。如果您正在处理任何容易出错的API，这是一个很好的选择，因为它可以让您快速诊断情况，而不会对代码的正确性做出错误的假设。</p>
<h4 id="LLDB断点语法"><a href="#LLDB断点语法" class="headerlink" title="LLDB断点语法"></a>LLDB断点语法</h4><p><code>image</code>命令是一个很好的工具，可以帮助内省对设置断点至关重要的细节。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -n &quot;-[UIViewController viewDidLoad]&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn test</span><br></pre></td></tr></table></figure>

<h5 id="Objective-C-properties"><a href="#Objective-C-properties" class="headerlink" title="Objective-C properties"></a>Objective-C properties</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">TestClass</span> : <span class="title">NSObject</span> </span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> *name; </span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -n &quot;-[TestClass name]&quot;</span><br></pre></td></tr></table></figure>

<h5 id="Objective-C-properties-and-dot-notation"><a href="#Objective-C-properties-and-dot-notation" class="headerlink" title="Objective-C properties and dot notation"></a>Objective-C properties and dot notation</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">TestClass *a = [[TestClass alloc] init];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Both equivalent for setters </span></span><br><span class="line">[a setName:<span class="string">@&quot;hello, world&quot;</span>]; </span><br><span class="line">a.name = <span class="string">@&quot;hello, world&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Both equivalent for getters </span></span><br><span class="line"><span class="built_in">NSString</span> *b; </span><br><span class="line">b = [a name]; <span class="comment">// b = @&quot;hello, world&quot; </span></span><br><span class="line">b = a.name; <span class="comment">// b = @&quot;hello, world&quot;</span></span><br></pre></td></tr></table></figure>

<p>重要的是要知道您是在处理Objective-C代码并尝试使用点表示法在setter和getter属性上创建断点。</p>
<h5 id="Swift-properties"><a href="#Swift-properties" class="headerlink" title="Swift properties"></a>Swift properties</h5><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SwiftTestClass</span>: <span class="title class_">NSObject</span> &#123; </span><br><span class="line">	<span class="keyword">var</span> name: <span class="type">String</span>!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In the LLDB console, type the following:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn Signals.SwiftTestClass.name.setter</span><br></pre></td></tr></table></figure>

<p>You’ll get output similar to below:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1 match found in /Users/derekselander/Library/Developer/Xcode/ DerivedData/Signals-atqcdyprrotlrvdanihoufkwzyqh/Build/Products/Debugiphonesimulator/Signals.app/Signals:</span><br><span class="line"></span><br><span class="line">Address: Signals[0x000000010000cc70] (Signals.__TEXT.__text + 44816)</span><br><span class="line"></span><br><span class="line">Summary: Signals`Signals.SwiftTestClass.name.setter : Swift.ImplicitlyUnwrappedOptional&lt;Swift.String&gt; at SwiftTestClass.swift: 28</span><br></pre></td></tr></table></figure>

<p>使用以下正则表达式查询同时搜索name属性的SwiftTestClass setter和getter：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn Signals.SwiftTestClass.name</span><br></pre></td></tr></table></figure>

<h4 id="创建断点"><a href="#创建断点" class="headerlink" title="创建断点"></a>创建断点</h4><p>有几种不同的方法可以创建断点。最基本的方法是只输入字母b，后跟断点名称。这在Objective-C和C中相当容易，因为名称简短且易于键入（例如 - [NSObject init]或 - [UIView setAlpha:]）。输入C ++和Swift非常棘手，因为编译器会将您的方法转换为具有相当长名称的符号。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) b -[UIViewController viewDidLoad]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>与许多速记命令一样，b是另一个更长的LLDB命令的缩写。</p>
</blockquote>
<h5 id="正则表达式断点和范围"><a href="#正则表达式断点和范围" class="headerlink" title="正则表达式断点和范围"></a>正则表达式断点和范围</h5><p>rb命令将扩展到rbreak（假设您没有任何以“rb”开头的其他LLDB命令）。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) rb SwiftTestClass.name.setter</span><br></pre></td></tr></table></figure>



<p>这将在包含短语name.setter的任何内容上生成断点:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) rb name\.setter	</span><br></pre></td></tr></table></figure>



<p>在UIViewController的每个Objective-C实例方法上创建一个断点:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) rb &#x27;\-\[UIViewController\ &#x27;</span><br></pre></td></tr></table></figure>



<p>删除所有断点：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) breakpoint delete</span><br></pre></td></tr></table></figure>



<p>在断点中的UIViewController之后，这提供了带有一个或多个字母数字字符后跟空格的可选括号。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) rb &#x27;\-\[UIViewController(\(\w+\))?\ &#x27;</span><br></pre></td></tr></table></figure>



<p>使用正则表达式断点可以使用单个表达式捕获各种断点。</p>
<p>您可以使用-f选项将断点的范围限制为特定文件。</p>
<p>如果您正在调试DetailViewController.swift，这将非常有用。它将在此文件中的所有属性getter &#x2F; setter，块&#x2F;闭包，扩展&#x2F;类别和函数&#x2F;方法上设置断点。 -f称为范围限制。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) rb . -f DetailViewController.swift</span><br></pre></td></tr></table></figure>



<p>使用-s可以限制此共享库中设置断点。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) rb . -s UIKit</span><br></pre></td></tr></table></figure>



<p>-o选项为此提供了解决方案。它创造了所谓的“一次性”断点。当这些断点命中时，断点将被删除。所以它只会打一次。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) breakpoint delete </span><br><span class="line">(lldb) rb . -s UIKit -o</span><br></pre></td></tr></table></figure>

<h5 id="其他很酷的断点选项"><a href="#其他很酷的断点选项" class="headerlink" title="其他很酷的断点选项"></a>其他很酷的断点选项</h5><p>-L选项允许您按源代码的语言进行过滤。因此，如果您只想在Signals应用程序的Commons模块中使用Swift代码，则可以执行以下操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) breakpoint set -L swift -r . -s Commons</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这将在Commons模块中的每个Swift方法上设置断点。</p>
</blockquote>
<p>如果你想在Swift语句<code>if let</code>寻找一些有趣的东西，如果让它完全忘记你的应用程序在哪里，该怎么办？您可以使用源正则表达式断点来帮助确定感兴趣的位置！像这样：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) breakpoint set -A -p &quot;if let&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这将在包含<code>if let</code>的每个源代码位置创建一个断点。 -A选项表示搜索项目已知的所有源文件。</p>
</blockquote>
<p>如果想进一限制文件范围：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) breakpoint set -p &quot;if let&quot; -f MasterViewController.swift -f DetailViewController.swift</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这将获取所有源文件（-A），但只过滤那些属于Signals可执行文件（使用-s Signals选项）的文件。</p>
</blockquote>
<p>再来一个很酷的断点选项示例？好的。每当viewDidLoad被命中时，将创建一个打印UIViewController的断点，但是将通过LLDB控制台而不是符号断点窗口来执行此操作。然后将这个断点导出到文件中，这样就可以通过使用断点读取和断点写入命令展现给同事。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(lldb) breakpoint delete //清理断点</span><br><span class="line">(lldb) breakpoint set -n &quot;-[UIViewController viewDidLoad]&quot; -C &quot;po $arg1&quot; -G1 // 打印所有符合条件的实例对象</span><br><span class="line">(lldb) breakpoint write -f /tmp/br.json //断点写入文件</span><br><span class="line">(lldb) platform shell cat /tmp/br.json //shell读取文件</span><br><span class="line">(lldb) breakpoint delete //清理断点</span><br><span class="line">(lldb) breakpoint read -f /tmp/br.json //还能从文件中导入断点</span><br></pre></td></tr></table></figure>

<h5 id="修改和移除断点"><a href="#修改和移除断点" class="headerlink" title="修改和移除断点"></a>修改和移除断点</h5><p>断点会从1开始分配ID</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(lldb) b main</span><br><span class="line">(lldb) breakpoint list 1</span><br><span class="line">(lldb) breakpoint list 1 -b //简洁：没有位置（location）</span><br><span class="line">(lldb) breakpoint list 1 3 //多个</span><br><span class="line">(lldb) breakpoint list 1-3 //范围</span><br><span class="line">(lldb) breakpoint delete 1 //删除</span><br><span class="line">(lldb) breakpoint delete 1.1 //仅删除第一个子断点</span><br></pre></td></tr></table></figure>



<h3 id="第5章：表达式"><a href="#第5章：表达式" class="headerlink" title="第5章：表达式"></a>第5章：表达式</h3><h4 id="格式化-p-和-po"><a href="#格式化-p-和-po" class="headerlink" title="格式化 p 和 po"></a>格式化 p 和 po</h4><p>po通常用于Swift和Objective-C代码中以打印出感兴趣的项目。这可以是对象中的实例变量，对象的本地引用或寄存器，如本书前面所述。它甚至可以是一个任意的内存引用 - 只要该地址有一个对象！</p>
<p>po实际上是<code>expression -O --</code> 的简写表达式。 -O参数用于打印对象的描述。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(lldb) help po</span><br><span class="line">     Evaluate an expression on the current thread.  Displays any returned</span><br><span class="line">     value with formatting controlled by the type&#x27;s author.  Expects &#x27;raw&#x27;</span><br><span class="line">     input (see &#x27;help raw-input&#x27;.)</span><br><span class="line"></span><br><span class="line">Syntax: po &lt;expr&gt;</span><br><span class="line"></span><br><span class="line">Command Options Usage:</span><br><span class="line">  po &lt;expr&gt;</span><br><span class="line"></span><br><span class="line">&#x27;po&#x27; is an abbreviation for &#x27;expression -O  --&#x27;</span><br></pre></td></tr></table></figure>

<p>po经常被忽视的兄弟p,是另一个省略-O选项的缩写，<code>expression --</code> 。打印出的p的格式更依赖于LLDB类型系统。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(lldb) help p</span><br><span class="line">     Evaluate an expression on the current thread.  Displays any returned</span><br><span class="line">     value with LLDB&#x27;s default formatting.  Expects &#x27;raw&#x27; input (see &#x27;help</span><br><span class="line">     raw-input&#x27;.)</span><br><span class="line"></span><br><span class="line">Syntax: p &lt;expr&gt;</span><br><span class="line"></span><br><span class="line">Command Options Usage:</span><br><span class="line">  p &lt;expr&gt;</span><br><span class="line"></span><br><span class="line">&#x27;p&#x27; is an abbreviation for &#x27;expression --&#x27;</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123; </span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;Yay! debugging &quot;</span> <span class="operator">+</span> <span class="keyword">super</span>.description </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="keyword">var</span> debugDescription: <span class="type">String</span> &#123; </span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;debugDescription: &quot;</span> <span class="operator">+</span> <span class="keyword">super</span>.debugDescription </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidLoad</span>() &#123;</span><br><span class="line">   <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;<span class="subst">\(<span class="keyword">self</span>)</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在viewDidLoad中添加Xcode断点：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) po self</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">debugDescription: Yay! debugging &lt;Signals.MasterViewController: 0x7fb71fd04080&gt;</span><br></pre></td></tr></table></figure>

<h4 id="Swift-和-Objective-C-调试上下（文contexts）"><a href="#Swift-和-Objective-C-调试上下（文contexts）" class="headerlink" title="Swift 和 Objective-C 调试上下（文contexts）"></a>Swift 和 Objective-C 调试上下（文contexts）</h4><p>重要的是要注意调试程序时有两个调试上下文：非Swift调试上下文和Swift上下文。默认情况下，当您停止使用Objective-C代码时，LLDB将使用非Swift（Objective-C）调试上下文，而如果您在Swift代码中停止，则LLDB将使用Swift上下文。听起来合乎逻辑，对吧？</p>
<p>但是你也可以指定上下文：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) expression -l objc -O -- [UIApplication sharedApplication]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在这里，您告诉LLDB使用Objective-C的objc语言。如有必要，您还可以使用objc + +作为Objective-C ++。</p>
</blockquote>
<h4 id="用户定义变量"><a href="#用户定义变量" class="headerlink" title="用户定义变量"></a>用户定义变量</h4><p>如前所述，LLDB将在打印对象时代表您自动创建局部变量。您也可以创建自己的变量。</p>
<p>但是记得名字前面加<code>$</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(lldb) po id $test = [NSObject new] </span><br><span class="line">(lldb) po $test </span><br><span class="line">&lt;NSObject: 0x60000001d190&gt;</span><br><span class="line">(lldb) expression -l swift -O -- $test //切换至Swift上下文，同样可用</span><br><span class="line">&lt;NSObject: 0x60000001d190&gt;</span><br><span class="line">(lldb) expression -l swift -O -- $test.description //但是不能期待一切都正常</span><br><span class="line">error: &lt;EXPR&gt;:3:1: error: use of unresolved identifier &#x27;$test&#x27; $test.description ^~~~~</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这是一个正在积极开发的领域，Objective-C和Swift之间通过LLDB的桥梁可能会随着时间的推移而有所改善。</p>
</blockquote>
<p>在Xcoode创建符号断点：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Signals.MasterContainerViewController.viewDidLoad() -&gt; ()</span><br></pre></td></tr></table></figure>

<p>然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(lldb) p self</span><br><span class="line">(lldb) po $R0.title //$R0是上一步打印出来的self的变量的名字</span><br><span class="line">(lldb) expression -l swift -- $R0.title = &quot;new title&quot; //还可以修改</span><br></pre></td></tr></table></figure>

<p>通过键入continue或按Xcode中的播放按钮来恢复应用程序。就会发现标题已经更新为 ’new title‘</p>
<h5 id="类型格式化（Type-formatting）"><a href="#类型格式化（Type-formatting）" class="headerlink" title="类型格式化（Type formatting）"></a>类型格式化（Type formatting）</h5><p>LLDB的一个不错的选择是能够格式化基本数据类型的输出。这使得LLDB成为了解编译器如何格式化基本C类型的绝佳工具。当你正在探索汇编部分时，这是必须知道的，你将在本书后面做。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(lldb) expression -G x -- 10 //指定十进制格式化输出</span><br><span class="line">(lldb) p/x 10 //十进制</span><br><span class="line">(lldb) p/t 10 //二进制</span><br><span class="line">(lldb) p/d &#x27;D&#x27; //十进制</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-G &lt;gdb-format&gt; ( --gdb-format &lt;gdb-format&gt; )</span><br><span class="line">     Specify a format using a GDB format specifier string.</span><br></pre></td></tr></table></figure>

<p>输出格式的完整列表如下（取自<a target="_blank" rel="noopener" href="https://sourceware.org/gdb/">https://sourceware.org/gdb/</a> onlinedocs &#x2F; gdb &#x2F; Output-Formats.html）：</p>
<ul>
<li>x：十六进制</li>
<li>d：十进制</li>
<li>u：无符号十进制</li>
<li>o：八进制</li>
<li>t：二进制</li>
<li>a：地址</li>
<li>c：字符常量</li>
<li>f：浮点型</li>
<li>s：字符串</li>
</ul>
<p>如果这些格式不够，您可以使用LLDB的额外格式化程序，但您将无法使用GDB格式化语法。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) expression -f Y -- 1430672467</span><br><span class="line">(int) $0 = 53 54 46 55             STFU</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-f &lt;format&gt; ( --format &lt;format&gt; )</span><br><span class="line">     Specify a format to be used for display.</span><br></pre></td></tr></table></figure>

<p>LLDB具有以下格式化程序（摘自<a target="_blank" rel="noopener" href="http://lldb.llvm.org/varformats.html%EF%BC%89%EF%BC%9A">http://lldb.llvm.org/varformats.html）：</a></p>
<ul>
<li><p>B：布尔值</p>
</li>
<li><p>b：二进制</p>
</li>
<li><p>y：字节</p>
</li>
<li><p>Y：ASCII字节</p>
</li>
<li><p>c：字符</p>
</li>
<li><p>C：可打印字符</p>
</li>
<li><p>F：复杂的浮点型（包含实部和虚部）</p>
</li>
<li><p>s：c-string</p>
</li>
<li><p>i：十进制</p>
</li>
<li><p>E：枚举</p>
</li>
<li><p>x：十六进制</p>
</li>
<li><p>f：浮点型</p>
</li>
<li><p>o：八进制</p>
</li>
<li><p>O：MacOS OSType</p>
</li>
<li><p>U：UTF-16</p>
</li>
<li><p>u：无符号十进制</p>
</li>
<li><p>p：指针</p>
</li>
</ul>
<h3 id="第6章：线程，帧和步进（Thread-Frame-amp-Stepping-Around）"><a href="#第6章：线程，帧和步进（Thread-Frame-amp-Stepping-Around）" class="headerlink" title="第6章：线程，帧和步进（Thread, Frame &amp; Stepping Around）"></a>第6章：线程，帧和步进（Thread, Frame &amp; Stepping Around）</h3><p>您已经学习了如何创建断点，如何打印和修改值，以及如何在调试器中暂停时执行代码。但到目前为止，您已经处于高度干燥的状态，如何在调试器中移动并检查数据之外的数据。现在是时候了！</p>
<p>在本章中，您将学习如何在LLDB当前暂停时将调试器移入和移出功能。</p>
<p>这是一项关键技能，因为您经常需要在输入或退出代码片段时随时检查值。</p>
<h4 id="（栈的第一课）Stack-101"><a href="#（栈的第一课）Stack-101" class="headerlink" title="（栈的第一课）Stack 101"></a>（栈的第一课）Stack 101</h4><p>当计算机程序执行时，它将值存储在堆和栈中。两者都有其优点。作为高级调试器，您需要充分了解这些工作原理。现在，让我们简要介绍一下这个栈。</p>
<p>栈是LIFO（后进先出）队列，用于存储对当前正在执行的代码的引用。这种LIFO排序意味着最近添加的任何内容都会被删除。想想一栈盘子。在顶部添加一个盘子，它将是你首先取下的盘子。</p>
<p>栈指针指向栈的当前顶部。在板块类比中，栈指针指向顶板，告诉您从哪里取下一块板，或者在哪里放下一块板。</p>
<p><img src="/../assets/image-20190628093457893.png" alt="image-20190628093457893"></p>
<p>在此图中，高地址显示在顶部（0xFFFFFFFF），低地址显示在底部（0x00000000），显示栈将向下增长。</p>
<p>一些插图喜欢在底部具有高地址以与板类比匹配，因为栈将显示为向上增长。但是，我相信任何展示栈的图表都应显示从高地址向下增长，因为这会在以后讨论栈指针的偏移时引起较少的麻烦。</p>
<h4 id="检查栈的帧"><a href="#检查栈的帧" class="headerlink" title="检查栈的帧"></a>检查栈的帧</h4><p>这里我将使用 iPhone X Simulator。</p>
<p>添加断点：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Signals.MasterViewController.viewWillAppear(Swift.Bool) -&gt; ()</span><br></pre></td></tr></table></figure>

<p><img src="/../assets/image-20190628094640418.jpg" alt="image-20190628094640418"></p>
<p>在Debug Navigator面板中，将显示栈跟踪，显示栈帧列表，第一个是<code>viewWillAppear(_ :)</code>。接下来是Swift &#x2F; Objective-C桥接方法，<code>@objc MasterViewController.viewWillAppear(Bool) -&gt;():</code>。这个方法是自动生成的，所以Objective-C可以进入Swift代码。</p>
<p>之后，有一些来自UIKit的Objective-C代码栈帧。深入挖掘一下，你会看到一些属于CoreAnimation的C ++代码。更深入的是，你会看到一些方法都包含属于CoreFoundation的名称CFRunLoop。最后，最重要的是，main函数。</p>
<p>下面进入LLDB console：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) thread backtrace</span><br></pre></td></tr></table></figure>

<p>也可以使用<code>bt</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">(lldb) help bt</span><br><span class="line">     Show the current thread&#x27;s call stack.  Any numeric argument displays at</span><br><span class="line">     most that many frames.  The argument &#x27;all&#x27; displays all threads.  Expects</span><br><span class="line">     &#x27;raw&#x27; input (see &#x27;help raw-input&#x27;.)</span><br><span class="line"></span><br><span class="line">Syntax: bt [&lt;digit&gt; | all]</span><br><span class="line"></span><br><span class="line">&#x27;bt&#x27; is an abbreviation for &#x27;_regexp-bt&#x27;</span><br><span class="line">(lldb) help thread backtrace</span><br><span class="line">     Show thread call stacks.  Defaults to the current thread, thread indexes</span><br><span class="line">     can be specified as arguments.</span><br><span class="line">     Use the thread-index &quot;all&quot; to see all threads.</span><br><span class="line">     Use the thread-index &quot;unique&quot; to see threads grouped by unique call stacks.</span><br><span class="line"></span><br><span class="line">Syntax: thread backtrace &lt;cmd-options&gt;</span><br><span class="line"></span><br><span class="line">Command Options Usage:</span><br><span class="line">  thread backtrace [-c &lt;count&gt;] [-s &lt;frame-index&gt;] [-e &lt;boolean&gt;]</span><br><span class="line"></span><br><span class="line">       -c &lt;count&gt; ( --count &lt;count&gt; )</span><br><span class="line">            How many frames to display (-1 for all)</span><br><span class="line"></span><br><span class="line">       -e &lt;boolean&gt; ( --extended &lt;boolean&gt; )</span><br><span class="line">            Show the extended backtrace, if available</span><br><span class="line"></span><br><span class="line">       -s &lt;frame-index&gt; ( --start &lt;frame-index&gt; )</span><br><span class="line">            Frame in which to start the backtrace</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">(lldb) bt</span><br><span class="line">* thread #1, queue = &#x27;com.apple.main-thread&#x27;, stop reason = breakpoint 1.1</span><br><span class="line">  * frame #0: 0x0000000107044301 Signals`MasterViewController.viewWillAppear(animated=false, self=0x00007f9a26e0a670) at MasterViewController.swift:54:5</span><br><span class="line">    frame #1: 0x0000000107044993 Signals`@objc MasterViewController.viewWillAppear(_:) at &lt;compiler-generated&gt;:0</span><br><span class="line">    frame #2: 0x0000000110fc9437 UIKitCore`-[UIViewController _setViewAppearState:isAnimating:] + 687</span><br><span class="line">    frame #3: 0x0000000110fc9995 UIKitCore`__52-[UIViewController _setViewAppearState:isAnimating:]_block_invoke + 265</span><br><span class="line">    frame #4: 0x000000010957b33a CoreFoundation`-[__NSSingleObjectArrayI enumerateObjectsWithOptions:usingBlock:] + 58</span><br><span class="line">    frame #5: 0x0000000110fc9729 UIKitCore`-[UIViewController _setViewAppearState:isAnimating:] + 1441</span><br><span class="line">    frame #6: 0x0000000110fc9ba2 UIKitCore`-[UIViewController __viewWillAppear:] + 131</span><br><span class="line">    frame #7: 0x0000000110f275c9 UIKitCore`-[UINavigationController _startTransition:fromViewController:toViewController:] + 868</span><br><span class="line">    frame #8: 0x0000000110f283b5 UIKitCore`-[UINavigationController _startDeferredTransitionIfNeeded:] + 896</span><br><span class="line">    frame #9: 0x0000000110f296a7 UIKitCore`-[UINavigationController __viewWillLayoutSubviews] + 150</span><br><span class="line">    frame #10: 0x0000000110f0a38d UIKitCore`-[UILayoutContainerView layoutSubviews] + 217</span><br><span class="line">    frame #11: 0x0000000111a939c1 UIKitCore`-[UIView(CALayerDelegate) layoutSublayersOfLayer:] + 1417</span><br><span class="line">    frame #12: 0x000000010ea1feae QuartzCore`-[CALayer layoutSublayers] + 173</span><br><span class="line">    frame #13: 0x000000010ea24b88 QuartzCore`CA::Layer::layout_if_needed(CA::Transaction*) + 396</span><br><span class="line">    frame #14: 0x000000010ea30ee4 QuartzCore`CA::Layer::layout_and_display_if_needed(CA::Transaction*) + 72</span><br><span class="line">    frame #15: 0x000000010e9a03aa QuartzCore`CA::Context::commit_transaction(CA::Transaction*) + 328</span><br><span class="line">    frame #16: 0x000000010e9d7584 QuartzCore`CA::Transaction::commit() + 608</span><br><span class="line">    frame #17: 0x00000001115deccb UIKitCore`__34-[UIApplication _firstCommitBlock]_block_invoke_2 + 128</span><br><span class="line">    frame #18: 0x0000000109592aec CoreFoundation`__CFRUNLOOP_IS_CALLING_OUT_TO_A_BLOCK__ + 12</span><br><span class="line">    frame #19: 0x00000001095922b0 CoreFoundation`__CFRunLoopDoBlocks + 336</span><br><span class="line">    frame #20: 0x000000010958cb34 CoreFoundation`__CFRunLoopRun + 1252</span><br><span class="line">    frame #21: 0x000000010958c302 CoreFoundation`CFRunLoopRunSpecific + 626</span><br><span class="line">    frame #22: 0x000000010e8e22fe GraphicsServices`GSEventRunModal + 65</span><br><span class="line">    frame #23: 0x00000001115c5ba2 UIKitCore`UIApplicationMain + 140</span><br><span class="line">    frame #24: 0x000000010704b88b Signals`main at AppDelegate.swift:32:7</span><br><span class="line">    frame #25: 0x000000010af06541 libdyld.dylib`start + 1</span><br><span class="line">(lldb) frame info</span><br><span class="line">frame #0: 0x0000000107044301 Signals`MasterViewController.viewWillAppear(animated=false, self=0x00007f9a26e0a670) at MasterViewController.swift:54:5</span><br></pre></td></tr></table></figure>

<p>如您所见，此输出与Debug Navigator中找到的内容相匹配。那么，如果您只是从Debug Navigator中看到所有内容，为什么这甚至很重要？好吧，使用LLDB控制台可以对您想要查看的信息进行细致的控制。此外，您将制作自定义LLDB脚本，其中这些命令将变得非常有用。知道Xcode从哪里获取信息也很好，对吧？</p>
<p>然后：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) frame select 1</span><br><span class="line">frame #1: 0x0000000107044993 Signals`@objc MasterViewController.viewWillAppear(_:) at &lt;compiler-generated&gt;:0</span><br></pre></td></tr></table></figure>

<p>记下汇编中的绿线。在该行之前是负责执行<code>viewWillAppear(_:)</code>的<code>callq</code>指令，您在之前设置了断点。</p>
<p>不要让汇编太模糊你的眼睛。你还没有走出汇编树林……</p>
<h4 id="步进"><a href="#步进" class="headerlink" title="步进"></a>步进</h4><p>掌握LLDB时，您可以在程序暂停时执行的三个最重要的导航操作围绕着逐步执行程序。通过LLDB，您可以跳过（step over），单步执行（step in）或退出（step out）代码。</p>
<h5 id="跳过"><a href="#跳过" class="headerlink" title="跳过"></a>跳过</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) run //&#x27;run&#x27; is an abbreviation for &#x27;process launch -X true --&#x27;</span><br><span class="line">(lldb) next //&#x27;next&#x27; is an abbreviation for &#x27;thread step-over&#x27;</span><br></pre></td></tr></table></figure>

<h5 id="单步执行"><a href="#单步执行" class="headerlink" title="单步执行"></a>单步执行</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) step //&#x27;step&#x27; is an abbreviation for &#x27;thread step-in&#x27;</span><br></pre></td></tr></table></figure>

<h5 id="退出"><a href="#退出" class="headerlink" title="退出"></a>退出</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) finish //&#x27;finish&#x27; is an abbreviation for &#x27;thread step-out&#x27;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>请记住，只需按Enter键，LLDB将执行您输入的最后一个命令。</p>
</blockquote>
<h5 id="Xcode-界面中步进"><a href="#Xcode-界面中步进" class="headerlink" title="Xcode 界面中步进"></a>Xcode 界面中步进</h5><p>虽然使用控制台可以获得更加精细的控制，但Xcode已经为LLDB控制台上方的按钮提供了这些选项。</p>
<h4 id="检查栈中的数据"><a href="#检查栈中的数据" class="headerlink" title="检查栈中的数据"></a>检查栈中的数据</h4><p><code>frame</code> 命令的一个非常有趣的选项是 <code>frame variable</code> 子命令。</p>
<p>此命令将获取可执行文件头中的调试符号信息（如果您的应用程序被剥离，则为dYSM …稍后会详细介绍）并转储该特定栈帧的信息。由于调试信息，frame variable命令可以使用适当的选项轻松告诉您函数中所有变量的范围以及程序中的任何全局变量。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) frame variable</span><br><span class="line">(lldb) frame variable -F self //以平面格式打印结果</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-F ( --flat )</span><br><span class="line">      Display results in a flat format that uses expression paths for each variable or member.</span><br></pre></td></tr></table></figure>

<p><img src="/Users/will/git/blog/source/assets/image-20190701112507258.jpg" alt="image-20190701112507258"></p>
<blockquote>
<p>提供有关Apple私有API的ivars的更多信息，而不是Variables View。</p>
</blockquote>
<h3 id="第7章：镜像-Image"><a href="#第7章：镜像-Image" class="headerlink" title="第7章：镜像(Image)"></a>第7章：镜像(Image)</h3><p>现在是时候探索通过LLDB的权力找到感兴趣代码的最佳工具之一。在本章中，您将深入了解<code>image</code>命令。</p>
<p><code>image</code>命令是<code>target modules</code>子命令的别名。<code>image</code>命令专门查询 module 信息;也就是说，代码在进程中加载和执行。Module 可以包含许多东西，包括主要的可执行文件(main executables)，框架(framework)或插件(plugin)。但是，这些module中的大多数通常以动态库(dynamic libraries)的形式出现。动态库的示例包括适用于iOS的UIKit或适用于macOS的AppKit。</p>
<h4 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image list </span><br><span class="line">(lldb) image list Foundation</span><br><span class="line">[  0] FD4BF3C6-63C9-3A30-BEEA-D39F6F8EEB13 0x0000000107d70000 /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/System/Library/Frameworks/Foundation.framework/Foundation </span><br></pre></td></tr></table></figure>

<p>这是一种有用的方法，可以找到有关所需module的信息。</p>
<p>让我们来探索这个输出。 那里有一些有趣的东西：</p>
<ol>
<li><p>首先打印module的UUID（FD4BF3C6-63C9-3A30-BEEA-D39F6F8EEB13）。UUID对于搜索符号信息和唯一标识Foundation module的版本非常重要。</p>
</li>
<li><p>在UUID之后是加载地址（0x0000000107d70000）。 这标识将Foundation  module加载到Signals可执行文件的进程空间中。</p>
</li>
<li><p>最后，您拥有module在磁盘上所在位置的完整路径。</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image dump symtab UIKitCore -s address</span><br></pre></td></tr></table></figure>

<p>这将转储UIKitCore可用的所有符号表信息。由于<code>-s address</code>参数，此命令按私有UIKitCore模块中实现函数的地址对输出进行排序。</p>
<p>但是可读性不佳，需要另外一个命令来搜索：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -n &quot;-[UIViewController viewDidLoad]&quot;</span><br><span class="line">1 match found in /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/System/Library/PrivateFrameworks/UIKitCore.framework/UIKitCore:</span><br><span class="line">        Address: UIKitCore[0x000000000034adf9] (UIKitCore.__TEXT.__text + 3443497)</span><br><span class="line">        Summary: UIKitCore`-[UIViewController viewDidLoad]</span><br></pre></td></tr></table></figure>

<p>这将转储与UIViewController的viewDidLoad实例方法相关的信息。</p>
<p>如果想用正则来模糊搜索：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn UIViewController</span><br></pre></td></tr></table></figure>

<p>但是这还不够，因为结果包含了<code>UIViewControllerBuiltinTransitionViewAnimator</code>，这并不是我们想要的，所改为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn &#x27;\[UIViewController\ &#x27;</span><br><span class="line">(lldb) image lookup -rn \[UIViewController\s //等价的</span><br></pre></td></tr></table></figure>

<p>但是如果搜索Category，命名规则：<code>UIViewController(CategoryName)</code>，改进如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn &#x27;\[UIViewController\(\w+\)\ &#x27;</span><br></pre></td></tr></table></figure>

<p>当然这些都是参考正则表达式的规则，然后用在实际的需求中。</p>
<h5 id="寻找代码"><a href="#寻找代码" class="headerlink" title="寻找代码"></a>寻找代码</h5><p>您可以使用上面的<code>image lookup</code>命令找到UIViewController方法。您还使用它来寻找第4章“在代码中停止”中如何命名Swift属性setter和getter。</p>
<p>但是Block如何搜索呢？如下面例子</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dispatch_once(<span class="operator">&amp;</span>onceToken, <span class="operator">^</span>&#123;</span><br><span class="line">  sharedSignalHandler <span class="operator">=</span> [[<span class="type">UnixSignalHandler</span> alloc] initPrivate];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>我们先在Xcode添加断点，然后：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) frame info</span><br><span class="line">frame #0: 0x00000001048e1250 Commons`__34+[UnixSignalHandler sharedHandler]_block_invoke(.block_descriptor=0x00000001048e8230) at UnixSignalHandler.m:72:28</span><br></pre></td></tr></table></figure>

<p>可以看到完整的函数名：<code> __34+[UnixSignalHandler sharedHandler]_block_invoke</code></p>
<p>让我们先试试：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn _block_invoke</span><br></pre></td></tr></table></figure>

<p>结果太多，添加范围限制：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn _block_invoke Commons</span><br></pre></td></tr></table></figure>

<p>现在创建断点：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) rb appendSignal.*_block_invoke -s Commons</span><br></pre></td></tr></table></figure>

<p>之后我回到终端：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkill -SIGIO Signals</span><br></pre></td></tr></table></figure>

<p>就会触发刚刚创建的断点：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">2019-07-01 14:16:15.922561+0800 Signals[7583:429444] Appending new signal: SIGIO</span><br><span class="line">(lldb) frame variable</span><br><span class="line">(__block_literal_5 *) .block_descriptor = 0x0000600002f1d580</span><br><span class="line">(int) sig = &lt;read memory from 0x41 failed (0 of 4 bytes read)&gt;</span><br><span class="line"></span><br><span class="line">(siginfo_t *) siginfo = &lt;read memory from 0x39 failed (0 of 8 bytes read)&gt;</span><br><span class="line"></span><br><span class="line">(UnixSignalHandler *const) self = &lt;read memory from 0x31 failed (0 of 8 bytes read)&gt;</span><br><span class="line"></span><br><span class="line">(lldb) next</span><br><span class="line">(lldb) frame variable</span><br><span class="line">(__block_literal_5 *) .block_descriptor = 0x0000600002f1d580</span><br><span class="line">(int) sig = 23</span><br><span class="line">(siginfo_t *) siginfo = 0x00007ffeecdd9e78</span><br><span class="line">(UnixSignalHandler *) self = 0x0000600002f091c0</span><br><span class="line">(UnixSignal *) unixSignal = 0x0000000106ca4454</span><br></pre></td></tr></table></figure>

<p>您需要跳过一个语句，因此块执行了一些初始逻辑来设置函数，也称为函数序言（function prologue）。函数序言是与汇编相关的主题，您将在第II节中了解。</p>
<p>这实际上非常有趣。首先，您会看到一个block的对象，正在调用的。然后有sig和siginfo参数传递给Objective-C方法，在该方法中调用此块。这些如何传递到block中？</p>
<p>好吧，当创建一个block时，编译器足够聪明，可以确定它正在使用哪些参数。然后它创建一个将这些作为参数的函数。调用块时，调用此函数，并传入相关参数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -t __block_literal_5</span><br><span class="line">Best match found in /Users/will/Library/Developer/Xcode/DerivedData/Signals-bgjklehkjddsnxcexztwhrufpsbn/Build/Products/Debug-iphonesimulator/Signals.app/Frameworks/Commons.framework/Commons:</span><br><span class="line">id = &#123;0x100000be1&#125;, name = &quot;__block_literal_5&quot;, byte-size = 52, decl = UnixSignalHandler.m:127, compiler_type = &quot;struct __block_literal_5 &#123;</span><br><span class="line">    void *__isa;</span><br><span class="line">    int __flags;</span><br><span class="line">    int __reserved;</span><br><span class="line">    void (*__FuncPtr)();</span><br><span class="line">    __block_descriptor_withcopydispose *__descriptor;</span><br><span class="line">    UnixSignalHandler *const self;</span><br><span class="line">    siginfo_t *siginfo;</span><br><span class="line">    int sig;</span><br><span class="line">&#125;&quot;</span><br></pre></td></tr></table></figure>

<p>这是定义block的对象！</p>
<p>正如您所看到的，这几乎与头文件一样好，可以告诉您如何在block中导航内存。如果将内存中的引用转换为<code>__block_literal_5</code>类型，则可以轻松打印出block引用的所有变量。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">(lldb) po ((__block_literal_5 *)0x0000600002f1d580)</span><br><span class="line">&lt;__NSMallocBlock__: 0x600002f1d580&gt;</span><br><span class="line">(lldb) p/x ((__block_literal_5 *)0x0000600002f1d580)-&gt;__FuncPtr</span><br><span class="line">(void (*)()) $1 = 0x0000000103143a80 (Commons`__38-[UnixSignalHandler appendSignal:sig:]_block_invoke_2 at UnixSignalHandler.m:127)</span><br><span class="line">(lldb) image lookup -a 0x0000000103143a80</span><br><span class="line">      Address: Commons[0x0000000000001a80] (Commons.__TEXT.__text + 2240)</span><br><span class="line">      Summary: Commons`__38-[UnixSignalHandler appendSignal:sig:]_block_invoke_2 at UnixSignalHandler.m:127</span><br><span class="line">(lldb) po ((__block_literal_5 *)0x0000600002f1d580)-&gt;sig //打印出传递给block的所有参数</span><br><span class="line">23</span><br><span class="line">(lldb) p *(__block_literal_5 *)0x0000600002f1d580 //可以使用p命令转储完整的结构并解除引用指针</span><br><span class="line">(__block_literal_5) $4 = &#123;</span><br><span class="line">  __isa = 0x0000000106d6e170</span><br><span class="line">  __flags = -1023410174</span><br><span class="line">  __reserved = 0</span><br><span class="line">  __FuncPtr = 0x0000000103143a80 (Commons`__38-[UnixSignalHandler appendSignal:sig:]_block_invoke_2 at UnixSignalHandler.m:127)</span><br><span class="line">  __descriptor = 0x000000010314a2c0</span><br><span class="line">  self = 0x0000600002f091c0</span><br><span class="line">  siginfo = 0x00007ffeecdd9e78</span><br><span class="line">  sig = 23</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="深入研究（Snooping-around）"><a href="#深入研究（Snooping-around）" class="headerlink" title="深入研究（Snooping around）"></a>深入研究（Snooping around）</h4><p>好的，您已经发现了如何以静态方式检查私有类的实例变量，但是该块内存地址太过诱人而无法置之不理。 尝试将其打印出来并使用动态分析进行探索。</p>
<p>直接打印block的内存地址：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">(lldb) po 0x0000600002f1d580</span><br><span class="line">&lt;__NSMallocBlock__: 0x600002f1d580&gt;</span><br><span class="line">(lldb) image lookup -rn __NSMallocBlock__ // 没有结果</span><br><span class="line">(lldb) po [__NSMallocBlock__ superclass]</span><br><span class="line">__NSMallocBlock</span><br><span class="line">(lldb) image lookup -rn __NSMallocBlock</span><br><span class="line">5 matches found in /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation:</span><br><span class="line">        Address: CoreFoundation[0x000000000018b600] (CoreFoundation.__TEXT.__text + 1614448)</span><br><span class="line">        Summary: CoreFoundation`-[__NSMallocBlock retain]        Address: CoreFoundation[0x000000000018b620] (CoreFoundation.__TEXT.__text + 1614480)</span><br><span class="line">        Summary: CoreFoundation`-[__NSMallocBlock release]        Address: CoreFoundation[0x000000000018b630] (CoreFoundation.__TEXT.__text + 1614496)</span><br><span class="line">        Summary: CoreFoundation`-[__NSMallocBlock retainCount]        Address: CoreFoundation[0x000000000018b640] (CoreFoundation.__TEXT.__text + 1614512)</span><br><span class="line">        Summary: CoreFoundation`-[__NSMallocBlock _tryRetain]        Address: CoreFoundation[0x000000000018b650] (CoreFoundation.__TEXT.__text + 1614528)</span><br><span class="line">        Summary: CoreFoundation`-[__NSMallocBlock _isDeallocating]</span><br><span class="line">        </span><br><span class="line">(lldb) po [__NSMallocBlock superclass]</span><br><span class="line">NSBlock</span><br><span class="line"></span><br><span class="line">(lldb) image lookup -rn &#x27;NSBlock\ &#x27;</span><br><span class="line">6 matches found in /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation:</span><br><span class="line">        Address: CoreFoundation[0x000000000018b4c0] (CoreFoundation.__TEXT.__text + 1614128)</span><br><span class="line">        Summary: CoreFoundation`+[NSBlock allocWithZone:]        Address: CoreFoundation[0x000000000018b4e0] (CoreFoundation.__TEXT.__text + 1614160)</span><br><span class="line">        Summary: CoreFoundation`+[NSBlock alloc]        Address: CoreFoundation[0x000000000018b500] (CoreFoundation.__TEXT.__text + 1614192)</span><br><span class="line">        Summary: CoreFoundation`-[NSBlock copy]        Address: CoreFoundation[0x000000000018b510] (CoreFoundation.__TEXT.__text + 1614208)</span><br><span class="line">        Summary: CoreFoundation`-[NSBlock copyWithZone:]        Address: CoreFoundation[0x000000000018b520] (CoreFoundation.__TEXT.__text + 1614224)</span><br><span class="line">        Summary: CoreFoundation`-[NSBlock invoke]        Address: CoreFoundation[0x000000000018b530] (CoreFoundation.__TEXT.__text + 1614240)</span><br><span class="line">        Summary: CoreFoundation`-[NSBlock performAfterDelay:]</span><br></pre></td></tr></table></figure>

<p>您现在将尝试在block上调用此方法。但是，当保留此block的引用释放其控制时，您不希望块消失，从而降低retainCount，并可能释放block。</p>
<p>有一种简单的方法来保持这个block - 只需 <code>retain</code> 它！在LLDB中键入以下内容，将地址替换为block的地址：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(lldb) po id $block = (id)0x0000600002f1d580</span><br><span class="line">(lldb) po [$block retain]</span><br><span class="line">&lt;__NSMallocBlock__: 0x600002f1d580&gt;</span><br><span class="line"></span><br><span class="line">(lldb) po [$block invoke]</span><br><span class="line">2019-07-01 16:05:33.855039+0800 Signals[7583:452921] Appending new signal: SIGIO</span><br><span class="line"> nil</span><br></pre></td></tr></table></figure>

<p>这表明你已经再次调用了block！</p>
<p>这种用于探索公共和私有类，然后探索它们实现的方法的方法，是了解程序覆盖范围内的内容的好方法。稍后您将对方法使用相同的发现过程，然后分析这些方法执行的程序集，为您提供原始方法源代码的非常接近的近似值。</p>
<h5 id="Private-debugging-methods"><a href="#Private-debugging-methods" class="headerlink" title="Private debugging methods"></a>Private debugging methods</h5><p><code>image lookup</code> 命令可以很好地搜索私有方法以及您在Apple开发职业生涯中看到的公共方法。</p>
<p>但是，在调试自己的代码时，有一些隐藏的方法非常有用。</p>
<p>例如，以<code>_</code>开头的方法通常表示自己是一个私有（也可能是重要的！）方法。</p>
<p>让我们尝试在所有以下划线字符开头的模块中搜索任何Objective-C方法，并在其中包含单词“description”。</p>
<p>如果您在阅读此行代码时有些迷惑不解，强烈建议您仔细阅读 <a target="_blank" rel="noopener" href="https://docs.python.org/2/library/re.html">https://docs.python.org/2/library/re.html</a> 以了解正则表达式查询;从现在开始，它只会变得更加复杂。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -rn (?i)\ _\w+description\] //不区分大小写</span><br><span class="line">(lldb) image lookup -rn NSObject\(IvarDescription\)</span><br><span class="line">(lldb) po [[UIApplication sharedApplication] _ivarDescription]</span><br><span class="line">(lldb) image lookup -rn &#x27;\[UIStatusBar\ set&#x27; //查找所以set开头方法</span><br><span class="line">(lldb) po (BOOL)[[UIStatusBar class] isSubclassOfClass:[UIView class]]</span><br></pre></td></tr></table></figure>

<p>通过地址调用对象：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(lldb) po [[UIApplication sharedApplication] statusBar]</span><br><span class="line">&lt;UIStatusBar_Modern: 0x7f9965e03f00; frame = (0 0; 375 44); autoresize = W+BM; layer = &lt;CALayer: 0x6000025dd640&gt;&gt;</span><br><span class="line"></span><br><span class="line">(lldb) po [0x7f9965e03f00 setBackgroundColor:[UIColor purpleColor]]</span><br><span class="line">purpleColor</span><br></pre></td></tr></table></figure>

<blockquote>
<p>未完待续</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/06/14/SwiftUI-By-Example-Notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/06/14/SwiftUI-By-Example-Notes/" class="post-title-link" itemprop="url">SwiftUI By Example 笔记</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-06-14 22:40:57" itemprop="dateCreated datePublished" datetime="2019-06-14T22:40:57+08:00">2019-06-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>原文为 <a target="_blank" rel="noopener" href="https://click.pg.mlsend.com/link/c/YT0xMTc1OTUxMzkxNzkzODc4OTYyJmM9djB0OCZlPTE5MjgmYj0yNTYyNzIyMDImZD1xMWs3eDlr.F1niXtzxMJPvGR0n5OkwVQKdeuMBcqaV_PH83g6F9CQ">@twostraws</a> 的 <a target="_blank" rel="noopener" href="https://click.pg.mlsend.com/link/c/YT0xMTc1OTUxMzkxNzkzODc4OTYyJmM9djB0OCZlPTE5MjgmYj0yNTYyNzIyMDYmZD12NmowZzZl.r3cdqNyvWJ5dIgoCiFs_1q8hUT3njlEH6fEv1rWAXGo">SwiftUI By Example</a>，就是简单记录一些主要内容。</p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><strong>A brief explanation of the basics of SwiftUI</strong></p>
<h3 id="What-is-SwiftUI"><a href="#What-is-SwiftUI" class="headerlink" title="What is SwiftUI?"></a>What is SwiftUI?</h3><ol>
<li>声明式对比命令式，能够更好地处理不同状态的UI</li>
<li>跨平台：支持 iOS, macOS, tvOS, watchOS</li>
</ol>
<h3 id="SwiftUI-vs-Interface-Builder-and-storyboards"><a href="#SwiftUI-vs-Interface-Builder-and-storyboards" class="headerlink" title="SwiftUI vs Interface Builder and storyboards"></a>SwiftUI vs Interface Builder and storyboards</h3><ol>
<li>IB难以阅读和修改</li>
<li>IB难以看出修改了内容</li>
<li>IB和Swift交互不够友好，充满了Objective-C设计</li>
<li>SwiftUI是个仅支持Swift 的库，这样才可以充分利用Swift的特性</li>
</ol>
<p>Anyway, we’ll get onto exactly how SwiftUI works soon. For now, the least you need to know is that SwiftUI fixes many problems people had with the old Swift + Interface Builder approach:</p>
<ul>
<li>We no longer have to argue about programmatic or storyboard-based design, because SwiftUI gives us both at the same time.</li>
<li>We no longer have to worry about creating source control problems when committing user interface work, because code is much easier to read and manage than storyboard XML.</li>
<li>We no longer need to worry so much about stringly typed APIs – there are still some, but significantly fewer.</li>
<li>We no longer need to worry about calling functions that don’t exist, because our user interface gets checked by the Swift compiler.</li>
</ul>
<p>So, I hope you’ll agree there are lots of benefits to be had from moving to SwiftUI!</p>
<h3 id="Frequently-asked-questions-about-SwiftUI"><a href="#Frequently-asked-questions-about-SwiftUI" class="headerlink" title="Frequently asked questions about SwiftUI"></a>Frequently asked questions about SwiftUI</h3><h4 id="Does-SwiftUI-replace-UIKit"><a href="#Does-SwiftUI-replace-UIKit" class="headerlink" title="Does SwiftUI replace UIKit?"></a>Does SwiftUI replace UIKit?</h4><p>No. Many parts of SwiftUI directly build on top of existing UIKit components, such as UITableView. Of course, many other parts don’t – they are new controls rendered by SwiftUI and not UIKit.</p>
<p>But the point isn’t to what extent UIKit is involved. Instead, the point is that we don’t <em>care</em>. SwiftUI more or less completely masks UIKit’s behavior, so if you write your app for SwiftUI and Apple replaces UIKit with a singing elephant in two years you don’t have to care – as long as Apple makes the elephant compatible with the same methods and properties that UIKit exposed to SwiftUI, your code doesn’t change.</p>
<h4 id="Is-SwiftUI-fast"><a href="#Is-SwiftUI-fast" class="headerlink" title="Is SwiftUI fast?"></a>Is SwiftUI fast?</h4><p>SwiftUI is <em>screamingly</em> fast – in all my tests so far it seems to outpace UIKit. Having spoken to the team who made it I’m starting to get an idea why: first, they aggressively flatten their layer hierarchy so the system has to do less drawing, but second many operations bypass Core Animation entirely and go straight to Metal for extra speed.</p>
<p>So, yes: SwiftUI is incredibly fast, and all without us having to do any extra work.</p>
<h3 id="How-to-follow-this-quick-start-guide"><a href="#How-to-follow-this-quick-start-guide" class="headerlink" title="How to follow this quick start guide"></a>How to follow this quick start guide</h3><p>最好顺序阅读该教程</p>
<h3 id="Migrating-from-UIKit-to-SwiftUI"><a href="#Migrating-from-UIKit-to-SwiftUI" class="headerlink" title="Migrating from UIKit to SwiftUI"></a>Migrating from UIKit to SwiftUI</h3><p>如果你用过UIKit，不难发现SwiftUI就是把UI前缀去掉既是对应的组件。</p>
<p>Here’s a list to get you started, with UIKit class names followed by SwiftUI names:</p>
<ul>
<li><code>UITableView</code>: <code>List</code></li>
<li><code>UICollectionView</code>: No SwiftUI equivalent</li>
<li><code>UILabel</code>: <code>Text</code></li>
<li><code>UITextField</code>: <code>TextField</code></li>
<li><code>UITextField</code> with <code>isSecureTextEntry</code> set to true: <code>SecureField</code></li>
<li><code>UITextView</code>: No SwiftUI equivalent</li>
<li><code>UISwitch</code>: <code>Toggle</code></li>
<li><code>UISlider</code>: <code>Slider</code></li>
<li><code>UIButton</code>: <code>Button</code></li>
<li><code>UINavigationController</code>: <code>NavigationView</code></li>
<li><code>UIAlertController</code> with style <code>.alert</code>: <code>Alert</code></li>
<li><code>UIAlertController</code> with style <code>.actionSheet</code>: <code>ActionSheet</code></li>
<li><code>UIStackView</code> with horizontal axis: <code>HStack</code></li>
<li><code>UIStackView</code> with vertical axis: <code>VStack</code></li>
<li><code>UIImageView</code>: <code>Image</code></li>
<li><code>UISegmentedControl</code>: <code>SegmentedControl</code></li>
<li><code>UIStepper</code>: <code>Stepper</code></li>
<li><code>UIDatePicker</code>: <code>DatePicker</code></li>
<li><code>NSAttributedString</code>: Incompatible with SwiftUI; use <code>Text</code> instead.</li>
</ul>
<h2 id="Text-and-images"><a href="#Text-and-images" class="headerlink" title="Text and images"></a>Text and images</h2><p><strong>Getting started with basic controls</strong></p>
<h3 id="What’s-in-the-basic-template"><a href="#What’s-in-the-basic-template" class="headerlink" title="What’s in the basic template?"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/whats-in-the-basic-template">What’s in the basic template?</a></h3><p>SceneDelegate.swift is responsible for managing the way your app is shown.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> window <span class="operator">=</span> <span class="type">UIWindow</span>(frame: <span class="type">UIScreen</span>.main.bounds)</span><br><span class="line">window.rootViewController <span class="operator">=</span> <span class="type">UIHostingController</span>(rootView: <span class="type">ContentView</span>())</span><br><span class="line"><span class="keyword">self</span>.window <span class="operator">=</span> window</span><br><span class="line">window.makeKeyAndVisible()</span><br></pre></td></tr></table></figure>

<p>Open ContentView.swift and let’s look at some actual SwiftUI code.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">#if</span> <span class="type">DEBUG</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Previews</span> : <span class="title class_">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">#endif</span></span><br></pre></td></tr></table></figure>

<p>First, notice how <code>ContentView</code> is a struct.</p>
<p>Second, <code>ContentView</code> conforms to the <code>View</code> protocol.</p>
<p>第三，<code>body</code>的返回类型是<code>some view</code>。 <code>some</code>关键字是Swift 5.1中的新关键字，是名为<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=DvHkeUxiwYY">opaque return types</a>的功能的一部分，在这种情况下，就是字面意思：”这将返回某种<code>View</code>，但SwiftUI不需要知道（或关心）什么。”</p>
<p>Finally, below <code>ContentView</code> is a similar-but-different struct called <code>ContentView_Previews</code>.</p>
<h3 id="How-to-create-static-labels-with-a-Text-view"><a href="#How-to-create-static-labels-with-a-Text-view" class="headerlink" title="How to create static labels with a Text view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-static-labels-with-a-text-view">How to create static labels with a Text view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">    .lineLimit(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;This is an extremely long string that will never fit even the widest of Phones&quot;</span>)</span><br><span class="line">    .truncationMode(.middle)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-style-text-views-with-fonts-colors-line-spacing-and-more"><a href="#How-to-style-text-views-with-fonts-colors-line-spacing-and-more" class="headerlink" title="How to style text views with fonts, colors, line spacing, and more"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-style-text-views-with-fonts-colors-line-spacing-and-more">How to style text views with fonts, colors, line spacing, and more</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;This is an extremely long string that will never fit even the widest of Phones&quot;</span>)</span><br><span class="line">        .truncationMode(.middle)</span><br><span class="line">        .font(<span class="type">Font</span>.body)</span><br><span class="line">        .foregroundColor(<span class="type">Color</span>.green)</span><br><span class="line">        .background(<span class="type">Color</span>.gray)</span><br><span class="line">        .lineLimit(<span class="literal">nil</span>)</span><br><span class="line">        .lineSpacing(<span class="number">30</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-format-text-inside-text-views"><a href="#How-to-format-text-inside-text-views" class="headerlink" title="How to format text inside text views"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-format-text-inside-text-views">How to format text inside text views</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> taskDateFormat: <span class="type">DateFormatter</span> <span class="operator">=</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> formatter <span class="operator">=</span> <span class="type">DateFormatter</span>()</span><br><span class="line">        formatter.dateStyle <span class="operator">=</span> .long</span><br><span class="line">        <span class="keyword">return</span> formatter</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> dueDate <span class="operator">=</span> <span class="type">Date</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Task due date: <span class="subst">\(dueDate, formatter: <span class="keyword">Self</span>.taskDateFormat)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="How-to-draw-images-using-Image-views"><a href="#How-to-draw-images-using-Image-views" class="headerlink" title="How to draw images using Image views"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-draw-images-using-image-views">How to draw images using Image views</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Image</span>(systemName: <span class="string">&quot;cloud.heavyrain.fill&quot;</span>)</span><br><span class="line">    .foregroundColor(.red)</span><br><span class="line">		.font(.largeTitle)</span><br></pre></td></tr></table></figure>



<h3 id="How-to-adjust-the-way-an-image-is-fitted-to-its-space"><a href="#How-to-adjust-the-way-an-image-is-fitted-to-its-space" class="headerlink" title="How to adjust the way an image is fitted to its space"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-adjust-the-way-an-image-is-fitted-to-its-space">How to adjust the way an image is fitted to its space</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>)</span><br><span class="line">    .resizable()</span><br><span class="line">    .aspectRatio(contentMode: .fill)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-render-a-gradient"><a href="#How-to-render-a-gradient" class="headerlink" title="How to render a gradient"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-render-a-gradient">How to render a gradient</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">    .padding()</span><br><span class="line">    .foregroundColor(.white)</span><br><span class="line">    .background(<span class="type">LinearGradient</span>(gradient: <span class="type">Gradient</span>(colors: [.white, .black]), startPoint: .top, endPoint: .bottom), cornerRadius: <span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>支持更多颜色的渐变</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">    .padding()</span><br><span class="line">    .foregroundColor(.white)</span><br><span class="line">    .background(<span class="type">LinearGradient</span>(gradient: <span class="type">Gradient</span>(colors: [.white, .red, .black]), startPoint: .leading, endPoint: .trailing), cornerRadius: <span class="number">0</span>)</span><br></pre></td></tr></table></figure>



<h3 id="How-to-display-solid-shapes"><a href="#How-to-display-solid-shapes" class="headerlink" title="How to display solid shapes"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-display-solid-shapes">How to display solid shapes</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Rectangle</span>()</span><br><span class="line">    .fill(<span class="type">Color</span>.red)</span><br><span class="line">    .frame(width: <span class="number">200</span>, height: <span class="number">200</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-use-images-and-other-views-as-a-backgrounds"><a href="#How-to-use-images-and-other-views-as-a-backgrounds" class="headerlink" title="How to use images and other views as a backgrounds"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-use-images-and-other-views-as-a-backgrounds">How to use images and other views as a backgrounds</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hacking with Swift&quot;</span>)</span><br><span class="line">    .font(.largeTitle)</span><br><span class="line">    .background(</span><br><span class="line">        <span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>)</span><br><span class="line">            .resizable()</span><br><span class="line">            .frame(width: <span class="number">100</span>, height: <span class="number">100</span>))</span><br></pre></td></tr></table></figure>

<h2 id="View-layout"><a href="#View-layout" class="headerlink" title="View layout"></a>View layout</h2><p><strong>Position views in a grid structure and more</strong></p>
<h3 id="How-to-create-stacks-using-VStack-and-HStack"><a href="#How-to-create-stacks-using-VStack-and-HStack" class="headerlink" title="How to create stacks using VStack and HStack"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-stacks-using-vstack-and-hstack">How to create stacks using VStack and HStack</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">VStack</span> &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;SwiftUI&quot;</span>)</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;rocks&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-customize-stack-layouts-with-alignment-and-spacing"><a href="#How-to-customize-stack-layouts-with-alignment-and-spacing" class="headerlink" title="How to customize stack layouts with alignment and spacing"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-customize-stack-layouts-with-alignment-and-spacing">How to customize stack layouts with alignment and spacing</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">VStack</span>(alignment: .leading, spacing: <span class="number">20</span>) &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;SwiftUI&quot;</span>)</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;rocks&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-control-spacing-around-individual-views-using-padding"><a href="#How-to-control-spacing-around-individual-views-using-padding" class="headerlink" title="How to control spacing around individual views using padding"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-control-spacing-around-individual-views-using-padding">How to control spacing around individual views using padding</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;SwiftUI&quot;</span>)</span><br><span class="line">    .padding(.bottom, <span class="number">100</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-layer-views-on-top-of-each-other-using-ZStack"><a href="#How-to-layer-views-on-top-of-each-other-using-ZStack" class="headerlink" title="How to layer views on top of each other using ZStack"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-layer-views-on-top-of-each-other-using-zstack">How to layer views on top of each other using ZStack</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ZStack</span> &#123;</span><br><span class="line">           <span class="type">Rectangle</span>()</span><br><span class="line">               .fill(<span class="type">Color</span>.red)</span><br><span class="line">           <span class="type">Text</span>(<span class="string">&quot;Hacking with Swift&quot;</span>)</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>



<h3 id="How-to-return-different-view-types"><a href="#How-to-return-different-view-types" class="headerlink" title="How to return different view types"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-return-different-view-types">How to return different view types</a></h3><p>第一种方案</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">Group</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="type">Bool</span>.random() &#123;</span><br><span class="line">            <span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Better luck next time&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第二种方案</p>
<p>If you haven’t heard of this concept, it effectively forces Swift to forget about what specific type is inside the <code>AnyView</code>, allowing them to look like they are the same thing. This has a performance cost, though, so don’t use it often.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: <span class="type">AnyView</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="type">Bool</span>.random() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">AnyView</span>(<span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">AnyView</span>(<span class="type">Text</span>(<span class="string">&quot;Better luck next time&quot;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="How-to-create-views-in-a-loop-using-ForEach"><a href="#How-to-create-views-in-a-loop-using-ForEach" class="headerlink" title="How to create views in a loop using ForEach"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-views-in-a-loop-using-foreach">How to create views in a loop using ForEach</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">    <span class="type">ForEach</span>((<span class="number">1</span><span class="operator">...</span><span class="number">10</span>).reversed()) &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;<span class="subst">\(<span class="variable">$0</span>)</span>…&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;Ready or not, here I come!&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> colors: [<span class="type">Color</span>] <span class="operator">=</span> [.red, .green, .blue]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">ForEach</span>(colors.identified(by: \.<span class="keyword">self</span>)) &#123; color <span class="keyword">in</span></span><br><span class="line">                <span class="type">Text</span>(color.description.capitalized)</span><br><span class="line">                    .padding()</span><br><span class="line">                    .background(color)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-different-layouts-using-size-classes"><a href="#How-to-create-different-layouts-using-size-classes" class="headerlink" title="How to create different layouts using size classes"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-different-layouts-using-size-classes">How to create different layouts using size classes</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@Environment</span>(\.horizontalSizeClass) <span class="keyword">var</span> horizontalSizeClass: <span class="type">UserInterfaceSizeClass</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> horizontalSizeClass <span class="operator">==</span> .compact &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">Text</span>(<span class="string">&quot;Compact&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">Text</span>(<span class="string">&quot;Regular&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-place-content-outside-the-safe-area"><a href="#How-to-place-content-outside-the-safe-area" class="headerlink" title="How to place content outside the safe area"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-place-content-outside-the-safe-area">How to place content outside the safe area</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">    .frame(minWidth: <span class="number">0</span>, maxWidth: .infinity, minHeight: <span class="number">0</span>, maxHeight: .infinity)</span><br><span class="line">    .background(<span class="type">Color</span>.red)</span><br><span class="line">    .edgesIgnoringSafeArea(.all)</span><br></pre></td></tr></table></figure>

<h2 id="Reading-input"><a href="#Reading-input" class="headerlink" title="Reading input"></a>Reading input</h2><p><strong>Respond to interaction and control your program state</strong></p>
<h3 id="Working-with-state"><a href="#Working-with-state" class="headerlink" title="Working with state"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/working-with-state">Working with state</a></h3><p>SwiftUI solves this problem by removing state from our control. When we add properties to our views they are effectively inert – they have values, sure, but changing them doesn’t do anything. But if we added the special <code>@State</code> attribute before them, SwiftUI will automatically watch for changes and update any parts of our views that use that state.</p>
<h3 id="How-to-create-a-toggle-switch"><a href="#How-to-create-a-toggle-switch" class="headerlink" title="How to create a toggle switch"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-toggle-switch">How to create a toggle switch</a></h3><p>相反，我们应该定义一个<code>@State</code>布尔属性，用于存储切换的当前值。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showGreeting <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Toggle</span>(isOn: <span class="variable">$showGreeting</span>) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Show welcome message&quot;</span>)</span><br><span class="line">            &#125;.padding()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showGreeting &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-a-tappable-button"><a href="#How-to-create-a-tappable-button" class="headerlink" title="How to create a tappable button"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-tappable-button">How to create a tappable button</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showDetails <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Button</span>(action: &#123;</span><br><span class="line">                <span class="keyword">self</span>.showDetails.toggle()</span><br><span class="line">            &#125;) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Show details&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetails &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;You should follow me on Twitter: @twostraws&quot;</span>)</span><br><span class="line">                    .font(.largeTitle)</span><br><span class="line">                    .lineLimit(<span class="literal">nil</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-read-text-from-a-TextField"><a href="#How-to-read-text-from-a-TextField" class="headerlink" title="How to read text from a TextField"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-read-text-from-a-textfield">How to read text from a TextField</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> name: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;Tim&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">TextField</span>(<span class="variable">$name</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Hello, <span class="subst">\(name)</span>!&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-add-a-border-to-a-TextField"><a href="#How-to-add-a-border-to-a-TextField" class="headerlink" title="How to add a border to a TextField"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-add-a-border-to-a-textfield">How to add a border to a TextField</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">TextField</span>(<span class="variable">$yourBindingHere</span>)</span><br><span class="line">    .textFieldStyle(.roundedBorder)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-secure-text-fields-using-SecureField"><a href="#How-to-create-secure-text-fields-using-SecureField" class="headerlink" title="How to create secure text fields using SecureField"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-secure-text-fields-using-securefield">How to create secure text fields using SecureField</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> password: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">SecureField</span>(<span class="variable">$password</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;You entered: <span class="subst">\(password)</span>&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-a-Slider-and-read-values-from-it"><a href="#How-to-create-a-Slider-and-read-values-from-it" class="headerlink" title="How to create a Slider and read values from it"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-slider-and-read-values-from-it">How to create a Slider and read values from it</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> celsius: <span class="type">Double</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Slider</span>(value: <span class="variable">$celsius</span>, from: <span class="operator">-</span><span class="number">100</span>, through: <span class="number">100</span>, by: <span class="number">0.1</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;<span class="subst">\(celsius)</span> Celsius is <span class="subst">\(celsius <span class="operator">*</span> <span class="number">9</span> <span class="operator">/</span> <span class="number">5</span> <span class="operator">+</span> <span class="number">32</span>)</span> Fahrenheit&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-a-date-picker-and-read-values-from-it"><a href="#How-to-create-a-date-picker-and-read-values-from-it" class="headerlink" title="How to create a date picker and read values from it"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-date-picker-and-read-values-from-it">How to create a date picker and read values from it</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">   <span class="keyword">var</span> colors <span class="operator">=</span> [<span class="string">&quot;Red&quot;</span>, <span class="string">&quot;Green&quot;</span>, <span class="string">&quot;Blue&quot;</span>, <span class="string">&quot;Tartan&quot;</span>]</span><br><span class="line">   <span class="meta">@State</span> <span class="keyword">var</span> selectedColor <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">      <span class="type">VStack</span> &#123;</span><br><span class="line">         <span class="type">Picker</span>(selection: <span class="variable">$selectedColor</span>, label: <span class="type">Text</span>(<span class="string">&quot;Please choose a color&quot;</span>)) &#123;</span><br><span class="line">            <span class="type">ForEach</span>(<span class="number">0</span> <span class="operator">..&lt;</span> colors.count) &#123;</span><br><span class="line">               <span class="type">Text</span>(<span class="keyword">self</span>.colors[<span class="variable">$0</span>]).tag(<span class="variable">$0</span>)</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="type">Text</span>(<span class="string">&quot;You selected: <span class="subst">\(colors[selectedColor])</span>&quot;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-a-segmented-control-and-read-values-from-it"><a href="#How-to-create-a-segmented-control-and-read-values-from-it" class="headerlink" title="How to create a segmented control and read values from it"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-segmented-control-and-read-values-from-it">How to create a segmented control and read values from it</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> favoriteColor <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">var</span> colors <span class="operator">=</span> [<span class="string">&quot;Red&quot;</span>, <span class="string">&quot;Green&quot;</span>, <span class="string">&quot;Blue&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">SegmentedControl</span>(selection: <span class="variable">$favoriteColor</span>) &#123;</span><br><span class="line">                <span class="type">ForEach</span>(<span class="number">0</span><span class="operator">..&lt;</span>colors.count) &#123; index <span class="keyword">in</span></span><br><span class="line">                    <span class="type">Text</span>(<span class="keyword">self</span>.colors[index]).tag(index)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Value: <span class="subst">\(colors[favoriteColor])</span>&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-read-tap-and-double-tap-gestures"><a href="#How-to-read-tap-and-double-tap-gestures" class="headerlink" title="How to read tap and double-tap gestures"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-read-tap-and-double-tap-gestures">How to read tap and double-tap gestures</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>)</span><br><span class="line">    .tapAction(count: <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Double tapped!&quot;</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-add-a-gesture-recognizer-to-a-view"><a href="#How-to-add-a-gesture-recognizer-to-a-view" class="headerlink" title="How to add a gesture recognizer to a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-add-a-gesture-recognizer-to-a-view">How to add a gesture recognizer to a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> scale: <span class="type">Length</span> <span class="operator">=</span> <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>)</span><br><span class="line">            .scaleEffect(scale)</span><br><span class="line"></span><br><span class="line">            .gesture(</span><br><span class="line">                <span class="type">TapGesture</span>()</span><br><span class="line">                    .onEnded &#123; <span class="keyword">_</span> <span class="keyword">in</span></span><br><span class="line">                        <span class="keyword">self</span>.scale <span class="operator">+=</span> <span class="number">0.1</span></span><br><span class="line">                    &#125;</span><br><span class="line">            )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h2><p><strong>Create scrolling tables of data</strong></p>
<h3 id="Working-with-lists"><a href="#Working-with-lists" class="headerlink" title="Working with lists"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/working-with-lists">Working with lists</a></h3><p>SwiftUI’s <code>List</code> view is similar to <code>UITableView</code> in that it can show static or dynamic table view cells based on your needs.</p>
<h3 id="How-to-create-a-list-of-static-items"><a href="#How-to-create-a-list-of-static-items" class="headerlink" title="How to create a list of static items"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-list-of-static-items">How to create a list of static items</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">RestaurantRow</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Restaurant: <span class="subst">\(name)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">RestaurantRow</span>(name: <span class="string">&quot;Joe&#x27;s Original&quot;</span>)</span><br><span class="line">            <span class="type">RestaurantRow</span>(name: <span class="string">&quot;The Real Joe&#x27;s Original&quot;</span>)</span><br><span class="line">            <span class="type">RestaurantRow</span>(name: <span class="string">&quot;Original Joe&#x27;s&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-a-list-of-dynamic-items"><a href="#How-to-create-a-list-of-dynamic-items" class="headerlink" title="How to create a list of dynamic items"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-list-of-dynamic-items">How to create a list of dynamic items</a></h3><p>In order to handle dynamic items, you must first tell SwiftUI how it can identify which item is which. This is done using the <code>Identifiable</code> protocol, which has only one requirement: some sort of <code>id</code> value that SwiftUI can use to see which item is which.</p>
<p>和<code>ForEach</code>一样，可以使用符合<code>Identifiable</code> 协议的Model</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Restaurant</span>: <span class="title class_">Identifiable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> id <span class="operator">=</span> <span class="type">UUID</span>()</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">RestaurantRow</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> restaurant: <span class="type">Restaurant</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Come and eat at <span class="subst">\(restaurant.name)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> first <span class="operator">=</span> <span class="type">Restaurant</span>(name: <span class="string">&quot;Joe&#x27;s Original&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> second <span class="operator">=</span> <span class="type">Restaurant</span>(name: <span class="string">&quot;The Real Joe&#x27;s Original&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> third <span class="operator">=</span> <span class="type">Restaurant</span>(name: <span class="string">&quot;Original Joe&#x27;s&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> restaurants <span class="operator">=</span> [first, second, third]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="type">List</span>(restaurants) &#123; restaurant <span class="keyword">in</span></span><br><span class="line">            <span class="type">RestaurantRow</span>(restaurant: restaurant)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// return List(restaurants, rowContent: RestaurantRow.init)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="How-to-add-sections-to-a-list"><a href="#How-to-add-sections-to-a-list" class="headerlink" title="How to add sections to a list"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-add-sections-to-a-list">How to add sections to a list</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Section</span>(header: <span class="type">Text</span>(<span class="string">&quot;Other tasks&quot;</span>), footer: <span class="type">Text</span>(<span class="string">&quot;End&quot;</span>)) &#123;</span><br><span class="line">    <span class="type">TaskRow</span>()</span><br><span class="line">    <span class="type">TaskRow</span>()</span><br><span class="line">    <span class="type">TaskRow</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-make-a-grouped-list"><a href="#How-to-make-a-grouped-list" class="headerlink" title="How to make a grouped list"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-make-a-grouped-list">How to make a grouped list</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ExampleRow</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Example Row&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">Section</span>(header: <span class="type">Text</span>(<span class="string">&quot;Examples&quot;</span>)) &#123;</span><br><span class="line">                <span class="type">ExampleRow</span>()</span><br><span class="line">                <span class="type">ExampleRow</span>()</span><br><span class="line">                <span class="type">ExampleRow</span>()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.listStyle(.grouped)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Working-with-implicit-stacking"><a href="#Working-with-implicit-stacking" class="headerlink" title="Working with implicit stacking"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/working-with-implicit-stacking">Working with implicit stacking</a></h3><p>What happens if you create a dynamic list and put more than one thing in each row? SwiftUI’s solution is simple, flexible, and gives us great behavior by default: it creates an implicit <code>HStack</code> to hold your items, so they automatically get laid out horizontally.</p>
<p>List 会隐式的创建一个<code>HStack</code> 封装所有元素到Row中。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ExampleRow</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Example Row&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">Section</span>(header: <span class="type">Text</span>(<span class="string">&quot;Examples&quot;</span>)) &#123;</span><br><span class="line">                <span class="type">ExampleRow</span>()</span><br><span class="line">                <span class="type">ExampleRow</span>()</span><br><span class="line">                <span class="type">ExampleRow</span>()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.listStyle(.grouped)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Containers"><a href="#Containers" class="headerlink" title="Containers"></a>Containers</h2><p><strong>Place your views inside a navigation controller</strong></p>
<h3 id="Working-with-containers"><a href="#Working-with-containers" class="headerlink" title="Working with containers"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/working-with-containers">Working with containers</a></h3><p>SwiftUI is designed to be composed right out of the box, which means you can place one view inside another as much as you need.</p>
<p>常见的容器有：  <code>NavigationView</code>, <code>TabbedView</code>, <code>Group</code></p>
<h3 id="How-to-embed-a-view-in-a-navigation-view"><a href="#How-to-embed-a-view-in-a-navigation-view" class="headerlink" title="How to embed a view in a navigation view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-embed-a-view-in-a-navigation-view">How to embed a view in a navigation view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NavigationView</span> &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;SwiftUI&quot;</span>)</span><br><span class="line">        .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Welcome&quot;</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-add-bar-items-to-a-navigation-view"><a href="#How-to-add-bar-items-to-a-navigation-view" class="headerlink" title="How to add bar items to a navigation view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-add-bar-items-to-a-navigation-view">How to add bar items to a navigation view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">NavigationView</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;SwiftUI&quot;</span>)</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Welcome&quot;</span>))</span><br><span class="line">            .navigationBarItems(trailing:</span><br><span class="line">                <span class="type">Button</span>(action: &#123;</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Help tapped!&quot;</span>)</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Help&quot;</span>)</span><br><span class="line">                &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-group-views-together"><a href="#How-to-group-views-together" class="headerlink" title="How to group views together"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-group-views-together">How to group views together</a></h3><p><code>Stack</code> 不能超过10个元素</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">VStack</span> &#123;</span><br><span class="line">        <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Line&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Alerts-and-action-sheets"><a href="#Alerts-and-action-sheets" class="headerlink" title="Alerts and action sheets"></a>Alerts and action sheets</h2><p><strong>Show modal notifications when something happens</strong></p>
<h3 id="Working-with-presentations"><a href="#Working-with-presentations" class="headerlink" title="Working with presentations"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/working-with-presentations">Working with presentations</a></h3><p>SwiftUI’s declarative approach to programming means that we don’t create and present alert and action sheets in the same way as we did in UIKit. Instead, we define the conditions in which they should be shown, tell it what they should look like, then leave it to figure the rest out for itself.</p>
<h3 id="How-to-show-an-alert"><a href="#How-to-show-an-alert" class="headerlink" title="How to show an alert"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-show-an-alert">How to show an alert</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showingAlert <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">self</span>.showingAlert <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Show Alert&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .presentation(<span class="variable">$showingAlert</span>) &#123;</span><br><span class="line">            <span class="type">Alert</span>(title: <span class="type">Text</span>(<span class="string">&quot;Important message&quot;</span>), message: <span class="type">Text</span>(<span class="string">&quot;Wear sunscreen&quot;</span>), dismissButton: .default(<span class="type">Text</span>(<span class="string">&quot;Got it!&quot;</span>)))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-add-actions-to-alert-buttons"><a href="#How-to-add-actions-to-alert-buttons" class="headerlink" title="How to add actions to alert buttons"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-add-actions-to-alert-buttons">How to add actions to alert buttons</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showingAlert <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">self</span>.showingAlert <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Show Alert&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">            .presentation(<span class="variable">$showingAlert</span>) &#123;</span><br><span class="line">                <span class="type">Alert</span>(title: <span class="type">Text</span>(<span class="string">&quot;Are you sure you want to delete this?&quot;</span>), message: <span class="type">Text</span>(<span class="string">&quot;There is no undo&quot;</span>), primaryButton: .destructive(<span class="type">Text</span>(<span class="string">&quot;Delete&quot;</span>)) &#123;</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;Deleting...&quot;</span>)</span><br><span class="line">                &#125;, secondaryButton: .cancel())</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-show-an-action-sheet"><a href="#How-to-show-an-action-sheet" class="headerlink" title="How to show an action sheet"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-show-an-action-sheet">How to show an action sheet</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showingSheet <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> sheet: <span class="type">ActionSheet</span> &#123;</span><br><span class="line">        <span class="type">ActionSheet</span>(title: <span class="type">Text</span>(<span class="string">&quot;Action&quot;</span>), message: <span class="type">Text</span>(<span class="string">&quot;Quote mark&quot;</span>), buttons: [.default(<span class="type">Text</span>(<span class="string">&quot;Woo&quot;</span>), onTrigger: &#123;</span><br><span class="line">            <span class="keyword">self</span>.showingSheet <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">        &#125;)])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">self</span>.showingSheet <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Woo&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">            .presentation(showingSheet <span class="operator">?</span> sheet : <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Presenting-views"><a href="#Presenting-views" class="headerlink" title="Presenting views"></a>Presenting views</h2><p><strong>Move your user from one view to another</strong></p>
<h3 id="How-to-push-a-new-view-using-NavigationButton"><a href="#How-to-push-a-new-view-using-NavigationButton" class="headerlink" title="How to push a new view using NavigationButton"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-push-a-new-view-using-navigationbutton">How to push a new view using NavigationButton</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">DetailView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Detail&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">NavigationButton</span>(destination: <span class="type">DetailView</span>()) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Click&quot;</span>)</span><br><span class="line">            &#125;.navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Navigation&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-push-a-new-view-when-a-list-row-is-tapped"><a href="#How-to-push-a-new-view-when-a-list-row-is-tapped" class="headerlink" title="How to push a new view when a list row is tapped"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-push-a-new-view-when-a-list-row-is-tapped">How to push a new view when a list row is tapped</a></h3><p>SwiftUI doesn’t have a direct equivalent of the <code>didSelectRowAt</code> method of <code>UITableView</code>, but it doesn’t need one because we can combine <code>NavigationButton</code>with a list row and get the behavior for free.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Restaurant</span>: <span class="title class_">Identifiable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> id <span class="operator">=</span> <span class="type">UUID</span>()</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">RestaurantRow</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> restaurant: <span class="type">Restaurant</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(restaurant.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">RestaurantView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> restaurant: <span class="type">Restaurant</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Come and eat at <span class="subst">\(restaurant.name)</span>&quot;</span>)</span><br><span class="line">            .font(.largeTitle)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> first <span class="operator">=</span> <span class="type">Restaurant</span>(name: <span class="string">&quot;Joe&#x27;s Original&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> restaurants <span class="operator">=</span> [first]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span>(restaurants) &#123; restaurant <span class="keyword">in</span></span><br><span class="line">                <span class="type">NavigationButton</span>(destination: <span class="type">RestaurantView</span>(restaurant: restaurant)) &#123;</span><br><span class="line">                    <span class="type">RestaurantRow</span>(restaurant: restaurant)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;.navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Select a restaurant&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="How-to-present-a-new-view-using-PresentationButton"><a href="#How-to-present-a-new-view-using-PresentationButton" class="headerlink" title="How to present a new view using PresentationButton"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-present-a-new-view-using-presentationbutton">How to present a new view using PresentationButton</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">DetailView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Detail&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">PresentationButton</span>(<span class="type">Text</span>(<span class="string">&quot;Click to show&quot;</span>), destination: <span class="type">DetailView</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Transforming-views"><a href="#Transforming-views" class="headerlink" title="Transforming views"></a>Transforming views</h2><p><strong>Clip, size, scale, spin, and more</strong></p>
<h3 id="How-to-give-a-view-a-custom-frame"><a href="#How-to-give-a-view-a-custom-frame" class="headerlink" title="How to give a view a custom frame"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-give-a-view-a-custom-frame">How to give a view a custom frame</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Button</span>(action: &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Button tapped&quot;</span>)</span><br><span class="line">&#125;) &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;Welcome&quot;</span>)</span><br><span class="line">        .frame(minWidth: <span class="number">0</span>, maxWidth: <span class="number">200</span>, minHeight: <span class="number">0</span>, maxHeight: <span class="number">200</span>)</span><br><span class="line">        .font(.largeTitle)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">Text</span>(<span class="string">&quot;Please log in&quot;</span>)</span><br><span class="line">.frame(minWidth: <span class="number">0</span>, maxWidth: .infinity, minHeight: <span class="number">0</span>, maxHeight: .infinity)</span><br><span class="line">    .font(.largeTitle)</span><br><span class="line">    .foregroundColor(.white)</span><br><span class="line">    .background(<span class="type">Color</span>.red)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-adjust-the-position-of-a-view"><a href="#How-to-adjust-the-position-of-a-view" class="headerlink" title="How to adjust the position of a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-adjust-the-position-of-a-view">How to adjust the position of a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">VStack</span> &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;Home&quot;</span>)</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;Options&quot;</span>)</span><br><span class="line">        .offset(y: <span class="number">15</span>)</span><br><span class="line">        .padding(.bottom, <span class="number">15</span>)</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;Help&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-color-the-padding-around-a-view"><a href="#How-to-color-the-padding-around-a-view" class="headerlink" title="How to color the padding around a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-color-the-padding-around-a-view">How to color the padding around a view</a></h3><p>Padding 的先后顺序影响结果，因为代码是顺序执行的。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hacking with Swift&quot;</span>)</span><br><span class="line">    .background(<span class="type">Color</span>.black)</span><br><span class="line">    .foregroundColor(.white)</span><br><span class="line">    .padding()</span><br><span class="line"></span><br><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hacking with Swift&quot;</span>)</span><br><span class="line">    .padding()</span><br><span class="line">    .background(<span class="type">Color</span>.black)</span><br><span class="line">    .foregroundColor(.white)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-stack-modifiers-to-create-more-advanced-effects"><a href="#How-to-stack-modifiers-to-create-more-advanced-effects" class="headerlink" title="How to stack modifiers to create more advanced effects"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-stack-modifiers-to-create-more-advanced-effects">How to stack modifiers to create more advanced effects</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Forecast: Sun&quot;</span>)</span><br><span class="line">    .font(.largeTitle)</span><br><span class="line">    .foregroundColor(.white)</span><br><span class="line">    .padding()</span><br><span class="line">    .background(<span class="type">Color</span>.red)</span><br><span class="line">    .padding()</span><br><span class="line">    .background(<span class="type">Color</span>.orange)</span><br><span class="line">    .padding()</span><br><span class="line">    .background(<span class="type">Color</span>.yellow)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-draw-a-border-around-a-view"><a href="#How-to-draw-a-border-around-a-view" class="headerlink" title="How to draw a border around a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-draw-a-border-around-a-view">How to draw a border around a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hacking with Swift&quot;</span>)</span><br><span class="line">    .padding()</span><br><span class="line">    .border(<span class="type">Color</span>.red, width: <span class="number">4</span>, cornerRadius: <span class="number">16</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-draw-a-shadow-around-a-view"><a href="#How-to-draw-a-shadow-around-a-view" class="headerlink" title="How to draw a shadow around a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-draw-a-shadow-around-a-view">How to draw a shadow around a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hacking with Swift&quot;</span>)</span><br><span class="line">    .padding()</span><br><span class="line">    .border(<span class="type">Color</span>.red, width: <span class="number">4</span>)</span><br><span class="line">    .shadow(color: .red, radius: <span class="number">5</span>, x: <span class="number">20</span>, y: <span class="number">20</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-clip-a-view-so-only-part-is-visible"><a href="#How-to-clip-a-view-so-only-part-is-visible" class="headerlink" title="How to clip a view so only part is visible"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-clip-a-view-so-only-part-is-visible">How to clip a view so only part is visible</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Button</span>(action: &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Button tapped&quot;</span>)</span><br><span class="line">&#125;) &#123;</span><br><span class="line">    <span class="type">Image</span>(systemName: <span class="string">&quot;bolt.fill&quot;</span>)</span><br><span class="line">        .foregroundColor(.white)</span><br><span class="line">        .padding()</span><br><span class="line">        .background(<span class="type">Color</span>.green)</span><br><span class="line">        .clipShape(<span class="type">Circle</span>())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-rotate-a-view"><a href="#How-to-rotate-a-view" class="headerlink" title="How to rotate a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-rotate-a-view">How to rotate a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> rotation: <span class="type">Double</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Slider</span>(value: <span class="variable">$rotation</span>, from: <span class="number">0.0</span>, through: <span class="number">360.0</span>, by: <span class="number">1.0</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Up we go&quot;</span>)</span><br><span class="line">                .rotationEffect(.degrees(rotation))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-rotate-a-view-in-3D"><a href="#How-to-rotate-a-view-in-3D" class="headerlink" title="How to rotate a view in 3D"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-rotate-a-view-in-3d">How to rotate a view in 3D</a></h3><p>SwiftUI’s <code>rotation3DEffect()</code> modifier lets us rotate views in 3D space to create beautiful effects in almost no code.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;EPISODE LLVM&quot;</span>)</span><br><span class="line">    .font(.largeTitle)</span><br><span class="line">    .foregroundColor(.yellow)</span><br><span class="line">    .rotation3DEffect(.degrees(<span class="number">45</span>), axis: (x: <span class="number">1</span>, y: <span class="number">0</span>, z: <span class="number">0</span>))</span><br></pre></td></tr></table></figure>

<h3 id="How-to-scale-a-view-up-or-down"><a href="#How-to-scale-a-view-up-or-down" class="headerlink" title="How to scale a view up or down"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-scale-a-view-up-or-down">How to scale a view up or down</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Up we go&quot;</span>)</span><br><span class="line">    .scaleEffect(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-round-the-corners-of-a-view"><a href="#How-to-round-the-corners-of-a-view" class="headerlink" title="How to round the corners of a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-round-the-corners-of-a-view">How to round the corners of a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Round Me&quot;</span>)</span><br><span class="line">    .padding()</span><br><span class="line">    .background(<span class="type">Color</span>.red)</span><br><span class="line">    .cornerRadius(<span class="number">25</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-adjust-the-opacity-of-a-view"><a href="#How-to-adjust-the-opacity-of-a-view" class="headerlink" title="How to adjust the opacity of a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-adjust-the-opacity-of-a-view">How to adjust the opacity of a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Now you see me&quot;</span>)</span><br><span class="line">    .padding()</span><br><span class="line">    .background(<span class="type">Color</span>.red)</span><br><span class="line">    .opacity(<span class="number">0.3</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-adjust-the-accent-color-of-a-view"><a href="#How-to-adjust-the-accent-color-of-a-view" class="headerlink" title="How to adjust the accent color of a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-adjust-the-accent-color-of-a-view">How to adjust the accent color of a view</a></h3><p>iOS uses tint colors to give apps a coordinated theme, and the same functionality is available in SwiftUI under the name <em>accent colors</em>.</p>
<h3 id="How-to-mask-one-view-with-another"><a href="#How-to-mask-one-view-with-another" class="headerlink" title="How to mask one view with another"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-mask-one-view-with-another">How to mask one view with another</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Image</span>(<span class="string">&quot;stripes&quot;</span>)</span><br><span class="line">    .resizable()</span><br><span class="line">    .frame(width: <span class="number">300</span>, height: <span class="number">300</span>)</span><br><span class="line">    .mask(<span class="type">Text</span>(<span class="string">&quot;SWIFT!&quot;</span>)</span><br><span class="line">        .font(<span class="type">Font</span>.system(size: <span class="number">72</span>).weight(.black)))</span><br></pre></td></tr></table></figure>

<h3 id="How-to-blur-a-view"><a href="#How-to-blur-a-view" class="headerlink" title="How to blur a view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-blur-a-view">How to blur a view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Welcome to my SwiftUI app&quot;</span>)</span><br><span class="line">    .blur(radius: <span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-blend-views-together"><a href="#How-to-blend-views-together" class="headerlink" title="How to blend views together"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-blend-views-together">How to blend views together</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ZStack</span> &#123;</span><br><span class="line">    <span class="type">Image</span>(<span class="string">&quot;paul-hudson&quot;</span>)</span><br><span class="line">    <span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>)</span><br><span class="line">        .blendMode(.multiply)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-adjust-views-by-tinting-and-desaturating-and-more"><a href="#How-to-adjust-views-by-tinting-and-desaturating-and-more" class="headerlink" title="How to adjust views by tinting, and desaturating, and more"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-adjust-views-by-tinting-and-desaturating-and-more">How to adjust views by tinting, and desaturating, and more</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Image</span>(<span class="string">&quot;paul-hudson&quot;</span>)</span><br><span class="line">    .contrast(<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Animation"><a href="#Animation" class="headerlink" title="Animation"></a>Animation</h2><p><strong>Bring your views to life with movement</strong></p>
<h3 id="How-to-create-a-basic-animation"><a href="#How-to-create-a-basic-animation" class="headerlink" title="How to create a basic animation"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-basic-animation">How to create a basic animation</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> angle: <span class="type">Double</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> borderThickness: <span class="type">Length</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">self</span>.angle <span class="operator">+=</span> <span class="number">45</span></span><br><span class="line">            <span class="keyword">self</span>.borderThickness <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Tap here&quot;</span>)</span><br><span class="line">                .padding()</span><br><span class="line">                .border(<span class="type">Color</span>.red, width: borderThickness)</span><br><span class="line">                .rotationEffect(.degrees(angle))</span><br><span class="line">                .animation(.basic())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-a-spring-animation"><a href="#How-to-create-a-spring-animation" class="headerlink" title="How to create a spring animation"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-spring-animation">How to create a spring animation</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> angle: <span class="type">Double</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">self</span>.angle <span class="operator">+=</span> <span class="number">45</span></span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Tap here&quot;</span>)</span><br><span class="line">                .padding()</span><br><span class="line">                .rotationEffect(.degrees(angle))</span><br><span class="line">                .animation(.spring())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-an-explicit-animation"><a href="#How-to-create-an-explicit-animation" class="headerlink" title="How to create an explicit animation"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-an-explicit-animation">How to create an explicit animation</a></h3><p>Explicit animations are often helpful because they cause every affected view to animation, not just those that have implicit animations attached. For example, if view A has to make room for view B as part of the animation, but only view B has an animation attached, then view A will jump to its new position without animating unless you use explicit animations.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> opacity: <span class="type">Double</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            withAnimation &#123;</span><br><span class="line">                <span class="keyword">self</span>.opacity <span class="operator">-=</span> <span class="number">0.2</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Tap here&quot;</span>)</span><br><span class="line">                .padding()</span><br><span class="line">                .opacity(opacity)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-add-and-remove-views-with-a-transition"><a href="#How-to-add-and-remove-views-with-a-transition" class="headerlink" title="How to add and remove views with a transition"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-add-and-remove-views-with-a-transition">How to add and remove views with a transition</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showDetails <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Button</span>(action: &#123;</span><br><span class="line">                withAnimation &#123;</span><br><span class="line">                    <span class="keyword">self</span>.showDetails.toggle()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Tap to show details&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetails &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Details go here.&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>By default, SwiftUI uses a fade animation to insert or remove views, but you can change that if you want by attaching a <code>transition()</code> modifier to a view.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Details go here.&quot;</span>)</span><br><span class="line">    .transition(.move(edge: .bottom))</span><br></pre></td></tr></table></figure>

<h3 id="How-to-combine-transitions"><a href="#How-to-combine-transitions" class="headerlink" title="How to combine transitions"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-combine-transitions">How to combine transitions</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Details go here.&quot;</span>).transition(<span class="type">AnyTransition</span>.opacity.combined(with: .slide))</span><br></pre></td></tr></table></figure>

<p>或者使用拓展来封装常用的过渡效果</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">AnyTransition</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> moveAndScale: <span class="type">AnyTransition</span> &#123;</span><br><span class="line">        <span class="type">AnyTransition</span>.move(edge: .bottom).combined(with: .scale())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Usage</span></span><br><span class="line"><span class="type">Text</span>(<span class="string">&quot;Details go here.&quot;</span>).transition(.moveAndScale)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-asymmetric-transitions"><a href="#How-to-create-asymmetric-transitions" class="headerlink" title="How to create asymmetric transitions"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-asymmetric-transitions">How to create asymmetric transitions</a></h3><p>SwiftUI lets us specify one transition when adding a view and another when removing it, all done using the <code>asymmetric()</code> transition type.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Details go here.&quot;</span>).transition(.asymmetric(insertion: .move(edge: .leading), removal: .move(edge: .bottom)))</span><br></pre></td></tr></table></figure>

<h2 id="Composing-views"><a href="#Composing-views" class="headerlink" title="Composing views"></a>Composing views</h2><p><strong>Make your UI structure easier to understand</strong></p>
<h3 id="How-to-create-and-compose-custom-views"><a href="#How-to-create-and-compose-custom-views" class="headerlink" title="How to create and compose custom views"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-and-compose-custom-views">How to create and compose custom views</a></h3><p>都是基于数据驱动UI，所以每一级封装都是传Model：<code>User</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> jobTitle: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> emailAddress: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> profilePicture: <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfilePicture</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> imageName: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Image</span>(imageName)</span><br><span class="line">            .resizable()</span><br><span class="line">            .frame(width: <span class="number">100</span>, height: <span class="number">100</span>)</span><br><span class="line">            .clipShape(<span class="type">Circle</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">EmailAddress</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> address: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            <span class="type">Image</span>(systemName: <span class="string">&quot;envelope&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(address)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">UserDetails</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> user: <span class="type">User</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Text</span>(user.name)</span><br><span class="line">                .font(.largeTitle)</span><br><span class="line">                .foregroundColor(.primary)</span><br><span class="line">            <span class="type">Text</span>(user.jobTitle)</span><br><span class="line">                .foregroundColor(.secondary)</span><br><span class="line">            <span class="type">EmailAddress</span>(address: user.emailAddress)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">UserView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> user: <span class="type">User</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            <span class="type">ProfilePicture</span>(imageName: user.profilePicture)</span><br><span class="line">            <span class="type">UserDetails</span>(user: user)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> user <span class="operator">=</span> <span class="type">User</span>(name: <span class="string">&quot;Paul Hudson&quot;</span>, jobTitle: <span class="string">&quot;Editor, Hacking with Swift&quot;</span>, emailAddress: <span class="string">&quot;paul@hackingwithswift.com&quot;</span>, profilePicture: <span class="string">&quot;paul-hudson&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">UserView</span>(user: user)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-combine-text-views-together"><a href="#How-to-combine-text-views-together" class="headerlink" title="How to combine text views together"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-combine-text-views-together">How to combine text views together</a></h3><p>这样子拼接文本很方便</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;SwiftUI &quot;</span>)</span><br><span class="line">        .font(.largeTitle)</span><br><span class="line">    <span class="operator">+</span> <span class="type">Text</span>(<span class="string">&quot;is &quot;</span>)</span><br><span class="line">        .font(.headline)</span><br><span class="line">    <span class="operator">+</span> <span class="type">Text</span>(<span class="string">&quot;awesome&quot;</span>)</span><br><span class="line">        .font(.footnote)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是有个修改器不适合拼接如：<code>foregroundColor</code></p>
<p>这时候就需要换成能够使用<code>+</code>的修改器，如<code>color</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;SwiftUI &quot;</span>)</span><br><span class="line">    .color(.red)</span><br><span class="line"><span class="operator">+</span> <span class="type">Text</span>(<span class="string">&quot;is &quot;</span>)</span><br><span class="line">    .color(.orange)</span><br><span class="line"><span class="operator">+</span> <span class="type">Text</span>(<span class="string">&quot;awesome&quot;</span>)</span><br><span class="line">    .color(.blue)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-store-views-as-properties"><a href="#How-to-store-views-as-properties" class="headerlink" title="How to store views as properties"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-store-views-as-properties">How to store views as properties</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> title <span class="operator">=</span> <span class="type">Text</span>(<span class="string">&quot;Paul Hudson&quot;</span>)</span><br><span class="line">        .font(.largeTitle)</span><br><span class="line">    <span class="keyword">let</span> subtitle <span class="operator">=</span> <span class="type">Text</span>(<span class="string">&quot;Author&quot;</span>)</span><br><span class="line">        .foregroundColor(.secondary)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            title</span><br><span class="line">            .color(.red)</span><br><span class="line">            subtitle</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="How-to-create-custom-modifiers"><a href="#How-to-create-custom-modifiers" class="headerlink" title="How to create custom modifiers"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-custom-modifiers">How to create custom modifiers</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">PrimaryLabel</span>: <span class="title class_">ViewModifier</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">body</span>(<span class="params">content</span>: <span class="type">Content</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        content</span><br><span class="line">            .padding()</span><br><span class="line">            .background(<span class="type">Color</span>.red)</span><br><span class="line">            .foregroundColor(<span class="type">Color</span>.white)</span><br><span class="line">            .font(.largeTitle)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello, SwiftUI&quot;</span>)</span><br><span class="line">            .modifier(<span class="type">PrimaryLabel</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Tooling"><a href="#Tooling" class="headerlink" title="Tooling"></a>Tooling</h2><p><strong>Build better apps with help from Xcode</strong></p>
<h3 id="How-to-preview-your-layout-at-different-Dynamic-Type-sizes"><a href="#How-to-preview-your-layout-at-different-Dynamic-Type-sizes" class="headerlink" title="How to preview your layout at different Dynamic Type sizes"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-preview-your-layout-at-different-dynamic-type-sizes">How to preview your layout at different Dynamic Type sizes</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">#if</span> <span class="type">DEBUG</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Previews</span> : <span class="title class_">PreviewProvider</span> &#123;</span><br><span class="line">   <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">      <span class="type">Group</span> &#123;</span><br><span class="line">         <span class="type">ContentView</span>()</span><br><span class="line">            .environment(\.colorScheme, .dark)</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">#endif</span></span><br></pre></td></tr></table></figure>

<h3 id="How-to-preview-your-layout-in-light-and-dark-mode"><a href="#How-to-preview-your-layout-in-light-and-dark-mode" class="headerlink" title="How to preview your layout in light and dark mode"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-preview-your-layout-in-light-and-dark-mode">How to preview your layout in light and dark mode</a></h3><p>If you want to see both light and dark mode side by side, place multiple previews in a group, like this:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">#if</span> <span class="type">DEBUG</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Previews</span> : <span class="title class_">PreviewProvider</span> &#123;</span><br><span class="line">   <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">      <span class="type">Group</span> &#123;</span><br><span class="line">         <span class="type">ContentView</span>()</span><br><span class="line">            .environment(\.colorScheme, .light)</span><br><span class="line"></span><br><span class="line">         <span class="type">ContentView</span>()</span><br><span class="line">            .environment(\.colorScheme, .dark)</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">#endif</span></span><br></pre></td></tr></table></figure>

<h3 id="How-to-preview-your-layout-in-different-devices"><a href="#How-to-preview-your-layout-in-different-devices" class="headerlink" title="How to preview your layout in different devices"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-preview-your-layout-in-different-devices">How to preview your layout in different devices</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ContentView</span>()</span><br><span class="line">    .previewDevice(<span class="type">PreviewDevice</span>(rawValue: <span class="string">&quot;iPhone SE&quot;</span>))</span><br></pre></td></tr></table></figure>

<h3 id="How-to-preview-your-layout-in-a-navigation-view"><a href="#How-to-preview-your-layout-in-a-navigation-view" class="headerlink" title="How to preview your layout in a navigation view"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-preview-your-layout-in-a-navigation-view">How to preview your layout in a navigation view</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">   <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">      <span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">         .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Welcome&quot;</span>))</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">#if</span> <span class="type">DEBUG</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Previews</span> : <span class="title class_">PreviewProvider</span> &#123;</span><br><span class="line">   <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">      <span class="type">NavigationView</span> &#123;</span><br><span class="line">         <span class="type">ContentView</span>()</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">#endif</span></span><br></pre></td></tr></table></figure>

<h3 id="How-to-use-Instruments-to-profile-your-SwiftUI-code-and-identify-slow-layouts"><a href="#How-to-use-Instruments-to-profile-your-SwiftUI-code-and-identify-slow-layouts" class="headerlink" title="How to use Instruments to profile your SwiftUI code and identify slow layouts"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-use-instruments-to-profile-your-swiftui-code-and-identify-slow-layouts">How to use Instruments to profile your SwiftUI code and identify slow layouts</a></h3><p>示例代码</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Combine</span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FrequentUpdater</span>: <span class="title class_">BindableObject</span> &#123;</span><br><span class="line">   <span class="keyword">var</span> didChange <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Void</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">   <span class="keyword">var</span> timer: <span class="type">Timer</span>?</span><br><span class="line"></span><br><span class="line">   <span class="keyword">init</span>() &#123;</span><br><span class="line">      timer <span class="operator">=</span> <span class="type">Timer</span>.scheduledTimer(</span><br><span class="line">         withTimeInterval: <span class="number">0.01</span>,</span><br><span class="line">         repeats: <span class="literal">true</span></span><br><span class="line">      ) &#123; <span class="keyword">_</span> <span class="keyword">in</span></span><br><span class="line">         <span class="keyword">self</span>.didChange.send(())</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">   <span class="meta">@ObjectBinding</span> <span class="keyword">var</span> updater <span class="operator">=</span> <span class="type">FrequentUpdater</span>()</span><br><span class="line">   <span class="meta">@State</span> <span class="keyword">var</span> tapCount <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">      <span class="type">VStack</span> &#123;</span><br><span class="line">         <span class="type">Text</span>(<span class="string">&quot;<span class="subst">\(UUID().uuidString)</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">         <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">self</span>.tapCount <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">         &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Tap count: <span class="subst">\(tapCount)</span>&quot;</span>)</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="检测我们的代码"><a href="#检测我们的代码" class="headerlink" title="检测我们的代码"></a>检测我们的代码</h4><p>默认情况下，SwiftUI工具告诉我们各种各样的事情：</p>
<p>1.在此期间创建了多少视图以及创建它们需要多长时间（“View Body”）<br>2.视图的属性是什么以及它们如何随时间变化（“View Properties”）<br>3.发生了多少次Core Animation提交（“Core Animation Commits”）<br>4.每个函数调用的确切时间（“Time Profiler”）</p>
<p><img src="https://www.hackingwithswift.com/img/quick-start/swiftui/profiling-1.jpg"></p>
<h4 id="监视body调用"><a href="#监视body调用" class="headerlink" title="监视body调用"></a>监视<code>body</code>调用</h4><p>如果您选择<code>View Body</code>轨道 - 这是instrument列表中的第一行 - 您应该能够看到乐器将结果分解为SwiftUI和您的项目，前者是原始类型，如文本视图和按钮，以及后者包含您的自定义视图类型。在我们的例子中，这意味着“ContentView”应该出现在自定义视图中，因为这是我们视图的名称。</p>
<p>现在，您在这里看不到的是您的代码与SwiftUI视图的完美一对一映射，因为SwiftUI积极地折叠其视图层次结构以尽可能少地完成工作。所以，不要指望在代码中看到任何VStack创建 - 这个应用程序实际上是免费的。</p>
<p>在这个屏幕上，重要的数字是计数和平均持续时间 - 每件事创建的次数，以及花费的时间。因为这是一个压力测试你应该看到非常高的数字，但我们的布局是微不足道的，所以平均持续时间可能是几十微秒。</p>
<p><img src="https://www.hackingwithswift.com/img/quick-start/swiftui/profiling-2.jpg" alt="img"></p>
<h4 id="跟踪状态（state）变化"><a href="#跟踪状态（state）变化" class="headerlink" title="跟踪状态（state）变化"></a>跟踪状态（state）变化</h4><p>接下来，选择“View Properties”轨道，这是仪器列表中的第二行。这将显示所有视图的所有属性，包括其当前值和所有先前值。</p>
<p>我们的示例应用程序有一个按钮，通过在数字中添加一个来更改其标签，并且在此工具中可见 - 请查看视图类型ContentView和属性类型<code>State </code>。</p>
<p>可悲的是，Instruments还没有（还能）向我们展示那里的确切属性名称，如果你跟踪了几个整数状态，这可能会更加令人困惑。然而，它确实有一个不同的技巧：在记录窗口的顶部是一个标记当前视图位置的箭头，如果你拖动它，你会看到应用程序状态随时间的变化 - 每次你点击按钮，你会看到状态整数上升一个，你可以前进和后退来看它发生。</p>
<p>这可以释放巨大的能力，因为它可以让我们直接看到状态变化导致慢速重绘或其他工作 - 这几乎就像是在时间机器中，您可以在运行期间的每个点检查应用程序的确切状态。</p>
<p><img src="https://www.hackingwithswift.com/img/quick-start/swiftui/profiling-3.jpg" alt="img"></p>
<h4 id="识别慢速绘图"><a href="#识别慢速绘图" class="headerlink" title="识别慢速绘图"></a>识别慢速绘图</h4><p>虽然SwiftUI能够直接调用Metal以提高性能，但大多数情况下它更喜欢使用Core Animation进行渲染。这意味着我们会自动从Instruments获取内置的Core Animation分析工具，包括检测昂贵提交（expensive commits）的能力。</p>
<p>当多个更改放在一个组中时，Core Animation的效果最佳，称为<code>transaction</code>。我们在一个事务中有效地堆叠了一系列工作，然后要求CA继续渲染工作 - 称为<em>提交</em>事务。</p>
<p>因此，当Instruments向我们展示昂贵的Core Animation提交时，它真正向我们展示的是SwiftUI因为更新而被迫重绘屏幕上的像素的次数。理论上，这应该只在我们的应用程序的实际状态导致不同的视图层次结构时发生，因为SwiftUI应该能够将我们的<code>body</code>属性的新输出与先前的输出进行比较。</p>
<p><img src="https://www.hackingwithswift.com/img/quick-start/swiftui/profiling-4.jpg" alt="img"></p>
<h4 id="寻找缓慢的函数调用"><a href="#寻找缓慢的函数调用" class="headerlink" title="寻找缓慢的函数调用"></a>寻找缓慢的函数调用</h4><p>Time Profiler，它向我们展示了在代码的每个部分花费了多少时间。这与乐器中的常规时间分析器完全相同，但如果您之前没有尝试过，那么您至少需要知道：</p>
<ol>
<li><p>右侧的扩展详细信息窗口默认显示最重的堆栈跟踪，这是运行时间最长的代码段。明亮的代码（白色或黑色，取决于您的macOS配色方案）是您编写的代码;昏暗代码（灰色）是系统库代码。</p>
</li>
<li><p>在左侧，您可以看到创建的所有线程，以及公开指示器，让您深入了解它们调用的函数以及这些函数调用的函数等。大多数工作将在“start”内部进行。</p>
</li>
<li><p>为避免混乱，您可能需要单击底部的“调用树”按钮，然后选择“隐藏系统库”。这只会显示您编写的代码，但是如果您的问题是您使用的系统库很糟糕，这可能没有帮助。</p>
</li>
<li><p>要直接了解具体细节，您还可以单击“调用树”并选择“反转调用树”以翻转事物，以便叶子功能（树末端的功能）显示在顶部，现在可以向下钻取公开指示器（向上钻取？）到调用它们的函数。</p>
<p><img src="https://www.hackingwithswift.com/img/quick-start/swiftui/profiling-5.jpg"></p>
</li>
</ol>
<h4 id="最后一些提示"><a href="#最后一些提示" class="headerlink" title="最后一些提示"></a>最后一些提示</h4><p>在您收取配置自己的代码之前，有一些事情需要注意：</p>
<ol>
<li>在检查应用程序性能的一小部分时，您应该单击并拖动相关范围，以便仅查看该应用程序部分的统计信息。这使您可以专注于特定操作的性能，例如响应按下按钮。</li>
<li>即使你在仪器中看到纯色条，它们只是从远处看起来那样 - 你可以通过按住Cmd并按 - 和+来查看更多细节</li>
<li>要获得最准确的数字，请始终在真实设备上进行配置。</li>
<li>如果要通过分析代码进行更改，请始终一次进行一次更改。如果你进行两次更改，可能会使你的性能提高20％而另一种会降低10％，但是将它们合在一起意味着你可能会认为它们整体性能提高了10％。</li>
<li>Instruments在release模式下运行您的代码，从而实现Swift的所有优化。这也会影响您添加到代码中的任何调试标志，因此请小心。</li>
</ol>
<h2 id="What-now"><a href="#What-now" class="headerlink" title="What now?"></a>What now?</h2><p><strong>How to continue learning SwiftUI after the basics</strong></p>
<h3 id="SwiftUI-tips-and-tricks"><a href="#SwiftUI-tips-and-tricks" class="headerlink" title="SwiftUI tips and tricks"></a><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/swiftui-tips-and-tricks">SwiftUI tips and tricks</a></h3><p>SwiftUI拥有强大的标题功能，但也有许多较小的提示和技巧可以帮助您编写更好的应用程序。</p>
<h4 id="State-设为私有"><a href="#State-设为私有" class="headerlink" title="@State 设为私有"></a>@State 设为私有</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> score <span class="operator">=</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>

<h4 id="具有常量绑定的原型"><a href="#具有常量绑定的原型" class="headerlink" title="具有常量绑定的原型"></a>具有常量绑定的原型</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">TextField</span>(.constant(<span class="string">&quot;Hello&quot;</span>))</span><br><span class="line">    .textFieldStyle(.roundedBorder)</span><br></pre></td></tr></table></figure>

<h4 id="使用语义颜色"><a href="#使用语义颜色" class="headerlink" title="使用语义颜色"></a>使用语义颜色</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Color</span>.red</span><br></pre></td></tr></table></figure>

<h4 id="依靠自适应填充"><a href="#依靠自适应填充" class="headerlink" title="依靠自适应填充"></a>依靠自适应填充</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Row 1&quot;</span>)</span><br><span class="line">    .padding(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<h4 id="合并文本视图"><a href="#合并文本视图" class="headerlink" title="合并文本视图"></a>合并文本视图</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Colored &quot;</span>)</span><br><span class="line">            .color(.red)</span><br><span class="line">        <span class="operator">+</span></span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;SwifUI &quot;</span>)</span><br><span class="line">                .color(.green)</span><br><span class="line">        <span class="operator">+</span></span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Text&quot;</span>)</span><br><span class="line">            .color(.blue)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="如何使print-工作"><a href="#如何使print-工作" class="headerlink" title="如何使print()工作"></a>如何使<code>print()</code>工作</h4><p>右键单击预览画布（preview canvas）中的播放按钮，然后选择“调试预览（Debug Preview）”。</p>
<h4 id="依靠隐式HStack"><a href="#依靠隐式HStack" class="headerlink" title="依靠隐式HStack"></a>依靠隐式<code>HStack</code></h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> imageNames <span class="operator">=</span> [<span class="string">&quot;paul-hudson&quot;</span>, <span class="string">&quot;swiftui&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span>(imageNames.identified(by: \.<span class="keyword">self</span>)) &#123; image <span class="keyword">in</span></span><br><span class="line">            <span class="type">Image</span>(image).resizable().frame(width: <span class="number">40</span>)</span><br><span class="line">            <span class="type">Text</span>(image)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="分割大视图"><a href="#分割大视图" class="headerlink" title="分割大视图"></a>分割大视图</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> users <span class="operator">=</span> [<span class="string">&quot;Paul Hudson&quot;</span>, <span class="string">&quot;Taylor Swift&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span>(users.identified(by: \.<span class="keyword">self</span>)) &#123; user <span class="keyword">in</span></span><br><span class="line">                <span class="type">NavigationButton</span>(destination: <span class="type">Text</span>(<span class="string">&quot;Detail View&quot;</span>)) &#123;</span><br><span class="line">                    <span class="type">Image</span>(<span class="string">&quot;example-image&quot;</span>).resizable().frame(width: <span class="number">50</span>, height: <span class="number">50</span>)</span><br><span class="line"></span><br><span class="line">                    <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                        <span class="type">Text</span>(<span class="string">&quot;Johnny Appleseed&quot;</span>).font(.headline)</span><br><span class="line">                        <span class="type">Text</span>(<span class="string">&quot;Occupation: Programmer&quot;</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;.navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Users&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="更好的预览"><a href="#更好的预览" class="headerlink" title="更好的预览"></a>更好的预览</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">#if</span> <span class="type">DEBUG</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Previews</span> : <span class="title class_">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">ContentView</span>()</span><br><span class="line">                .environment(\.sizeCategory, .accessibilityExtraExtraExtraLarge)</span><br><span class="line">            <span class="type">ContentView</span>()</span><br><span class="line">                .environment(\.colorScheme, .dark)</span><br><span class="line">            <span class="type">NavigationView</span> &#123;</span><br><span class="line">                <span class="type">ContentView</span>()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">#endif</span></span><br></pre></td></tr></table></figure>

<h4 id="创建自定义修改器"><a href="#创建自定义修改器" class="headerlink" title="创建自定义修改器"></a>创建自定义修改器</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">PrimaryLabel</span>: <span class="title class_">ViewModifier</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">body</span>(<span class="params">content</span>: <span class="type">Content</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        content</span><br><span class="line">            .padding()</span><br><span class="line">            .background(<span class="type">Color</span>.black)</span><br><span class="line">            .foregroundColor(<span class="type">Color</span>.white)</span><br><span class="line">            .font(.largeTitle)</span><br><span class="line">            .cornerRadius(<span class="number">10</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">            .modifier(<span class="type">PrimaryLabel</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="动画变化很容易"><a href="#动画变化很容易" class="headerlink" title="动画变化很容易"></a>动画变化很容易</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span> : <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showingWelcome <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Toggle</span>(isOn: <span class="variable">$showingWelcome</span>.animation(.spring())) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Toggle label&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showingWelcome &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/03/17/Hackintosh-Installation-with-MSI-Z390-and-i9-9900K/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/03/17/Hackintosh-Installation-with-MSI-Z390-and-i9-9900K/" class="post-title-link" itemprop="url">黑苹果安装记录 MSI Z390 和 i9-9900K</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-03-17 23:12:36" itemprop="dateCreated datePublished" datetime="2019-03-17T23:12:36+08:00">2019-03-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-08 17:06:49" itemprop="dateModified" datetime="2023-09-08T17:06:49+08:00">2023-09-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>微星 MSI Z390 GAMING PRO CARBON AC 华硕 Vega64 黑苹果</p>
<h2 id="机器配置"><a href="#机器配置" class="headerlink" title="机器配置"></a>机器配置</h2><p>主板：<a target="_blank" rel="noopener" href="https://www.msi.com/Motherboard/MPG-Z390-GAMING-PRO-CARBON-AC">微星 MSI MPG Z390 GAMING PRO CARBON AC</a></p>
<p>CPU：<a target="_blank" rel="noopener" href="https://ark.intel.com/content/www/us/en/ark/products/186605/intel-core-i9-9900k-processor-16m-cache-up-to-5-00-ghz.html">Intel i9 9900K</a></p>
<p>内存：Avexir DDR4 2400</p>
<p>显卡：<a target="_blank" rel="noopener" href="https://www.asus.com/us/Graphics-Cards/AREZ-STRIX-RXVEGA64-O8G-GAMING/">华硕 ASUS AREZ-STRIX-RXVEGA64-O8G-GAMING</a></p>
<p>电源：<a target="_blank" rel="noopener" href="https://www.evga.com/products/product.aspx?pn=120-GP-0750-X1">EVGA SuperNOVA 750 G+</a></p>
<p>散热：<a target="_blank" rel="noopener" href="http://www.coolermaster.com/cooling/cpu-liquid-cooler/masterliquid-ml240r-rgb/">MASTERLIQUID ML240R RGB</a></p>
<p>固态：三星 970 EVO 500G</p>
<p>板载声卡：ALC S1220A</p>
<p>板载有线网卡：Intel I219V7</p>
<p>显示器：戴尔 P2715Q 4K显示器</p>
<p>机箱：<a target="_blank" rel="noopener" href="http://www.phanteks.com/Enthoo-Evolv-ATX-TemperedGlass.html">追风者 PK-515ETG</a></p>
<h2 id="安装过程"><a href="#安装过程" class="headerlink" title="安装过程"></a>安装过程</h2><p><strong>重要提示：已降 BIOS 至 <a target="_blank" rel="noopener" href="https://www.msi.com/Motherboard/support/MPG-Z390-GAMING-PRO-CARBON-AC">Version 7B17v10</a>，不在卡 no nvram variable。</strong></p>
<ol>
<li><a target="_blank" rel="noopener" href="https://blog.daliansky.net/macOS-Mojave-10.14.3-18D42-official-version-with-Clover-4859-original-image.html">【黑果小兵】<strong>macOS Mojave 10.14.3 18D42</strong> 正式版 <strong>with Clover 4859</strong>原版镜像</a></li>
<li>执行：<strong>300</strong>系列主板请于<strong>drivers64UEFI</strong>目录中移除<strong>AptioMemoryFix-64.efi</strong>添加<strong>OsxAptioFix2Drv-free2000.efi</strong>该驱动位于**&#x2F;EFI&#x2F;CLOVER&#x2F;drivers-off<strong>目录下。顺利进入</strong>macOS**安装界面</li>
<li>系统后序安装和复制 <strong>EFI</strong> 到硬盘教程：<a target="_blank" rel="noopener" href="https://blog.daliansky.net/Lenovo-Xiaoxin-Air-13-macOS-Mojave-installation-tutorial.html">联想小新<strong>Air 13</strong>安装黑苹果兼<strong>macOS Mojave</strong>安装教程</a></li>
<li>进入系统设置页面前：卡在 <strong>AppleUSBHostResources panic</strong>。解决方案是<strong>boot</strong> 添加 <strong>safe mode</strong></li>
<li>合并 <strong>Windows</strong> 和 <strong>Clover</strong> 引导</li>
<li>完善驱动</li>
<li>结束</li>
</ol>
<h2 id="附图"><a href="#附图" class="headerlink" title="附图"></a>附图</h2><h2 id="Hackintosh-i9-2019-03-15-https-gewill-org-assets-Hackintosh-i9-2019-03-15-png-总结"><a href="#Hackintosh-i9-2019-03-15-https-gewill-org-assets-Hackintosh-i9-2019-03-15-png-总结" class="headerlink" title="![Hackintosh-i9 2019-03-15](https://gewill.org/assets/Hackintosh-i9 2019-03-15.png)总结"></a>![Hackintosh-i9 2019-03-15](<a target="_blank" rel="noopener" href="https://gewill.org/assets/Hackintosh-i9">https://gewill.org/assets/Hackintosh-i9</a> 2019-03-15.png)总结</h2><ol>
<li>小兵教程很好用。</li>
<li>就是一直卡在 BIOS 部分，所以无论做什么努力的都没有效果。所以购买主板一定要看 tonymacx86.com 的 <a target="_blank" rel="noopener" href="https://www.tonymacx86.com/buyersguide/building-a-customac-hackintosh-the-ultimate-buyers-guide/">Buyer’s Guide</a> 和网友的成功贴。我只之前微星 Z170A M3 安装黑苹果成功，就想当然的买了微星的这块主板。活生生的因为 BIOS 问题，至少1个月的安装时间浪费了。</li>
<li>买主板别买带无解的无线网卡，明明可以省200块，去买同系列的微星 MPG Z390 GAMING PRO CARBON。然后去买免驱的无线蓝牙网卡：Broadcom 94360CD。</li>
</ol>
<h2 id="EFI"><a href="#EFI" class="headerlink" title="EFI"></a>EFI</h2><p>EFI已上传 <a target="_blank" rel="noopener" href="https://github.com/gewill/Hackintosh-Installation-with-MSI-Z390-and-i9-9900K">https://github.com/gewill/Hackintosh-Installation-with-MSI-Z390-and-i9-9900K</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Ge Will</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  





</body>
</html>
